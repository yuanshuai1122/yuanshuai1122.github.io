<!DOCTYPE html>
<html class="js no-touch  progressive-image  no-reduced-motion progressive" lang="zh-hans">
  <head>
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/img/favicon.ico">

    <meta name="keyword" content=""><meta property="og:title" content="Pythonçˆ¬è™«ï¼ˆå…¨ï¼‰" />
<meta property="og:description" content="ï¼ˆç¼–ç encode()ï¼‰ pat=r&quot;(.*?)&quot; data=re.findall(pat,reponse) print(data[0]) ```python #åˆ›å»ºè‡ªå®šä¹‰opener from urllib import request #æ„å»ºHTTPå¤„ç†å™¨å¯¹è±¡ï¼ˆä¸“é—¨å¤„ç†HTTPè¯·æ±‚çš„å¯¹è±¡ï¼‰ http_hander=request.HTTPHandler() #åˆ›å»ºè‡ªå®šä¹‰open" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuanshuai1122.github.io/posts/python%E7%88%AC%E8%99%AB%E5%85%A8-python%E7%88%AC%E8%99%AB%E5%85%A8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-26T21:52:17+00:00" />
<meta property="article:modified_time" content="2021-11-26T21:52:17+00:00" />
<title>Pythonçˆ¬è™«ï¼ˆå…¨ï¼‰</title>

    <link rel="canonical" href="/posts/python%E7%88%AC%E8%99%AB%E5%85%A8-python%E7%88%AC%E8%99%AB%E5%85%A8/">

    <link rel="stylesheet" href="/css/global.css">

    <link rel="stylesheet" href="/css/custom.css">

    <link rel="stylesheet" href="/css/search.css" />

    
    

    
    

</head>
  </head>
  <body class=" page-article   ">
    <header>
      <nav class="nav">
  <div class="nav-wrapper">
    <div class="nav-content-wrapper">
      <div class="nav-content">
        <a href="/ " class="nav-title">ğŸ§€</a>
        <div class="nav-menu">
          <div class="nav-item-wrapper">
            <a href="/posts " class="nav-item-content">ç›®å½•</a>
          </div><div class="nav-item-wrapper">
            <a href="/about" class="nav-item-content">å…³äº</a>
          </div><div class="nav-item-wrapper">
            <a href="/index.xml" class="nav-item-content" target="_blank">RSS</a>
          </div></div>
      </div>
    </div>
  </div>
</nav>

<script>
  function toggleSearchModal(){
    const template = `
    <div class="modal-body">
      <div id="autocomplete" onclick="event.stopPropagation();"></div>
    </div>
    `
    const modal = document.querySelector("#modal-wrapper")
    if(!modal){
      const div = document.createElement("div")
      document.body.setAttribute("style","overflow: hidden;")
      div.setAttribute("id", "modal-wrapper")
      div.setAttribute("onclick", "toggleSearchModal()")
      div.innerHTML = template
      const script = document.createElement("script");script.setAttribute("src", "https://yuanshuai1122.github.io/js/algolia.js")
      div.appendChild(script)
      document.body.append(div)
    } else {
      document.body.removeAttribute("style")
      document.body.removeChild(modal)
    }
  }
</script>
    </header>
    
  
  
  <main id="main" class="main">
      <section>
        <article class="article">
          
          <div class=" article-header ">
            <div class="category component">
              <div class="component-content">
                <div class="category-eyebrow">
                  <span class="category-eyebrow__category category_original">
                    
                      
                        Python
                      
                    
                  </span>
                  <span class="category-eyebrow__date">2021å¹´11æœˆ26æ—¥</span>
                </div>
              </div>
            </div>
            <div class="pagetitle component">
              <div class="component-content">
                <h1 class="hero-headline">Pythonçˆ¬è™«ï¼ˆå…¨ï¼‰</h1>
              </div>
            </div>
            <div class="component  article-subhead ">
              <div class="component-content"></div>
            </div>

            <div class="tagssheet component">
              <div class="component-content">
                
                  
                  <a href="/tags/python" class="tag">
                    Python
                  </a>
                
                  
                  <a href="/tags/%E7%88%AC%E8%99%AB" class="tag">
                    çˆ¬è™«
                  </a>
                
              </div>
            </div>
          </div>
          
          <div class="pagebody">
            
            
            
            
            
            
            
            
            <p class="component-content component">ï¼ˆç¼–ç encode()ï¼‰</p>
<p class="component-content component">pat=r&quot;<!-- raw HTML omitted -->(.*?)<!-- raw HTML omitted -->&quot;</p>
<p class="component-content component">data=re.findall(pat,reponse)</p>
<p class="component-content component">print(data[0])</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">
```python
#åˆ›å»ºè‡ªå®šä¹‰opener

from urllib import request

#æ„å»ºHTTPå¤„ç†å™¨å¯¹è±¡ï¼ˆä¸“é—¨å¤„ç†HTTPè¯·æ±‚çš„å¯¹è±¡ï¼‰
http_hander=request.HTTPHandler()

#åˆ›å»ºè‡ªå®šä¹‰opener
opener=request.build_opener(http_hander)

#åˆ›å»ºè‡ªå®šä¹‰è¯·æ±‚å¯¹è±¡
req=request.Request(&#34;http://www.baidu.com&#34;)

#å‘é€è¯·æ±‚ï¼Œè·å–å“åº”
#reponse=opener.open(req).read()

#æŠŠè‡ªå®šä¹‰openerè®¾ç½®ä¸ºå…¨å±€ï¼Œè¿™æ ·ç”¨urlopenå‘é€çš„è¯·æ±‚ä¹Ÿä¼šä½¿ç”¨è‡ªå®šä¹‰çš„opener;
request.install_opener(opener)

reponse=request.urlopen(req).read()


print(reponse)</code></pre>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> urllib <span style="color:#f92672">import</span> request
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åçˆ¬è™«2ï¼šåˆ¤æ–­è¯·æ±‚æ¥æºçš„ipåœ°å€</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æªæ–½ï¼šä½¿ç”¨ä»£ç†IP</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>proxylist<span style="color:#f92672">=</span>[
</span></span><span style="display:flex;"><span>	{<span style="color:#e6db74">&#34;http&#34;</span>:<span style="color:#e6db74">&#34;101.248.64.82:80&#34;</span>}
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>proxy<span style="color:#f92672">=</span>random<span style="color:#f92672">.</span>choice(proxylist)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ„å»ºä»£ç†å¤„ç†å™¨å¯¹è±¡</span>
</span></span><span style="display:flex;"><span>proxyHandler<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>ProxyHandler(proxy)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åˆ›å»ºè‡ªå®šä¹‰opener</span>
</span></span><span style="display:flex;"><span>opener<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>build_opener(proxyHandler)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åˆ›å»ºè¯·æ±‚å¯¹è±¡</span>
</span></span><span style="display:flex;"><span>req<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>Request(<span style="color:#e6db74">&#34;http://www.baidu.com&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>res<span style="color:#f92672">=</span>opener<span style="color:#f92672">.</span>open(req)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(res<span style="color:#f92672">.</span>read())</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#å¤„ç†getè¯·æ±‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> urllib <span style="color:#f92672">import</span> request
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib
</span></span><span style="display:flex;"><span><span style="color:#75715e">#http://www.baidu.com/s?wd=%E5%8C%97%E4%BA%AC #urlç¼–ç </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>wd<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;wd&#34;</span>:<span style="color:#e6db74">&#34;åŒ—äº¬&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.baidu.com/s?&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ„é€ urlç¼–ç </span>
</span></span><span style="display:flex;"><span>wdd<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>parse<span style="color:#f92672">.</span>urlencode(wd)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url<span style="color:#f92672">=</span>url<span style="color:#f92672">+</span>wdd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>req<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>Request(url)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>reponse<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>urlopen(req)<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(reponse)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å®æˆ˜ï¼šè´´å§çˆ¬è™«</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> urllib <span style="color:#f92672">import</span> request
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ„é€ è¯·æ±‚å¤´ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>header<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;User-Agent&#34;</span>:<span style="color:#e6db74">&#34;Mozilla/5.0 (Linux; U; An</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">droid 8.1.0; zh-cn; BLA-AL00 Build/HUAW</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">EIBLA-AL00) AppleWebKit/537.36 (KHTML, l</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">ike Gecko) Version/4.0 Chrome/57.0.2987.13</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">2 MQQBrowser/8.9 Mobile Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#urlè§„å¾‹</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># http://tieba.baidu.com/f?kw=python&amp;ie=utf-8&amp;pn=0  #ç¬¬ä¸€é¡µ ï¼ˆ1-1ï¼‰*50</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># http://tieba.baidu.com/f?kw=python&amp;ie=utf-8&amp;pn=50 #ç¬¬äºŒé¡µ ï¼ˆ2-1ï¼‰*50</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># http://tieba.baidu.com/f?kw=python&amp;ie=utf-8&amp;pn=100 #ç¬¬ä¸‰é¡µ ï¼ˆ3-1ï¼‰*50</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># http://tieba.baidu.com/f?kw=python&amp;ie=utf-8&amp;pn=150 #ç¬¬å››é¡µï¼ˆ4-1ï¼‰*50</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># for i in range(1,4):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 	print(&#34;http://tieba.baidu.com/f?kw=python&amp;ie=utf-8&amp;pn=&#34;+str((i-1)*50))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">loadpage</span>(fullurl,filename):
</span></span><span style="display:flex;"><span>	print(<span style="color:#e6db74">&#34;æ­£åœ¨ä¸‹è½½ï¼š&#34;</span>,filename)
</span></span><span style="display:flex;"><span>	req<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>Request(fullurl,headers<span style="color:#f92672">=</span>header)
</span></span><span style="display:flex;"><span>	resp<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>urlopen(req)<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> resp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">writepage</span>(html,filename):
</span></span><span style="display:flex;"><span>	print(<span style="color:#e6db74">&#34;æ­£åœ¨ä¿å­˜ï¼š&#34;</span>,filename)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">with</span> open(filename,<span style="color:#e6db74">&#34;wb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>		f<span style="color:#f92672">.</span>write(html)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	print(<span style="color:#e6db74">&#34;---------------------------&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ„é€ url</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">tiebaSpider</span>(url,begin,end):
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> page <span style="color:#f92672">in</span> range(begin,end<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>		pn<span style="color:#f92672">=</span>(page<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>		fullurl<span style="color:#f92672">=</span>url<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&amp;pn=&#34;</span><span style="color:#f92672">+</span>str(pn) <span style="color:#75715e">#æ¯æ¬¡è¯·æ±‚çš„å®Œæ•´url</span>
</span></span><span style="display:flex;"><span>		filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;c:/ç¬¬&#34;</span><span style="color:#f92672">+</span>str(page)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;é¡µ.html&#34;</span> <span style="color:#75715e">#æ¯æ¬¡è¯·æ±‚åä¿å­˜çš„æ–‡ä»¶å</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		html<span style="color:#f92672">=</span>loadpage(fullurl,filename) <span style="color:#75715e">#è°ƒç”¨çˆ¬è™«ï¼Œçˆ¬å–ç½‘é¡µ</span>
</span></span><span style="display:flex;"><span>		writepage(html,filename) <span style="color:#75715e">#æŠŠè·å–åˆ°çš„ç½‘é¡µä¿¡æ¯å†™å…¥æœ¬åœ°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	kw<span style="color:#f92672">=</span>input(<span style="color:#e6db74">&#34;è¯·è¾“å…¥è´´å§åï¼š&#34;</span>)
</span></span><span style="display:flex;"><span>	begin<span style="color:#f92672">=</span>int(input(<span style="color:#e6db74">&#34;è¯·è¾“å…¥èµ·å§‹é¡µï¼š&#34;</span>))
</span></span><span style="display:flex;"><span>	end<span style="color:#f92672">=</span>int(input(<span style="color:#e6db74">&#34;è¯·è¾“å…¥ç»“æŸé¡µï¼š&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://tieba.baidu.com/f?&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	key<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>parse<span style="color:#f92672">.</span>urlencode({<span style="color:#e6db74">&#34;kw&#34;</span>:kw})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	url<span style="color:#f92672">=</span>url<span style="color:#f92672">+</span>key
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	tiebaSpider(url,begin,end)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">10</span>)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å®æˆ˜ï¼šè´´å§çˆ¬è™«</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> urllib <span style="color:#f92672">import</span> request
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åçˆ¬è™«1 ï¼š ä¼ªè£…æµè§ˆå™¨çš„çˆ¬è™«</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ„é€ è¯·æ±‚å¤´ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>agent1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Mozilla/5.0 (Linux; U; Android 8.1.0; zh-cn; BLA-AL00 Build/HUAWEIBLA-AL00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.132 MQQBrowser/8.9 Mobile Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>agent2<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Mozilla/5.0 (Linux; Android 8.1; EML-AL00 Build/HUAWEIEML-AL00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.143 Crosswalk/24.53.595.0 XWEB/358 MMWEBSDK/23 Mobile Safari/537.36 MicroMessenger/6.7.2.1340(0x2607023A) NetType/4G Language/zh_CN&#34;</span>
</span></span><span style="display:flex;"><span>agent3<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Mozilla/5.0 (Linux; U; Android 8.0.0; zh-CN; MHA-AL00 Build/HUAWEIMHA-AL00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 UCBrowser/12.1.4.994 Mobile Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>agent4<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>agent5<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>list1<span style="color:#f92672">=</span>[agent1,agent2,agent3,agent4,agent5]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>agent<span style="color:#f92672">=</span>random<span style="color:#f92672">.</span>choice(list1)
</span></span><span style="display:flex;"><span>print(agent)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åçˆ¬è™«2ï¼šåˆ¤æ–­è¯·æ±‚æ¥æºçš„ipåœ°å€</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æªæ–½ï¼šä½¿ç”¨ä»£ç†IP</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># proxylist = [</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 	#{&#34;http&#34;: &#34;101.248.64.82:80&#34;}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 	#{&#34;http&#34;: &#34;49.89.87.40:3000&#34;},</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 	#{&#34;http&#34;: &#34;36.249.109.42:9999&#34;},</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 	#{&#34;http&#34;: &#34;58.254.220.116:53579&#34;},</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 	#{&#34;http&#34;: &#34;183.166.136.49:8888&#34;}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># proxy = random.choice(proxylist)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(proxy)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># # æ„å»ºä»£ç†å¤„ç†å™¨å¯¹è±¡</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># proxyHandler = request.ProxyHandler(proxy)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># # åˆ›å»ºè‡ªå®šä¹‰opener</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># opener = request.build_opener(proxyHandler)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #æŠŠè‡ªå®šä¹‰openerè®¾ç½®ä¸ºå…¨å±€ï¼Œè¿™æ ·ç”¨urlopenå‘é€çš„è¯·æ±‚ä¹Ÿä¼šä½¿ç”¨è‡ªå®šä¹‰çš„opener;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># request.install_opener(opener)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>header<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;User-Agent&#34;</span>:agent
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://fanyi.youdao.com/translate?smartresult=dict&amp;smartresult=rule&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#key=&#34;è‡ªå­¦&#34;</span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;è¯·è¾“å…¥è¦ç¿»è¯‘çš„æ–‡å­—ï¼š&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#postè¯·æ±‚éœ€è¦æäº¤çš„å‚æ•°</span>
</span></span><span style="display:flex;"><span>formdata<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;i&#34;</span>:key,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;from&#34;</span>:<span style="color:#e6db74">&#34;AUTO&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;to&#34;</span>:<span style="color:#e6db74">&#34;AUTO&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;smartresult&#34;</span>:<span style="color:#e6db74">&#34;dict&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;client&#34;</span>:<span style="color:#e6db74">&#34;fanyideskweb&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;salt&#34;</span>:<span style="color:#e6db74">&#34;15503049709404&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;sign&#34;</span>:<span style="color:#e6db74">&#34;3da914b136a37f75501f7f31b11e75fb&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;ts&#34;</span>:<span style="color:#e6db74">&#34;1550304970940&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;bv&#34;</span>:<span style="color:#e6db74">&#34;ab57a166e6a56368c9f95952de6192b5&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;doctype&#34;</span>:<span style="color:#e6db74">&#34;json&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;version&#34;</span>:<span style="color:#e6db74">&#34;2.1&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;keyfrom&#34;</span>:<span style="color:#e6db74">&#34;fanyi.web&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;action&#34;</span>:<span style="color:#e6db74">&#34;FY_BY_REALTIME&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;typoResult&#34;</span>:<span style="color:#e6db74">&#34;false&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è½¬ç </span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>parse<span style="color:#f92672">.</span>urlencode(formdata)<span style="color:#f92672">.</span>encode(encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>req<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>Request(url,data<span style="color:#f92672">=</span>data,headers<span style="color:#f92672">=</span>header)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resp<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>urlopen(req)<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ­£åˆ™è¡¨è¾¾å¼ æå–&#34;tgt&#34;:&#34;å’Œ&#34;}]]ä¸­é—´çš„ä»»æ„å†…å®¹</span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&#34;tgt&#34;:&#34;(.*?)&#34;}]]&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>findall(pat,resp)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result[<span style="color:#ae81ff">0</span>])</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#å¼‚å¸¸å¤„ç†</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> urllib <span style="color:#f92672">import</span> request
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>list1<span style="color:#f92672">=</span>[
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;http://www.baidu.com&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;http://www.baidu.com&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;http://www.jiswiswissnduehduehd.com&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;http://www.baidu.com&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;http://www.baidu.com&#34;</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> url <span style="color:#f92672">in</span> list1:
</span></span><span style="display:flex;"><span>	i<span style="color:#f92672">=</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>		request<span style="color:#f92672">.</span>urlopen(url)
</span></span><span style="display:flex;"><span>		print(<span style="color:#e6db74">&#34;ç¬¬&#34;</span>,i,<span style="color:#e6db74">&#34;æ¬¡è¯·æ±‚å®Œæˆ&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>		print(e)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Cookie</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> urllib <span style="color:#f92672">import</span> request
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://i.baidu.com/&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;User-Agent&#34;</span> : <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) App</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">    leWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36&#34;</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Cookie&#34;</span>:<span style="color:#e6db74">&#34;BAIDUID=F1676F6D91D12CF987A81C35B5683EF5:FG=1; PSTM=1543068715; BIDUPSID=F1676F6D91D12CF987A81C35B5683EF5; BDUSS=k4VllQdW9-ZDR6fmo1LWxIeEo5LWd1OTMxLUhCQkY5eUZlZXY0OEtKSzdVSEZjQVFBQUFBJCQAAAAAAAAAAAEAAABATb2F1~OwttK76ti0s8zs0cQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALvDSVy7w0lca3; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; PHPSESSID=e1sso19h9qnjugdq974cpofk50; __guid=62687476.678578182179940700.1550386788528.5847; Hm_lvt_4010fd5075fcfe46a16ec4cb65e02f04=1550386790; monitor_count=4; Hm_lpvt_4010fd5075fcfe46a16ec4cb65e02f04=1550387997&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>req <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>Request(url, headers <span style="color:#f92672">=</span> headers)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>urlopen(req)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(response<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>decode())</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="äºŒrequests" class="pagebody-header">
    äºŒã€requests
  </h2>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) Ap</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">pleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Sa</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">fari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>wd<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;wd&#34;</span>:<span style="color:#e6db74">&#34;ä¸­å›½&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://www.baidu.com/s?&#34;</span>,params<span style="color:#f92672">=</span>wd,headers<span style="color:#f92672">=</span>headers)  <span style="color:#75715e">#getè¯·æ±‚çš„å‚æ•°ä¸ºparams</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>response<span style="color:#f92672">.</span>text <span style="color:#75715e">#è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²å½¢å¼çš„æ•°æ®</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data2<span style="color:#f92672">=</span>response<span style="color:#f92672">.</span>content <span style="color:#75715e">#è¿”å›ä¸€ä¸ªäºŒè¿›åˆ¶å½¢å¼çš„æ•°æ®</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(data2<span style="color:#f92672">.</span>decode())</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ„é€ è¯·æ±‚å¤´ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>header<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;User-Agent&#34;</span>:<span style="color:#e6db74">&#34;Mozilla/5.0 (Linux; U; An</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">droid 8.1.0; zh-cn; BLA-AL00 Build/HUAW</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">EIBLA-AL00) AppleWebKit/537.36 (KHTML, l</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">ike Gecko) Version/4.0 Chrome/57.0.2987.13</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">2 MQQBrowser/8.9 Mobile Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://fanyi.youdao.com/translate?smartresult=dict&amp;smartresult=rule&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#key=&#34;è‡ªå­¦&#34;</span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;è¯·è¾“å…¥è¦ç¿»è¯‘çš„æ–‡å­—ï¼š&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#postè¯·æ±‚éœ€è¦æäº¤çš„å‚æ•°</span>
</span></span><span style="display:flex;"><span>formdata<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;i&#34;</span>:key,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;from&#34;</span>:<span style="color:#e6db74">&#34;AUTO&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;to&#34;</span>:<span style="color:#e6db74">&#34;AUTO&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;smartresult&#34;</span>:<span style="color:#e6db74">&#34;dict&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;client&#34;</span>:<span style="color:#e6db74">&#34;fanyideskweb&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;salt&#34;</span>:<span style="color:#e6db74">&#34;15503049709404&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;sign&#34;</span>:<span style="color:#e6db74">&#34;3da914b136a37f75501f7f31b11e75fb&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;ts&#34;</span>:<span style="color:#e6db74">&#34;1550304970940&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;bv&#34;</span>:<span style="color:#e6db74">&#34;ab57a166e6a56368c9f95952de6192b5&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;doctype&#34;</span>:<span style="color:#e6db74">&#34;json&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;version&#34;</span>:<span style="color:#e6db74">&#34;2.1&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;keyfrom&#34;</span>:<span style="color:#e6db74">&#34;fanyi.web&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;action&#34;</span>:<span style="color:#e6db74">&#34;FY_BY_REALTIME&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;typoResult&#34;</span>:<span style="color:#e6db74">&#34;false&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>post(url,headers<span style="color:#f92672">=</span>header,data<span style="color:#f92672">=</span>formdata)   <span style="color:#75715e">#postè¯·æ±‚çš„å‚æ•°ä¸ºdata</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ­£åˆ™è¡¨è¾¾å¼ æå–&#34;tgt&#34;:&#34;å’Œ&#34;}]]ä¸­é—´çš„ä»»æ„å†…å®¹</span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&#34;tgt&#34;:&#34;(.*?)&#34;}]]&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>findall(pat,response<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è®¾ç½®ipåœ°å€</span>
</span></span><span style="display:flex;"><span>proxy<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;http&#34;</span>:<span style="color:#e6db74">&#34;http://101.248.64.72:80&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;http&#34;</span>:<span style="color:#e6db74">&#34;http://101.248.64.68:80&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;https&#34;</span>:<span style="color:#e6db74">&#34;https://101.248.64.72:80&#34;</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://www.baidu.com&#34;</span>,proxies<span style="color:#f92672">=</span>proxy)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(response<span style="color:#f92672">.</span>content<span style="color:#f92672">.</span>decode())</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://www.baidu.com&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#1.è·å–è¿”å›çš„cookiejarå¯¹è±¡</span>
</span></span><span style="display:flex;"><span>cookiejar<span style="color:#f92672">=</span>response<span style="color:#f92672">.</span>cookies
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#2.å°†cookiejarè½¬æ¢æˆå­—å…¸</span>
</span></span><span style="display:flex;"><span>cookiedict<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>utils<span style="color:#f92672">.</span>dict_from_cookiejar(cookiejar)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print(cookiejar)</span>
</span></span><span style="display:flex;"><span>print(cookiedict)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#ä½¿ç”¨sessionå®ç°ç™»é™†</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># import requests</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># headers = {&#34;User-Agent&#34;: &#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36&#34;}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #åˆ›å»ºsessionå¯¹è±¡</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ses=requests.session()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #æ„é€ ç™»é™†éœ€è¦çš„å‚æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># data={&#34;email&#34;:&#34;3254272716@qq.com&#34;,&#34;password&#34;:&#34;123321a&#34;}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #é€šè¿‡ä¼ é€’ç”¨æˆ·åå¯†ç å¾—åˆ°cookieä¿¡æ¯</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ses.post(&#34;http://www.renren.com/PLogin.do&#34;,data=data)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #è¯·æ±‚éœ€è¦çš„é¡µé¢</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># response=ses.get(&#34;http://www.renren.com/880151247/profile&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(response.text)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åˆ›å»ºsessionå¯¹è±¡</span>
</span></span><span style="display:flex;"><span>ses<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>session()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ„é€ ç™»é™†éœ€è¦çš„å‚æ•°</span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;18232336174@163.com&#34;</span>,<span style="color:#e6db74">&#34;password&#34;</span>:<span style="color:#e6db74">&#34;18232336174...&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#é€šè¿‡ä¼ é€’ç”¨æˆ·åå¯†ç å¾—åˆ°cookieä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>ses<span style="color:#f92672">.</span>post(<span style="color:#e6db74">&#34;http://mail.163.com&#34;</span>,data<span style="color:#f92672">=</span>data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è¯·æ±‚éœ€è¦çš„é¡µé¢</span>
</span></span><span style="display:flex;"><span>response<span style="color:#f92672">=</span>ses<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://mail.163.com/js6/main.jsp?sid=KAOGBblSlxmIGlAAmDSSXTjrBseNxEhE&amp;df=mail163_letter#module=contact.ContactModule%7C%7B%7D&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(response<span style="color:#f92672">.</span>content<span style="color:#f92672">.</span>decode())</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> re   <span style="color:#75715e"># python çš„æ­£åˆ™åº“</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests     <span style="color:#75715e"># python çš„requestsåº“</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># page=int(input(&#34;è¯·è¾“å…¥æ‚¨è¦çˆ¬å–çš„é¡µæ•°ï¼š&#34;))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>songID<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>songName<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>page_size <span style="color:#f92672">=</span> int(input(<span style="color:#e6db74">&#34;è¯·é—®è¦çˆ¬å–ç¬¬å‡ é¡µå‘¢ï¼š&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,page_size):
</span></span><span style="display:flex;"><span>	url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.htqyy.com/top/musicList/hot?pageIndex=&#34;</span><span style="color:#f92672">+</span>str(i)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&amp;pageSize=20&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#$url = &#34;http://www.htqyy.com/top/hot&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ„é€ è¯·æ±‚å¤´ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>header <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Accept&#34;</span>: <span style="color:#e6db74">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Accept-Encoding&#34;</span>: <span style="color:#e6db74">&#34;gzip, deflate&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Accept-Language&#34;</span>: <span style="color:#e6db74">&#34;zh-CN,zh;q=0.9&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Cache-Control&#34;</span>: <span style="color:#e6db74">&#34;max-age=0&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Connection&#34;</span>: <span style="color:#e6db74">&#34;keep-alive&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&#34;Cookie&#34;:&#34; __cfduid=d54ff2470d42e999d942b3b64cc266a9f1594821751; BAIDU_SSP_lcr=https://www.baidu.com/link?url=zPqjAbMqG9O52ECGWPxIoo5nIDVDpw6DO0i0JHZqbgy&amp;wd=&amp;eqid=e3b52e830007c46a000000035f0f0c70; blk=0; Hm_lvt_74e11efe27096f6ef1745cd53f168168=1594821752; isPlay=0; jploop=false; Hm_lpvt_74e11efe27096f6ef1745cd53f168168=1594828497&#34;,</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Host&#34;</span>: <span style="color:#e6db74">&#34;www.htqyy.com&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Referer&#34;</span>: <span style="color:#e6db74">&#34;http://www.htqyy.com/top/hot&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Upgrade-Insecure-Requests&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è·å–éŸ³ä¹æ¦œå•çš„ç½‘é¡µä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>html<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(url,headers <span style="color:#f92672">=</span> header)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>strr<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;title=&#34;(.*?)&#34; sid&#39;</span>
</span></span><span style="display:flex;"><span>pat2<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;sid=&#34;(.*?)&#34;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>idlist<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>findall(pat2,strr)
</span></span><span style="display:flex;"><span>titlelist<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>findall(pat1,strr)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>songID<span style="color:#f92672">.</span>extend(idlist)
</span></span><span style="display:flex;"><span>songName<span style="color:#f92672">.</span>extend(titlelist)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(songID)):
</span></span><span style="display:flex;"><span>	songurl<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://f2.htqyy.com/play8/&#34;</span><span style="color:#f92672">+</span>str(songID[i])<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/mp3/7&#34;</span>
</span></span><span style="display:flex;"><span>	songname<span style="color:#f92672">=</span>songName[i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	data<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(songurl)<span style="color:#f92672">.</span>content
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	print(<span style="color:#e6db74">&#34;æ­£åœ¨ä¸‹è½½ç¬¬&#34;</span>,i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#34;é¦–,&#34;&#34;æ­Œæ›²åä¸ºï¼š&#34;</span>,songName[i])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;/Users/yuanshuai/Downloads/music/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.mp3&#34;</span><span style="color:#f92672">.</span>format(songname),<span style="color:#e6db74">&#34;wb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>		f<span style="color:#f92672">.</span>write(data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.5</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="ä¸‰æ­£åˆ™è¡¨è¾¾å¼" class="pagebody-header">
    ä¸‰ã€æ­£åˆ™è¡¨è¾¾å¼
  </h2>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åŸå­ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¸­å®ç°åŒ¹é…çš„åŸºæœ¬å•ä½</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å…ƒå­—ç¬¦ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¸­å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ä»¥æ™®é€šå­—ç¬¦ä½œä¸ºåŸå­ï¼ˆåŒ¹é…ä¸€ä¸ªæ™®é€šå­—ç¬¦ï¼‰</span>
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;æ¹–å—æ¹–åŒ—å¹¿ä¸œå¹¿è¥¿&#34;</span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;æ¹–åŒ—&#34;</span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>search(pat,a)
</span></span><span style="display:flex;"><span>print(result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åŒ¹é…é€šç”¨å­—ç¬¦</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#\w ä»»æ„å­—æ¯/æ•°å­—/ä¸‹åˆ’çº¿ </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#\W å’Œå°å†™wç›¸å </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#\d åè¿›åˆ¶æ•°å­—</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#\D é™¤äº†åè¿›åˆ¶æ•°ä»¥å¤–çš„å€¼</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#\s ç©ºç™½å­—ç¬¦ </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#\S éç©ºç™½å­—ç¬¦ </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;136892763900&#34;</span>
</span></span><span style="display:flex;"><span>pat2<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1\d\d\d\d\d\d\d\d\d\d&#34;</span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>search(pat2,b))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;@@@@@@@@@@##@!_tdyuhdihdiw&#34;</span>
</span></span><span style="display:flex;"><span>pat3<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;\W\w\w&#34;</span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>search(pat3,c))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åŒ¹é…æ•°å­—ã€è‹±æ–‡ã€ä¸­æ–‡</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ•°å­— [0-9]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è‹±æ–‡ [a-z][A-Z]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä¸­æ–‡ [\u4e00-\u9fa5]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;!@#$@#@##$å¼ ä¸‰%$^%$%#@$boy#@%##$%$$@#@#23@#@#@#@##$%$%$&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;[\u4e00-\u9fa5][\u4e00-\u9fa5]&#34;</span>
</span></span><span style="display:flex;"><span>pat2<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;[a-z][a-z][a-z]&#34;</span>
</span></span><span style="display:flex;"><span>pat3<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;[0-9][0-9]&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result1<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>search(pat1,d)
</span></span><span style="display:flex;"><span>result2<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>search(pat2,d)
</span></span><span style="display:flex;"><span>result3<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>search(pat3,d)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result1,result2,result3)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åŸå­è¡¨</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å®šä¹‰ä¸€ç»„å¹³ç­‰çš„åŸå­</span>
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;18689276390&#34;</span>
</span></span><span style="display:flex;"><span>pat2<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1[3578]\d\d\d\d\d\d\d\d\d&#34;</span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>search(pat2,b))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;nsiwsoiwpythonjsoksosj&#34;</span>
</span></span><span style="display:flex;"><span>pat3<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;py[abcdt]hon&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>search(pat2,b))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å…ƒå­—ç¬¦--æ­£åˆ™è¡¨è¾¾å¼ä¸­å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># . åŒ¹é…ä»»æ„å­—ç¬¦ \né™¤å¤–</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ^ åŒ¹é…å­—ç¬¦ä¸²å¼€å§‹ä½ç½®  ^136</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># $ åŒ¹é…å­—ç¬¦ä¸²ä¸­ç»“æŸçš„ä½ç½® 6666$</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># * é‡å¤0æ¬¡1æ¬¡å¤šæ¬¡å‰é¢çš„åŸå­ \d*</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ? é‡å¤ä¸€æ¬¡æˆ–è€…0æ¬¡å‰é¢çš„åŸå­ \d?</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># + é‡å¤ä¸€æ¬¡æˆ–å¤šæ¬¡å‰é¢çš„åŸå­  \d+</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;135738484941519874888813774748687&#34;</span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;...&#34;</span>
</span></span><span style="display:flex;"><span>pat2<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;^135\d\d\d\d\d\d\d\d&#34;</span>
</span></span><span style="display:flex;"><span>pat3<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.*8687$&#34;</span>
</span></span><span style="display:flex;"><span>pat4<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;8*&#34;</span>
</span></span><span style="display:flex;"><span>pat5<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;8+&#34;</span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>search(pat5,d))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åŒ¹é…å›ºå®šæ¬¡æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#{n}å‰é¢çš„åŸå­å‡ºç°äº†næ¬¡</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#{n,}è‡³å°‘å‡ºç°næ¬¡</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#{n,m}å‡ºç°æ¬¡æ•°ä»‹äºn-mä¹‹é—´</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;234ded65de45667888991jisw&#34;</span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;\d{8,10}&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>search(pat1,a))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #å¤šä¸ªè¡¨è¾¾å¼ | </span>
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;13699998888&#34;</span>
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;027-1234567&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;1[3578]\d</span><span style="color:#e6db74">{9}</span><span style="color:#e6db74">|\d</span><span style="color:#e6db74">{3}</span><span style="color:#e6db74">-\d</span><span style="color:#e6db74">{7}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>search(pat1,a))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åˆ†ç»„ ()</span>
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;jiwdjeodjo@$#python%$$^^&amp;*&amp;^%$java#@!!!!!!!!!!!!!!13688889999!!!!!!!!!!!!!!!!!#@#$#$&#34;</span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;(python).{0,}(java).{0,}(1[3578]\d</span><span style="color:#e6db74">{9}</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>search(pat,a)<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;jiwdjeodjo@$#python%$$^^&amp;*&amp;^%$java#@!!!!!!!!!!!!!!aaaæˆ‘è¦è‡ªå­¦ç½‘bbb!!!!!!!!!!!!!!!!!#@#$#$&#34;</span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;aaa(.*?)bbb&#34;</span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>findall(pat,a))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è´ªå©ªæ¨¡å¼å’Œéè´ªå©ªæ¨¡å¼</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è´ªå©ªæ¨¡å¼ï¼šåœ¨æ•´ä¸ªè¡¨è¾¾å¼åŒ¹é…æˆåŠŸçš„å‰æä¸‹ï¼Œå°½å¯èƒ½å¤šçš„åŒ¹é…ï¼›</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#éè´ªå©ªæ¨¡å¼ï¼šåœ¨æ•´ä¸ªè¡¨è¾¾å¼åŒ¹é…æˆåŠŸçš„å‰æä¸‹ï¼Œå°½å¯èƒ½å°‘çš„åŒ¹é… ( ? )ï¼›</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Pythoné‡Œé»˜è®¤æ˜¯è´ªå©ªçš„ã€‚</span>
</span></span><span style="display:flex;"><span>strr<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;aa&lt;div&gt;test1&lt;/div&gt;bb&lt;div&gt;test2&lt;/div&gt;cc&#39;</span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;&lt;div&gt;.*&lt;/div&gt;&#34;</span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>search(pat1,strr)) <span style="color:#75715e">#è´ªå©ªæ¨¡å¼</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>strr<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;aa&lt;div&gt;test1&lt;/div&gt;bb&lt;div&gt;test2&lt;/div&gt;cc&#39;</span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;&lt;div&gt;.*?&lt;/div&gt;&#34;</span>
</span></span><span style="display:flex;"><span>print(re<span style="color:#f92672">.</span>findall(pat1,strr)) <span style="color:#75715e">#éè´ªå©ªæ¨¡å¼</span></span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#compileå‡½æ•°---å°†æ­£åˆ™è¡¨è¾¾å¼è½¬æ¢æˆå†…éƒ¨æ ¼å¼ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>strr<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;PYTHON666Java&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;Python&#34;</span>,re<span style="color:#f92672">.</span>I) <span style="color:#75715e">#æ¨¡å¼ä¿®æ­£ç¬¦ï¼šå¿½ç•¥å¤§å°å†™</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(pat<span style="color:#f92672">.</span>search(strr))</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#matchå‡½æ•°å’Œsearchå‡½æ•°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># matchå‡½æ•°--åŒ¹é…å¼€å¤´</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># searchå‡½æ•°--åŒ¹é…ä»»æ„ä½ç½®</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯ä¸€æ¬¡åŒ¹é…ï¼ŒåŒ¹é…åˆ°ä¸€æ¬¡å°±ä¸å†å¾€åç»§ç»­åŒ¹é…äº†</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>strr<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javapythonjavahtmlpythonjs&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;python&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(pat<span style="color:#f92672">.</span>search(strr)<span style="color:#f92672">.</span>group())</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#findall()   æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…çš„å†…å®¹ï¼Œè£…åˆ°åˆ—è¡¨ä¸­</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#finditer()  æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…çš„å†…å®¹ï¼Œè£…åˆ°è¿­ä»£å™¨ä¸­</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>strr<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;hello--------hello-----------</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">---------hello-----------------</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">---------hello--hello----------------</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">----------hello---------hello----hello----------&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;hello&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print(pat.findall(strr))</span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>pat<span style="color:#f92672">.</span>finditer(strr)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>list1<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> data:
</span></span><span style="display:flex;"><span>	list1<span style="color:#f92672">.</span>append(i<span style="color:#f92672">.</span>group())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(list1)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#split()  æŒ‰ç…§èƒ½å¤ŸåŒ¹é…çš„å­ä¸²å°†å­—ç¬¦ä¸²åˆ†å‰²åè¿”å›åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#sub()    subæ–¹æ³• ç”¨äºæ›¿æ¢</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>strr1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;å¼ ä¸‰,,,æå››,,,,,,,,,ç‹äº”,,,,,,,,èµµå…­&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;,+&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result1<span style="color:#f92672">=</span>pat1<span style="color:#f92672">.</span>split(strr1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>strr2<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;hello 123,hello 456!&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat2<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;\d+&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result2<span style="color:#f92672">=</span>pat2<span style="color:#f92672">.</span>sub(<span style="color:#e6db74">&#34;666&#34;</span>,strr2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result2)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) Ap</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">pleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Sa</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">fari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://changyongdianhuahaoma.51240.com/&#34;</span>,headers<span style="color:#f92672">=</span>headers)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&lt;tr bgcolor=&#34;#EFF7F0&#34;&gt;[\s\S]*?&lt;td&gt;(.*?)&lt;/td&gt;[\s\S]*?&lt;td&gt;[\s\S]*?&lt;/td&gt;[\s\S]*?&lt;/tr&gt;&#39;</span>
</span></span><span style="display:flex;"><span>pat2<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&lt;tr bgcolor=&#34;#EFF7F0&#34;&gt;[\s\S]*?&lt;td&gt;[\s\S]*?&lt;/td&gt;[\s\S]*?&lt;td&gt;(.*?)&lt;/td&gt;[\s\S]*?&lt;/tr&gt;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pattern1<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(pat1)
</span></span><span style="display:flex;"><span>pattern2<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(pat2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data1<span style="color:#f92672">=</span>pattern1<span style="color:#f92672">.</span>findall(response)
</span></span><span style="display:flex;"><span>data2<span style="color:#f92672">=</span>pattern2<span style="color:#f92672">.</span>findall(response)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resultlist<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(data1)):
</span></span><span style="display:flex;"><span>	resultlist<span style="color:#f92672">.</span>append(data1[i]<span style="color:#f92672">+</span>data2[i])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(resultlist)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib.request
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å…¨å±€å–æ¶ˆè¯ä¹¦éªŒè¯</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> ssl
</span></span><span style="display:flex;"><span>ssl<span style="color:#f92672">.</span>_create_default_https_context <span style="color:#f92672">=</span> ssl<span style="color:#f92672">.</span>_create_unverified_context
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;User-Agent&#34;</span> : <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>page_num <span style="color:#f92672">=</span> int(input(<span style="color:#e6db74">&#34;è¯·é—®è¦çˆ¬å–ç¬¬å‡ é¡µå‘¢ï¼š&#34;</span>))
</span></span><span style="display:flex;"><span>page<span style="color:#f92672">=</span>str((page_num<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">20</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://movie.douban.com/j/chart/top_list?type=11&amp;interval_id=100%3A90&amp;action=&amp;start=&#34;</span><span style="color:#f92672">+</span>page<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&amp;limit=20&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>req<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>Request(url,headers<span style="color:#f92672">=</span>headers)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(req)<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&#34;rating&#34;:\[&#34;(.*?)&#34;,&#34;\d+&#34;\]&#39;</span>
</span></span><span style="display:flex;"><span>pat2<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&#34;title&#34;:&#34;(.*?)&#34;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pattern1<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(pat1,re<span style="color:#f92672">.</span>I)
</span></span><span style="display:flex;"><span>pattern2<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(pat2,re<span style="color:#f92672">.</span>I)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data1<span style="color:#f92672">=</span>pattern1<span style="color:#f92672">.</span>findall(data)
</span></span><span style="display:flex;"><span>data2<span style="color:#f92672">=</span>pattern2<span style="color:#f92672">.</span>findall(data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(len(data1)):
</span></span><span style="display:flex;"><span>	print(<span style="color:#e6db74">&#34;æ’åï¼š&#34;</span>,x<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#34;ç”µå½±åï¼š&#34;</span>,data2[x],<span style="color:#e6db74">&#34;è±†ç“£è¯„åˆ†:&#34;</span>,data1[x])</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="å››xpathè¡¨è¾¾å¼" class="pagebody-header">
    å››ã€xpathè¡¨è¾¾å¼
  </h2>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#xpathè¡¨è¾¾å¼</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æœ‰åŒå­¦è¯´ï¼Œæˆ‘æ­£åˆ™ç”¨çš„ä¸å¥½ï¼Œå¤„ç†HTMLæ–‡æ¡£å¾ˆç´¯ï¼Œæœ‰æ²¡æœ‰å…¶ä»–çš„æ–¹æ³•ï¼Ÿ</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æœ‰ï¼é‚£å°±æ˜¯XPathï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°† HTMLæ–‡ä»¶ è½¬æ¢æˆ XMLæ–‡æ¡£ï¼Œ</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ç„¶åç”¨ XPath æŸ¥æ‰¾ HTML èŠ‚ç‚¹æˆ–å…ƒç´ ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æˆ‘ä»¬éœ€è¦å®‰è£…lxmlæ¨¡å—æ¥æ”¯æŒxpathçš„æ“ä½œã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ä½¿ç”¨ pip å®‰è£…ï¼špip install lxml</span></span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#è§£æå­—ç¬¦ä¸²å½¢å¼html</span>
</span></span><span style="display:flex;"><span>text <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &lt;ul&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;item-0&#34;&gt;&lt;a href=&#34;link1.html&#34;&gt;å¼ ä¸‰&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;item-1&#34;&gt;&lt;a href=&#34;link2.html&#34;&gt;æå››&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;item-inactive&#34;&gt;&lt;a href=&#34;link3.html&#34;&gt;ç‹äº”&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;item-1&#34;&gt;&lt;a href=&#34;link4.html&#34;&gt;èµµå…­&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;item-0&#34;&gt;&lt;a href=&#34;link5.html&#34;&gt;è€ä¸ƒ&lt;/a&gt; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     &lt;/ul&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#etree.HTML()å°†å­—ç¬¦ä¸²è§£ææˆäº†ç‰¹æ®Šçš„htmlå¯¹è±¡</span>
</span></span><span style="display:flex;"><span>html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(text)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å°†htmlå¯¹è±¡è½¬æˆå­—ç¬¦ä¸²</span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>tostring(html,encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span>)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#è§£ææœ¬åœ°html</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#çˆ¬è™«ä¸­ç½‘é¡µå¤„ç†æ–¹å¼ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#1ï¼Œåœ¨çˆ¬è™«ä¸­ï¼Œæ•°æ®è·å–å’Œæ•°æ®æ¸…æ´—ä¸€ä½“ï¼ŒHTML()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#2ã€æ•°æ®è·å–å’Œæ•°æ®æ¸…æ´—åˆ†å¼€ï¼Œparse()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è·å–æœ¬åœ°htmlæ–‡æ¡£</span>
</span></span><span style="display:flex;"><span>html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>parse(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\file\hello.html&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>tostring(html,encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span>)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#è·å–ä¸€ç±»æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>parse(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\file\hello.html&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#34;//a&#34;</span>) <span style="color:#75715e">#è·å–æ‰€æœ‰spanæ ‡ç­¾çš„ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>text)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#è·å–æŒ‡å®šå±æ€§çš„æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>html <span style="color:#f92672">=</span> etree<span style="color:#f92672">.</span>parse(<span style="color:#e6db74">&#34;c:/file/hello.html&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># result1=html.xpath(&#34;//li[@class=&#39;item-88&#39;]&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result2<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#34;//li/a[@href=&#39;link2.html&#39;]&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result2)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree 
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è·å–æ ‡ç­¾çš„å±æ€§</span>
</span></span><span style="display:flex;"><span>html <span style="color:#f92672">=</span> etree<span style="color:#f92672">.</span>parse(<span style="color:#e6db74">&#34;c:/file/hello.html&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># result1=html.xpath(&#34;//li/@class&#34;)</span>
</span></span><span style="display:flex;"><span>result2<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#34;//li/a/@href&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> result2:
</span></span><span style="display:flex;"><span>	requests<span style="color:#f92672">.</span>get(i)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#è·å–å­æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>html <span style="color:#f92672">=</span> etree<span style="color:#f92672">.</span>parse(<span style="color:#e6db74">&#34;c:/file/hello.html&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result1<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#34;//li/a&#34;</span>) <span style="color:#75715e">#è·å–ä¸‹ä¸€çº§å­æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>result2<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#34;//li//span&#34;</span>) <span style="color:#75715e">#è·å–æ‰€æœ‰ç¬¦åˆæ¡ä»¶å­æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print(result2[1].text)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è·å–liæ ‡ç­¾ä¸‹aæ ‡ç­¾é‡Œæ‰€æœ‰çš„class</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result3<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#34;//li/a//@class&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result3)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#è·å–æ ‡ç­¾åå’Œå†…å®¹</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>html <span style="color:#f92672">=</span> etree<span style="color:#f92672">.</span>parse(<span style="color:#e6db74">&#34;c:/file/hello.html&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è·å–å€’æ•°ç¬¬äºŒä¸ªliå…ƒç´ ä¸‹açš„å†…å®¹</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#result1=html.xpath(&#34;//li[last()-1]/a&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># result2=html.xpath(&#34;//li/a&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(result1[-2].text) #.textè·å–æ ‡ç­¾å†…å®¹</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è·å– class å€¼ä¸º bold çš„æ ‡ç­¾å</span>
</span></span><span style="display:flex;"><span>result3<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#34;//*[@class=&#39;bold&#39;]&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result3[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>tag) <span style="color:#75715e">#.tagè¡¨ç¤ºè·å–æ ‡ç­¾å</span></span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#çˆ¬å–ç³—äº‹ç™¾ç§‘æ®µå­</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://www.qiushibaike.com/&#39;</span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#39;User-Agent&#39;</span>: <span style="color:#e6db74">&#39;Mozilla/5.0 (Windows NT 10.0; WOW64)</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">	AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">	.2743.116 Safari/537.36&#39;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#39;Accept-Language&#39;</span>: <span style="color:#e6db74">&#39;zh-CN,zh;q=0.8&#39;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(url,headers<span style="color:#f92672">=</span>headers)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(response)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result1<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//div//a[@class=&#34;recmd-content&#34;]/@href&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print(result1)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#https://www.qiushibaike.com/article/121207030</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> site <span style="color:#f92672">in</span> result1:
</span></span><span style="display:flex;"><span>	xurl<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://www.qiushibaike.com&#34;</span><span style="color:#f92672">+</span>site
</span></span><span style="display:flex;"><span>	response2<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(xurl)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>	html2<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(response2)
</span></span><span style="display:flex;"><span>	result2<span style="color:#f92672">=</span>html2<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#34;//div[@class=&#39;content&#39;]&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	print(result2[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>text)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#ç™¾åº¦è´´å§å›¾ç‰‡çˆ¬è™«</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib.request
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å…¨å±€å–æ¶ˆè¯ä¹¦éªŒè¯</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> ssl
</span></span><span style="display:flex;"><span>ssl<span style="color:#f92672">.</span>_create_default_https_context <span style="color:#f92672">=</span> ssl<span style="color:#f92672">.</span>_create_unverified_context
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Spider</span>(object):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>beginPage<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>endPage<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://tieba.baidu.com/f?&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>ua_header <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;User-Agent&#34;</span> : <span style="color:#e6db74">&#34;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1 Trident/5.0;&#34;</span>}
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>fileName<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#æ„é€ url</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">tiebaSpider</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> page <span style="color:#f92672">in</span> range(self<span style="color:#f92672">.</span>beginPage,self<span style="color:#f92672">.</span>endPage<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            pn<span style="color:#f92672">=</span>(page<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>            wo<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;pn&#39;</span>:pn,<span style="color:#e6db74">&#39;kw&#39;</span>:tiebaName}
</span></span><span style="display:flex;"><span>            word<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>parse<span style="color:#f92672">.</span>urlencode(wo)
</span></span><span style="display:flex;"><span>            myurl<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>url<span style="color:#f92672">+</span>word
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>loadPage(myurl)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#çˆ¬å–é¡µé¢å†…å®¹</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">loadPage</span>(self,url):
</span></span><span style="display:flex;"><span>        req<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>Request(url,headers<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>ua_header)
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(req)<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(data)
</span></span><span style="display:flex;"><span>        links<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//div[@class=&#34;threadlist_lz clearfix&#34;]/div/a/@href&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> link <span style="color:#f92672">in</span> links:
</span></span><span style="display:flex;"><span>            link<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://tieba.baidu.com&#34;</span><span style="color:#f92672">+</span>link
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>loadImages(link)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#çˆ¬å–å¸–å­è¯¦æƒ…é¡µï¼Œè·å¾—å›¾ç‰‡çš„é“¾æ¥</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">loadImages</span>(self,link):
</span></span><span style="display:flex;"><span>        req<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>Request(link,headers<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>ua_header)
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(req)<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>        html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(data)
</span></span><span style="display:flex;"><span>        links<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//img[@class=&#34;BDE_Image&#34;]/@src&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> imageslink <span style="color:#f92672">in</span> links:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>writeImages(imageslink)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#é€šè¿‡å›¾ç‰‡æ‰€åœ¨é“¾æ¥ï¼Œçˆ¬å–å›¾ç‰‡å¹¶ä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°ï¼š</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">writeImages</span>(self,imagesLink):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;æ­£åœ¨å­˜å‚¨å›¾ç‰‡ï¼š&#34;</span>,self<span style="color:#f92672">.</span>fileName,<span style="color:#e6db74">&#34;....&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        image<span style="color:#f92672">=</span>urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(imagesLink)<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#ä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°</span>
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">=</span>open(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;/Users/yuanshuai/Desktop/img//&#34;</span><span style="color:#f92672">+</span>str(self<span style="color:#f92672">.</span>fileName)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.jpg&#34;</span>,<span style="color:#e6db74">&#34;wb&#34;</span>)
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(image)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>fileName<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    tiebaName <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;è¯·è¾“å…¥è¦çˆ¬å–çš„è´´å§åï¼š&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    mySpider<span style="color:#f92672">=</span>Spider()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    mySpider<span style="color:#f92672">.</span>tiebaSpider()</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="äº”beautifulsoup" class="pagebody-header">
    äº”ã€BeautifulSoup
  </h2>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#BeautifulSoupæ¨¡å—ç®€ä»‹å’Œå®‰è£…</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> bs4 <span style="color:#f92672">import</span> BeautifulSoup
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#CSS é€‰æ‹©å™¨ï¼šBeautifulSoup4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å’Œlxml ä¸€æ ·ï¼ŒBeautiful Soup ä¹Ÿæ˜¯ä¸€ä¸ªHTML/XMLçš„è§£æå™¨</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ä¸»è¦çš„åŠŸèƒ½ä¹Ÿæ˜¯å¦‚ä½•è§£æå’Œæå– HTML/XML æ•°æ®ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ¨¡å—ä¸‹è½½å®‰è£…ï¼špip install bs4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åŸºç¡€ä¾‹å­</span>
</span></span><span style="display:flex;"><span>html <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse&#39;s story&lt;/title&gt;&lt;/head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;body&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;p class=&#34;title&#34; name=&#34;dromouse&#34;&gt;&lt;b&gt;The Dormouse&#39;s story&lt;/b&gt;&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;p class=&#34;story&#34;&gt;Once upon a time there were three little sisters; and their names were
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;a href=&#34;http://example.com/elsie&#34; class=&#34;sister&#34; id=&#34;link1&#34;&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;a href=&#34;http://example.com/lacie&#34; class=&#34;sister&#34; id=&#34;link2&#34;&gt;Lacie&lt;/a&gt; and
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;a href=&#34;http://example.com/tillie&#34; class=&#34;sister&#34; id=&#34;link3&#34;&gt;Tillie&lt;/a&gt;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">and they lived at the bottom of a well.&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;p class=&#34;story&#34;&gt;...&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è§£æå­—ç¬¦ä¸²å½¢å¼çš„html</span>
</span></span><span style="display:flex;"><span>soup<span style="color:#f92672">=</span>BeautifulSoup(html,<span style="color:#e6db74">&#34;lxml&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #è§£ææœ¬åœ°htmlæ–‡ä»¶</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># soup2=BeautifulSoup(open(&#34;index.html&#34;))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ ¼å¼åŒ–è¾“å‡ºsoupå¯¹è±¡</span>
</span></span><span style="display:flex;"><span>print(soup<span style="color:#f92672">.</span>prettify())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #æ ¹æ®æ ‡ç­¾åè·å–æ ‡ç­¾ä¿¡æ¯ soup.æ ‡ç­¾å</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(soup.title)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #è·å–æ ‡ç­¾å†…å®¹</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(soup.title.string)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #è·å–æ ‡ç­¾å</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(soup.title.name)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #è·å–æ ‡ç­¾å†…æ‰€æœ‰å±æ€§</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(soup.p.attrs[&#34;name&#34;])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è·å–ç›´æ¥å­æ ‡ç­¾ï¼Œç»“æœæ˜¯ä¸€ä¸ªåˆ—è¡¨</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(soup.head.contents)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è·å–ç›´æ¥å­æ ‡ç­¾ï¼Œç»“æœæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># for i in soup.head.children:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 	print(i)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è·å–æ‰€æœ‰å­æ ‡ç­¾ï¼Œç»“æœæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> soup<span style="color:#f92672">.</span>p<span style="color:#f92672">.</span>descendants:
</span></span><span style="display:flex;"><span>	print(i)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ ¹æ®å­—ç¬¦ä¸²æŸ¥æ‰¾æ‰€æœ‰çš„aæ ‡ç­¾ï¼Œè¿”å›ä¸€ä¸ªç»“æœé›†ï¼Œé‡Œé¢è£…çš„æ˜¯æ ‡ç­¾å¯¹è±¡</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># data=soup.find_all(&#34;a&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># for i in data:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 	print(i.string)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># data2=soup.find_all(re.compile(&#34;^b&#34;))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># for i in data2:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 	print(i.string)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ ¹æ®å±æ€§æŸ¥æ‰¾æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># data3=soup.find_all(id=&#34;link2&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># for i in data3:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 	print(i)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ ¹æ®æ ‡ç­¾å†…å®¹è·å–æ ‡ç­¾å†…å®¹</span>
</span></span><span style="display:flex;"><span>data4<span style="color:#f92672">=</span>soup<span style="color:#f92672">.</span>find_all(text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Lacie&#34;</span>)
</span></span><span style="display:flex;"><span>data5<span style="color:#f92672">=</span>soup<span style="color:#f92672">.</span>find_all(text<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;Lacie&#34;</span>,<span style="color:#e6db74">&#34;Tillie&#34;</span>])
</span></span><span style="display:flex;"><span>data6<span style="color:#f92672">=</span>soup<span style="color:#f92672">.</span>find_all(text<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">&#34;Do&#34;</span>))
</span></span><span style="display:flex;"><span>print(data6)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#CSSé€‰æ‹©å™¨ç±»å‹ï¼šæ ‡ç­¾é€‰æ‹©å™¨ã€ç±»é€‰æ‹©å™¨ã€idé€‰æ‹©å™¨</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#é€šè¿‡æ ‡ç­¾åæŸ¥æ‰¾</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># data=soup.select(&#34;a&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#é€šè¿‡ç±»åæŸ¥æ‰¾</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># data=soup.select(&#34;.sister&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#é€šè¿‡idæŸ¥æ‰¾</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># data=soup.select(&#34;#link2&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ç»„åˆæŸ¥æ‰¾</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># data=soup.select(&#34;p #link1&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#é€šè¿‡å…¶ä»–å±æ€§æŸ¥æ‰¾</span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>soup<span style="color:#f92672">.</span>select(<span style="color:#e6db74">&#39;a[href=&#34;http://example.com/tillie&#34;]&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(data)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="å…­å¤šçº¿ç¨‹" class="pagebody-header">
    å…­ã€å¤šçº¿ç¨‹
  </h2>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> threading
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(name):
</span></span><span style="display:flex;"><span>    print(name,<span style="color:#e6db74">&#34;çº¿ç¨‹æ‰§è¡Œäº†ï¼&#34;</span>)
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åˆ›å»º2ä¸ªçº¿ç¨‹å¯¹è±¡</span>
</span></span><span style="display:flex;"><span>t1<span style="color:#f92672">=</span>threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>run,args<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;t1&#34;</span>,))
</span></span><span style="display:flex;"><span>t2<span style="color:#f92672">=</span>threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>run,args<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;t2&#34;</span>,))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å¯åŠ¨çº¿ç¨‹</span>
</span></span><span style="display:flex;"><span>t1<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>t2<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åå†æ‰§è¡Œä¸»çº¿ç¨‹åé¢çš„å†…å®¹</span>
</span></span><span style="display:flex;"><span>t1<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>t2<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;æ‰§è¡Œå®Œæ¯•&#34;</span>)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨ threading æ¨¡å—åˆ›å»ºçº¿ç¨‹ </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºä¸€ä¸ªæ–°çš„å­ç±»ç»§æ‰¿threading.Thread.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¹¶å®ä¾‹åŒ–åè°ƒç”¨ start() æ–¹æ³•å¯åŠ¨æ–°çº¿ç¨‹ï¼Œå³å®ƒè°ƒç”¨äº†çº¿ç¨‹çš„ run() æ–¹æ³•</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> threading
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#çº¿ç¨‹ç±»</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">myThread</span>(threading<span style="color:#f92672">.</span>Thread):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self,name):
</span></span><span style="display:flex;"><span>        threading<span style="color:#f92672">.</span>Thread<span style="color:#f92672">.</span>__init__(self)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> name
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;å¼€å§‹çº¿ç¨‹&#34;</span>,self<span style="color:#f92672">.</span>name)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;çº¿ç¨‹æ‰§è¡Œä¸­---1&#34;</span>)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;çº¿ç¨‹æ‰§è¡Œä¸­---2&#34;</span>)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;çº¿ç¨‹æ‰§è¡Œä¸­---3&#34;</span>)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;çº¿ç¨‹æ‰§è¡Œä¸­---4&#34;</span>)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;çº¿ç¨‹æ‰§è¡Œä¸­---5&#34;</span>)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;ç»“æŸçº¿ç¨‹&#34;</span>,self<span style="color:#f92672">.</span>name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åˆ›å»ºçº¿ç¨‹</span>
</span></span><span style="display:flex;"><span>t1<span style="color:#f92672">=</span>myThread(<span style="color:#e6db74">&#34;t1&#34;</span>)
</span></span><span style="display:flex;"><span>t2<span style="color:#f92672">=</span>myThread(<span style="color:#e6db74">&#34;t2&#34;</span>)
</span></span><span style="display:flex;"><span>t3<span style="color:#f92672">=</span>myThread(<span style="color:#e6db74">&#34;t3&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å¼€å¯çº¿ç¨‹</span>
</span></span><span style="display:flex;"><span>t1<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>t2<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>t3<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t1<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>t2<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>t3<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;æ‰§è¡Œå®Œæ¯•&#34;</span>)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#é˜Ÿåˆ—Queue</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> queue
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Queueæ˜¯pythonæ ‡å‡†åº“ä¸­çš„çº¿ç¨‹å®‰å…¨çš„å®ç°,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æä¾›äº†ä¸€ä¸ªé€‚ç”¨äºå¤šçº¿ç¨‹ç¼–ç¨‹çš„å…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„ï¼Œ</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å³é˜Ÿåˆ—ï¼Œç”¨æ¥åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹ä¹‹é—´çš„ä¿¡æ¯ä¼ é€’ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å¯¹äºèµ„æºï¼ŒåŠ é”æ˜¯ä¸ªé‡è¦çš„ç¯èŠ‚ã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å› ä¸ºpythonåŸç”Ÿçš„list,dictç­‰ï¼Œéƒ½æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è€ŒQueueï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤åœ¨æ»¡è¶³ä½¿ç”¨æ¡ä»¶ä¸‹ï¼Œå»ºè®®ä½¿ç”¨é˜Ÿåˆ—ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åˆ›å»ºé˜Ÿåˆ—</span>
</span></span><span style="display:flex;"><span>q<span style="color:#f92672">=</span>queue<span style="color:#f92672">.</span>Queue(maxsize<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">11</span>):
</span></span><span style="display:flex;"><span>    q<span style="color:#f92672">.</span>put(i) <span style="color:#75715e">#å¾€é˜Ÿåˆ—é‡Œé¢æ”¾å€¼</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(q.get())</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(q.get())</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(q.get())</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(q.get())</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(q.get())</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(q.get())</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå¾ªç¯å–å‡ºæ‰€æœ‰å€¼</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> q<span style="color:#f92672">.</span>empty():
</span></span><span style="display:flex;"><span>    print(q<span style="color:#f92672">.</span>get())</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#å¤šçº¿ç¨‹çˆ¬å–ç³—äº‹ç™¾ç§‘</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨äº†çº¿ç¨‹åº“</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> threading
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é˜Ÿåˆ—</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> queue
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># https://www.qiushibaike.com/8hr/page/1/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># https://www.qiushibaike.com/8hr/page/2/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># https://www.qiushibaike.com/8hr/page/3/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&#39;//div/a[@class=&#34;recmd-content&#34;]&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#é‡‡é›†ç½‘é¡µçº¿ç¨‹--çˆ¬å–æ®µå­åˆ—è¡¨æ‰€åœ¨çš„ç½‘é¡µï¼Œæ”¾è¿›é˜Ÿåˆ—</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Thread1</span>(threading<span style="color:#f92672">.</span>Thread):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, threadName,pageQueue,dataQueue):
</span></span><span style="display:flex;"><span>        threading<span style="color:#f92672">.</span>Thread<span style="color:#f92672">.</span>__init__(self)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>threadName <span style="color:#f92672">=</span> threadName <span style="color:#75715e">#çº¿ç¨‹å</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>pageQueue <span style="color:#f92672">=</span> pageQueue <span style="color:#75715e">#é¡µç é˜Ÿåˆ—</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>dataQueue <span style="color:#f92672">=</span> dataQueue <span style="color:#75715e">#æ•°æ®é˜Ÿåˆ—</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;User-Agent&#34;</span> : <span style="color:#e6db74">&#34;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0;&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;å¯åŠ¨çº¿ç¨‹&#34;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>threadName)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> flag1:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                page<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>pageQueue<span style="color:#f92672">.</span>get()
</span></span><span style="display:flex;"><span>                url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://www.qiushibaike.com/8hr/page/&#34;</span><span style="color:#f92672">+</span>str(page)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/&#34;</span>
</span></span><span style="display:flex;"><span>                content<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(url,headers<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>headers)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>                time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>dataQueue<span style="color:#f92672">.</span>put(content) <span style="color:#75715e">#å°†æ•°æ®æ”¾å…¥æ•°æ®é˜Ÿåˆ—ä¸­</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;ç»“æŸçº¿ç¨‹&#34;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>threadName)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#è§£æç½‘é¡µçº¿ç¨‹--ä»å¯¹ã€é˜Ÿåˆ—ä¸­æ‹¿åˆ°åˆ—è¡¨ç½‘é¡µï¼Œè¿›è¡Œè§£æï¼Œå¹¶å­˜å‚¨åˆ°æœ¬åœ°</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Thread2</span>(threading<span style="color:#f92672">.</span>Thread):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, threadName,dataQueue,filename):
</span></span><span style="display:flex;"><span>        threading<span style="color:#f92672">.</span>Thread<span style="color:#f92672">.</span>__init__(self)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>threadName <span style="color:#f92672">=</span> threadName
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>dataQueue <span style="color:#f92672">=</span> dataQueue
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>filename <span style="color:#f92672">=</span> filename
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;å¯åŠ¨çº¿ç¨‹&#34;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>threadName)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> flag2:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                data1<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>dataQueue<span style="color:#f92672">.</span>get()
</span></span><span style="display:flex;"><span>                html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(data1)
</span></span><span style="display:flex;"><span>                node_list<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//div/a[@class=&#34;recmd-content&#34;]&#39;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> node <span style="color:#f92672">in</span> node_list:
</span></span><span style="display:flex;"><span>                    data<span style="color:#f92672">=</span>node<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>                    self<span style="color:#f92672">.</span>filename<span style="color:#f92672">.</span>write(data<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;ç»“æŸçº¿ç¨‹&#34;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>threadName)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag1<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span> <span style="color:#75715e">#åˆ¤æ–­é¡µç é˜Ÿåˆ—ä¸­æ˜¯å¦ä¸ºç©º</span>
</span></span><span style="display:flex;"><span>flag2<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span> <span style="color:#75715e">#åˆ¤æ–­æ•°æ®é˜Ÿåˆ—ä¸­æ˜¯å¦ä¸ºç©º</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#é¡µç é˜Ÿåˆ—</span>
</span></span><span style="display:flex;"><span>    pageQueue<span style="color:#f92672">=</span>queue<span style="color:#f92672">.</span>Queue(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">11</span>):
</span></span><span style="display:flex;"><span>        pageQueue<span style="color:#f92672">.</span>put(i)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#å­˜æ”¾é‡‡é›†ç»“æœçš„æ•°æ®é˜Ÿåˆ—</span>
</span></span><span style="display:flex;"><span>    dataQueue<span style="color:#f92672">=</span>queue<span style="color:#f92672">.</span>Queue()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#ä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>    filename<span style="color:#f92672">=</span>open(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\file\dianzi.txt&#34;</span>,<span style="color:#e6db74">&#34;a&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#å¯åŠ¨çº¿ç¨‹</span>
</span></span><span style="display:flex;"><span>    t1<span style="color:#f92672">=</span>Thread1(<span style="color:#e6db74">&#34;é‡‡é›†çº¿ç¨‹&#34;</span>,pageQueue,dataQueue)
</span></span><span style="display:flex;"><span>    t1<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>    t2<span style="color:#f92672">=</span>Thread2(<span style="color:#e6db74">&#34;è§£æçº¿ç¨‹&#34;</span>,dataQueue,filename)
</span></span><span style="display:flex;"><span>    t2<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#å½“pageQueueä¸ºç©ºæ—¶ï¼Œç»“æŸé‡‡é›†çº¿ç¨‹</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> pageQueue<span style="color:#f92672">.</span>empty():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> flag1
</span></span><span style="display:flex;"><span>    flag1<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#å½“dataQueueä¸ºç©ºæ—¶ï¼Œç»“æŸè§£æçº¿ç¨‹</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> dataQueue<span style="color:#f92672">.</span>empty():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> flag2
</span></span><span style="display:flex;"><span>    flag2<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    t1<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>    t2<span style="color:#f92672">.</span>join()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    filename<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;ç»“æŸï¼&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    main()</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="ä¸ƒéªŒè¯ç è¯†åˆ«" class="pagebody-header">
    ä¸ƒã€éªŒè¯ç è¯†åˆ«
  </h2>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#è¯†åˆ«è½¦ç‰Œå·</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> aip <span style="color:#f92672">import</span> AipOcr
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>APP_ID <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;15469265&#39;</span>
</span></span><span style="display:flex;"><span>API_KEY <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;rAGFtOChXtO7mnRPiwXg1Frf&#39;</span>
</span></span><span style="display:flex;"><span>SECRET_KEY <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Ailvoijh4X7lQIAoZ58UsGPlaDCmLIt7&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> AipOcr(APP_ID, API_KEY, SECRET_KEY)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34; è¯»å–å›¾ç‰‡ &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_file_content</span>(filePath):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(filePath, <span style="color:#e6db74">&#39;rb&#39;</span>) <span style="color:#66d9ef">as</span> fp:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> fp<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>image <span style="color:#f92672">=</span> get_file_content(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:\Users\Administrator\Desktop\img\ee.jpg&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34; è°ƒç”¨é€šç”¨æ–‡å­—è¯†åˆ«, å›¾ç‰‡å‚æ•°ä¸ºæœ¬åœ°å›¾ç‰‡ &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>str(client<span style="color:#f92672">.</span>basicGeneral(image))<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39; &#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;{&#39;words&#39;:&#39;(.*?)&#39;}&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>pat<span style="color:#f92672">.</span>findall(data)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#äººå·¥æ™ºèƒ½æ¥å£ç”³è¯·</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> aip <span style="color:#f92672">import</span> AipOcr
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>APP_ID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;15725370&#34;</span>
</span></span><span style="display:flex;"><span>API_KEY<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;t85bppstXXudNNSU0klALWgj&#34;</span>
</span></span><span style="display:flex;"><span>SECRET_KEY<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Zt7z61AXutINgWS1lqWe3xsWp9uePSFF&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">=</span>AipOcr(APP_ID,API_KEY,SECRET_KEY)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;C:\Users\Administrator\Desktop\img\ee.jpg&#34;</span>,<span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    image<span style="color:#f92672">=</span>f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>str(client<span style="color:#f92672">.</span>basicGeneral(image))<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34; &#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;{&#39;words&#39;:&#39;(.*?)&#39;}&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>pat<span style="color:#f92672">.</span>findall(data)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#æ–‡å­—è¯†åˆ«</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> aip <span style="color:#f92672">import</span> AipOcr
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>APP_ID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;15725370&#34;</span>
</span></span><span style="display:flex;"><span>API_KEY<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;t85bppstXXudNNSU0klALWgj&#34;</span>
</span></span><span style="display:flex;"><span>SECRET_KEY<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Zt7z61AXutINgWS1lqWe3xsWp9uePSFF&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">=</span>AipOcr(APP_ID,API_KEY,SECRET_KEY)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;http://127.0.0.1:8020/ç™»é™†éªŒè¯ç /login.html&#34;</span>)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&lt;img src=&#34;(.*?)&#34; style&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://127.0.0.1:8020/ç™»é™†éªŒè¯ç /&#34;</span><span style="color:#f92672">+</span>pat<span style="color:#f92672">.</span>findall(data)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>image<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(url)<span style="color:#f92672">.</span>content
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>str(client<span style="color:#f92672">.</span>basicGeneral(image))<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34; &#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;{&#39;words&#39;:&#39;(.*?)&#39;}&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>pat<span style="color:#f92672">.</span>findall(data)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result)</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#æ¨¡æ‹ŸéªŒè¯ç è¯†åˆ«</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> aip <span style="color:#f92672">import</span> AipOcr
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>APP_ID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;15725370&#34;</span>
</span></span><span style="display:flex;"><span>API_KEY<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;t85bppstXXudNNSU0klALWgj&#34;</span>
</span></span><span style="display:flex;"><span>SECRET_KEY<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Zt7z61AXutINgWS1lqWe3xsWp9uePSFF&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">=</span>AipOcr(APP_ID,API_KEY,SECRET_KEY)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;http://127.0.0.1:8020/ç™»é™†éªŒè¯ç /login.html&#34;</span>)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&lt;img src=&#34;(.*?)&#34; style&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://127.0.0.1:8020/ç™»é™†éªŒè¯ç /&#34;</span><span style="color:#f92672">+</span>pat<span style="color:#f92672">.</span>findall(data)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>image<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(url)<span style="color:#f92672">.</span>content
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">=</span>str(client<span style="color:#f92672">.</span>basicGeneral(image))<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34; &#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;{&#39;words&#39;:&#39;(.*?)&#39;}&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>pat<span style="color:#f92672">.</span>findall(data)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="å…«scrapyæ¡†æ¶" class="pagebody-header">
    å…«ã€scrapyæ¡†æ¶
  </h2>
</div><div class="component-content component"><ol>
<li>åˆ›å»ºé¡¹ç›®</li>
</ol></div>
<blockquote>
<p class="component-content component">scrapy startproject é¡¹ç›®å</p>
</blockquote>
<ol start="2">
<li>åˆ›å»ºçˆ¬è™«</li>
</ol></div>
<blockquote>
<p class="component-content component">scrapy  genspider  çˆ¬è™«è¯†åˆ«åç§°   &lsquo;è¦çˆ¬å–çš„ä¸»æœºåœ°å€&rsquo;</p>
</blockquote>
<ol start="3">
<li>è¿è¡Œçˆ¬è™«</li>
</ol></div>
<blockquote>
<p class="component-content component">scrapy crawl çˆ¬è™«è¯†åˆ«åç§°</p>
</blockquote>

<div class="component-content pagebody component">
  <h3 id="1scrapyæ¡†æ¶çš„å®‰è£…" class="pagebody-header">
    1.Scrapyæ¡†æ¶çš„å®‰è£…
  </h3>
</div><blockquote>
<p class="component-content component">pip3 install scrapy</p>
</blockquote>

<div class="component-content pagebody component">
  <h3 id="2scrapyæ¡†æ¶çš„ç®€å•ä½¿ç”¨" class="pagebody-header">
    2.Scrapyæ¡†æ¶çš„ç®€å•ä½¿ç”¨
  </h3>
</div><div class="component-content component"><ul>
<li>å¸¸ç”¨å‘½ä»¤</li>
</ul></div>
<blockquote>
<p class="component-content component">åˆ›å»ºé¡¹ç›®ï¼šscrapy startproject xxx
è¿›å…¥é¡¹ç›®ï¼šcd xxx #è¿›å…¥æŸä¸ªæ–‡ä»¶å¤¹ä¸‹
åˆ›å»ºçˆ¬è™«ï¼šscrapy genspider xxxï¼ˆçˆ¬è™«åï¼‰ xxx.com ï¼ˆçˆ¬å–åŸŸï¼‰
ç”Ÿæˆæ–‡ä»¶ï¼šscrapy crawl xxx -o xxx.json (ç”ŸæˆæŸç§ç±»å‹çš„æ–‡ä»¶)
è¿è¡Œçˆ¬è™«ï¼šscrapy crawl XXX
åˆ—å‡ºæ‰€æœ‰çˆ¬è™«ï¼šscrapy list
è·å¾—é…ç½®ä¿¡æ¯ï¼šscrapy settings [options]</p>
</blockquote>
<div class="component-content component"><ul>
<li>Scrapyé¡¹ç›®ä¸‹åŒ…å«</li>
</ul></div>
<blockquote>
<p class="component-content component">scrapy.cfg: é¡¹ç›®çš„é…ç½®æ–‡ä»¶
tutorial/: è¯¥é¡¹ç›®çš„pythonæ¨¡å—ã€‚åœ¨æ­¤æ”¾å…¥ä»£ç ï¼ˆæ ¸å¿ƒï¼‰
tutorial/items.py: é¡¹ç›®ä¸­çš„itemæ–‡ä»¶.ï¼ˆè¿™æ˜¯åˆ›å»ºå®¹å™¨çš„åœ°æ–¹ï¼Œçˆ¬å–çš„ä¿¡æ¯åˆ†åˆ«æ”¾åˆ°ä¸åŒå®¹å™¨é‡Œï¼‰
tutorial/pipelines.py: é¡¹ç›®ä¸­çš„pipelinesæ–‡ä»¶.
tutorial/settings.py: é¡¹ç›®çš„è®¾ç½®æ–‡ä»¶.ï¼ˆæˆ‘ç”¨åˆ°çš„è®¾ç½®ä¸€ä¸‹åŸºç¡€å‚æ•°ï¼Œæ¯”å¦‚åŠ ä¸ªæ–‡ä»¶å¤´ï¼Œè®¾ç½®ä¸€ä¸ªç¼–ç ï¼‰
tutorial/spiders/: æ”¾ç½®spiderä»£ç çš„ç›®å½•. ï¼ˆæ”¾çˆ¬è™«çš„åœ°æ–¹ï¼‰</p>
</blockquote>
<div class="component-content component"><ul>
<li>
<p class="component-content component">å®¹å™¨ï¼ˆitemsï¼‰çš„å®šä¹‰ï¼Œå®¹å™¨ä¸ä¸€å®šæ˜¯ä¸€å¼€å§‹å…¨éƒ¨éƒ½å®šä¹‰å¥½çš„ï¼Œå¯ä»¥è·Ÿéšé¡¹ç›®çš„æ›´æ–°ä¸€ç‚¹ç‚¹å‘é‡Œé¢æ·»åŠ </p>
<p class="component-content component">ä¹Ÿå°±æ˜¯å®šä¹‰æˆ‘ä»¬è¦çˆ¬å–çš„å†…å®¹</p>
</li>
</ul></div>
<blockquote>
<p class="component-content component">import scrapy
class DmozItem(scrapy.Item): #åˆ›å»ºä¸€ä¸ªç±»ï¼Œç»§æ‰¿scrapy.itemç±»ï¼Œå°±æ˜¯ç»§æ‰¿äººå®¶å†™å¥½çš„å®¹å™¨
title = scrapy.Field() # éœ€è¦å–å“ªäº›å†…å®¹ï¼Œå°±åˆ›å»ºå“ªäº›å®¹å™¨
link = scrapy.Field()
desc = scrapy.Field()</p>
</blockquote>
<div class="component-content component"><ul>
<li>ä¸€ä¸ªç®€å•çˆ¬è™«å°ä¾‹å­</li>
</ul></div>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> scrapy
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DmozSpider</span>(scrapy<span style="color:#f92672">.</span>Spider): <span style="color:#75715e"># ç»§æ‰¿Spiderç±»</span>
</span></span><span style="display:flex;"><span>    name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dmoz&#34;</span> <span style="color:#75715e"># çˆ¬è™«çš„å”¯ä¸€æ ‡è¯†ï¼Œä¸èƒ½é‡å¤ï¼Œå¯åŠ¨çˆ¬è™«çš„æ—¶å€™è¦ç”¨</span>
</span></span><span style="display:flex;"><span>    allowed_domains <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;dmoz.org&#34;</span>] <span style="color:#75715e"># é™å®šåŸŸåï¼Œåªçˆ¬å–è¯¥åŸŸåä¸‹çš„ç½‘é¡µ</span>
</span></span><span style="display:flex;"><span>    start_urls <span style="color:#f92672">=</span> [ <span style="color:#75715e"># å¼€å§‹çˆ¬å–çš„é“¾æ¥</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://www.baidu.com/&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse</span>(self, response):
</span></span><span style="display:flex;"><span>        filename <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>url<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>] <span style="color:#75715e"># è·å–urlï¼Œç”¨â€/â€åˆ†æ®µï¼Œè·å»å€’æ•°ç¬¬äºŒä¸ªå­—æ®µ</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> open(filename, <span style="color:#e6db74">&#39;a&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>            f<span style="color:#f92672">.</span>write(response<span style="color:#f92672">.</span>body) <span style="color:#75715e"># æŠŠè®¿é—®çš„å¾—åˆ°çš„ç½‘é¡µæºç å†™å…¥æ–‡ä»¶</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">é‡Œé¢çš„parseæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æœ‰ä¸¤ä¸ªä½œç”¨
1.è´Ÿè´£è§£æstart_urlä¸‹è½½çš„Response å¯¹è±¡ï¼Œæ ¹æ®itemæå–æ•°æ®ï¼ˆè§£æitemæ•°æ®çš„å‰ææ˜¯parseé‡Œå…¨éƒ¨requestsè¯·æ±‚éƒ½è¢«åŠ å…¥äº†çˆ¬å–é˜Ÿåˆ—ï¼‰
2.å¦‚æœæœ‰æ–°çš„urlåˆ™åŠ å…¥çˆ¬å–é˜Ÿåˆ—ï¼Œè´Ÿè´£è¿›ä¸€æ­¥å¤„ç†ï¼ŒURLçš„Request å¯¹è±¡
è¿™ä¸¤ç‚¹ç®€å•æ¥è¯´å°±æ˜¯ç¼–å†™çˆ¬è™«çš„ä¸»è¦éƒ¨åˆ†</p>
<p class="component-content component">é‚£ä¹ˆçˆ¬è™«ç¼–å†™å®Œï¼Œæˆ‘ä»¬éœ€è¦å¯åŠ¨çˆ¬è™«</p>
<blockquote>
<p class="component-content component">cd XXX</p>
</blockquote>
<p class="component-content component">è¿›å…¥åˆ°ä½ çš„æ–‡ä»¶å¤¹ä¸‹
è¾“å…¥å‘½ä»¤,å¯åŠ¨çˆ¬è™«</p>
<blockquote>
<p class="component-content component">scrapy crawl dmoz</p>
</blockquote>
<p class="component-content component">é‚£ä¹ˆå¯åŠ¨çˆ¬è™«æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ
Scrapyä¸ºSpiderçš„ start_urls å±æ€§ä¸­çš„æ¯ä¸ªurlåˆ›å»ºäº†Request å¯¹è±¡ï¼Œå¹¶å°† parse æ–¹æ³•ä½œä¸ºå›è°ƒå‡½æ•°(callback)èµ‹å€¼ç»™äº†requests,è€Œrequestså¯¹è±¡ç»è¿‡è°ƒåº¦å™¨çš„è°ƒåº¦ï¼Œæ‰§è¡Œç”Ÿæˆresponseå¯¹è±¡å¹¶é€å›ç»™parse() æ–¹æ³•è¿›è¡Œè§£æ,æ‰€ä»¥è¯·æ±‚é“¾æ¥çš„æ”¹å˜æ˜¯é å›è°ƒå‡½æ•°å®ç°çš„ã€‚</p>
<blockquote>
<p class="component-content component">yield scrapy.Request(self.url, callback=self.parse)</p>
</blockquote>

<div class="component-content pagebody component">
  <h3 id="3scrapyæ¡†æ¶çš„æ•´ä½“æ¶æ„å’Œç»„æˆ" class="pagebody-header">
    3.Scrapyæ¡†æ¶çš„æ•´ä½“æ¶æ„å’Œç»„æˆ
  </h3>
</div><div class="component-content component"><ul>
<li>å®˜æ–¹çš„Scrapyçš„æ¶æ„å›¾</li>
</ul></div>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-8e4a2a3eb1eae98845d8e5a2e32081ef" id="lht8e4a2a3eb1eae98845d8e5a2e32081ef">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_spider/1.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<blockquote>
<p class="component-content component">å›¾ä¸­ç»¿è‰²çš„æ˜¯æ•°æ®çš„æµå‘
æˆ‘ä»¬çœ‹åˆ°å›¾é‡Œæœ‰è¿™ä¹ˆå‡ ä¸ªä¸œè¥¿ï¼Œåˆ†åˆ«æ˜¯
Spidersï¼šçˆ¬è™«ï¼Œå®šä¹‰äº†çˆ¬å–çš„é€»è¾‘å’Œç½‘é¡µå†…å®¹çš„è§£æè§„åˆ™ï¼Œä¸»è¦è´Ÿè´£è§£æå“åº”å¹¶ç”Ÿæˆç»“æœå’Œæ–°çš„è¯·æ±‚
Engineï¼šå¼•æ“ï¼Œå¤„ç†æ•´ä¸ªç³»ç»Ÿçš„æ•°æ®æµå¤„ç†ï¼Œå‡ºå‘äº‹ç‰©ï¼Œæ¡†æ¶çš„æ ¸å¿ƒã€‚
Schedulerï¼šè°ƒåº¦å™¨ï¼Œæ¥å—å¼•æ“å‘è¿‡æ¥çš„è¯·æ±‚ï¼Œå¹¶å°†å…¶åŠ å…¥é˜Ÿåˆ—ä¸­ï¼Œåœ¨å¼•æ“å†æ¬¡è¯·æ±‚æ—¶å°†è¯·æ±‚æä¾›ç»™å¼•æ“
Downloaderï¼šä¸‹è½½å™¨ï¼Œä¸‹è½½ç½‘é¡µå†…å®¹ï¼Œå¹¶å°†ä¸‹è½½å†…å®¹è¿”å›ç»™spider
ItemPipelineï¼šé¡¹ç›®ç®¡é“ï¼Œè´Ÿè´£å¤„ç†spiderä»ç½‘é¡µä¸­æŠ½å–çš„æ•°æ®ï¼Œä¸»è¦æ˜¯è´Ÿè´£æ¸…æ´—ï¼ŒéªŒè¯å’Œå‘æ•°æ®åº“ä¸­å­˜å‚¨æ•°æ®
Downloader Middlewaresï¼šä¸‹è½½ä¸­é—´ä»¶ï¼Œæ˜¯å¤„äºScrapyçš„Requestå’ŒRequesponseä¹‹é—´çš„å¤„ç†æ¨¡å—
Spider Middlewaresï¼šspiderä¸­é—´ä»¶ï¼Œä½äºå¼•æ“å’Œspiderä¹‹é—´çš„æ¡†æ¶ï¼Œä¸»è¦å¤„ç†spiderè¾“å…¥çš„å“åº”å’Œè¾“å‡ºçš„ç»“æœåŠæ–°çš„è¯·æ±‚middlewares.pyé‡Œå®ç°</p>
</blockquote>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-72634626a3804b8db499b979ca104d8e" id="lht72634626a3804b8db499b979ca104d8e">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_spider/2.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<div class="component-content component"><ul>
<li>æœ€åæˆ‘ä»¬æ¥é¡ºä¸€ä¸‹scrapyæ¡†æ¶çš„æ•´ä½“æ‰§è¡Œæµç¨‹ï¼š</li>
</ul></div>
<blockquote>
<p class="component-content component">1.spiderçš„yeildå°†requestå‘é€ç»™engine
2.engineå¯¹requestä¸åšä»»ä½•å¤„ç†å‘é€ç»™scheduler
3.schedulerï¼Œç”Ÿæˆrequestäº¤ç»™engine
4.engineæ‹¿åˆ°requestï¼Œé€šè¿‡middlewareå‘é€ç»™downloader
5.downloaderåœ¨\è·å–åˆ°responseä¹‹åï¼Œåˆç»è¿‡middlewareå‘é€ç»™engine
6.engineè·å–åˆ°responseä¹‹åï¼Œè¿”å›ç»™spiderï¼Œspiderçš„parse()æ–¹æ³•å¯¹è·å–åˆ°çš„responseè¿›è¡Œå¤„ç†ï¼Œè§£æå‡ºitemsæˆ–è€…requests
7.å°†è§£æå‡ºæ¥çš„itemsæˆ–è€…requestså‘é€ç»™engine
8.engineè·å–åˆ°itemsæˆ–è€…requestsï¼Œå°†itemså‘é€ç»™ItemPipelineï¼Œå°†requestså‘é€ç»™schedulerï¼ˆpsï¼Œåªæœ‰è°ƒåº¦å™¨ä¸­ä¸å­˜åœ¨requestæ—¶ï¼Œç¨‹åºæ‰åœæ­¢ï¼ŒåŠæ—¶è¯·æ±‚å¤±è´¥scrapyä¹Ÿä¼šé‡æ–°è¿›è¡Œè¯·æ±‚ï¼‰</p>
</blockquote>

<div class="component-content pagebody component">
  <h3 id="4ä¸­é—´ä»¶ä»‹ç»" class="pagebody-header">
    4.ä¸­é—´ä»¶ä»‹ç»
  </h3>
</div><p class="component-content component">è¯·æŸ¥çœ‹xmindæ€ç»´å¯¼å›¾ï¼šScrapy.xmind</p>

<div class="component-content pagebody component">
  <h3 id="5é™„ä»¶" class="pagebody-header">
    5.é™„ä»¶
  </h3>
</div><p class="component-content component">é˜³å…‰é—®æ”¿å¹³å°çˆ¬è™«ï¼ˆScrapyå®ç°ï¼š2020.7.21ï¼‰ sunSpideræ–‡ä»¶å¤¹</p>

<div class="component-content pagebody component">
  <h2 id="ä¹fiddleræ‰‹æœºæŠ“åŒ…" class="pagebody-header">
    ä¹ã€fiddleræ‰‹æœºæŠ“åŒ…
  </h2>
</div><div class="component-content component"><ul>
<li>fiddlerå®˜ç½‘ï¼šhttps://www.telerik.com/fiddler</li>
</ul></div>
<p class="component-content component">é€šè¿‡FiddleræŠ“åŒ…å·¥å…·ï¼Œå¯ä»¥æŠ“å–æ‰‹æœºçš„ç½‘ç»œé€šä¿¡ï¼Œä½†å‰ææ˜¯æ‰‹æœºå’Œç”µè„‘å¤„äºåŒä¸€å±€åŸŸç½‘å†…ï¼ˆWI-FIæˆ–çƒ­ç‚¹ï¼‰ï¼Œç„¶åè¿›è¡Œä»¥ä¸‹è®¾ç½®ï¼š</p>
<div class="component-content component"><ul>
<li>

<div class="component-content pagebody component">
  <h3 id="ç”¨fiddlerå¯¹androidåº”ç”¨è¿›è¡ŒæŠ“åŒ…" class="pagebody-header">
    ç”¨Fiddlerå¯¹Androidåº”ç”¨è¿›è¡ŒæŠ“åŒ…
  </h3>
</div></li>
</ul></div>
<div class="component-content component"><ol>
<li>æ‰“å¼€Fiddlerè®¾ç½®</li>
</ol></div>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-ca02c23e2dbc95d384b9989378c9ec88" id="lhtca02c23e2dbc95d384b9989378c9ec88">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_spider/fiddler1.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">åœ¨<code>Connections</code>é‡Œè®¾ç½®å…è®¸è¿æ¥è¿œç¨‹è®¡ç®—æœºï¼Œç¡®è®¤åé‡æ–°å¯åŠ¨Fiddler</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-a02f5d178790dce38c1138e8ed8eef9b" id="lhta02f5d178790dce38c1138e8ed8eef9b">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_spider/fiddler2.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<ol start="2">
<li>åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹è¾“å…¥<code>ipconfig</code>æŸ¥çœ‹æœ¬æœºIP</li>
</ol></div>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-2d77f345e8d360e41db3b0724be8f6c9" id="lht2d77f345e8d360e41db3b0724be8f6c9">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_spider/fiddler3.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<ol start="3">
<li>æ‰“å¼€Androidè®¾å¤‡çš„â€œè®¾ç½®â€-&gt;â€œWLANâ€ï¼Œæ‰¾åˆ°ä½ è¦è¿æ¥çš„ç½‘ç»œï¼Œåœ¨ä¸Šé¢é•¿æŒ‰ï¼Œç„¶åé€‰æ‹©â€œä¿®æ”¹ç½‘ç»œâ€ï¼Œå¼¹å‡ºç½‘ç»œè®¾ç½®å¯¹è¯æ¡†ï¼Œç„¶åå‹¾é€‰â€œæ˜¾ç¤ºé«˜çº§é€‰é¡¹â€ã€‚</li>
</ol></div>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-ddbdc1c02179f32d3d361071b7ead722" id="lhtddbdc1c02179f32d3d361071b7ead722">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_spider/fiddler4.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<ol start="4">
<li>åœ¨â€œä»£ç†â€åé¢çš„è¾“å…¥æ¡†é€‰æ‹©â€œæ‰‹åŠ¨â€ï¼Œåœ¨â€œä»£ç†æœåŠ¡å™¨ä¸»æœºåâ€åé¢çš„è¾“å…¥æ¡†è¾“å…¥ç”µè„‘çš„ipåœ°å€ï¼Œåœ¨â€œä»£ç†æœåŠ¡å™¨ç«¯å£â€åé¢çš„è¾“å…¥æ¡†è¾“å…¥8888ï¼Œç„¶åç‚¹å‡»â€œä¿å­˜â€æŒ‰é’®ã€‚</li>
</ol></div>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-a0f8eeb3f691125748a67073e9542708" id="lhta0f8eeb3f691125748a67073e9542708">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_spider/fiddler5.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<ol start="5">
<li>å¯åŠ¨Androidè®¾å¤‡ä¸­çš„æµè§ˆå™¨ï¼Œè®¿é—®ç½‘é¡µå³å¯åœ¨Fiddlerä¸­å¯ä»¥çœ‹åˆ°å®Œæˆçš„è¯·æ±‚å’Œå“åº”æ•°æ®ã€‚</li>
</ol></div>
<div class="component-content component"><ul>
<li>

<div class="component-content pagebody component">
  <h3 id="ç”¨fiddlerå¯¹iphoneæ‰‹æœºåº”ç”¨è¿›è¡ŒæŠ“åŒ…" class="pagebody-header">
    ç”¨Fiddlerå¯¹iPhoneæ‰‹æœºåº”ç”¨è¿›è¡ŒæŠ“åŒ…
  </h3>
</div></li>
</ul></div>
<p class="component-content component">åŸºæœ¬æµç¨‹å·®ä¸å¤šï¼Œåªæ˜¯æ‰‹æœºè®¾ç½®ä¸å¤ªä¸€æ ·ï¼š</p>
<p class="component-content component">iPhoneæ‰‹æœºï¼šç‚¹å‡»è®¾ç½® &gt; æ— çº¿å±€åŸŸç½‘ &gt; æ— çº¿ç½‘ç»œ &gt; HTTPä»£ç† &gt; æ‰‹åŠ¨ï¼š</p>
<p class="component-content component">ä»£ç†åœ°å€(ç”µè„‘IP)ï¼š192.168.xx.xxx</p>
<p class="component-content component">ç«¯å£å·ï¼š8888</p>

<div class="component-content pagebody component">
  <h2 id="åæ•°æ®å†™å…¥" class="pagebody-header">
    åã€æ•°æ®å†™å…¥
  </h2>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#å†™å…¥åˆ°Excel</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> xlsxwriter
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åˆ›å»ºæ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªå·¥ä½œè¡¨</span>
</span></span><span style="display:flex;"><span>workbook<span style="color:#f92672">=</span>xlsxwriter<span style="color:#f92672">.</span>Workbook(<span style="color:#e6db74">&#39;demo.xlsx&#39;</span>)
</span></span><span style="display:flex;"><span>worksheet<span style="color:#f92672">=</span>workbook<span style="color:#f92672">.</span>add_worksheet()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åœ¨æŒ‡å®šä½ç½®å†™å…¥æ•°æ®</span>
</span></span><span style="display:flex;"><span>worksheet<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;A1&#34;</span>,<span style="color:#e6db74">&#34;è¿™æ˜¯A1çš„æ•°æ®&#34;</span>)
</span></span><span style="display:flex;"><span>worksheet<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;A2&#34;</span>,<span style="color:#e6db74">&#34;è¿™æ˜¯A2çš„æ•°æ®&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å…³é—­è¡¨æ ¼æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>workbook<span style="color:#f92672">.</span>close()</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#çˆ¬å–ä¾¿æ°‘æŸ¥è¯¢ç½‘å¸¸ç”¨å·ç ï¼Œå¹¶å†™å…¥åˆ°Excel</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> xlsxwriter
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) Ap</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">pleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Sa</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">fari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://changyongdianhuahaoma.51240.com/&#34;</span>,headers<span style="color:#f92672">=</span>headers)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&lt;tr bgcolor=&#34;#EFF7F0&#34;&gt;[\s\S]*?&lt;td&gt;(.*?)&lt;/td&gt;[\s\S]*?&lt;td&gt;[\s\S]*?&lt;/td&gt;[\s\S]*?&lt;/tr&gt;&#39;</span>
</span></span><span style="display:flex;"><span>pat2<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&lt;tr bgcolor=&#34;#EFF7F0&#34;&gt;[\s\S]*?&lt;td&gt;[\s\S]*?&lt;/td&gt;[\s\S]*?&lt;td&gt;(.*?)&lt;/td&gt;[\s\S]*?&lt;/tr&gt;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pattern1<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(pat1)
</span></span><span style="display:flex;"><span>pattern2<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(pat2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data1<span style="color:#f92672">=</span>pattern1<span style="color:#f92672">.</span>findall(response)
</span></span><span style="display:flex;"><span>data2<span style="color:#f92672">=</span>pattern2<span style="color:#f92672">.</span>findall(response)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resultlist<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åˆ›å»ºè¡¨æ ¼</span>
</span></span><span style="display:flex;"><span>workbook<span style="color:#f92672">=</span>xlsxwriter<span style="color:#f92672">.</span>Workbook(<span style="color:#e6db74">&#34;demo2.xlsx&#34;</span>)
</span></span><span style="display:flex;"><span>worksheet<span style="color:#f92672">=</span>workbook<span style="color:#f92672">.</span>add_worksheet()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(data1)):
</span></span><span style="display:flex;"><span>	resultlist<span style="color:#f92672">.</span>append(data1[i]<span style="color:#f92672">+</span>data2[i])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#å†™å…¥æ•°æ®</span>
</span></span><span style="display:flex;"><span>	worksheet<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;A&#34;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>),data1[i])
</span></span><span style="display:flex;"><span>	worksheet<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;B&#34;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>),data2[i])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(resultlist)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å…³é—­è¡¨æ ¼èµ„æºï¼Œè¿™æ ·æ‰ä¼šå®Œæˆåˆ›å»º</span>
</span></span><span style="display:flex;"><span>workbook<span style="color:#f92672">.</span>close()</span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#çˆ¬å–ä¾¿æ°‘æŸ¥è¯¢ç½‘å¸¸ç”¨å·ç ï¼Œå¹¶å†™å…¥åˆ°Mysql </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ³¨æ„ï¼šéœ€è¦æå‰åˆ›å»ºå¯¹åº”å­—æ®µçš„æ•°æ®åº“</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pymysql
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å»ºç«‹æ•°æ®åº“è¿æ¥</span>
</span></span><span style="display:flex;"><span>db<span style="color:#f92672">=</span>pymysql<span style="color:#f92672">.</span>Connect(host<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;localhost&#34;</span>,port<span style="color:#f92672">=</span><span style="color:#ae81ff">3306</span>,user<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;root&#34;</span>,passwd<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;AA123456&#34;</span>,db<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;spider_test&#34;</span>,charset<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf8&#34;</span>)
</span></span><span style="display:flex;"><span>cursor<span style="color:#f92672">=</span>db<span style="color:#f92672">.</span>cursor()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#çˆ¬å–æ•°æ®</span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) Ap</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">pleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Sa</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">fari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://changyongdianhuahaoma.51240.com/&#34;</span>,headers<span style="color:#f92672">=</span>headers)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#å¤„ç†æ•°æ®</span>
</span></span><span style="display:flex;"><span>pat1<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&lt;tr bgcolor=&#34;#EFF7F0&#34;&gt;[\s\S]*?&lt;td&gt;(.*?)&lt;/td&gt;[\s\S]*?&lt;td&gt;[\s\S]*?&lt;/td&gt;[\s\S]*?&lt;/tr&gt;&#39;</span>
</span></span><span style="display:flex;"><span>pat2<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&lt;tr bgcolor=&#34;#EFF7F0&#34;&gt;[\s\S]*?&lt;td&gt;[\s\S]*?&lt;/td&gt;[\s\S]*?&lt;td&gt;(.*?)&lt;/td&gt;[\s\S]*?&lt;/tr&gt;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pattern1<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(pat1)
</span></span><span style="display:flex;"><span>pattern2<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(pat2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data1<span style="color:#f92672">=</span>pattern1<span style="color:#f92672">.</span>findall(response)
</span></span><span style="display:flex;"><span>data2<span style="color:#f92672">=</span>pattern2<span style="color:#f92672">.</span>findall(response)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ¸…ç©ºæ•°æ®åº“åŸæ¥çš„å†…å®¹</span>
</span></span><span style="display:flex;"><span>sqll<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;delete from tel&#34;</span>
</span></span><span style="display:flex;"><span>cursor<span style="color:#f92672">.</span>execute(sqll)
</span></span><span style="display:flex;"><span>db<span style="color:#f92672">.</span>commit()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resultlist<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(data1)):
</span></span><span style="display:flex;"><span>	resultlist<span style="color:#f92672">.</span>append(data1[i]<span style="color:#f92672">+</span>data2[i])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	sql<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;insert into tel(name,phone) values(&#39;&#34;</span><span style="color:#f92672">+</span>data1[i]<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#39;,&#39;&#34;</span><span style="color:#f92672">+</span>data2[i]<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#39;)&#34;</span>
</span></span><span style="display:flex;"><span>	cursor<span style="color:#f92672">.</span>execute(sql)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(resultlist)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>db<span style="color:#f92672">.</span>commit()
</span></span><span style="display:flex;"><span>db<span style="color:#f92672">.</span>close()</span></span></code></pre></div></div>
  
</div><p class="component-content component">å®Œç»“æ’’èŠ±~</p>
<p class="component-content component">2020.7.22 ä¸‹åˆ5ï¼š11</p>

          </div><div class="component">
            <div class="component-content">
              <div class="article-copyright">
                <p class="content">
                  ç‰ˆæƒå£°æ˜: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">ç‰ˆæƒå£°æ˜ï¼šç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™… (CC BY-NC-SA 4.0)</a>
                </p>
                <p class="content">ä½œè€…:  yuanshuai </p>
                <p class="content">å‘è¡¨æ—¥æœŸ:  2021å¹´11æœˆ26æ—¥</p>
              </div>
            </div>
          </div></article>
      </section>
  </main>

  <script>
    var script = document.createElement("script");script.src = "https://yuanshuai1122.github.io/js/initPost.js";
    document.head.appendChild(script);
  </script>

    
    <div class="footer-main ">
  <div class="content-body footer-wraper">
    <div class="footer-box">
      <div class="foot-nav">
        <div class="foot-nav-items">
          <div class="item">
            <div class="logo"></div>
            <div class="email">Email: <a href="mailto:shuaiyuan@gmail.com">shuaiyuan@gmail.com</a></div>
          </div>

          <div class="item community">
            <div class="item-title">ç¤¾äº¤åª’ä½“</div>
            
              <a href="https://github.com/yuanshuai1122" target="_blank">Github</a>
            
          </div>

          <div class="item resources">
            <div class="item-title">å‹é“¾</div>
            
              <a href="https://yuanshuaicn.com/" target="_blank">ğŸ‘‹</a>
            
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="item copyright">
          &copy; 2023
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://github.com/floyd-li/hugo-theme-itheme" target="_blank">iTheme</a>
        </div>
      </div>
    </div>
  </div>
</div>

  </body>
    
    

    
    
</html>
