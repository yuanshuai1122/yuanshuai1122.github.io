<!DOCTYPE html>
<html class="js no-touch  progressive-image  no-reduced-motion progressive" lang="zh-hans">
  <head>
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/img/favicon.ico">

    <meta name="keyword" content=""><meta property="og:title" content="MySQL基础之查询（二）" />
<meta property="og:description" content="&mdash;&mdash;- | &mdash;&mdash;&mdash;&mdash;&mdash;&mdash; | &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash; | | 分组前筛选 | 原始表 | group by前 where | | 分组后筛选 | group by后的结果集 | group by后 having | 问题1：分组函数做筛选能不能放在where后面 答：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuanshuai1122.github.io/posts/mysql%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%9F%A5%E8%AF%A2%E4%BA%8C-mysql%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%9F%A5%E8%AF%A2%E4%BA%8C/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-24T08:53:34+00:00" />
<meta property="article:modified_time" content="2021-11-24T08:53:34+00:00" />
<title>MySQL基础之查询（二）</title>

    <link rel="canonical" href="/posts/mysql%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%9F%A5%E8%AF%A2%E4%BA%8C-mysql%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%9F%A5%E8%AF%A2%E4%BA%8C/">

    <link rel="stylesheet" href="/css/global.css">

    <link rel="stylesheet" href="/css/custom.css">

    <link rel="stylesheet" href="/css/search.css" />

    
    

    
    

</head>
  </head>
  <body class=" page-article   ">
    <header>
      <nav class="nav">
  <div class="nav-wrapper">
    <div class="nav-content-wrapper">
      <div class="nav-content">
        <a href="/ " class="nav-title">🧀</a>
        <div class="nav-menu">
          <div class="nav-item-wrapper">
            <a href="/posts " class="nav-item-content">目录</a>
          </div><div class="nav-item-wrapper">
            <a href="/about" class="nav-item-content">关于</a>
          </div><div class="nav-item-wrapper">
            <a href="/index.xml" class="nav-item-content" target="_blank">RSS</a>
          </div></div>
      </div>
    </div>
  </div>
</nav>

<script>
  function toggleSearchModal(){
    const template = `
    <div class="modal-body">
      <div id="autocomplete" onclick="event.stopPropagation();"></div>
    </div>
    `
    const modal = document.querySelector("#modal-wrapper")
    if(!modal){
      const div = document.createElement("div")
      document.body.setAttribute("style","overflow: hidden;")
      div.setAttribute("id", "modal-wrapper")
      div.setAttribute("onclick", "toggleSearchModal()")
      div.innerHTML = template
      const script = document.createElement("script");script.setAttribute("src", "https://yuanshuai1122.github.io/js/algolia.js")
      div.appendChild(script)
      document.body.append(div)
    } else {
      document.body.removeAttribute("style")
      document.body.removeChild(modal)
    }
  }
</script>
    </header>
    
  
  
  <main id="main" class="main">
      <section>
        <article class="article">
          
          <div class=" article-header ">
            <div class="category component">
              <div class="component-content">
                <div class="category-eyebrow">
                  <span class="category-eyebrow__category category_original">
                    
                      
                        mysql
                      
                    
                  </span>
                  <span class="category-eyebrow__date">2021年11月24日</span>
                </div>
              </div>
            </div>
            <div class="pagetitle component">
              <div class="component-content">
                <h1 class="hero-headline">MySQL基础之查询（二）</h1>
              </div>
            </div>
            <div class="component  article-subhead ">
              <div class="component-content"></div>
            </div>

            <div class="tagssheet component">
              <div class="component-content">
                
                  
                  <a href="/tags/mysql" class="tag">
                    mysql
                  </a>
                
                  
                  <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93" class="tag">
                    数据库
                  </a>
                
              </div>
            </div>
          </div>
          
          <div class="pagebody">
            
            
            
            
            
            
            
            
            <p class="component-content component">&mdash;&mdash;- | &mdash;&mdash;&mdash;&mdash;&mdash;&mdash; | &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash; |
| 分组前筛选 | 原始表             | group by前	where  |
| 分组后筛选 | group by后的结果集 | group by后	having |</p>
<p class="component-content component">问题1：分组函数做筛选能不能放在where后面
答：不能</p>
<p class="component-content component">问题2：where——group by——having</p>
<p class="component-content component">一般来讲，能用分组前筛选的，尽量使用分组前筛选，提高效率</p>
<p class="component-content component">3、分组可以按单个字段也可以按多个字段
4、可以搭配着排序使用</p>
<p class="component-content component">引入：查询每个部门的员工个数</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>) <span style="color:#66d9ef">FROM</span> employees <span style="color:#66d9ef">WHERE</span> department_id<span style="color:#f92672">=</span><span style="color:#ae81ff">90</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="1简单的分组" class="pagebody-header">
    1.简单的分组
  </h3>
</div><p class="component-content component">案例1：查询每个工种的员工平均工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),job_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> job_id;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：查询每个位置的部门个数</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>),location_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> location_id;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2可以实现分组前的筛选" class="pagebody-header">
    2、可以实现分组前的筛选
  </h3>
</div><p class="component-content component">案例1：查询邮箱中包含a字符的 每个部门的最高工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MAX</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> email <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%a%&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：查询有奖金的每个领导手下员工的平均工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),manager_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> commission_pct <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> manager_id;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3分组后筛选" class="pagebody-header">
    3、分组后筛选
  </h3>
</div><p class="component-content component">案例：查询哪个部门的员工个数&gt;5</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#①查询每个部门的员工个数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#② 筛选刚才①结果
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：每个工种有奖金的员工的最高工资&gt;12000的工种编号和最高工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> job_id,<span style="color:#a6e22e">MAX</span>(salary)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> commission_pct <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> job_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">MAX</span>(salary)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">12000</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例3：领导编号&gt;102的每个领导手下的最低工资大于5000的领导编号和最低工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>manager_id<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">102</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> manager_id,<span style="color:#a6e22e">MIN</span>(salary)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> manager_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">MIN</span>(salary)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5000</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="4添加排序" class="pagebody-header">
    4.添加排序
  </h3>
</div><p class="component-content component">案例：每个工种有奖金的员工的最高工资&gt;6000的工种编号和最高工资,按最高工资升序</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> job_id,<span style="color:#a6e22e">MAX</span>(salary) m
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> commission_pct <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> job_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> m<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">6000</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> m ;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="5按多个字段分组" class="pagebody-header">
    5.按多个字段分组
  </h3>
</div><p class="component-content component">案例：查询每个工种每个部门的最低工资,并按最低工资降序</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(salary),job_id,department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id,job_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">MIN</span>(salary) <span style="color:#66d9ef">DESC</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="二连接查询" class="pagebody-header">
    二、连接查询
  </h1>
</div><p class="component-content component">含义：又称多表查询，当查询的字段来自于多个表时，就会用到连接查询</p>
<p class="component-content component">笛卡尔乘积现象：表1 有m行，表2有n行，结果=m*n行</p>
<p class="component-content component">发生原因：没有有效的连接条件
如何避免：添加有效的连接条件</p>
<p class="component-content component">分类：</p>
<blockquote>
<p class="component-content component">按年代分类：
sql92标准:仅仅支持内连接
sql99标准【推荐】：支持内连接+外连接（左外和右外）+交叉连接</p>
<p class="component-content component">按功能分类：
内连接：
等值连接
非等值连接
自连接
外连接：
左外连接
右外连接
全外连接
交叉连接</p>
</blockquote>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> beauty;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> boys;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#等价为
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> NAME,boyName <span style="color:#66d9ef">FROM</span> boys,beauty
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> beauty.boyfriend_id<span style="color:#f92672">=</span> boys.id;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="一sql92语法" class="pagebody-header">
    一、sql92语法
  </h2>
</div>
<div class="component-content pagebody component">
  <h3 id="1等值连接" class="pagebody-header">
    1、等值连接
  </h3>
</div><p class="component-content component">① 多表等值连接的结果为多表的交集部分
②n表连接，至少需要n-1个连接条件
③ 多表的顺序没有要求
④一般需要为表起别名
⑤可以搭配前面介绍的所有子句使用，比如排序、分组、筛选</p>
<p class="component-content component">案例1：查询女神名和对应的男神名</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> NAME,boyName 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> boys,beauty
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> beauty.boyfriend_id<span style="color:#f92672">=</span> boys.id;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：查询员工名和对应的部门名</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,department_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees,departments
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> employees.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`=</span>departments.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2为表起别名" class="pagebody-header">
    2、为表起别名
  </h3>
</div><p class="component-content component">①提高语句的简洁度
②区分多个重名的字段</p>
<p class="component-content component">注意：如果为表起了别名，则查询的字段就不能使用原来的表名去限定</p>
<p class="component-content component">案例：查询员工名、工种号、工种名</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> e.last_name,e.job_id,j.job_title
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees  e,jobs j
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.<span style="color:#f92672">`</span>job_id<span style="color:#f92672">`=</span>j.<span style="color:#f92672">`</span>job_id<span style="color:#f92672">`</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3两个表的顺序是否可以调换" class="pagebody-header">
    3、两个表的顺序是否可以调换
  </h3>
</div><p class="component-content component">查询员工名、工种号、工种名</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> e.last_name,e.job_id,j.job_title
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> jobs j,employees e
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.<span style="color:#f92672">`</span>job_id<span style="color:#f92672">`=</span>j.<span style="color:#f92672">`</span>job_id<span style="color:#f92672">`</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="4可以加筛选" class="pagebody-header">
    4、可以加筛选
  </h3>
</div><p class="component-content component">案例：查询有奖金的员工名、部门名</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,department_name,commission_pct
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e,departments d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`=</span>d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">AND</span> e.<span style="color:#f92672">`</span>commission_pct<span style="color:#f92672">`</span> <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：查询城市名中第二个字符为o的部门名和城市名</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> department_name,city
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments d,locations l
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> d.<span style="color:#f92672">`</span>location_id<span style="color:#f92672">`</span> <span style="color:#f92672">=</span> l.<span style="color:#f92672">`</span>location_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">AND</span> city <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;_o%&#39;</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="5可以加分组" class="pagebody-header">
    5、可以加分组
  </h3>
</div><p class="component-content component">案例1：查询每个城市的部门个数</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>) <span style="color:#960050;background-color:#1e0010">个数</span>,city
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments d,locations l
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> d.<span style="color:#f92672">`</span>location_id<span style="color:#f92672">`=</span>l.<span style="color:#f92672">`</span>location_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> city;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：查询有奖金的每个部门的部门名和部门的领导编号和该部门的最低工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> department_name,d.<span style="color:#f92672">`</span>manager_id<span style="color:#f92672">`</span>,<span style="color:#a6e22e">MIN</span>(salary)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments d,employees e
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`=</span>e.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">AND</span> commission_pct <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_name,d.<span style="color:#f92672">`</span>manager_id<span style="color:#f92672">`</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="6可以加排序" class="pagebody-header">
    6、可以加排序
  </h3>
</div><p class="component-content component">案例：查询每个工种的工种名和员工的个数，并且按员工个数降序</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> job_title,<span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e,jobs j
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.<span style="color:#f92672">`</span>job_id<span style="color:#f92672">`=</span>j.<span style="color:#f92672">`</span>job_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> job_title
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>) <span style="color:#66d9ef">DESC</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="7可以实现三表连接" class="pagebody-header">
    7、可以实现三表连接？
  </h3>
</div><p class="component-content component">案例：查询员工名、部门名和所在的城市</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,department_name,city
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e,departments d,locations l
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`=</span>d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">AND</span> d.<span style="color:#f92672">`</span>location_id<span style="color:#f92672">`=</span>l.<span style="color:#f92672">`</span>location_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">AND</span> city <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;s%&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> department_name <span style="color:#66d9ef">DESC</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="71非等值连接" class="pagebody-header">
    7.1、非等值连接
  </h4>
</div><p class="component-content component">案例1：查询员工的工资和工资级别</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> salary,grade_level
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e,job_grades g
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> salary <span style="color:#66d9ef">BETWEEN</span> g.<span style="color:#f92672">`</span>lowest_sal<span style="color:#f92672">`</span> <span style="color:#66d9ef">AND</span> g.<span style="color:#f92672">`</span>highest_sal<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">AND</span> g.<span style="color:#f92672">`</span>grade_level<span style="color:#f92672">`=</span><span style="color:#e6db74">&#39;A&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#前提我们要插入等级sql
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">select salary,employee_id from employees;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">select * from job_grades;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">CREATE TABLE job_grades
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">(grade_level VARCHAR(3),
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> lowest_sal  int,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> highest_sal int);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">INSERT INTO job_grades
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">VALUES (&#39;A&#39;, 1000, 2999);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">INSERT INTO job_grades
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">VALUES (&#39;B&#39;, 3000, 5999);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">INSERT INTO job_grades
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">VALUES(&#39;C&#39;, 6000, 9999);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">INSERT INTO job_grades
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">VALUES(&#39;D&#39;, 10000, 14999);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">INSERT INTO job_grades
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">VALUES(&#39;E&#39;, 15000, 24999);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">INSERT INTO job_grades
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">VALUES(&#39;F&#39;, 25000, 40000);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="72自连接" class="pagebody-header">
    7.2、自连接
  </h4>
</div><p class="component-content component">案例：查询 员工名和上级的名称</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> e.employee_id,e.last_name,m.employee_id,m.last_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e,employees m
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.<span style="color:#f92672">`</span>manager_id<span style="color:#f92672">`=</span>m.<span style="color:#f92672">`</span>employee_id<span style="color:#f92672">`</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="二sql99语法" class="pagebody-header">
    二、sql99语法
  </h2>
</div><p class="component-content component">语法：</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">select</span> <span style="color:#960050;background-color:#1e0010">查询列表</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">from</span> <span style="color:#960050;background-color:#1e0010">表</span><span style="color:#ae81ff">1</span> <span style="color:#960050;background-color:#1e0010">别名</span> <span style="color:#960050;background-color:#1e0010">【连接类型】</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">join</span> <span style="color:#960050;background-color:#1e0010">表</span><span style="color:#ae81ff">2</span> <span style="color:#960050;background-color:#1e0010">别名</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">on</span> <span style="color:#960050;background-color:#1e0010">连接条件</span>
</span></span><span style="display:flex;"><span>	<span style="color:#960050;background-color:#1e0010">【</span><span style="color:#66d9ef">where</span> <span style="color:#960050;background-color:#1e0010">筛选条件】</span>
</span></span><span style="display:flex;"><span>	<span style="color:#960050;background-color:#1e0010">【</span><span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> <span style="color:#960050;background-color:#1e0010">分组】</span>
</span></span><span style="display:flex;"><span>	<span style="color:#960050;background-color:#1e0010">【</span><span style="color:#66d9ef">having</span> <span style="color:#960050;background-color:#1e0010">筛选条件】</span>
</span></span><span style="display:flex;"><span>	<span style="color:#960050;background-color:#1e0010">【</span><span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#960050;background-color:#1e0010">排序列表】</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">分类：</p>
<blockquote>
<p class="component-content component">内连接（★）：inner
外连接
左外(★):left 【outer】
右外(★)：right 【outer】
全外：full【outer】
交叉连接：cross</p>
</blockquote>

<div class="component-content pagebody component">
  <h3 id="一内连接" class="pagebody-header">
    一）内连接
  </h3>
</div><p class="component-content component">语法：</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">select</span> <span style="color:#960050;background-color:#1e0010">查询列表</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">from</span> <span style="color:#960050;background-color:#1e0010">表</span><span style="color:#ae81ff">1</span> <span style="color:#960050;background-color:#1e0010">别名</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">inner</span> <span style="color:#66d9ef">join</span> <span style="color:#960050;background-color:#1e0010">表</span><span style="color:#ae81ff">2</span> <span style="color:#960050;background-color:#1e0010">别名</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">on</span> <span style="color:#960050;background-color:#1e0010">连接条件</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">分类：</p>
<blockquote>
<p class="component-content component">等值
非等值
自连接</p>
</blockquote>
<p class="component-content component">特点：
①添加排序、分组、筛选
②inner可以省略
③ 筛选条件放在where后面，连接条件放在on后面，提高分离性，便于阅读
④inner join连接和sql92语法中的等值连接效果是一样的，都是查询多表的交集</p>

<div class="component-content pagebody component">
  <h4 id="1等值连接-1" class="pagebody-header">
    1、等值连接
  </h4>
</div><p class="component-content component">案例1.查询员工名、部门名</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,department_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments d
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">JOIN</span>  employees e
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ON</span> e.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span> <span style="color:#f92672">=</span> d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2.查询名字中包含e的员工名和工种名（添加筛选）</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,job_title
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> jobs j
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ON</span> e.<span style="color:#f92672">`</span>job_id<span style="color:#f92672">`=</span>  j.<span style="color:#f92672">`</span>job_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.<span style="color:#f92672">`</span>last_name<span style="color:#f92672">`</span> <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%e%&#39;</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例3. 查询部门个数&gt;3的城市名和部门个数，（添加分组+筛选）</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#①查询每个城市的部门个数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#②在①结果上筛选满足条件的
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> city,<span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>) <span style="color:#960050;background-color:#1e0010">部门个数</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> locations l
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ON</span> d.<span style="color:#f92672">`</span>location_id<span style="color:#f92672">`=</span>l.<span style="color:#f92672">`</span>location_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> city
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">3</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例4.查询哪个部门的员工个数&gt;3的部门名和员工个数，并按个数降序（添加排序）</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">①查询每个部门的员工个数</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>),department_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> departments d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ON</span> e.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`=</span>d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_name
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#② 在①结果上筛选员工个数&gt;3的记录，并排序
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>) <span style="color:#960050;background-color:#1e0010">个数</span>,department_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> departments d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ON</span> e.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`=</span>d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>) <span style="color:#66d9ef">DESC</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例5.查询员工名、部门名、工种名，并按部门名降序（添加三表连接）</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,department_name,job_title
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> departments d <span style="color:#66d9ef">ON</span> e.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`=</span>d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> jobs j <span style="color:#66d9ef">ON</span> e.<span style="color:#f92672">`</span>job_id<span style="color:#f92672">`</span> <span style="color:#f92672">=</span> j.<span style="color:#f92672">`</span>job_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> department_name <span style="color:#66d9ef">DESC</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="二非等值连接" class="pagebody-header">
    二）非等值连接
  </h3>
</div><p class="component-content component">查询员工的工资级别</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> salary,grade_level
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">JOIN</span> job_grades g
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">ON</span> e.<span style="color:#f92672">`</span>salary<span style="color:#f92672">`</span> <span style="color:#66d9ef">BETWEEN</span> g.<span style="color:#f92672">`</span>lowest_sal<span style="color:#f92672">`</span> <span style="color:#66d9ef">AND</span> g.<span style="color:#f92672">`</span>highest_sal<span style="color:#f92672">`</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">查询工资级别的个数&gt;20的个数，并且按工资级别降序</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>),grade_level
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">JOIN</span> job_grades g
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ON</span> e.<span style="color:#f92672">`</span>salary<span style="color:#f92672">`</span> <span style="color:#66d9ef">BETWEEN</span> g.<span style="color:#f92672">`</span>lowest_sal<span style="color:#f92672">`</span> <span style="color:#66d9ef">AND</span> g.<span style="color:#f92672">`</span>highest_sal<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> grade_level
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> grade_level <span style="color:#66d9ef">DESC</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="三自连接" class="pagebody-header">
    三）自连接
  </h3>
</div><p class="component-content component">查询员工的名字、上级的名字</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> e.last_name,m.last_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">JOIN</span> employees m
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ON</span> e.<span style="color:#f92672">`</span>manager_id<span style="color:#f92672">`=</span> m.<span style="color:#f92672">`</span>employee_id<span style="color:#f92672">`</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">查询姓名中包含字符k的员工的名字、上级的名字</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span> <span style="color:#66d9ef">SELECT</span> e.last_name,m.last_name
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">JOIN</span> employees m
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">ON</span> e.<span style="color:#f92672">`</span>manager_id<span style="color:#f92672">`=</span> m.<span style="color:#f92672">`</span>employee_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">WHERE</span> e.<span style="color:#f92672">`</span>last_name<span style="color:#f92672">`</span> <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%k%&#39;</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="四外连接" class="pagebody-header">
    四）外连接
  </h3>
</div><p class="component-content component">应用场景：用于查询一个表中有，另一个表没有的记录</p>
<p class="component-content component">特点：
1、外连接的查询结果为主表中的所有记录
如果从表中有和它匹配的，则显示匹配的值
如果从表中没有和它匹配的，则显示null
外连接查询结果=内连接结果+主表中有而从表没有的记录
2、左外连接，left join左边的是主表
右外连接，right join右边的是主表
3、左外和右外交换两个表的顺序，可以实现同样的效果
4、全外连接=内连接的结果+表1中有但表2没有的+表2中有但表1没有的</p>
<p class="component-content component">引入：查询男朋友 不在男神表的的女神名</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span> <span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> beauty;
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> boys;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e">#左外连接
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#66d9ef">SELECT</span> b.<span style="color:#f92672">*</span>,bo.<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">FROM</span> boys bo
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">LEFT</span> <span style="color:#66d9ef">OUTER</span> <span style="color:#66d9ef">JOIN</span> beauty b
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">ON</span> b.<span style="color:#f92672">`</span>boyfriend_id<span style="color:#f92672">`</span> <span style="color:#f92672">=</span> bo.<span style="color:#f92672">`</span>id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">WHERE</span> b.<span style="color:#f92672">`</span>id<span style="color:#f92672">`</span> <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NULL</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例1：查询哪个部门没有员工</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span> <span style="color:#75715e">#左外
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#66d9ef">SELECT</span> d.<span style="color:#f92672">*</span>,e.employee_id
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">FROM</span> departments d
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">LEFT</span> <span style="color:#66d9ef">OUTER</span> <span style="color:#66d9ef">JOIN</span> employees e
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">ON</span> d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span> <span style="color:#f92672">=</span> e.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">WHERE</span> e.<span style="color:#f92672">`</span>employee_id<span style="color:#f92672">`</span> <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NULL</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e">#右外
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">SELECT</span> d.<span style="color:#f92672">*</span>,e.employee_id
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">RIGHT</span> <span style="color:#66d9ef">OUTER</span> <span style="color:#66d9ef">JOIN</span> departments d
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">ON</span> d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span> <span style="color:#f92672">=</span> e.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">WHERE</span> e.<span style="color:#f92672">`</span>employee_id<span style="color:#f92672">`</span> <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NULL</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e">#全外
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">USE</span> girls;
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">SELECT</span> b.<span style="color:#f92672">*</span>,bo.<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">FROM</span> beauty b
</span></span><span style="display:flex;"><span> FULL <span style="color:#66d9ef">OUTER</span> <span style="color:#66d9ef">JOIN</span> boys bo
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">ON</span> b.<span style="color:#f92672">`</span>boyfriend_id<span style="color:#f92672">`</span> <span style="color:#f92672">=</span> bo.id;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e">#交叉连接
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">SELECT</span> b.<span style="color:#f92672">*</span>,bo.<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">FROM</span> beauty b
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">CROSS</span> <span style="color:#66d9ef">JOIN</span> boys bo; </span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="三sql92和-sql99pk" class="pagebody-header">
    三、sql92和 sql99pk
  </h2>
</div><p class="component-content component">功能：sql99支持的较多
可读性：sql99实现连接条件和筛选条件的分离，可读性较高</p>

<div class="component-content pagebody component">
  <h1 id="三子查询" class="pagebody-header">
    三、子查询
  </h1>
</div><p class="component-content component">含义：
出现在其他语句中的select语句，称为子查询或内查询
外部的查询语句，称为主查询或外查询</p>
<p class="component-content component">分类：
按子查询出现的位置：</p>
<pre><code>&gt;select后面：
&gt;		仅仅支持标量子查询
&gt;	from后面：
&gt;		支持表子查询
&gt;	where或having后面：★
&gt;		标量子查询（单行） √
&gt;		列子查询  （多行） √
&gt;		
&gt;
&gt;​		行子查询
&gt;
&gt;​	exists后面（相关子查询）
&gt;​		表子查询
</code></pre>
<p class="component-content component">按结果集的行列数不同：</p>
<pre><code>&gt;标量子查询（结果集只有一行一列）
&gt;	列子查询（结果集只有一列多行）
&gt;	行子查询（结果集有一行多列）
&gt;	表子查询（结果集一般为多行多列）
</code></pre>

<div class="component-content pagebody component">
  <h2 id="一where或having后面" class="pagebody-header">
    一、where或having后面
  </h2>
</div><p class="component-content component">1、标量子查询（单行子查询）
2、列子查询（多行子查询）</p>
<p class="component-content component">3、行子查询（多列多行）</p>
<p class="component-content component">特点：
①子查询放在小括号内
②子查询一般放在条件的右侧
③标量子查询，一般搭配着单行操作符使用</p>
<blockquote>
<p class="component-content component">&lt; &gt;= &lt;= = &lt;&gt;</p>
</blockquote>
<p class="component-content component">列子查询，一般搭配着多行操作符使用</p>
<blockquote>
<p class="component-content component">in、any/some、all</p>
</blockquote>
<p class="component-content component">④子查询的执行优先于主查询执行，主查询的条件用到了子查询的结果</p>

<div class="component-content pagebody component">
  <h3 id="1标量子查询" class="pagebody-header">
    1.标量子查询★
  </h3>
</div><p class="component-content component">案例1：谁的工资比 Abel 高?</p>
<p class="component-content component">①查询Abel的工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> last_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Abel&#39;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">②查询员工的信息，满足 salary&gt;①结果</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> salary<span style="color:#f92672">&gt;</span>(
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> last_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Abel&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：返回job_id与141号员工相同，salary比143号员工多的员工 姓名，job_id 和工资</p>
<p class="component-content component">①查询141号员工的job_id</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> job_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> employee_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">141</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">②查询143号员工的salary</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> employee_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">143</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">③查询员工的姓名，job_id 和工资，要求job_id=①并且salary&gt;②</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,job_id,salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> job_id <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> job_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> employee_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">141</span>
</span></span><span style="display:flex;"><span>) <span style="color:#66d9ef">AND</span> salary<span style="color:#f92672">&gt;</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> salary
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> employee_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">143</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例3：返回公司工资最少的员工的last_name,job_id和salary</p>
<p class="component-content component">①查询公司的 最低工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(salary)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees</span></span></code></pre></div></div>
  
</div><p class="component-content component">②查询last_name,job_id和salary，要求salary=①</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,job_id,salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> salary<span style="color:#f92672">=</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(salary)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例4：查询最低工资大于50号部门最低工资的部门id和其最低工资</p>
<p class="component-content component">①查询50号部门的最低工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span>  <span style="color:#a6e22e">MIN</span>(salary)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> department_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">②查询每个部门的最低工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id</span></span></code></pre></div></div>
  
</div><p class="component-content component">③ 在②基础上筛选，满足min(salary)&gt;①</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">MIN</span>(salary)<span style="color:#f92672">&gt;</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span>  <span style="color:#a6e22e">MIN</span>(salary)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> department_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div><p class="component-content component">非法使用标量子查询</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">MIN</span>(salary)<span style="color:#f92672">&gt;</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span>  salary
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> department_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">250</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2列子查询多行子查询" class="pagebody-header">
    2.列子查询（多行子查询）★
  </h3>
</div><p class="component-content component">案例1：返回location_id是1400或1700的部门中的所有员工姓名</p>
<p class="component-content component">①查询location_id是1400或1700的部门编号</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> location_id <span style="color:#66d9ef">IN</span>(<span style="color:#ae81ff">1400</span>,<span style="color:#ae81ff">1700</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">②查询员工姓名，要求部门号是①列表中的某一个</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> department_id  <span style="color:#f92672">&lt;&gt;</span><span style="color:#66d9ef">ALL</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> departments
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> location_id <span style="color:#66d9ef">IN</span>(<span style="color:#ae81ff">1400</span>,<span style="color:#ae81ff">1700</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：返回其它工种中比job_id为‘IT_PROG’工种任一工资低的员工的员工号、姓名、job_id 以及salary</p>
<p class="component-content component">①查询job_id为‘IT_PROG’部门任一工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> job_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;IT_PROG&#39;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">②查询员工号、姓名、job_id 以及salary，salary&lt;(①)的任意一个</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,employee_id,job_id,salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> salary<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">ANY</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> salary
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> job_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;IT_PROG&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>) <span style="color:#66d9ef">AND</span> job_id<span style="color:#f92672">&lt;&gt;</span><span style="color:#e6db74">&#39;IT_PROG&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#或
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> last_name,employee_id,job_id,salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> salary<span style="color:#f92672">&lt;</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MAX</span>(salary)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> job_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;IT_PROG&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>) <span style="color:#66d9ef">AND</span> job_id<span style="color:#f92672">&lt;&gt;</span><span style="color:#e6db74">&#39;IT_PROG&#39;</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例3：返回其它部门中比job_id为‘IT_PROG’部门所有工资都低的员工   的员工号、姓名、job_id 以及salary</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,employee_id,job_id,salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> salary<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">ALL</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> salary
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> job_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;IT_PROG&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>) <span style="color:#66d9ef">AND</span> job_id<span style="color:#f92672">&lt;&gt;</span><span style="color:#e6db74">&#39;IT_PROG&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#或
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_name,employee_id,job_id,salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> salary<span style="color:#f92672">&lt;</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>( salary)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> job_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;IT_PROG&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>) <span style="color:#66d9ef">AND</span> job_id<span style="color:#f92672">&lt;&gt;</span><span style="color:#e6db74">&#39;IT_PROG&#39;</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3行子查询结果集一行多列或多行多列" class="pagebody-header">
    3、行子查询（结果集一行多列或多行多列）
  </h3>
</div><p class="component-content component">案例：查询员工编号最小并且工资最高的员工信息</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> (employee_id,salary)<span style="color:#f92672">=</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(employee_id),<span style="color:#a6e22e">MAX</span>(salary)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div><p class="component-content component">①查询最小的员工编号</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(employee_id)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees</span></span></code></pre></div></div>
  
</div><p class="component-content component">②查询最高工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MAX</span>(salary)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees</span></span></code></pre></div></div>
  
</div><p class="component-content component">③查询员工信息</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> employee_id<span style="color:#f92672">=</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(employee_id)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>)<span style="color:#66d9ef">AND</span> salary<span style="color:#f92672">=</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MAX</span>(salary)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="二select后面" class="pagebody-header">
    二、select后面
  </h2>
</div><p class="component-content component"><strong>仅仅支持标量子查询</strong></p>
<p class="component-content component">案例：查询每个部门的员工个数</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> d.<span style="color:#f92672">*</span>,(
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.department_id <span style="color:#f92672">=</span> d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ) <span style="color:#960050;background-color:#1e0010">个数</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">FROM</span> departments d;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：查询员工号=102的部门名</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> department_name,e.department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> departments d
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> employees e
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">ON</span> d.department_id<span style="color:#f92672">=</span>e.department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> e.employee_id<span style="color:#f92672">=</span><span style="color:#ae81ff">102</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>) <span style="color:#960050;background-color:#1e0010">部门名</span>;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="三from后面" class="pagebody-header">
    三、from后面
  </h2>
</div><p class="component-content component"><strong>将子查询结果充当一张表，要求必须起别名</strong></p>
<p class="component-content component">案例：查询每个部门的平均工资的工资等级
①查询每个部门的平均工资</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> job_grades;</span></span></code></pre></div></div>
  
</div><p class="component-content component">②连接①的结果集和job_grades表，筛选条件平均工资 between lowest_sal and highest_sal</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span>  ag_dep.<span style="color:#f92672">*</span>,g.<span style="color:#f92672">`</span>grade_level<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary) ag,department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>) ag_dep
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> job_grades g
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ON</span> ag_dep.ag <span style="color:#66d9ef">BETWEEN</span> lowest_sal <span style="color:#66d9ef">AND</span> highest_sal;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="四exists后面相关子查询" class="pagebody-header">
    四、exists后面（相关子查询）
  </h2>
</div><p class="component-content component">语法：
exists(完整的查询语句)
结果：
1或0</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">EXISTS</span>(<span style="color:#66d9ef">SELECT</span> employee_id <span style="color:#66d9ef">FROM</span> employees <span style="color:#66d9ef">WHERE</span> salary<span style="color:#f92672">=</span><span style="color:#ae81ff">300000</span>);</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例1：查询有员工的部门名</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#in
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> department_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span> <span style="color:#66d9ef">IN</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#exists
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> department_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">EXISTS</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees e
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`=</span>e.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：查询没有女朋友的男神信息</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#in
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> bo.<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> boys bo
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> bo.id <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">IN</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> boyfriend_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> beauty
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#exists
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> bo.<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> boys bo
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">EXISTS</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> boyfriend_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> beauty b
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">WHERE</span> bo.<span style="color:#f92672">`</span>id<span style="color:#f92672">`=</span>b.<span style="color:#f92672">`</span>boyfriend_id<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="五子查询经典案例" class="pagebody-header">
    五、子查询经典案例
  </h2>
</div>
<div class="component-content pagebody component">
  <h3 id="1-查询工资最低的员工信息-last_name-salary" class="pagebody-header">
    1. 查询工资最低的员工信息: last_name, salary
  </h3>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#①查询最低的工资
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(salary)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#②查询last_name,salary，要求salary=①
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> last_name,salary
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> salary<span style="color:#f92672">=</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(salary)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2-查询平均工资最低的部门信息" class="pagebody-header">
    2. 查询平均工资最低的部门信息
  </h3>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#方式一：
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#①各部门的平均工资
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#75715e">#②查询①结果上的最低平均工资
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(ag)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary) ag,department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>) ag_dep
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#③查询哪个部门的平均工资=②
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">AVG</span>(salary)<span style="color:#f92672">=</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(ag)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> (
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary) ag,department_id
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>	) ag_dep
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#④查询部门信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> d.<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`=</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">AVG</span>(salary)<span style="color:#f92672">=</span>(
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(ag)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">FROM</span> (
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary) ag,department_id
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>		) ag_dep
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#方式二：
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#①各部门的平均工资
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#②求出最低平均工资的部门编号
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">AVG</span>(salary) 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#③查询部门信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> department_id<span style="color:#f92672">=</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">AVG</span>(salary) 
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3-查询平均工资最低的部门信息和该部门的平均工资" class="pagebody-header">
    3. 查询平均工资最低的部门信息和该部门的平均工资
  </h3>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#①各部门的平均工资
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#75715e">#②求出最低平均工资的部门编号
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">AVG</span>(salary) 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#③查询部门信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> d.<span style="color:#f92672">*</span>,ag
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> departments d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">JOIN</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary) ag,department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">AVG</span>(salary) 
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>) ag_dep
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ON</span> d.<span style="color:#f92672">`</span>department_id<span style="color:#f92672">`=</span>ag_dep.department_id;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="4-查询平均工资最高的-job-信息" class="pagebody-header">
    4. 查询平均工资最高的 job 信息
  </h3>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#①查询最高的job的平均工资
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),job_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> job_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">AVG</span>(salary) <span style="color:#66d9ef">DESC</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#②查询job信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> jobs
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> job_id<span style="color:#f92672">=</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> job_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> job_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">AVG</span>(salary) <span style="color:#66d9ef">DESC</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="5-查询平均工资高于公司平均工资的部门有哪些" class="pagebody-header">
    5. 查询平均工资高于公司平均工资的部门有哪些?
  </h3>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#①查询平均工资
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#②查询每个部门的平均工资
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#③筛选②结果集，满足平均工资&gt;①
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary),department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#a6e22e">AVG</span>(salary)<span style="color:#f92672">&gt;</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">AVG</span>(salary)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="6-查询出公司中所有-manager-的详细信息" class="pagebody-header">
    6. 查询出公司中所有 manager 的详细信息.
  </h3>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#①查询所有manager的员工编号
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> manager_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#②查询详细信息，满足employee_id=①
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> employee_id <span style="color:#f92672">=</span><span style="color:#a6e22e">ANY</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> manager_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="7-各个部门中-最高工资中最低的那个部门的-最低工资是多少" class="pagebody-header">
    7. 各个部门中 最高工资中最低的那个部门的 最低工资是多少
  </h3>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#①查询各部门的最高工资中最低的部门编号
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">MAX</span>(salary)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#②查询①结果的那个部门的最低工资
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#a6e22e">MIN</span>(salary) ,department_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> department_id<span style="color:#f92672">=</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">SELECT</span> department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">FROM</span> employees
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">MAX</span>(salary)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>);</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="8-查询平均工资最高的部门的-manager-的详细信息-last_name-department_id-email-salary" class="pagebody-header">
    8. 查询平均工资最高的部门的 manager 的详细信息: last_name, department_id, email, salary
  </h3>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#75715e">#①查询平均工资最高的部门编号
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> 
</span></span><span style="display:flex;"><span>    department_id 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span>
</span></span><span style="display:flex;"><span>    employees 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">AVG</span>(salary) <span style="color:#66d9ef">DESC</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#②将employees和departments连接查询，筛选条件是①
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">SELECT</span> 
</span></span><span style="display:flex;"><span>        last_name, d.department_id, email, salary 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span>
</span></span><span style="display:flex;"><span>        employees e 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> departments d 
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">ON</span> d.manager_id <span style="color:#f92672">=</span> e.employee_id 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> d.department_id <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>        (<span style="color:#66d9ef">SELECT</span> 
</span></span><span style="display:flex;"><span>            department_id 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">FROM</span>
</span></span><span style="display:flex;"><span>            employees 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department_id 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#a6e22e">AVG</span>(salary) <span style="color:#66d9ef">DESC</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>) ;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="四分页查询-" class="pagebody-header">
    四、分页查询 ★
  </h1>
</div><p class="component-content component">应用场景：当要显示的数据，一页显示不全，需要分页提交sql请求
语法：</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">select</span> <span style="color:#960050;background-color:#1e0010">查询列表</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">from</span> <span style="color:#960050;background-color:#1e0010">表</span>
</span></span><span style="display:flex;"><span>	<span style="color:#960050;background-color:#1e0010">【</span><span style="color:#66d9ef">join</span> type <span style="color:#66d9ef">join</span> <span style="color:#960050;background-color:#1e0010">表</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">on</span> <span style="color:#960050;background-color:#1e0010">连接条件</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">where</span> <span style="color:#960050;background-color:#1e0010">筛选条件</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> <span style="color:#960050;background-color:#1e0010">分组字段</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">having</span> <span style="color:#960050;background-color:#1e0010">分组后的筛选</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#960050;background-color:#1e0010">排序的字段】</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">limit</span> <span style="color:#960050;background-color:#1e0010">【</span>offset,<span style="color:#960050;background-color:#1e0010">】</span>size;</span></span></code></pre></div></div>
  
</div><blockquote>
<p class="component-content component">offset要显示条目的起始索引（起始索引从0开始）
size 要显示的条目个数</p>
</blockquote>
<p class="component-content component">特点：
①limit语句放在查询语句的最后
②公式
要显示的页数 page，每页的条目数size</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">select</span> <span style="color:#960050;background-color:#1e0010">查询列表</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">from</span> <span style="color:#960050;background-color:#1e0010">表</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">limit</span> (page<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>size,size;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>size<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>page  
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>	<span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>	<span style="color:#ae81ff">20</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">案例1：查询前五条员工信息</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span>  employees <span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">5</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span>  employees <span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">5</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例2：查询第11条——第25条</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span>  employees <span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">15</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例3：有奖金的员工信息，并且工资较高的前10名显示出来</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span>
</span></span><span style="display:flex;"><span>    employees 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> commission_pct <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> salary <span style="color:#66d9ef">DESC</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">10</span> ;</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="五联合查询" class="pagebody-header">
    五、联合查询
  </h1>
</div><p class="component-content component">union 联合 合并：将多条查询语句的结果合并成一个结果</p>
<p class="component-content component">语法：</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">查询语句</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">union</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">查询语句</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">union</span>
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div></div>
  
</div><p class="component-content component">应用场景：
要查询的结果来自于多个表，且多个表没有直接的连接关系，但查询的信息一致时</p>
<p class="component-content component">特点：★
1、要求多条查询语句的查询列数是一致的！
2、要求多条查询语句的查询的每一列的类型和顺序最好一致
3、union关键字默认去重，如果使用union all 可以包含重复项</p>
<p class="component-content component">引入的案例：查询部门编号&gt;90或邮箱包含a的员工信息</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> employees <span style="color:#66d9ef">WHERE</span> email <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%a%&#39;</span> <span style="color:#66d9ef">OR</span> department_id<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">90</span>;;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> employees  <span style="color:#66d9ef">WHERE</span> email <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%a%&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">UNION</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> employees  <span style="color:#66d9ef">WHERE</span> department_id<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">90</span>;</span></span></code></pre></div></div>
  
</div><p class="component-content component">案例：查询中国用户中男性的信息以及外国用户中年男性的用户信息</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"></code></pre></div></div>
  
</div>
          </div><div class="component">
            <div class="component-content">
              <div class="article-copyright">
                <p class="content">
                  版权声明: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">版权声明：署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)</a>
                </p>
                <p class="content">作者:  yuanshuai </p>
                <p class="content">发表日期:  2021年11月24日</p>
              </div>
            </div>
          </div></article>
      </section>
  </main>

  <script>
    var script = document.createElement("script");script.src = "https://yuanshuai1122.github.io/js/initPost.js";
    document.head.appendChild(script);
  </script>

    
    <div class="footer-main ">
  <div class="content-body footer-wraper">
    <div class="footer-box">
      <div class="foot-nav">
        <div class="foot-nav-items">
          <div class="item">
            <div class="logo"></div>
            <div class="email">Email: <a href="mailto:shuaiyuan@gmail.com">shuaiyuan@gmail.com</a></div>
          </div>

          <div class="item community">
            <div class="item-title">社交媒体</div>
            
              <a href="https://github.com/yuanshuai1122" target="_blank">Github</a>
            
          </div>

          <div class="item resources">
            <div class="item-title">友链</div>
            
              <a href="https://yuanshuaicn.com/" target="_blank">👋</a>
            
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="item copyright">
          &copy; 2023
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://github.com/floyd-li/hugo-theme-itheme" target="_blank">iTheme</a>
        </div>
      </div>
    </div>
  </div>
</div>

  </body>
    
    

    
    
</html>
