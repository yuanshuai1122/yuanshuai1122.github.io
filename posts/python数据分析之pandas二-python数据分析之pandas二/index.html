<!DOCTYPE html>
<html class="js no-touch  progressive-image  no-reduced-motion progressive" lang="zh-hans">
  <head>
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/img/favicon.ico">

    <meta name="keyword" content=""><meta property="og:title" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäºŒï¼‰" />
<meta property="og:description" content=": | &mdash;&mdash;&mdash;: | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;: | &mdash;&mdash;-: | | 0 | 2018-01-01 | 3â„ƒ | -6â„ƒ | æ™´~å¤šäº‘ | ä¸œåŒ—é£ | 1-2çº§ | 59 | è‰¯ | 2 | | 1 | 2018-01-02 | 2â„ƒ | -5â„ƒ | é˜´~å¤šäº‘ | ä¸œ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuanshuai1122.github.io/posts/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-26T21:53:10+00:00" />
<meta property="article:modified_time" content="2021-11-26T21:53:10+00:00" />
<title>Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäºŒï¼‰</title>

    <link rel="canonical" href="/posts/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C/">

    <link rel="stylesheet" href="/css/global.css">

    <link rel="stylesheet" href="/css/custom.css">

    <link rel="stylesheet" href="/css/search.css" />

    
    

    
    

</head>
  </head>
  <body class=" page-article   ">
    <header>
      <nav class="nav">
  <div class="nav-wrapper">
    <div class="nav-content-wrapper">
      <div class="nav-content">
        <a href="/ " class="nav-title">ğŸ§€</a>
        <div class="nav-menu">
          <div class="nav-item-wrapper">
            <a href="/posts " class="nav-item-content">ç›®å½•</a>
          </div><div class="nav-item-wrapper">
            <a href="/about" class="nav-item-content">å…³äº</a>
          </div><div class="nav-item-wrapper">
            <a href="/index.xml" class="nav-item-content" target="_blank">RSS</a>
          </div></div>
      </div>
    </div>
  </div>
</nav>

<script>
  function toggleSearchModal(){
    const template = `
    <div class="modal-body">
      <div id="autocomplete" onclick="event.stopPropagation();"></div>
    </div>
    `
    const modal = document.querySelector("#modal-wrapper")
    if(!modal){
      const div = document.createElement("div")
      document.body.setAttribute("style","overflow: hidden;")
      div.setAttribute("id", "modal-wrapper")
      div.setAttribute("onclick", "toggleSearchModal()")
      div.innerHTML = template
      const script = document.createElement("script");script.setAttribute("src", "https://yuanshuai1122.github.io/js/algolia.js")
      div.appendChild(script)
      document.body.append(div)
    } else {
      document.body.removeAttribute("style")
      document.body.removeChild(modal)
    }
  }
</script>
    </header>
    
  
  
  <main id="main" class="main">
      <section>
        <article class="article">
          
          <div class=" article-header ">
            <div class="category component">
              <div class="component-content">
                <div class="category-eyebrow">
                  <span class="category-eyebrow__category category_original">
                    
                      
                        Python
                      
                    
                  </span>
                  <span class="category-eyebrow__date">2021å¹´11æœˆ26æ—¥</span>
                </div>
              </div>
            </div>
            <div class="pagetitle component">
              <div class="component-content">
                <h1 class="hero-headline">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäºŒï¼‰</h1>
              </div>
            </div>
            <div class="component  article-subhead ">
              <div class="component-content"></div>
            </div>

            <div class="tagssheet component">
              <div class="component-content">
                
                  
                  <a href="/tags/python" class="tag">
                    Python
                  </a>
                
                  
                  <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90" class="tag">
                    æ•°æ®åˆ†æ
                  </a>
                
              </div>
            </div>
          </div>
          
          <div class="pagebody">
            
            
            
            
            
            
            
            
            <p class="component-content component">: | &mdash;&mdash;&mdash;: | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;: | &mdash;&mdash;-: |
|    0 | 2018-01-01 |     3â„ƒ |    -6â„ƒ | æ™´~å¤šäº‘ |    ä¸œåŒ—é£ |  1-2çº§ |   59 |      è‰¯ |        2 |
|    1 | 2018-01-02 |     2â„ƒ |    -5â„ƒ | é˜´~å¤šäº‘ |    ä¸œåŒ—é£ |  1-2çº§ |   49 |      ä¼˜ |        1 |
|    2 | 2018-01-03 |     2â„ƒ |    -5â„ƒ |    å¤šäº‘ |      åŒ—é£ |  1-2çº§ |   28 |      ä¼˜ |        1 |
|    3 | 2018-01-04 |     0â„ƒ |    -8â„ƒ |      é˜´ |    ä¸œåŒ—é£ |  1-2çº§ |   28 |      ä¼˜ |        1 |
|    4 | 2018-01-05 |     3â„ƒ |    -6â„ƒ | å¤šäº‘~æ™´ |    è¥¿åŒ—é£ |  1-2çº§ |   50 |      ä¼˜ |        1 |</p>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>dtypes</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ymd          object
</span></span><span style="display:flex;"><span>bWendu       object
</span></span><span style="display:flex;"><span>yWendu       object
</span></span><span style="display:flex;"><span>tianqi       object
</span></span><span style="display:flex;"><span>fengxiang    object
</span></span><span style="display:flex;"><span>fengli       object
</span></span><span style="display:flex;"><span>aqi           int64
</span></span><span style="display:flex;"><span>aqiInfo      object
</span></span><span style="display:flex;"><span>aqiLevel      int64
</span></span><span style="display:flex;"><span>dtype: object</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="1è·å–seriesçš„strå±æ€§ä½¿ç”¨å„ç§å­—ç¬¦ä¸²å¤„ç†å‡½æ•°" class="pagebody-header">
    1ã€è·å–Seriesçš„strå±æ€§ï¼Œä½¿ç”¨å„ç§å­—ç¬¦ä¸²å¤„ç†å‡½æ•°
  </h3>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>pandas<span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>strings<span style="color:#f92672">.</span>StringMethods at <span style="color:#ae81ff">0x1af21871808</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;â„ƒ&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>       <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>       <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">..</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Name: bWendu, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># åˆ¤æ–­æ˜¯ä¸æ˜¯æ•°å­—</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>isnumeric()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">...</span>  
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>Name: bWendu, Length: <span style="color:#ae81ff">365</span>, dtype: bool</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;aqi&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>len()
</span></span><span style="display:flex;"><span><span style="color:#f92672">---------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AttributeError</span>                            Traceback (most recent call last)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>ipython<span style="color:#f92672">-</span>input<span style="color:#f92672">-</span><span style="color:#ae81ff">8</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>cdcbdb6f81<span style="color:#f92672">&gt;</span> <span style="color:#f92672">in</span> <span style="color:#f92672">&lt;</span>module<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">----&gt;</span> <span style="color:#ae81ff">1</span> df[<span style="color:#e6db74">&#34;aqi&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>len()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d:\appdata\python37\lib\site<span style="color:#f92672">-</span>packages\pandas\core\generic<span style="color:#f92672">.</span>py <span style="color:#f92672">in</span> __getattr__(self, name)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5173</span>             <span style="color:#f92672">or</span> name <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_accessors
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5174</span>         ):
</span></span><span style="display:flex;"><span><span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">5175</span>             <span style="color:#66d9ef">return</span> object<span style="color:#f92672">.</span>__getattribute__(self, name)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5176</span>         <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5177</span>             <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>_info_axis<span style="color:#f92672">.</span>_can_hold_identifiers_and_holds_name(name):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d:\appdata\python37\lib\site<span style="color:#f92672">-</span>packages\pandas\core\accessor<span style="color:#f92672">.</span>py <span style="color:#f92672">in</span> __get__(self, obj, cls)
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">173</span>             <span style="color:#75715e"># we&#39;re accessing the attribute of the class, i.e., Dataset.geo</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">174</span>             <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_accessor
</span></span><span style="display:flex;"><span><span style="color:#f92672">--&gt;</span> <span style="color:#ae81ff">175</span>         accessor_obj <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_accessor(obj)
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">176</span>         <span style="color:#75715e"># Replace the property with the accessor object. Inspired by:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">177</span>         <span style="color:#75715e"># http://www.pydanny.com/cached-property.html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d:\appdata\python37\lib\site<span style="color:#f92672">-</span>packages\pandas\core\strings<span style="color:#f92672">.</span>py <span style="color:#f92672">in</span> __init__(self, data)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1915</span> 
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1916</span>     <span style="color:#66d9ef">def</span> __init__(self, data):
</span></span><span style="display:flex;"><span><span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">1917</span>         self<span style="color:#f92672">.</span>_inferred_dtype <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_validate(data)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1918</span>         self<span style="color:#f92672">.</span>_is_categorical <span style="color:#f92672">=</span> is_categorical_dtype(data)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1919</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d:\appdata\python37\lib\site<span style="color:#f92672">-</span>packages\pandas\core\strings<span style="color:#f92672">.</span>py <span style="color:#f92672">in</span> _validate(data)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1965</span> 
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1966</span>         <span style="color:#66d9ef">if</span> inferred_dtype <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> allowed_types:
</span></span><span style="display:flex;"><span><span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">1967</span>             <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">AttributeError</span>(<span style="color:#e6db74">&#34;Can only use .str accessor with string &#34;</span> <span style="color:#e6db74">&#34;values!&#34;</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1968</span>         <span style="color:#66d9ef">return</span> inferred_dtype
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1969</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AttributeError</span>: Can only use <span style="color:#f92672">.</span>str accessor <span style="color:#66d9ef">with</span> string values<span style="color:#960050;background-color:#1e0010">!</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2ä½¿ç”¨strçš„startswithcontainsç­‰å¾—åˆ°boolçš„serieså¯ä»¥åšæ¡ä»¶æŸ¥è¯¢" class="pagebody-header">
    2ã€ä½¿ç”¨strçš„startswithã€containsç­‰å¾—åˆ°boolçš„Serieså¯ä»¥åšæ¡ä»¶æŸ¥è¯¢
  </h3>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>condition <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#34;2018-03&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>condition</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">...</span>  
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>Name: ymd, Length: <span style="color:#ae81ff">365</span>, dtype: bool</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[condition]<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">59</td>
<td style="text-align:right">2018-03-01</td>
<td style="text-align:right">8â„ƒ</td>
<td style="text-align:right">-3â„ƒ</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">46</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">60</td>
<td style="text-align:right">2018-03-02</td>
<td style="text-align:right">9â„ƒ</td>
<td style="text-align:right">-1â„ƒ</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">95</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">61</td>
<td style="text-align:right">2018-03-03</td>
<td style="text-align:right">13â„ƒ</td>
<td style="text-align:right">3â„ƒ</td>
<td style="text-align:right">å¤šäº‘~é˜´</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">214</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">62</td>
<td style="text-align:right">2018-03-04</td>
<td style="text-align:right">7â„ƒ</td>
<td style="text-align:right">-2â„ƒ</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œå—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">144</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">63</td>
<td style="text-align:right">2018-03-05</td>
<td style="text-align:right">8â„ƒ</td>
<td style="text-align:right">-3â„ƒ</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">94</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3éœ€è¦å¤šæ¬¡strå¤„ç†çš„é“¾å¼æ“ä½œ" class="pagebody-header">
    3ã€éœ€è¦å¤šæ¬¡strå¤„ç†çš„é“¾å¼æ“ä½œ
  </h3>
</div><p class="component-content component">æ€æ ·æå–201803è¿™æ ·çš„æ•°å­—æœˆä»½ï¼Ÿ
1ã€å…ˆå°†æ—¥æœŸ2018-03-31æ›¿æ¢æˆ20180331çš„å½¢å¼
2ã€æå–æœˆä»½å­—ç¬¦ä¸²201803</p>
<p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">20180101</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">20180102</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">20180103</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">20180104</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">20180105</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">...</span>   
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">20181227</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">20181228</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">20181229</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">20181230</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">20181231</span>
</span></span><span style="display:flex;"><span>Name: ymd, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ¯æ¬¡è°ƒç”¨å‡½æ•°ï¼Œéƒ½è¿”å›ä¸€ä¸ªæ–°Series</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>slice(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">---------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AttributeError</span>                            Traceback (most recent call last)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>ipython<span style="color:#f92672">-</span>input<span style="color:#f92672">-</span><span style="color:#ae81ff">13</span><span style="color:#f92672">-</span>ae278fb12255<span style="color:#f92672">&gt;</span> <span style="color:#f92672">in</span> <span style="color:#f92672">&lt;</span>module<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">1</span> <span style="color:#75715e"># æ¯æ¬¡è°ƒç”¨å‡½æ•°ï¼Œéƒ½è¿”å›ä¸€ä¸ªæ–°Series</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">----&gt;</span> <span style="color:#ae81ff">2</span> df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>slice(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d:\appdata\python37\lib\site<span style="color:#f92672">-</span>packages\pandas\core\generic<span style="color:#f92672">.</span>py <span style="color:#f92672">in</span> __getattr__(self, name)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5177</span>             <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>_info_axis<span style="color:#f92672">.</span>_can_hold_identifiers_and_holds_name(name):
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5178</span>                 <span style="color:#66d9ef">return</span> self[name]
</span></span><span style="display:flex;"><span><span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">5179</span>             <span style="color:#66d9ef">return</span> object<span style="color:#f92672">.</span>__getattribute__(self, name)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5180</span> 
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5181</span>     <span style="color:#66d9ef">def</span> __setattr__(self, name, value):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AttributeError</span>: <span style="color:#e6db74">&#39;Series&#39;</span> object has no attribute <span style="color:#e6db74">&#39;slice&#39;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>slice(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>  
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span>Name: ymd, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># sliceå°±æ˜¯åˆ‡ç‰‡è¯­æ³•ï¼Œå¯ä»¥ç›´æ¥ç”¨</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>str[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">6</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>  
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span>Name: ymd, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="4-ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†" class="pagebody-header">
    4. ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†
  </h3>
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ·»åŠ æ–°åˆ—</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_nianyueri</span>(x):
</span></span><span style="display:flex;"><span>    year,month,day <span style="color:#f92672">=</span> x[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>year<span style="color:#e6db74">}</span><span style="color:#e6db74">å¹´</span><span style="color:#e6db74">{</span>month<span style="color:#e6db74">}</span><span style="color:#e6db74">æœˆ</span><span style="color:#e6db74">{</span>day<span style="color:#e6db74">}</span><span style="color:#e6db74">æ—¥&#34;</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ä¸­æ–‡æ—¥æœŸ&#34;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>apply(get_nianyueri, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ä¸­æ–‡æ—¥æœŸ&#34;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">2018</span>å¹´01æœˆ01æ—¥
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">2018</span>å¹´01æœˆ02æ—¥
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">2018</span>å¹´01æœˆ03æ—¥
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">2018</span>å¹´01æœˆ04æ—¥
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">2018</span>å¹´01æœˆ05æ—¥
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">...</span>     
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">2018</span>å¹´12æœˆ27æ—¥
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">2018</span>å¹´12æœˆ28æ—¥
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">2018</span>å¹´12æœˆ29æ—¥
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">2018</span>å¹´12æœˆ30æ—¥
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">2018</span>å¹´12æœˆ31æ—¥
</span></span><span style="display:flex;"><span>Name: ä¸­æ–‡æ—¥æœŸ, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">é—®é¢˜ï¼šæ€æ ·å°†â€œ2018å¹´12æœˆ31æ—¥â€ä¸­çš„å¹´ã€æœˆã€æ—¥ä¸‰ä¸ªä¸­æ–‡å­—ç¬¦å»é™¤ï¼Ÿ</p>
<p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ–¹æ³•1ï¼šé“¾å¼replace</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ä¸­æ–‡æ—¥æœŸ&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;å¹´&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;æœˆ&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;æ—¥&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">20180101</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">20180102</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">20180103</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">20180104</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">20180105</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">...</span>   
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">20181227</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">20181228</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">20181229</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">20181230</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">20181231</span>
</span></span><span style="display:flex;"><span>Name: ä¸­æ–‡æ—¥æœŸ, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">*<strong>Series.stré»˜è®¤å°±å¼€å¯äº†æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼*</strong></p>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ–¹æ³•2ï¼šæ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ä¸­æ–‡æ—¥æœŸ&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;[å¹´æœˆæ—¥]&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">20180101</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">20180102</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">20180103</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">20180104</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">20180105</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">...</span>   
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">20181227</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">20181228</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">20181229</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">20181230</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">20181231</span>
</span></span><span style="display:flex;"><span>Name: ä¸­æ–‡æ—¥æœŸ, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="11pandasçš„axiså‚æ•°æ€ä¹ˆç†è§£" class="pagebody-header">
    11ã€Pandasçš„axiså‚æ•°æ€ä¹ˆç†è§£ï¼Ÿ
  </h2>
</div><div class="component-content component"><ul>
<li>
<p class="component-content component">axis=0æˆ–è€…&quot;index&quot;ï¼š</p>
<div class="component-content component"><ul>
<li>å¦‚æœæ˜¯å•è¡Œæ“ä½œï¼Œå°±æŒ‡çš„æ˜¯æŸä¸€è¡Œ</li>
<li>å¦‚æœæ˜¯èšåˆæ“ä½œï¼ŒæŒ‡çš„æ˜¯è·¨è¡Œcross rows</li>
</ul></div>
</li>
<li>
<p class="component-content component">axis=1æˆ–è€…&quot;columns&quot;ï¼š</p>
<div class="component-content component"><ul>
<li>
<p class="component-content component">å¦‚æœæ˜¯å•åˆ—æ“ä½œï¼Œå°±æŒ‡çš„æ˜¯æŸä¸€åˆ—</p>
</li>
<li>
<p class="component-content component">å¦‚æœæ˜¯èšåˆæ“ä½œï¼ŒæŒ‡çš„æ˜¯è·¨åˆ—cross columns</p>
<p class="component-content component">*<strong>æŒ‰å“ªä¸ªaxisï¼Œå°±æ˜¯è¿™ä¸ªaxisè¦åŠ¨èµ·æ¥(ç±»ä¼¼è¢«foréå†)ï¼Œå…¶å®ƒçš„axisä¿æŒä¸åŠ¨*</strong></p>
</li>
</ul></div>
</li>
</ul></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(
</span></span><span style="display:flex;"><span>    np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">12</span>)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>),
</span></span><span style="display:flex;"><span>    columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#e6db74">&#39;C&#39;</span>, <span style="color:#e6db74">&#39;D&#39;</span>]
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">df</code></pre>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="1å•åˆ—dropå°±æ˜¯åˆ é™¤æŸä¸€åˆ—" class="pagebody-header">
    1ã€å•åˆ—dropï¼Œå°±æ˜¯åˆ é™¤æŸä¸€åˆ—
  </h3>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ä»£è¡¨çš„å°±æ˜¯åˆ é™¤æŸåˆ—</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#34;A&#34;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2å•è¡Œdropå°±æ˜¯åˆ é™¤æŸä¸€è¡Œ" class="pagebody-header">
    2ã€å•è¡Œdropï¼Œå°±æ˜¯åˆ é™¤æŸä¸€è¡Œ
  </h3>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ä»£è¡¨çš„å°±æ˜¯åˆ é™¤æŸè¡Œ</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>drop(<span style="color:#ae81ff">1</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3æŒ‰axis0indexæ‰§è¡Œmeanèšåˆæ“ä½œ" class="pagebody-header">
    3ã€æŒ‰axis=0/indexæ‰§è¡Œmeanèšåˆæ“ä½œ
  </h3>
</div><p class="component-content component">åç›´è§‰ï¼šè¾“å‡ºçš„ä¸æ˜¯æ¯è¡Œçš„ç»“æœï¼Œè€Œæ˜¯æ¯åˆ—çš„ç»“æœ</p>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># axis=0 or axis=index</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>mean(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>A    <span style="color:#ae81ff">4.0</span>
</span></span><span style="display:flex;"><span>B    <span style="color:#ae81ff">5.0</span>
</span></span><span style="display:flex;"><span>C    <span style="color:#ae81ff">6.0</span>
</span></span><span style="display:flex;"><span>D    <span style="color:#ae81ff">7.0</span>
</span></span><span style="display:flex;"><span>dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-0d3748140e02aa43fef144f522b8e753" id="lht0d3748140e02aa43fef144f522b8e753">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/1.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">*<strong>æŒ‡å®šäº†æŒ‰å“ªä¸ªaxisï¼Œå°±æ˜¯è¿™ä¸ªaxisè¦åŠ¨èµ·æ¥(ç±»ä¼¼è¢«foréå†)ï¼Œå…¶å®ƒçš„axisä¿æŒä¸åŠ¨*</strong></p>

<div class="component-content pagebody component">
  <h3 id="4æŒ‰axis1columnsæ‰§è¡Œmeanèšåˆæ“ä½œ" class="pagebody-header">
    4ã€æŒ‰axis=1/columnsæ‰§è¡Œmeanèšåˆæ“ä½œ
  </h3>
</div><p class="component-content component">åç›´è§‰ï¼šè¾“å‡ºçš„ä¸æ˜¯æ¯è¡Œçš„ç»“æœï¼Œè€Œæ˜¯æ¯åˆ—çš„ç»“æœ</p>
<p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># axis=1 or axis=columns</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>mean(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">5.5</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    <span style="color:#ae81ff">9.5</span>
</span></span><span style="display:flex;"><span>dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-b83d0af3985d1aca5b3ff0677fbd7803" id="lhtb83d0af3985d1aca5b3ff0677fbd7803">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/2.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">*<strong>æŒ‡å®šäº†æŒ‰å“ªä¸ªaxisï¼Œå°±æ˜¯è¿™ä¸ªaxisè¦åŠ¨èµ·æ¥(ç±»ä¼¼è¢«foréå†)ï¼Œå…¶å®ƒçš„axisä¿æŒä¸åŠ¨*</strong></p>

<div class="component-content pagebody component">
  <h3 id="5å†æ¬¡ä¸¾ä¾‹åŠ æ·±ç†è§£" class="pagebody-header">
    5ã€å†æ¬¡ä¸¾ä¾‹ï¼ŒåŠ æ·±ç†è§£
  </h3>
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_sum_value</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x[<span style="color:#e6db74">&#34;A&#34;</span>] <span style="color:#f92672">+</span> x[<span style="color:#e6db74">&#34;B&#34;</span>] <span style="color:#f92672">+</span> x[<span style="color:#e6db74">&#34;C&#34;</span>] <span style="color:#f92672">+</span> x[<span style="color:#e6db74">&#34;D&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;sum_value&#34;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>apply(get_sum_value, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">df</code></pre>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">sum_value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
<td style="text-align:right">38</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>æŒ‡å®šäº†æŒ‰å“ªä¸ªaxisï¼Œå°±æ˜¯è¿™ä¸ªaxisè¦åŠ¨èµ·æ¥(ç±»ä¼¼è¢«foréå†)ï¼Œå…¶å®ƒçš„axisä¿æŒä¸åŠ¨*</strong></p>

<div class="component-content pagebody component">
  <h2 id="12pandasçš„ç´¢å¼•indexçš„ç”¨é€”" class="pagebody-header">
    12ã€Pandasçš„ç´¢å¼•indexçš„ç”¨é€”
  </h2>
</div><p class="component-content component">æŠŠæ•°æ®å­˜å‚¨äºæ™®é€šçš„columnåˆ—ä¹Ÿèƒ½ç”¨äºæ•°æ®æŸ¥è¯¢ï¼Œé‚£ä½¿ç”¨indexæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p>
<p class="component-content component">indexçš„ç”¨é€”æ€»ç»“ï¼š</p>
<div class="component-content component"><ol>
<li>æ›´æ–¹ä¾¿çš„æ•°æ®æŸ¥è¯¢ï¼›</li>
<li>ä½¿ç”¨indexå¯ä»¥è·å¾—æ€§èƒ½æå‡ï¼›</li>
<li>è‡ªåŠ¨çš„æ•°æ®å¯¹é½åŠŸèƒ½ï¼›</li>
<li>æ›´å¤šæ›´å¼ºå¤§çš„æ•°æ®ç»“æ„æ”¯æŒï¼›</li>
</ol></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./datas/ml-latest-small/ratings.csv&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982703</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964981247</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">47</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964983815</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">50</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964982931</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>count()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>userId       <span style="color:#ae81ff">100836</span>
</span></span><span style="display:flex;"><span>movieId      <span style="color:#ae81ff">100836</span>
</span></span><span style="display:flex;"><span>rating       <span style="color:#ae81ff">100836</span>
</span></span><span style="display:flex;"><span>timestamp    <span style="color:#ae81ff">100836</span>
</span></span><span style="display:flex;"><span>dtype: int64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="1ä½¿ç”¨indexæŸ¥è¯¢æ•°æ®" class="pagebody-header">
    1ã€ä½¿ç”¨indexæŸ¥è¯¢æ•°æ®
  </h2>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># drop==Falseï¼Œè®©ç´¢å¼•åˆ—è¿˜ä¿æŒåœ¨column</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#34;userId&#34;</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, drop<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982703</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964981247</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">47</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964983815</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">50</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964982931</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Int64Index([  <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>],
</span></span><span style="display:flex;"><span>           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;userId&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">100836</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨indexçš„æŸ¥è¯¢æ–¹æ³•</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[<span style="color:#ae81ff">500</span>]<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005527755</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">11</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005528017</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">39</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527926</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527980</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">104</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005528065</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨columnçš„conditionæŸ¥è¯¢æ–¹æ³•</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[df[<span style="color:#e6db74">&#34;userId&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">500</span>]<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005527755</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">11</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005528017</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">39</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527926</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527980</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">104</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005528065</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h2 id="2-ä½¿ç”¨indexä¼šæå‡æŸ¥è¯¢æ€§èƒ½" class="pagebody-header">
    2. ä½¿ç”¨indexä¼šæå‡æŸ¥è¯¢æ€§èƒ½
  </h2>
</div><div class="component-content component"><ul>
<li>å¦‚æœindexæ˜¯å”¯ä¸€çš„ï¼ŒPandasä¼šä½¿ç”¨å“ˆå¸Œè¡¨ä¼˜åŒ–ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¸ºO(1);</li>
<li>å¦‚æœindexä¸æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯æœ‰åºï¼ŒPandasä¼šä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ç®—æ³•ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¸ºO(logN);</li>
<li>å¦‚æœindexæ˜¯å®Œå…¨éšæœºçš„ï¼Œé‚£ä¹ˆæ¯æ¬¡æŸ¥è¯¢éƒ½è¦æ‰«æå…¨è¡¨ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¸ºO(N);</li>
</ul></div>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-96fbc4fecfce54532675614bd8760186" id="lht96fbc4fecfce54532675614bd8760186">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/3.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h3 id="å®éªŒ1å®Œå…¨éšæœºçš„é¡ºåºæŸ¥è¯¢" class="pagebody-header">
    å®éªŒ1ï¼šå®Œå…¨éšæœºçš„é¡ºåºæŸ¥è¯¢
  </h3>
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å°†æ•°æ®éšæœºæ‰“æ•£</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.utils <span style="color:#f92672">import</span> shuffle
</span></span><span style="display:flex;"><span>df_shuffle <span style="color:#f92672">=</span> shuffle(df)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_shuffle<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">160</td>
<td style="text-align:right">160</td>
<td style="text-align:right">2340</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">985383314</td>
</tr>
<tr>
<td style="text-align:right">129</td>
<td style="text-align:right">129</td>
<td style="text-align:right">1136</td>
<td style="text-align:right">3.5</td>
<td style="text-align:right">1167375403</td>
</tr>
<tr>
<td style="text-align:right">167</td>
<td style="text-align:right">167</td>
<td style="text-align:right">44191</td>
<td style="text-align:right">4.5</td>
<td style="text-align:right">1154718915</td>
</tr>
<tr>
<td style="text-align:right">536</td>
<td style="text-align:right">536</td>
<td style="text-align:right">276</td>
<td style="text-align:right">3.0</td>
<td style="text-align:right">832839990</td>
</tr>
<tr>
<td style="text-align:right">67</td>
<td style="text-align:right">67</td>
<td style="text-align:right">5952</td>
<td style="text-align:right">2.0</td>
<td style="text-align:right">1501274082</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ç´¢å¼•æ˜¯å¦æ˜¯é€’å¢çš„</span>
</span></span><span style="display:flex;"><span>df_shuffle<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>is_monotonic_increasing</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">False</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_shuffle<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>is_unique</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">False</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># è®¡æ—¶ï¼ŒæŸ¥è¯¢id==500æ•°æ®æ€§èƒ½</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>timeit df_shuffle<span style="color:#f92672">.</span>loc[<span style="color:#ae81ff">500</span>]
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">376</span> Âµs <span style="color:#960050;background-color:#1e0010">Â±</span> <span style="color:#ae81ff">52.4</span> Âµs per loop (mean <span style="color:#960050;background-color:#1e0010">Â±</span> std<span style="color:#f92672">.</span> dev<span style="color:#f92672">.</span> of <span style="color:#ae81ff">7</span> runs, <span style="color:#ae81ff">1000</span> loops each)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="å®éªŒ2å°†indexæ’åºåçš„æŸ¥è¯¢" class="pagebody-header">
    å®éªŒ2ï¼šå°†indexæ’åºåçš„æŸ¥è¯¢
  </h3>
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_sorted <span style="color:#f92672">=</span> df_shuffle<span style="color:#f92672">.</span>sort_index()</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_sorted<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2985</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964983034</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2617</td>
<td style="text-align:right">2.0</td>
<td style="text-align:right">964982588</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3639</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982271</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">733</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982400</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ç´¢å¼•æ˜¯å¦æ˜¯é€’å¢çš„</span>
</span></span><span style="display:flex;"><span>df_sorted<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>is_monotonic_increasing</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">True</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_sorted<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>is_unique</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">False</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">%</span>timeit df_sorted<span style="color:#f92672">.</span>loc[<span style="color:#ae81ff">500</span>]
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">203</span> Âµs <span style="color:#960050;background-color:#1e0010">Â±</span> <span style="color:#ae81ff">20.8</span> Âµs per loop (mean <span style="color:#960050;background-color:#1e0010">Â±</span> std<span style="color:#f92672">.</span> dev<span style="color:#f92672">.</span> of <span style="color:#ae81ff">7</span> runs, <span style="color:#ae81ff">1000</span> loops each)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="3-ä½¿ç”¨indexèƒ½è‡ªåŠ¨å¯¹é½æ•°æ®" class="pagebody-header">
    3. ä½¿ç”¨indexèƒ½è‡ªåŠ¨å¯¹é½æ•°æ®
  </h2>
</div><p class="component-content component">åŒ…æ‹¬serieså’Œdataframe</p>
<p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>], index<span style="color:#f92672">=</span>list(<span style="color:#e6db74">&#34;abc&#34;</span>))</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s1</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>b    <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>c    <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>dtype: int64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>], index<span style="color:#f92672">=</span>list(<span style="color:#e6db74">&#34;bcd&#34;</span>))</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>b    <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>c    <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>d    <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>dtype: int64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s1<span style="color:#f92672">+</span>s2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a    NaN
</span></span><span style="display:flex;"><span>b    <span style="color:#ae81ff">4.0</span>
</span></span><span style="display:flex;"><span>c    <span style="color:#ae81ff">6.0</span>
</span></span><span style="display:flex;"><span>d    NaN
</span></span><span style="display:flex;"><span>dtype: float64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="4-ä½¿ç”¨indexæ›´å¤šæ›´å¼ºå¤§çš„æ•°æ®ç»“æ„æ”¯æŒ" class="pagebody-header">
    4. ä½¿ç”¨indexæ›´å¤šæ›´å¼ºå¤§çš„æ•°æ®ç»“æ„æ”¯æŒ
  </h2>
</div><p class="component-content component">*<strong>å¾ˆå¤šå¼ºå¤§çš„ç´¢å¼•æ•°æ®ç»“æ„*</strong></p>
<div class="component-content component"><ul>
<li>CategoricalIndexï¼ŒåŸºäºåˆ†ç±»æ•°æ®çš„Indexï¼Œæå‡æ€§èƒ½ï¼›</li>
<li>MultiIndexï¼Œå¤šç»´ç´¢å¼•ï¼Œç”¨äºgroupbyå¤šç»´èšåˆåç»“æœç­‰ï¼›</li>
<li>DatetimeIndexï¼Œæ—¶é—´ç±»å‹ç´¢å¼•ï¼Œå¼ºå¤§çš„æ—¥æœŸå’Œæ—¶é—´çš„æ–¹æ³•æ”¯æŒï¼›</li>
</ul></div>

<div class="component-content pagebody component">
  <h1 id="13pandasæ€æ ·å®ç°dataframeçš„merge" class="pagebody-header">
    13ã€Pandasæ€æ ·å®ç°DataFrameçš„Merge
  </h1>
</div><p class="component-content component">Pandasçš„Mergeï¼Œç›¸å½“äºSqlçš„Joinï¼Œå°†ä¸åŒçš„è¡¨æŒ‰keyå…³è”åˆ°ä¸€ä¸ªè¡¨</p>

<div class="component-content pagebody component">
  <h3 id="mergeçš„è¯­æ³•" class="pagebody-header">
    mergeçš„è¯­æ³•ï¼š
  </h3>
</div><p class="component-content component">pd.merge(left, right, how=&lsquo;inner&rsquo;, on=None, left_on=None, right_on=None, left_index=False, right_index=False, sort=True, suffixes=(&rsquo;_x&rsquo;, &lsquo;_y&rsquo;), copy=True, indicator=False, validate=None)</p>
<div class="component-content component"><ul>
<li>leftï¼Œrightï¼šè¦mergeçš„dataframeæˆ–è€…æœ‰nameçš„Series</li>
<li>howï¼šjoinç±»å‹ï¼Œ&rsquo;left&rsquo;, &lsquo;right&rsquo;, &lsquo;outer&rsquo;, &lsquo;inner&rsquo;</li>
<li>onï¼šjoinçš„keyï¼Œleftå’Œrightéƒ½éœ€è¦æœ‰è¿™ä¸ªkey</li>
<li>left_onï¼šleftçš„dfæˆ–è€…seriesçš„key</li>
<li>right_onï¼šrightçš„dfæˆ–è€…seiresçš„key</li>
<li>left_indexï¼Œright_indexï¼šä½¿ç”¨indexè€Œä¸æ˜¯æ™®é€šçš„columnåšjoin</li>
<li>suffixesï¼šä¸¤ä¸ªå…ƒç´ çš„åç¼€ï¼Œå¦‚æœåˆ—æœ‰é‡åï¼Œè‡ªåŠ¨æ·»åŠ åç¼€ï¼Œé»˜è®¤æ˜¯(&rsquo;_x&rsquo;, &lsquo;_y&rsquo;)</li>
</ul></div>
<p class="component-content component">æ–‡æ¡£åœ°å€ï¼šhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html</p>
<p class="component-content component">æœ¬æ¬¡è®²è§£æçº²ï¼š</p>
<div class="component-content component"><ol>
<li>ç”µå½±æ•°æ®é›†çš„joinå®ä¾‹</li>
<li>ç†è§£mergeæ—¶ä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šçš„æ•°é‡å¯¹é½å…³ç³»</li>
<li>ç†è§£left joinã€right joinã€inner joinã€outer joinçš„åŒºåˆ«</li>
<li>å¦‚æœå‡ºç°éKeyçš„å­—æ®µé‡åæ€ä¹ˆåŠ</li>
</ol></div>

<div class="component-content pagebody component">
  <h3 id="1ç”µå½±æ•°æ®é›†çš„joinå®ä¾‹" class="pagebody-header">
    1ã€ç”µå½±æ•°æ®é›†çš„joinå®ä¾‹
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="ç”µå½±è¯„åˆ†æ•°æ®é›†" class="pagebody-header">
    ç”µå½±è¯„åˆ†æ•°æ®é›†
  </h4>
</div><p class="component-content component">æ˜¯æ¨èç³»ç»Ÿç ”ç©¶çš„å¾ˆå¥½çš„æ•°æ®é›†
ä½äºæœ¬ä»£ç ç›®å½•ï¼š./datas/movielens-1m</p>
<p class="component-content component">åŒ…å«ä¸‰ä¸ªæ–‡ä»¶ï¼š</p>
<div class="component-content component"><ol>
<li>ç”¨æˆ·å¯¹ç”µå½±çš„è¯„åˆ†æ•°æ® ratings.dat</li>
<li>ç”¨æˆ·æœ¬èº«çš„ä¿¡æ¯æ•°æ® users.dat</li>
<li>ç”µå½±æœ¬èº«çš„æ•°æ® movies.dat</li>
</ol></div>
<p class="component-content component">å¯ä»¥å…³è”ä¸‰ä¸ªè¡¨ï¼Œå¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„å¤§è¡¨</p>
<p class="component-content component">æ•°æ®é›†å®˜æ–¹åœ°å€ï¼šhttps://grouplens.org/datasets/movielens/</p>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;./datas/movielens-1m/ratings.dat&#34;</span>, 
</span></span><span style="display:flex;"><span>    sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;::&#34;</span>,
</span></span><span style="display:flex;"><span>    engine<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;python&#39;</span>, 
</span></span><span style="display:flex;"><span>    names<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UserID::MovieID::Rating::Timestamp&#34;</span><span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;::&#34;</span>)
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_users <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;./datas/movielens-1m/users.dat&#34;</span>, 
</span></span><span style="display:flex;"><span>    sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;::&#34;</span>,
</span></span><span style="display:flex;"><span>    engine<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;python&#39;</span>, 
</span></span><span style="display:flex;"><span>    names<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UserID::Gender::Age::Occupation::Zip-code&#34;</span><span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;::&#34;</span>)
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_users<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">M</td>
<td style="text-align:right">56</td>
<td style="text-align:right">16</td>
<td style="text-align:right">70072</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">15</td>
<td style="text-align:right">55117</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">M</td>
<td style="text-align:right">45</td>
<td style="text-align:right">7</td>
<td style="text-align:right">02460</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">20</td>
<td style="text-align:right">55455</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_movies <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;./datas/movielens-1m/movies.dat&#34;</span>, 
</span></span><span style="display:flex;"><span>    sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;::&#34;</span>,
</span></span><span style="display:flex;"><span>    engine<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;python&#39;</span>, 
</span></span><span style="display:flex;"><span>    names<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;MovieID::Title::Genres&#34;</span><span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;::&#34;</span>)
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_movies<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">Father of the Bride Part II (1995)</td>
<td style="text-align:right">Comedy</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings_users <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(
</span></span><span style="display:flex;"><span>   df_ratings, df_users, left_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UserID&#34;</span>, right_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UserID&#34;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;inner&#34;</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings_users<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings_users_movies <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(
</span></span><span style="display:flex;"><span>    df_ratings_users, df_movies, left_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;MovieID&#34;</span>, right_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;MovieID&#34;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;inner&#34;</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings_users_movies<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">10</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978298413</td>
<td style="text-align:right">M</td>
<td style="text-align:right">56</td>
<td style="text-align:right">16</td>
<td style="text-align:right">70072</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978220179</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">12</td>
<td style="text-align:right">32793</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">15</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978199279</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">7</td>
<td style="text-align:right">22903</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">17</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978158471</td>
<td style="text-align:right">M</td>
<td style="text-align:right">50</td>
<td style="text-align:right">1</td>
<td style="text-align:right">95350</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">18</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978156168</td>
<td style="text-align:right">F</td>
<td style="text-align:right">18</td>
<td style="text-align:right">3</td>
<td style="text-align:right">95825</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">19</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">982730936</td>
<td style="text-align:right">M</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48073</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">24</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978136709</td>
<td style="text-align:right">F</td>
<td style="text-align:right">25</td>
<td style="text-align:right">7</td>
<td style="text-align:right">10023</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">28</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978125194</td>
<td style="text-align:right">F</td>
<td style="text-align:right">25</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14607</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">33</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978557765</td>
<td style="text-align:right">M</td>
<td style="text-align:right">45</td>
<td style="text-align:right">3</td>
<td style="text-align:right">55421</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2ç†è§£mergeæ—¶æ•°é‡çš„å¯¹é½å…³ç³»" class="pagebody-header">
    2ã€ç†è§£mergeæ—¶æ•°é‡çš„å¯¹é½å…³ç³»
  </h3>
</div><p class="component-content component">ä»¥ä¸‹å…³ç³»è¦æ­£ç¡®ç†è§£ï¼š</p>
<div class="component-content component"><ul>
<li>one-to-oneï¼šä¸€å¯¹ä¸€å…³ç³»ï¼Œå…³è”çš„keyéƒ½æ˜¯å”¯ä¸€çš„
<div class="component-content component"><ul>
<li>æ¯”å¦‚(å­¦å·ï¼Œå§“å) merge (å­¦å·ï¼Œå¹´é¾„)</li>
<li>ç»“æœæ¡æ•°ä¸ºï¼š1*1</li>
</ul></div>
</li>
<li>one-to-manyï¼šä¸€å¯¹å¤šå…³ç³»ï¼Œå·¦è¾¹å”¯ä¸€keyï¼Œå³è¾¹ä¸å”¯ä¸€key
<div class="component-content component"><ul>
<li>æ¯”å¦‚(å­¦å·ï¼Œå§“å) merge (å­¦å·ï¼Œ[è¯­æ–‡æˆç»©ã€æ•°å­¦æˆç»©ã€è‹±è¯­æˆç»©])</li>
<li>ç»“æœæ¡æ•°ä¸ºï¼š1*N</li>
</ul></div>
</li>
<li>many-to-manyï¼šå¤šå¯¹å¤šå…³ç³»ï¼Œå·¦è¾¹å³è¾¹éƒ½ä¸æ˜¯å”¯ä¸€çš„
<div class="component-content component"><ul>
<li>æ¯”å¦‚ï¼ˆå­¦å·ï¼Œ[è¯­æ–‡æˆç»©ã€æ•°å­¦æˆç»©ã€è‹±è¯­æˆç»©]ï¼‰ merge (å­¦å·ï¼Œ[ç¯®çƒã€è¶³çƒã€ä¹’ä¹“çƒ])</li>
<li>ç»“æœæ¡æ•°ä¸ºï¼šM*N</li>
</ul></div>
</li>
</ul></div>

<div class="component-content pagebody component">
  <h4 id="21-one-to-one-ä¸€å¯¹ä¸€å…³ç³»çš„merge" class="pagebody-header">
    2.1 one-to-one ä¸€å¯¹ä¸€å…³ç³»çš„merge
  </h4>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-a07d663338c59fd41d088338ea2f991e" id="lhta07d663338c59fd41d088338ea2f991e">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/4.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">In[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;name&#39;</span>: [<span style="color:#e6db74">&#39;name_a&#39;</span>, <span style="color:#e6db74">&#39;name_b&#39;</span>, <span style="color:#e6db74">&#39;name_c&#39;</span>, <span style="color:#e6db74">&#39;name_d&#39;</span>]
</span></span><span style="display:flex;"><span>                    })
</span></span><span style="display:flex;"><span>left</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">name_d</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;age&#39;</span>: [<span style="color:#e6db74">&#39;21&#39;</span>, <span style="color:#e6db74">&#39;22&#39;</span>, <span style="color:#e6db74">&#39;23&#39;</span>, <span style="color:#e6db74">&#39;24&#39;</span>]
</span></span><span style="display:flex;"><span>                    })
</span></span><span style="display:flex;"><span>right</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">age</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">21</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">23</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">24</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ä¸€å¯¹ä¸€å…³ç³»ï¼Œç»“æœä¸­æœ‰4æ¡</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sno&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
<th style="text-align:right">age</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">21</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
<td style="text-align:right">23</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">name_d</td>
<td style="text-align:right">24</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="22-one-to-many-ä¸€å¯¹å¤šå…³ç³»çš„merge" class="pagebody-header">
    2.2 one-to-many ä¸€å¯¹å¤šå…³ç³»çš„merge
  </h4>
</div><p class="component-content component">æ³¨æ„ï¼šæ•°æ®ä¼šè¢«å¤åˆ¶</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-3473a938d8a9db1b40648e0b1434fc22" id="lht3473a938d8a9db1b40648e0b1434fc22">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/5.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">In[15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;name&#39;</span>: [<span style="color:#e6db74">&#39;name_a&#39;</span>, <span style="color:#e6db74">&#39;name_b&#39;</span>, <span style="color:#e6db74">&#39;name_c&#39;</span>, <span style="color:#e6db74">&#39;name_d&#39;</span>]
</span></span><span style="display:flex;"><span>                    })
</span></span><span style="display:flex;"><span>left</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">name_d</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>],
</span></span><span style="display:flex;"><span>                       <span style="color:#e6db74">&#39;grade&#39;</span>: [<span style="color:#e6db74">&#39;è¯­æ–‡88&#39;</span>, <span style="color:#e6db74">&#39;æ•°å­¦90&#39;</span>, <span style="color:#e6db74">&#39;è‹±è¯­75&#39;</span>,<span style="color:#e6db74">&#39;è¯­æ–‡66&#39;</span>, <span style="color:#e6db74">&#39;æ•°å­¦55&#39;</span>, <span style="color:#e6db74">&#39;è‹±è¯­29&#39;</span>]
</span></span><span style="display:flex;"><span>                     })
</span></span><span style="display:flex;"><span>right</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">è¯­æ–‡88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">æ•°å­¦90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">è‹±è¯­75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">13</td>
<td style="text-align:right">è‹±è¯­29</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ•°ç›®ä»¥å¤šçš„ä¸€è¾¹ä¸ºå‡†</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sno&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">è¯­æ–‡88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">æ•°å­¦90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">è‹±è¯­75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
<td style="text-align:right">è‹±è¯­29</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="23-many-to-many-å¤šå¯¹å¤šå…³ç³»çš„merge" class="pagebody-header">
    2.3 many-to-many å¤šå¯¹å¤šå…³ç³»çš„merge
  </h4>
</div><p class="component-content component">æ³¨æ„ï¼šç»“æœæ•°é‡ä¼šå‡ºç°ä¹˜æ³•</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-533fb4ee5f8cf7384ccd8cff2ef53113" id="lht533fb4ee5f8cf7384ccd8cff2ef53113">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/6.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">12</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;çˆ±å¥½&#39;</span>: [<span style="color:#e6db74">&#39;ç¯®çƒ&#39;</span>, <span style="color:#e6db74">&#39;ç¾½æ¯›çƒ&#39;</span>, <span style="color:#e6db74">&#39;ä¹’ä¹“çƒ&#39;</span>, <span style="color:#e6db74">&#39;ç¯®çƒ&#39;</span>, <span style="color:#e6db74">&#34;è¶³çƒ&#34;</span>]
</span></span><span style="display:flex;"><span>                    })
</span></span><span style="display:flex;"><span>left</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">çˆ±å¥½</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¯®çƒ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¾½æ¯›çƒ</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ä¹’ä¹“çƒ</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ç¯®çƒ</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">è¶³çƒ</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>],
</span></span><span style="display:flex;"><span>                       <span style="color:#e6db74">&#39;grade&#39;</span>: [<span style="color:#e6db74">&#39;è¯­æ–‡88&#39;</span>, <span style="color:#e6db74">&#39;æ•°å­¦90&#39;</span>, <span style="color:#e6db74">&#39;è‹±è¯­75&#39;</span>,<span style="color:#e6db74">&#39;è¯­æ–‡66&#39;</span>, <span style="color:#e6db74">&#39;æ•°å­¦55&#39;</span>, <span style="color:#e6db74">&#39;è‹±è¯­29&#39;</span>]
</span></span><span style="display:flex;"><span>                     })
</span></span><span style="display:flex;"><span>right</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">è¯­æ–‡88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">æ•°å­¦90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">è‹±è¯­75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">13</td>
<td style="text-align:right">è‹±è¯­29</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sno&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">çˆ±å¥½</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¯®çƒ</td>
<td style="text-align:right">è¯­æ–‡88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¯®çƒ</td>
<td style="text-align:right">æ•°å­¦90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¯®çƒ</td>
<td style="text-align:right">è‹±è¯­75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¾½æ¯›çƒ</td>
<td style="text-align:right">è¯­æ–‡88</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¾½æ¯›çƒ</td>
<td style="text-align:right">æ•°å­¦90</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¾½æ¯›çƒ</td>
<td style="text-align:right">è‹±è¯­75</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ä¹’ä¹“çƒ</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ä¹’ä¹“çƒ</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ç¯®çƒ</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ç¯®çƒ</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">12</td>
<td style="text-align:right">è¶³çƒ</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">12</td>
<td style="text-align:right">è¶³çƒ</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3ç†è§£left-joinright-joininner-joinouter-joinçš„åŒºåˆ«" class="pagebody-header">
    3ã€ç†è§£left joinã€right joinã€inner joinã€outer joinçš„åŒºåˆ«
  </h3>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-453a770c447b6b88aa9a2d2c4de0b8f7" id="lht453a770c447b6b88aa9a2d2c4de0b8f7">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/7.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>, <span style="color:#e6db74">&#39;K1&#39;</span>, <span style="color:#e6db74">&#39;K2&#39;</span>, <span style="color:#e6db74">&#39;K3&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>, <span style="color:#e6db74">&#39;A1&#39;</span>, <span style="color:#e6db74">&#39;A2&#39;</span>, <span style="color:#e6db74">&#39;A3&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>, <span style="color:#e6db74">&#39;B1&#39;</span>, <span style="color:#e6db74">&#39;B2&#39;</span>, <span style="color:#e6db74">&#39;B3&#39;</span>]})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>, <span style="color:#e6db74">&#39;K1&#39;</span>, <span style="color:#e6db74">&#39;K4&#39;</span>, <span style="color:#e6db74">&#39;K5&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>, <span style="color:#e6db74">&#39;C1&#39;</span>, <span style="color:#e6db74">&#39;C4&#39;</span>, <span style="color:#e6db74">&#39;C5&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>, <span style="color:#e6db74">&#39;D1&#39;</span>, <span style="color:#e6db74">&#39;D4&#39;</span>, <span style="color:#e6db74">&#39;D5&#39;</span>]})</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">left</code></pre>
  
</div><p class="component-content component">Out[22]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>right</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="31-inner-joiné»˜è®¤" class="pagebody-header">
    3.1 inner joinï¼Œé»˜è®¤
  </h4>
</div><p class="component-content component">å·¦è¾¹å’Œå³è¾¹çš„keyéƒ½æœ‰ï¼Œæ‰ä¼šå‡ºç°åœ¨ç»“æœé‡Œ</p>
<p class="component-content component">In [24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[24]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="32-left-join" class="pagebody-header">
    3.2 left join
  </h4>
</div><p class="component-content component">å·¦è¾¹çš„éƒ½ä¼šå‡ºç°åœ¨ç»“æœé‡Œï¼Œå³è¾¹çš„å¦‚æœæ— æ³•åŒ¹é…åˆ™ä¸ºNull</p>
<p class="component-content component">In [25]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[25]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="33-right-join" class="pagebody-header">
    3.3 right join
  </h4>
</div><p class="component-content component">å³è¾¹çš„éƒ½ä¼šå‡ºç°åœ¨ç»“æœé‡Œï¼Œå·¦è¾¹çš„å¦‚æœæ— æ³•åŒ¹é…åˆ™ä¸ºNull</p>
<p class="component-content component">In [26]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;right&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[26]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="34-outer-join" class="pagebody-header">
    3.4 outer join
  </h4>
</div><p class="component-content component">å·¦è¾¹ã€å³è¾¹çš„éƒ½ä¼šå‡ºç°åœ¨ç»“æœé‡Œï¼Œå¦‚æœæ— æ³•åŒ¹é…åˆ™ä¸ºNull</p>
<p class="component-content component">In [27]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[27]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="4å¦‚æœå‡ºç°ékeyçš„å­—æ®µé‡åæ€ä¹ˆåŠ" class="pagebody-header">
    4ã€å¦‚æœå‡ºç°éKeyçš„å­—æ®µé‡åæ€ä¹ˆåŠ
  </h3>
</div><p class="component-content component">In [28]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>, <span style="color:#e6db74">&#39;K1&#39;</span>, <span style="color:#e6db74">&#39;K2&#39;</span>, <span style="color:#e6db74">&#39;K3&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>, <span style="color:#e6db74">&#39;A1&#39;</span>, <span style="color:#e6db74">&#39;A2&#39;</span>, <span style="color:#e6db74">&#39;A3&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>, <span style="color:#e6db74">&#39;B1&#39;</span>, <span style="color:#e6db74">&#39;B2&#39;</span>, <span style="color:#e6db74">&#39;B3&#39;</span>]})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>, <span style="color:#e6db74">&#39;K1&#39;</span>, <span style="color:#e6db74">&#39;K4&#39;</span>, <span style="color:#e6db74">&#39;K5&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A10&#39;</span>, <span style="color:#e6db74">&#39;A11&#39;</span>, <span style="color:#e6db74">&#39;A12&#39;</span>, <span style="color:#e6db74">&#39;A13&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>, <span style="color:#e6db74">&#39;D1&#39;</span>, <span style="color:#e6db74">&#39;D4&#39;</span>, <span style="color:#e6db74">&#39;D5&#39;</span>]})</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [29]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[29]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [30]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>right</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[30]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A10</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A11</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">A12</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">A13</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [31]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[31]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A_x</th>
<th style="text-align:right">B</th>
<th style="text-align:right">A_y</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">A10</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">A11</td>
<td style="text-align:right">D1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [32]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key&#39;</span>, suffixes<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#39;_left&#39;</span>, <span style="color:#e6db74">&#39;_right&#39;</span>))</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[32]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A_left</th>
<th style="text-align:right">B</th>
<th style="text-align:right">A_right</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">A10</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">A11</td>
<td style="text-align:right">D1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="14pandaså®ç°æ•°æ®çš„åˆå¹¶concat" class="pagebody-header">
    14ã€Pandaså®ç°æ•°æ®çš„åˆå¹¶concat
  </h1>
</div>
<div class="component-content pagebody component">
  <h4 id="ä½¿ç”¨åœºæ™¯" class="pagebody-header">
    ä½¿ç”¨åœºæ™¯ï¼š
  </h4>
</div><p class="component-content component">æ‰¹é‡åˆå¹¶ç›¸åŒæ ¼å¼çš„Excelã€ç»™DataFrameæ·»åŠ è¡Œã€ç»™DataFrameæ·»åŠ åˆ—</p>

<div class="component-content pagebody component">
  <h4 id="ä¸€å¥è¯è¯´æ˜concatè¯­æ³•" class="pagebody-header">
    ä¸€å¥è¯è¯´æ˜concatè¯­æ³•ï¼š
  </h4>
</div><div class="component-content component"><ul>
<li>ä½¿ç”¨æŸç§åˆå¹¶æ–¹å¼(inner/outer)</li>
<li>æ²¿ç€æŸä¸ªè½´å‘(axis=0/1)</li>
<li>æŠŠå¤šä¸ªPandaså¯¹è±¡(DataFrame/Series)åˆå¹¶æˆä¸€ä¸ªã€‚</li>
</ul></div>

<div class="component-content pagebody component">
  <h4 id="concatè¯­æ³•pandasconcatobjs-axis0-joinouter-ignore_indexfalse" class="pagebody-header">
    concatè¯­æ³•ï¼špandas.concat(objs, axis=0, join=&lsquo;outer&rsquo;, ignore_index=False)
  </h4>
</div><div class="component-content component"><ul>
<li>objsï¼šä¸€ä¸ªåˆ—è¡¨ï¼Œå†…å®¹å¯ä»¥æ˜¯DataFrameæˆ–è€…Seriesï¼Œå¯ä»¥æ··åˆ</li>
<li>axisï¼šé»˜è®¤æ˜¯0ä»£è¡¨æŒ‰è¡Œåˆå¹¶ï¼Œå¦‚æœç­‰äº1ä»£è¡¨æŒ‰åˆ—åˆå¹¶</li>
<li>joinï¼šåˆå¹¶çš„æ—¶å€™ç´¢å¼•çš„å¯¹é½æ–¹å¼ï¼Œé»˜è®¤æ˜¯outer joinï¼Œä¹Ÿå¯ä»¥æ˜¯inner join</li>
<li>ignore_indexï¼šæ˜¯å¦å¿½ç•¥æ‰åŸæ¥çš„æ•°æ®ç´¢å¼•</li>
</ul></div>

<div class="component-content pagebody component">
  <h4 id="appendè¯­æ³•dataframeappendother-ignore_indexfalse" class="pagebody-header">
    appendè¯­æ³•ï¼šDataFrame.append(other, ignore_index=False)
  </h4>
</div><p class="component-content component">appendåªæœ‰æŒ‰è¡Œåˆå¹¶ï¼Œæ²¡æœ‰æŒ‰åˆ—åˆå¹¶ï¼Œç›¸å½“äºconcatæŒ‰è¡Œçš„ç®€å†™å½¢å¼</p>
<div class="component-content component"><ul>
<li>otherï¼šå•ä¸ªdataframeã€seriesã€dictï¼Œæˆ–è€…åˆ—è¡¨</li>
<li>ignore_indexï¼šæ˜¯å¦å¿½ç•¥æ‰åŸæ¥çš„æ•°æ®ç´¢å¼•</li>
</ul></div>

<div class="component-content pagebody component">
  <h4 id="å‚è€ƒæ–‡æ¡£" class="pagebody-header">
    å‚è€ƒæ–‡æ¡£ï¼š
  </h4>
</div><div class="component-content component"><ul>
<li>pandas.concatçš„apiæ–‡æ¡£ï¼šhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html</li>
<li>pandas.concatçš„æ•™ç¨‹ï¼šhttps://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html</li>
<li>pandas.appendçš„apiæ–‡æ¡£ï¼šhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html</li>
</ul></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> warnings
</span></span><span style="display:flex;"><span>warnings<span style="color:#f92672">.</span>filterwarnings(<span style="color:#e6db74">&#39;ignore&#39;</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="ä¸€ä½¿ç”¨pandasconcatåˆå¹¶æ•°æ®" class="pagebody-header">
    ä¸€ã€ä½¿ç”¨pandas.concatåˆå¹¶æ•°æ®
  </h3>
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>, <span style="color:#e6db74">&#39;A1&#39;</span>, <span style="color:#e6db74">&#39;A2&#39;</span>, <span style="color:#e6db74">&#39;A3&#39;</span>],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>, <span style="color:#e6db74">&#39;B1&#39;</span>, <span style="color:#e6db74">&#39;B2&#39;</span>, <span style="color:#e6db74">&#39;B3&#39;</span>],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>, <span style="color:#e6db74">&#39;C1&#39;</span>, <span style="color:#e6db74">&#39;C2&#39;</span>, <span style="color:#e6db74">&#39;C3&#39;</span>],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>, <span style="color:#e6db74">&#39;D1&#39;</span>, <span style="color:#e6db74">&#39;D2&#39;</span>, <span style="color:#e6db74">&#39;D3&#39;</span>],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;E&#39;</span>: [<span style="color:#e6db74">&#39;E0&#39;</span>, <span style="color:#e6db74">&#39;E1&#39;</span>, <span style="color:#e6db74">&#39;E2&#39;</span>, <span style="color:#e6db74">&#39;E3&#39;</span>]
</span></span><span style="display:flex;"><span>                   })
</span></span><span style="display:flex;"><span>df1</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({ <span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A4&#39;</span>, <span style="color:#e6db74">&#39;A5&#39;</span>, <span style="color:#e6db74">&#39;A6&#39;</span>, <span style="color:#e6db74">&#39;A7&#39;</span>],
</span></span><span style="display:flex;"><span>                     <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B4&#39;</span>, <span style="color:#e6db74">&#39;B5&#39;</span>, <span style="color:#e6db74">&#39;B6&#39;</span>, <span style="color:#e6db74">&#39;B7&#39;</span>],
</span></span><span style="display:flex;"><span>                     <span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C4&#39;</span>, <span style="color:#e6db74">&#39;C5&#39;</span>, <span style="color:#e6db74">&#39;C6&#39;</span>, <span style="color:#e6db74">&#39;C7&#39;</span>],
</span></span><span style="display:flex;"><span>                     <span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D4&#39;</span>, <span style="color:#e6db74">&#39;D5&#39;</span>, <span style="color:#e6db74">&#39;D6&#39;</span>, <span style="color:#e6db74">&#39;D7&#39;</span>],
</span></span><span style="display:flex;"><span>                     <span style="color:#e6db74">&#39;F&#39;</span>: [<span style="color:#e6db74">&#39;F4&#39;</span>, <span style="color:#e6db74">&#39;F5&#39;</span>, <span style="color:#e6db74">&#39;F6&#39;</span>, <span style="color:#e6db74">&#39;F7&#39;</span>]
</span></span><span style="display:flex;"><span>                   })
</span></span><span style="display:flex;"><span>df2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
<td style="text-align:right">F4</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
<td style="text-align:right">F5</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
<td style="text-align:right">F6</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">F7</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>1ã€é»˜è®¤çš„concatï¼Œå‚æ•°ä¸ºaxis=0ã€join=outerã€ignore_index=False*</strong></p>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1,df2])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F4</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F5</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F6</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F7</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>2ã€ä½¿ç”¨ignore_index=Trueå¯ä»¥å¿½ç•¥åŸæ¥çš„ç´¢å¼•*</strong></p>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1,df2], ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F5</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F6</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F7</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>3ã€ä½¿ç”¨join=innerè¿‡æ»¤æ‰ä¸åŒ¹é…çš„åˆ—*</strong></p>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1,df2], ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, join<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;inner&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>4ã€ä½¿ç”¨axis=1ç›¸å½“äºæ·»åŠ æ–°åˆ—*</strong></p>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>Aï¼šæ·»åŠ ä¸€åˆ—Series*</strong></p>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(list(range(<span style="color:#ae81ff">4</span>)), name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;F&#34;</span>)
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1,s1], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>Bï¼šæ·»åŠ å¤šåˆ—Series*</strong></p>
<p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s2 <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x:x[<span style="color:#e6db74">&#34;A&#34;</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;_GG&#34;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>    A0_GG
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    A1_GG
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    A2_GG
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    A3_GG
</span></span><span style="display:flex;"><span>dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s2<span style="color:#f92672">.</span>name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;G&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1,s1,s2], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
<th style="text-align:right">G</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A0_GG</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">A1_GG</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">A2_GG</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">A3_GG</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># åˆ—è¡¨å¯ä»¥åªæœ‰Series</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([s1,s2], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">F</th>
<th style="text-align:right">G</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A0_GG</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">A1_GG</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">A2_GG</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">A3_GG</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># åˆ—è¡¨æ˜¯å¯ä»¥æ··åˆé¡ºåºçš„</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([s1,df1,s2], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">F</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">G</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">A0_GG</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">A1_GG</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">A2_GG</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">A3_GG</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="äºŒä½¿ç”¨dataframeappendæŒ‰è¡Œåˆå¹¶æ•°æ®" class="pagebody-header">
    äºŒã€ä½¿ç”¨DataFrame.appendæŒ‰è¡Œåˆå¹¶æ•°æ®
  </h3>
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>]], columns<span style="color:#f92672">=</span>list(<span style="color:#e6db74">&#39;AB&#39;</span>))
</span></span><span style="display:flex;"><span>df1</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([[<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>], [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>]], columns<span style="color:#f92672">=</span>list(<span style="color:#e6db74">&#39;AB&#39;</span>))
</span></span><span style="display:flex;"><span>df2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>1ã€ç»™1ä¸ªdataframeæ·»åŠ å¦ä¸€ä¸ªdataframe*</strong></p>
<p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1<span style="color:#f92672">.</span>append(df2)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>2ã€å¿½ç•¥åŸæ¥çš„ç´¢å¼•ignore_index=True*</strong></p>
<p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1<span style="color:#f92672">.</span>append(df2, ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>3ã€å¯ä»¥ä¸€è¡Œä¸€è¡Œçš„ç»™DataFrameæ·»åŠ æ•°æ®*</strong></p>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ä¸€ä¸ªç©ºçš„df</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;A&#39;</span>])
</span></span><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>Aï¼šä½æ€§èƒ½ç‰ˆæœ¬*</strong></p>
<p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># æ³¨æ„è¿™é‡Œæ¯æ¬¡éƒ½åœ¨å¤åˆ¶</span>
</span></span><span style="display:flex;"><span>    df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>append({<span style="color:#e6db74">&#39;A&#39;</span>: i}, ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>Bï¼šæ€§èƒ½å¥½çš„ç‰ˆæœ¬*</strong></p>
<p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ç¬¬ä¸€ä¸ªå…¥å‚æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œé¿å…äº†å¤šæ¬¡å¤åˆ¶</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat(
</span></span><span style="display:flex;"><span>    [pd<span style="color:#f92672">.</span>DataFrame([i], columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;A&#39;</span>]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>)],
</span></span><span style="display:flex;"><span>    ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="15pandasæ‰¹é‡æ‹†åˆ†excelä¸åˆå¹¶excel" class="pagebody-header">
    15ã€Pandasæ‰¹é‡æ‹†åˆ†Excelä¸åˆå¹¶Excel
  </h1>
</div><p class="component-content component">å®ä¾‹æ¼”ç¤ºï¼š</p>
<div class="component-content component"><ol>
<li>å°†ä¸€ä¸ªå¤§Excelç­‰ä»½æ‹†æˆå¤šä¸ªExcel</li>
<li>å°†å¤šä¸ªå°Excelåˆå¹¶æˆä¸€ä¸ªå¤§Excelå¹¶æ ‡è®°æ¥æº</li>
</ol></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>work_dir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;./course_datas/c15_excel_split_merge&#34;</span>
</span></span><span style="display:flex;"><span>splits_dir<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>work_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/splits&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>exists(splits_dir):
</span></span><span style="display:flex;"><span>    os<span style="color:#f92672">.</span>mkdir(splits_dir)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="0è¯»å–æºexcelåˆ°pandas" class="pagebody-header">
    0ã€è¯»å–æºExcelåˆ°Pandas
  </h3>
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_source <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>work_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/crazyant_blog_articles_source.xlsx&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_source<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">id</th>
<th style="text-align:right">title</th>
<th style="text-align:right">tags</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2585</td>
<td style="text-align:right">Tensorflowæ€æ ·æ¥æ”¶å˜é•¿åˆ—è¡¨ç‰¹å¾</td>
<td style="text-align:right">python,tensorflow,ç‰¹å¾å·¥ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2583</td>
<td style="text-align:right">Pandaså®ç°æ•°æ®çš„åˆå¹¶concat</td>
<td style="text-align:right">pandas,python,æ•°æ®åˆ†æ</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2574</td>
<td style="text-align:right">Pandasçš„Indexç´¢å¼•æœ‰ä»€ä¹ˆç”¨é€”ï¼Ÿ</td>
<td style="text-align:right">pandas,python,æ•°æ®åˆ†æ</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2564</td>
<td style="text-align:right">æœºå™¨å­¦ä¹ å¸¸ç”¨æ•°æ®é›†å¤§å…¨</td>
<td style="text-align:right">python,æœºå™¨å­¦ä¹ </td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2561</td>
<td style="text-align:right">ä¸€ä¸ªæ•°æ®ç§‘å­¦å®¶çš„ä¿®ç‚¼è·¯å¾„</td>
<td style="text-align:right">æ•°æ®åˆ†æ</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_source<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RangeIndex(start<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, stop<span style="color:#f92672">=</span><span style="color:#ae81ff">258</span>, step<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_source<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">258</span>, <span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>total_row_count <span style="color:#f92672">=</span> df_source<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>total_row_count</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">258</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="ä¸€å°†ä¸€ä¸ªå¤§excelç­‰ä»½æ‹†æˆå¤šä¸ªexcel" class="pagebody-header">
    ä¸€ã€å°†ä¸€ä¸ªå¤§Excelç­‰ä»½æ‹†æˆå¤šä¸ªExcel
  </h3>
</div><div class="component-content component"><ol>
<li>ä½¿ç”¨df.ilocæ–¹æ³•ï¼Œå°†ä¸€ä¸ªå¤§çš„dataframeï¼Œæ‹†åˆ†æˆå¤šä¸ªå°dataframe</li>
<li>å°†ä½¿ç”¨dataframe.to_excelä¿å­˜æ¯ä¸ªå°Excel</li>
</ol></div>

<div class="component-content pagebody component">
  <h4 id="1è®¡ç®—æ‹†åˆ†åçš„æ¯ä¸ªexcelçš„è¡Œæ•°" class="pagebody-header">
    1ã€è®¡ç®—æ‹†åˆ†åçš„æ¯ä¸ªexcelçš„è¡Œæ•°
  </h4>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># è¿™ä¸ªå¤§excelï¼Œä¼šæ‹†åˆ†ç»™è¿™å‡ ä¸ªäºº</span>
</span></span><span style="display:flex;"><span>user_names <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;xiao_shuai&#34;</span>, <span style="color:#e6db74">&#34;xiao_wang&#34;</span>, <span style="color:#e6db74">&#34;xiao_ming&#34;</span>, <span style="color:#e6db74">&#34;xiao_lei&#34;</span>, <span style="color:#e6db74">&#34;xiao_bo&#34;</span>, <span style="color:#e6db74">&#34;xiao_hong&#34;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ¯ä¸ªäººçš„ä»»åŠ¡æ•°ç›®</span>
</span></span><span style="display:flex;"><span>split_size <span style="color:#f92672">=</span> total_row_count <span style="color:#f92672">//</span> len(user_names)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> total_row_count <span style="color:#f92672">%</span> len(user_names) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    split_size <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>split_size</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">43</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="2æ‹†åˆ†æˆå¤šä¸ªdataframe" class="pagebody-header">
    2ã€æ‹†åˆ†æˆå¤šä¸ªdataframe
  </h4>
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_subs <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> idx, user_name <span style="color:#f92672">in</span> enumerate(user_names):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ilocçš„å¼€å§‹ç´¢å¼•</span>
</span></span><span style="display:flex;"><span>    begin <span style="color:#f92672">=</span> idx<span style="color:#f92672">*</span>split_size
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ilocçš„ç»“æŸç´¢å¼•</span>
</span></span><span style="display:flex;"><span>    end <span style="color:#f92672">=</span> begin<span style="color:#f92672">+</span>split_size
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å®ç°dfæŒ‰ç…§ilocæ‹†åˆ†</span>
</span></span><span style="display:flex;"><span>    df_sub <span style="color:#f92672">=</span> df_source<span style="color:#f92672">.</span>iloc[begin:end]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å°†æ¯ä¸ªå­dfå­˜å…¥åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>    df_subs<span style="color:#f92672">.</span>append((idx, user_name, df_sub))</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="3å°†æ¯ä¸ªdatafameå­˜å…¥excel" class="pagebody-header">
    3ã€å°†æ¯ä¸ªdatafameå­˜å…¥excel
  </h4>
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> idx, user_name, df_sub <span style="color:#f92672">in</span> df_subs:
</span></span><span style="display:flex;"><span>    file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>splits_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/crazyant_blog_articles_</span><span style="color:#e6db74">{</span>idx<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">{</span>user_name<span style="color:#e6db74">}</span><span style="color:#e6db74">.xlsx&#34;</span>
</span></span><span style="display:flex;"><span>    df_sub<span style="color:#f92672">.</span>to_excel(file_name, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="äºŒåˆå¹¶å¤šä¸ªå°excelåˆ°ä¸€ä¸ªå¤§excel" class="pagebody-header">
    äºŒã€åˆå¹¶å¤šä¸ªå°Excelåˆ°ä¸€ä¸ªå¤§Excel
  </h3>
</div><div class="component-content component"><ol>
<li>éå†æ–‡ä»¶å¤¹ï¼Œå¾—åˆ°è¦åˆå¹¶çš„Excelæ–‡ä»¶åˆ—è¡¨</li>
<li>åˆ†åˆ«è¯»å–åˆ°dataframeï¼Œç»™æ¯ä¸ªdfæ·»åŠ ä¸€åˆ—ç”¨äºæ ‡è®°æ¥æº</li>
<li>ä½¿ç”¨pd.concatè¿›è¡Œdfæ‰¹é‡åˆå¹¶</li>
<li>å°†åˆå¹¶åçš„dataframeè¾“å‡ºåˆ°excel</li>
</ol></div>

<div class="component-content pagebody component">
  <h4 id="1-éå†æ–‡ä»¶å¤¹å¾—åˆ°è¦åˆå¹¶çš„excelåç§°åˆ—è¡¨" class="pagebody-header">
    1. éå†æ–‡ä»¶å¤¹ï¼Œå¾—åˆ°è¦åˆå¹¶çš„Excelåç§°åˆ—è¡¨
  </h4>
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>excel_names <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> excel_name <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(splits_dir):
</span></span><span style="display:flex;"><span>    excel_names<span style="color:#f92672">.</span>append(excel_name)
</span></span><span style="display:flex;"><span>excel_names</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;crazyant_blog_articles_0_xiao_shuai.xlsx&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;crazyant_blog_articles_1_xiao_wang.xlsx&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;crazyant_blog_articles_2_xiao_ming.xlsx&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;crazyant_blog_articles_3_xiao_lei.xlsx&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;crazyant_blog_articles_4_xiao_bo.xlsx&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;crazyant_blog_articles_5_xiao_hong.xlsx&#39;</span>]</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="2-åˆ†åˆ«è¯»å–åˆ°dataframe" class="pagebody-header">
    2. åˆ†åˆ«è¯»å–åˆ°dataframe
  </h4>
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_list <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> excel_name <span style="color:#f92672">in</span> excel_names:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># è¯»å–æ¯ä¸ªexcelåˆ°df</span>
</span></span><span style="display:flex;"><span>    excel_path <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>splits_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>excel_name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    df_split <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(excel_path)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å¾—åˆ°username</span>
</span></span><span style="display:flex;"><span>    username <span style="color:#f92672">=</span> excel_name<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;crazyant_blog_articles_&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;.xlsx&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)[<span style="color:#ae81ff">2</span>:]
</span></span><span style="display:flex;"><span>    print(excel_name, username)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç»™æ¯ä¸ªdfæ·»åŠ 1åˆ—ï¼Œå³ç”¨æˆ·åå­—</span>
</span></span><span style="display:flex;"><span>    df_split[<span style="color:#e6db74">&#34;username&#34;</span>] <span style="color:#f92672">=</span> username
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    df_list<span style="color:#f92672">.</span>append(df_split)
</span></span><span style="display:flex;"><span>crazyant_blog_articles_0_xiao_shuai<span style="color:#f92672">.</span>xlsx xiao_shuai
</span></span><span style="display:flex;"><span>crazyant_blog_articles_1_xiao_wang<span style="color:#f92672">.</span>xlsx xiao_wang
</span></span><span style="display:flex;"><span>crazyant_blog_articles_2_xiao_ming<span style="color:#f92672">.</span>xlsx xiao_ming
</span></span><span style="display:flex;"><span>crazyant_blog_articles_3_xiao_lei<span style="color:#f92672">.</span>xlsx xiao_lei
</span></span><span style="display:flex;"><span>crazyant_blog_articles_4_xiao_bo<span style="color:#f92672">.</span>xlsx xiao_bo
</span></span><span style="display:flex;"><span>crazyant_blog_articles_5_xiao_hong<span style="color:#f92672">.</span>xlsx xiao_hong</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="3-ä½¿ç”¨pdconcatè¿›è¡Œåˆå¹¶" class="pagebody-header">
    3. ä½¿ç”¨pd.concatè¿›è¡Œåˆå¹¶
  </h4>
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(df_list)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">258</span>, <span style="color:#ae81ff">4</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">id</th>
<th style="text-align:right">title</th>
<th style="text-align:right">tags</th>
<th style="text-align:right">username</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2585</td>
<td style="text-align:right">Tensorflowæ€æ ·æ¥æ”¶å˜é•¿åˆ—è¡¨ç‰¹å¾</td>
<td style="text-align:right">python,tensorflow,ç‰¹å¾å·¥ç¨‹</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2583</td>
<td style="text-align:right">Pandaså®ç°æ•°æ®çš„åˆå¹¶concat</td>
<td style="text-align:right">pandas,python,æ•°æ®åˆ†æ</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2574</td>
<td style="text-align:right">Pandasçš„Indexç´¢å¼•æœ‰ä»€ä¹ˆç”¨é€”ï¼Ÿ</td>
<td style="text-align:right">pandas,python,æ•°æ®åˆ†æ</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2564</td>
<td style="text-align:right">æœºå™¨å­¦ä¹ å¸¸ç”¨æ•°æ®é›†å¤§å…¨</td>
<td style="text-align:right">python,æœºå™¨å­¦ä¹ </td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2561</td>
<td style="text-align:right">ä¸€ä¸ªæ•°æ®ç§‘å­¦å®¶çš„ä¿®ç‚¼è·¯å¾„</td>
<td style="text-align:right">æ•°æ®åˆ†æ</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged[<span style="color:#e6db74">&#34;username&#34;</span>]<span style="color:#f92672">.</span>value_counts()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>xiao_hong     <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>xiao_bo       <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>xiao_shuai    <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>xiao_lei      <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>xiao_wang     <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>xiao_ming     <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>Name: username, dtype: int64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="4-å°†åˆå¹¶åçš„dataframeè¾“å‡ºåˆ°excel" class="pagebody-header">
    4. å°†åˆå¹¶åçš„dataframeè¾“å‡ºåˆ°excel
  </h4>
</div><p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>work_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/crazyant_blog_articles_merged.xlsx&#34;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="16pandasæ€æ ·å®ç°groupbyåˆ†ç»„ç»Ÿè®¡" class="pagebody-header">
    16ã€Pandasæ€æ ·å®ç°groupbyåˆ†ç»„ç»Ÿè®¡
  </h1>
</div><p class="component-content component">ç±»ä¼¼SQLï¼š
select city,max(temperature) from city_weather group by city;</p>
<p class="component-content component">groupbyï¼šå…ˆå¯¹æ•°æ®åˆ†ç»„ï¼Œç„¶ååœ¨æ¯ä¸ªåˆ†ç»„ä¸Šåº”ç”¨èšåˆå‡½æ•°ã€è½¬æ¢å‡½æ•°</p>
<p class="component-content component">æœ¬æ¬¡æ¼”ç¤ºï¼š
ä¸€ã€åˆ†ç»„ä½¿ç”¨èšåˆå‡½æ•°åšæ•°æ®ç»Ÿè®¡
äºŒã€éå†groupbyçš„ç»“æœç†è§£æ‰§è¡Œæµç¨‹
ä¸‰ã€å®ä¾‹åˆ†ç»„æ¢ç´¢å¤©æ°”æ•°æ®</p>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŠ ä¸Šè¿™ä¸€å¥ï¼Œèƒ½åœ¨jupyter notebookå±•ç¤ºmatplotå›¾è¡¨</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;foo&#39;</span>],
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;one&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>, <span style="color:#e6db74">&#39;three&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>, <span style="color:#e6db74">&#39;three&#39;</span>],
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;C&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">8</span>),
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;D&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">8</span>)})
</span></span><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">0.542903</td>
<td style="text-align:right">0.788896</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.903407</td>
<td style="text-align:right">0.428031</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-1.093602</td>
<td style="text-align:right">0.837348</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.665189</td>
<td style="text-align:right">-1.505290</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-0.498339</td>
<td style="text-align:right">0.534438</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="ä¸€åˆ†ç»„ä½¿ç”¨èšåˆå‡½æ•°åšæ•°æ®ç»Ÿè®¡" class="pagebody-header">
    ä¸€ã€åˆ†ç»„ä½¿ç”¨èšåˆå‡½æ•°åšæ•°æ®ç»Ÿè®¡
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="1å•ä¸ªåˆ—groupbyæŸ¥è¯¢æ‰€æœ‰æ•°æ®åˆ—çš„ç»Ÿè®¡" class="pagebody-header">
    1ã€å•ä¸ªåˆ—groupbyï¼ŒæŸ¥è¯¢æ‰€æœ‰æ•°æ®åˆ—çš„ç»Ÿè®¡
  </h4>
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)<span style="color:#f92672">.</span>sum()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">0.436595</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">1.083423</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">æˆ‘ä»¬çœ‹åˆ°ï¼š</p>
<div class="component-content component"><ol>
<li>groupbyä¸­çš„&rsquo;A&rsquo;å˜æˆäº†æ•°æ®çš„ç´¢å¼•åˆ—</li>
<li>å› ä¸ºè¦ç»Ÿè®¡sumï¼Œä½†Båˆ—ä¸æ˜¯æ•°å­—ï¼Œæ‰€ä»¥è¢«è‡ªåŠ¨å¿½ç•¥æ‰</li>
</ol></div>

<div class="component-content pagebody component">
  <h4 id="2å¤šä¸ªåˆ—groupbyæŸ¥è¯¢æ‰€æœ‰æ•°æ®åˆ—çš„ç»Ÿè®¡" class="pagebody-header">
    2ã€å¤šä¸ªåˆ—groupbyï¼ŒæŸ¥è¯¢æ‰€æœ‰æ•°æ®åˆ—çš„ç»Ÿè®¡
  </h4>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>])<span style="color:#f92672">.</span>mean()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right">B</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.061143</td>
<td style="text-align:right">-0.358197</td>
</tr>
<tr>
<td style="text-align:right">three</td>
<td style="text-align:right">-0.498339</td>
<td style="text-align:right">0.534438</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.998504</td>
<td style="text-align:right">0.632690</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">æˆ‘ä»¬çœ‹åˆ°ï¼š(&lsquo;A&rsquo;,&lsquo;B&rsquo;)æˆå¯¹å˜æˆäº†äºŒçº§ç´¢å¼•</p>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>], as_index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>mean()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.061143</td>
<td style="text-align:right">-0.358197</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-0.498339</td>
<td style="text-align:right">0.534438</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.998504</td>
<td style="text-align:right">0.632690</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="3åŒæ—¶æŸ¥çœ‹å¤šç§æ•°æ®ç»Ÿè®¡" class="pagebody-header">
    3ã€åŒæ—¶æŸ¥çœ‹å¤šç§æ•°æ®ç»Ÿè®¡
  </h4>
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)<span style="color:#f92672">.</span>agg([np<span style="color:#f92672">.</span>sum, np<span style="color:#f92672">.</span>mean, np<span style="color:#f92672">.</span>std])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right">sum</td>
<td style="text-align:right">mean</td>
<td style="text-align:right">std</td>
<td style="text-align:right">sum</td>
<td style="text-align:right">mean</td>
<td style="text-align:right">std</td>
</tr>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">-0.714313</td>
<td style="text-align:right">0.741583</td>
<td style="text-align:right">0.436595</td>
<td style="text-align:right">0.145532</td>
<td style="text-align:right">0.526544</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">-0.523527</td>
<td style="text-align:right">0.637822</td>
<td style="text-align:right">1.083423</td>
<td style="text-align:right">0.216685</td>
<td style="text-align:right">0.977686</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">æˆ‘ä»¬çœ‹åˆ°ï¼šåˆ—å˜æˆäº†å¤šçº§ç´¢å¼•</p>

<div class="component-content pagebody component">
  <h4 id="4æŸ¥çœ‹å•åˆ—çš„ç»“æœæ•°æ®ç»Ÿè®¡" class="pagebody-header">
    4ã€æŸ¥çœ‹å•åˆ—çš„ç»“æœæ•°æ®ç»Ÿè®¡
  </h4>
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ–¹æ³•1ï¼šé¢„è¿‡æ»¤ï¼Œæ€§èƒ½æ›´å¥½</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)[<span style="color:#e6db74">&#39;C&#39;</span>]<span style="color:#f92672">.</span>agg([np<span style="color:#f92672">.</span>sum, np<span style="color:#f92672">.</span>mean, np<span style="color:#f92672">.</span>std])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sum</th>
<th style="text-align:right">mean</th>
<th style="text-align:right">std</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">-0.714313</td>
<td style="text-align:right">0.741583</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">-0.523527</td>
<td style="text-align:right">0.637822</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ–¹æ³•2</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)<span style="color:#f92672">.</span>agg([np<span style="color:#f92672">.</span>sum, np<span style="color:#f92672">.</span>mean, np<span style="color:#f92672">.</span>std])[<span style="color:#e6db74">&#39;C&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sum</th>
<th style="text-align:right">mean</th>
<th style="text-align:right">std</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">-0.714313</td>
<td style="text-align:right">0.741583</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">-0.523527</td>
<td style="text-align:right">0.637822</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="5ä¸åŒåˆ—ä½¿ç”¨ä¸åŒçš„èšåˆå‡½æ•°" class="pagebody-header">
    5ã€ä¸åŒåˆ—ä½¿ç”¨ä¸åŒçš„èšåˆå‡½æ•°
  </h4>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#34;C&#34;</span>:np<span style="color:#f92672">.</span>sum, <span style="color:#e6db74">&#34;D&#34;</span>:np<span style="color:#f92672">.</span>mean})</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">0.145532</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">0.216685</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="äºŒéå†groupbyçš„ç»“æœç†è§£æ‰§è¡Œæµç¨‹" class="pagebody-header">
    äºŒã€éå†groupbyçš„ç»“æœç†è§£æ‰§è¡Œæµç¨‹
  </h3>
</div><p class="component-content component">forå¾ªç¯å¯ä»¥ç›´æ¥éå†æ¯ä¸ªgroup</p>

<div class="component-content pagebody component">
  <h5 id="1éå†å•ä¸ªåˆ—èšåˆçš„åˆ†ç»„" class="pagebody-header">
    1ã€éå†å•ä¸ªåˆ—èšåˆçš„åˆ†ç»„
  </h5>
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)
</span></span><span style="display:flex;"><span>g</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>pandas<span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>groupby<span style="color:#f92672">.</span>generic<span style="color:#f92672">.</span>DataFrameGroupBy object at <span style="color:#ae81ff">0x00000123B250E548</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> name,group <span style="color:#f92672">in</span> g:
</span></span><span style="display:flex;"><span>    print(name)
</span></span><span style="display:flex;"><span>    print(group)
</span></span><span style="display:flex;"><span>    print()
</span></span><span style="display:flex;"><span>bar
</span></span><span style="display:flex;"><span>     A      B         C         D
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>  bar    one <span style="color:#f92672">-</span><span style="color:#ae81ff">0.375789</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.345869</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>  bar  three <span style="color:#f92672">-</span><span style="color:#ae81ff">1.564748</span>  <span style="color:#ae81ff">0.081163</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>  bar    two <span style="color:#f92672">-</span><span style="color:#ae81ff">0.202403</span>  <span style="color:#ae81ff">0.701301</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>foo
</span></span><span style="display:flex;"><span>     A      B         C         D
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span>  foo    one  <span style="color:#ae81ff">0.542903</span>  <span style="color:#ae81ff">0.788896</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>  foo    two <span style="color:#f92672">-</span><span style="color:#ae81ff">0.903407</span>  <span style="color:#ae81ff">0.428031</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>  foo    two <span style="color:#f92672">-</span><span style="color:#ae81ff">1.093602</span>  <span style="color:#ae81ff">0.837348</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  foo    one <span style="color:#f92672">-</span><span style="color:#ae81ff">0.665189</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.505290</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>  foo  three <span style="color:#f92672">-</span><span style="color:#ae81ff">0.498339</span>  <span style="color:#ae81ff">0.534438</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">*<strong>å¯ä»¥è·å–å•ä¸ªåˆ†ç»„çš„æ•°æ®*</strong></p>
<p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g<span style="color:#f92672">.</span>get_group(<span style="color:#e6db74">&#39;bar&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h5 id="2éå†å¤šä¸ªåˆ—èšåˆçš„åˆ†ç»„" class="pagebody-header">
    2ã€éå†å¤šä¸ªåˆ—èšåˆçš„åˆ†ç»„
  </h5>
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;B&#39;</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">for name,group in g:
    print(name)
    print(group)
    print()
(&#39;bar&#39;, &#39;one&#39;)
     A    B         C         D
1  bar  one -0.375789 -0.345869

(&#39;bar&#39;, &#39;three&#39;)
     A      B         C         D
3  bar  three -1.564748  0.081163

(&#39;bar&#39;, &#39;two&#39;)
     A    B         C         D
5  bar  two -0.202403  0.701301

(&#39;foo&#39;, &#39;one&#39;)
     A    B         C         D
0  foo  one  0.542903  0.788896
6  foo  one -0.665189 -1.505290

(&#39;foo&#39;, &#39;three&#39;)
     A      B         C         D
7  foo  three -0.498339  0.534438

(&#39;foo&#39;, &#39;two&#39;)
     A    B         C         D
2  foo  two -0.903407  0.428031
4  foo  two -1.093602  0.837348</code></pre>
  
</div><p class="component-content component">å¯ä»¥çœ‹åˆ°ï¼Œnameæ˜¯ä¸€ä¸ª2ä¸ªå…ƒç´ çš„tupleï¼Œä»£è¡¨ä¸åŒçš„åˆ—</p>
<p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g<span style="color:#f92672">.</span>get_group((<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>))</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">0.542903</td>
<td style="text-align:right">0.788896</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.665189</td>
<td style="text-align:right">-1.505290</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>å¯ä»¥ç›´æ¥æŸ¥è¯¢groupåçš„æŸå‡ åˆ—ï¼Œç”ŸæˆSeriesæˆ–è€…å­DataFrame*</strong></p>
<p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g[<span style="color:#e6db74">&#39;C&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>pandas<span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>groupby<span style="color:#f92672">.</span>generic<span style="color:#f92672">.</span>SeriesGroupBy object at <span style="color:#ae81ff">0x00000123C33F64C8</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> name, group <span style="color:#f92672">in</span> g[<span style="color:#e6db74">&#39;C&#39;</span>]:
</span></span><span style="display:flex;"><span>    print(name)
</span></span><span style="display:flex;"><span>    print(group)
</span></span><span style="display:flex;"><span>    print(type(group))
</span></span><span style="display:flex;"><span>    print()
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">0.375789</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;three&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">1.564748</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">0.202403</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0.542903</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">0.665189</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;three&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">0.498339</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">0.903407</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">1.093602</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">å…¶å®æ‰€æœ‰çš„èšåˆç»Ÿè®¡ï¼Œéƒ½æ˜¯åœ¨dataframeå’Œseriesä¸Šè¿›è¡Œçš„ï¼›</p>

<div class="component-content pagebody component">
  <h3 id="ä¸‰å®ä¾‹åˆ†ç»„æ¢ç´¢å¤©æ°”æ•°æ®" class="pagebody-header">
    ä¸‰ã€å®ä¾‹åˆ†ç»„æ¢ç´¢å¤©æ°”æ•°æ®
  </h3>
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fpath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(fpath)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ›¿æ¢æ‰æ¸©åº¦çš„åç¼€â„ƒ</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#34;bWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;â„ƒ&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#34;yWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;yWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;â„ƒ&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ–°å¢ä¸€åˆ—ä¸ºæœˆä»½</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;month&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;ymd&#39;</span>]<span style="color:#f92672">.</span>str[:<span style="color:#ae81ff">7</span>]
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
<th style="text-align:right">month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="1æŸ¥çœ‹æ¯ä¸ªæœˆçš„æœ€é«˜æ¸©åº¦" class="pagebody-header">
    1ã€æŸ¥çœ‹æ¯ä¸ªæœˆçš„æœ€é«˜æ¸©åº¦
  </h4>
</div><p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;month&#39;</span>)[<span style="color:#e6db74">&#39;bWendu&#39;</span>]<span style="color:#f92672">.</span>max()
</span></span><span style="display:flex;"><span>data</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>month
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">27</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>    <span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span>    <span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>    <span style="color:#ae81ff">38</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span>    <span style="color:#ae81ff">37</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span>    <span style="color:#ae81ff">36</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span>    <span style="color:#ae81ff">31</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>    <span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span>    <span style="color:#ae81ff">18</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>    <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>Name: bWendu, dtype: int32</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>type(data)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pandas<span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x123c344b308</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-acc2a49cb410a6b3e8bd444620cea607" id="lhtacc2a49cb410a6b3e8bd444620cea607">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/8.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h4 id="2æŸ¥çœ‹æ¯ä¸ªæœˆçš„æœ€é«˜æ¸©åº¦æœ€ä½æ¸©åº¦å¹³å‡ç©ºæ°”è´¨é‡æŒ‡æ•°" class="pagebody-header">
    2ã€æŸ¥çœ‹æ¯ä¸ªæœˆçš„æœ€é«˜æ¸©åº¦ã€æœ€ä½æ¸©åº¦ã€å¹³å‡ç©ºæ°”è´¨é‡æŒ‡æ•°
  </h4>
</div><p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
<th style="text-align:right">month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>group_data <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;month&#39;</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#34;bWendu&#34;</span>:np<span style="color:#f92672">.</span>max, <span style="color:#e6db74">&#34;yWendu&#34;</span>:np<span style="color:#f92672">.</span>min, <span style="color:#e6db74">&#34;aqi&#34;</span>:np<span style="color:#f92672">.</span>mean})
</span></span><span style="display:flex;"><span>group_data</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[24]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">aqi</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">month</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">60.677419</td>
</tr>
<tr>
<td style="text-align:right">2018-02</td>
<td style="text-align:right">12</td>
<td style="text-align:right">-10</td>
<td style="text-align:right">78.857143</td>
</tr>
<tr>
<td style="text-align:right">2018-03</td>
<td style="text-align:right">27</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">130.322581</td>
</tr>
<tr>
<td style="text-align:right">2018-04</td>
<td style="text-align:right">30</td>
<td style="text-align:right">1</td>
<td style="text-align:right">102.866667</td>
</tr>
<tr>
<td style="text-align:right">2018-05</td>
<td style="text-align:right">35</td>
<td style="text-align:right">10</td>
<td style="text-align:right">99.064516</td>
</tr>
<tr>
<td style="text-align:right">2018-06</td>
<td style="text-align:right">38</td>
<td style="text-align:right">17</td>
<td style="text-align:right">82.300000</td>
</tr>
<tr>
<td style="text-align:right">2018-07</td>
<td style="text-align:right">37</td>
<td style="text-align:right">22</td>
<td style="text-align:right">72.677419</td>
</tr>
<tr>
<td style="text-align:right">2018-08</td>
<td style="text-align:right">36</td>
<td style="text-align:right">20</td>
<td style="text-align:right">59.516129</td>
</tr>
<tr>
<td style="text-align:right">2018-09</td>
<td style="text-align:right">31</td>
<td style="text-align:right">11</td>
<td style="text-align:right">50.433333</td>
</tr>
<tr>
<td style="text-align:right">2018-10</td>
<td style="text-align:right">25</td>
<td style="text-align:right">1</td>
<td style="text-align:right">67.096774</td>
</tr>
<tr>
<td style="text-align:right">2018-11</td>
<td style="text-align:right">18</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">105.100000</td>
</tr>
<tr>
<td style="text-align:right">2018-12</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">77.354839</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [25]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>group_data<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[25]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x123c5502d48</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-938d640977ccbea0c3ac2e7ea6c39a27" id="lht938d640977ccbea0c3ac2e7ea6c39a27">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/9.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h1 id="17pandasçš„åˆ†å±‚ç´¢å¼•multiindex" class="pagebody-header">
    17ã€Pandasçš„åˆ†å±‚ç´¢å¼•MultiIndex
  </h1>
</div><p class="component-content component">ä¸ºä»€ä¹ˆè¦å­¦ä¹ åˆ†å±‚ç´¢å¼•MultiIndexï¼Ÿ</p>
<div class="component-content component"><ul>
<li>åˆ†å±‚ç´¢å¼•ï¼šåœ¨ä¸€ä¸ªè½´å‘ä¸Šæ‹¥æœ‰å¤šä¸ªç´¢å¼•å±‚çº§ï¼Œå¯ä»¥è¡¨è¾¾æ›´é«˜ç»´åº¦æ•°æ®çš„å½¢å¼ï¼›</li>
<li>å¯ä»¥æ›´æ–¹ä¾¿çš„è¿›è¡Œæ•°æ®ç­›é€‰ï¼Œå¦‚æœæœ‰åºåˆ™æ€§èƒ½æ›´å¥½ï¼›</li>
<li>groupbyç­‰æ“ä½œçš„ç»“æœï¼Œå¦‚æœæ˜¯å¤šKEYï¼Œç»“æœæ˜¯åˆ†å±‚ç´¢å¼•ï¼Œéœ€è¦ä¼šä½¿ç”¨</li>
<li>ä¸€èˆ¬ä¸éœ€è¦è‡ªå·±åˆ›å»ºåˆ†å±‚ç´¢å¼•(MultiIndexæœ‰æ„é€ å‡½æ•°ä½†ä¸€èˆ¬ä¸ç”¨)</li>
</ul></div>
<p class="component-content component">æ¼”ç¤ºæ•°æ®ï¼šç™¾åº¦ã€é˜¿é‡Œå·´å·´ã€çˆ±å¥‡è‰ºã€äº¬ä¸œå››å®¶å…¬å¸çš„10å¤©è‚¡ç¥¨æ•°æ®
æ•°æ®æ¥è‡ªï¼šè‹±ä¸ºè´¢ç»
<a href="https://cn.investing.com/">https://cn.investing.com/</a></p>
<p class="component-content component">æœ¬æ¬¡æ¼”ç¤ºæçº²ï¼š
ä¸€ã€Seriesçš„åˆ†å±‚ç´¢å¼•MultiIndex
äºŒã€Seriesæœ‰å¤šå±‚ç´¢å¼•æ€æ ·ç­›é€‰æ•°æ®ï¼Ÿ
ä¸‰ã€DataFrameçš„å¤šå±‚ç´¢å¼•MultiIndex
å››ã€DataFrameæœ‰å¤šå±‚ç´¢å¼•æ€æ ·ç­›é€‰æ•°æ®ï¼Ÿ</p>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#39;./datas/stocks/äº’è”ç½‘å…¬å¸è‚¡ç¥¨.xlsx&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">---------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NameError</span>                                 Traceback (most recent call last)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>ipython<span style="color:#f92672">-</span>input<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span><span style="color:#ae81ff">574</span>feeeb8bb0<span style="color:#f92672">&gt;</span> <span style="color:#f92672">in</span> <span style="color:#f92672">&lt;</span>module<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">----&gt;</span> <span style="color:#ae81ff">1</span> stocks <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#39;./datas/stocks/äº’è”ç½‘å…¬å¸è‚¡ç¥¨.xlsx&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NameError</span>: name <span style="color:#e6db74">&#39;pd&#39;</span> <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> defined</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks[<span style="color:#e6db74">&#34;å…¬å¸&#34;</span>]<span style="color:#f92672">.</span>unique()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;JD&#39;</span>], dtype<span style="color:#f92672">=</span>object)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RangeIndex(start<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, stop<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>, step<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;å…¬å¸&#39;</span>)[<span style="color:#e6db74">&#34;æ”¶ç›˜&#34;</span>]<span style="color:#f92672">.</span>mean()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>å…¬å¸
</span></span><span style="display:flex;"><span>BABA    <span style="color:#ae81ff">166.80</span>
</span></span><span style="display:flex;"><span>BIDU    <span style="color:#ae81ff">102.98</span>
</span></span><span style="display:flex;"><span>IQ       <span style="color:#ae81ff">15.90</span>
</span></span><span style="display:flex;"><span>JD       <span style="color:#ae81ff">28.35</span>
</span></span><span style="display:flex;"><span>Name: æ”¶ç›˜, dtype: float64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="ä¸€seriesçš„åˆ†å±‚ç´¢å¼•multiindex" class="pagebody-header">
    ä¸€ã€Seriesçš„åˆ†å±‚ç´¢å¼•MultiIndex
  </h3>
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser <span style="color:#f92672">=</span> stocks<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;å…¬å¸&#39;</span>, <span style="color:#e6db74">&#39;æ—¥æœŸ&#39;</span>])[<span style="color:#e6db74">&#39;æ”¶ç›˜&#39;</span>]<span style="color:#f92672">.</span>mean()
</span></span><span style="display:flex;"><span>ser</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>å…¬å¸    æ—¥æœŸ        
</span></span><span style="display:flex;"><span>BABA  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">165.15</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">165.77</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">169.48</span>
</span></span><span style="display:flex;"><span>BIDU  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">102.00</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">104.32</span>
</span></span><span style="display:flex;"><span>IQ    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">15.92</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">15.72</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">16.06</span>
</span></span><span style="display:flex;"><span>JD    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">28.19</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">28.06</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">28.80</span>
</span></span><span style="display:flex;"><span>Name: æ”¶ç›˜, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">å¤šç»´ç´¢å¼•ä¸­ï¼Œç©ºç™½çš„æ„æ€æ˜¯ï¼šä½¿ç”¨ä¸Šé¢çš„å€¼</p>
<p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>MultiIndex([(<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>)],
</span></span><span style="display:flex;"><span>           names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;å…¬å¸&#39;</span>, <span style="color:#e6db74">&#39;æ—¥æœŸ&#39;</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># unstackæŠŠäºŒçº§ç´¢å¼•å˜æˆåˆ—</span>
</span></span><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>unstack()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">2019-10-01</th>
<th style="text-align:right">2019-10-02</th>
<th style="text-align:right">2019-10-03</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">169.48</td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">104.32</td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">16.06</td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.80</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>å…¬å¸    æ—¥æœŸ        
</span></span><span style="display:flex;"><span>BABA  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">165.15</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">165.77</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">169.48</span>
</span></span><span style="display:flex;"><span>BIDU  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">102.00</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">104.32</span>
</span></span><span style="display:flex;"><span>IQ    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">15.92</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">15.72</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">16.06</span>
</span></span><span style="display:flex;"><span>JD    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">28.19</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">28.06</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">28.80</span>
</span></span><span style="display:flex;"><span>Name: æ”¶ç›˜, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>reset_index()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">æ”¶ç›˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="äºŒseriesæœ‰å¤šå±‚ç´¢å¼•multiindexæ€æ ·ç­›é€‰æ•°æ®" class="pagebody-header">
    äºŒã€Seriesæœ‰å¤šå±‚ç´¢å¼•MultiIndexæ€æ ·ç­›é€‰æ•°æ®ï¼Ÿ
  </h3>
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>å…¬å¸    æ—¥æœŸ        
</span></span><span style="display:flex;"><span>BABA  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">165.15</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">165.77</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">169.48</span>
</span></span><span style="display:flex;"><span>BIDU  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">102.00</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">104.32</span>
</span></span><span style="display:flex;"><span>IQ    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">15.92</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">15.72</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">16.06</span>
</span></span><span style="display:flex;"><span>JD    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">28.19</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">28.06</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">28.80</span>
</span></span><span style="display:flex;"><span>Name: æ”¶ç›˜, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#39;BIDU&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>æ—¥æœŸ
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">102.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">104.32</span>
</span></span><span style="display:flex;"><span>Name: æ”¶ç›˜, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å¤šå±‚ç´¢å¼•ï¼Œå¯ä»¥ç”¨å…ƒç»„çš„å½¢å¼ç­›é€‰</span>
</span></span><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>loc[(<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>)]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">102.62</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>å…¬å¸
</span></span><span style="display:flex;"><span>BABA    <span style="color:#ae81ff">165.77</span>
</span></span><span style="display:flex;"><span>BIDU    <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span>IQ       <span style="color:#ae81ff">15.72</span>
</span></span><span style="display:flex;"><span>JD       <span style="color:#ae81ff">28.06</span>
</span></span><span style="display:flex;"><span>Name: æ”¶ç›˜, dtype: float64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="ä¸‰dataframeçš„å¤šå±‚ç´¢å¼•multiindex" class="pagebody-header">
    ä¸‰ã€DataFrameçš„å¤šå±‚ç´¢å¼•MultiIndex
  </h3>
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>set_index([<span style="color:#e6db74">&#39;å…¬å¸&#39;</span>, <span style="color:#e6db74">&#39;æ—¥æœŸ&#39;</span>], inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>stocks</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">168.01</td>
<td style="text-align:right">168.23</td>
<td style="text-align:right">163.64</td>
<td style="text-align:right">14.19</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">16.14</td>
<td style="text-align:right">16.22</td>
<td style="text-align:right">15.50</td>
<td style="text-align:right">11.65</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>MultiIndex([(<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>)],
</span></span><span style="display:flex;"><span>           names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;å…¬å¸&#39;</span>, <span style="color:#e6db74">&#39;æ—¥æœŸ&#39;</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>sort_index(inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>stocks</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">168.01</td>
<td style="text-align:right">168.23</td>
<td style="text-align:right">163.64</td>
<td style="text-align:right">14.19</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">16.14</td>
<td style="text-align:right">16.22</td>
<td style="text-align:right">15.50</td>
<td style="text-align:right">11.65</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="å››dataframeæœ‰å¤šå±‚ç´¢å¼•multiindexæ€æ ·ç­›é€‰æ•°æ®" class="pagebody-header">
    å››ã€DataFrameæœ‰å¤šå±‚ç´¢å¼•MultiIndexæ€æ ·ç­›é€‰æ•°æ®ï¼Ÿ
  </h3>
</div><p class="component-content component">ã€*<strong>é‡è¦çŸ¥è¯†*</strong>ã€‘åœ¨é€‰æ‹©æ•°æ®æ—¶ï¼š</p>
<div class="component-content component"><ul>
<li>å…ƒç»„(key1,key2)ä»£è¡¨ç­›é€‰å¤šå±‚ç´¢å¼•ï¼Œå…¶ä¸­key1æ˜¯ç´¢å¼•ç¬¬ä¸€çº§ï¼Œkey2æ˜¯ç¬¬äºŒçº§ï¼Œæ¯”å¦‚key1=JD, key2=2019-10-02</li>
<li>åˆ—è¡¨[key1,key2]ä»£è¡¨åŒä¸€å±‚çš„å¤šä¸ªKEYï¼Œå…¶ä¸­key1å’Œkey2æ˜¯å¹¶åˆ—çš„åŒçº§ç´¢å¼•ï¼Œæ¯”å¦‚key1=JD, key2=BIDU</li>
</ul></div>
<p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#39;BIDU&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[(<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>), :]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>æ”¶ç›˜     <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span>å¼€ç›˜     <span style="color:#ae81ff">100.85</span>
</span></span><span style="display:flex;"><span>é«˜      <span style="color:#ae81ff">103.24</span>
</span></span><span style="display:flex;"><span>ä½       <span style="color:#ae81ff">99.50</span>
</span></span><span style="display:flex;"><span>äº¤æ˜“é‡      <span style="color:#ae81ff">2.69</span>
</span></span><span style="display:flex;"><span>æ¶¨è·Œå¹…      <span style="color:#ae81ff">0.01</span>
</span></span><span style="display:flex;"><span>Name: (BIDU, <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>), dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[(<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>), <span style="color:#e6db74">&#39;å¼€ç›˜&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">100.85</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[[<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;JD&#39;</span>], :]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[24]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [25]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[([<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;JD&#39;</span>], <span style="color:#e6db74">&#39;2019-10-03&#39;</span>), :]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[25]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [26]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[([<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;JD&#39;</span>], <span style="color:#e6db74">&#39;2019-10-03&#39;</span>), <span style="color:#e6db74">&#39;æ”¶ç›˜&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[26]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>å…¬å¸    æ—¥æœŸ        
</span></span><span style="display:flex;"><span>BIDU  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">104.32</span>
</span></span><span style="display:flex;"><span>JD    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">28.80</span>
</span></span><span style="display:flex;"><span>Name: æ”¶ç›˜, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [27]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[(<span style="color:#e6db74">&#39;BIDU&#39;</span>, [<span style="color:#e6db74">&#39;2019-10-02&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>]), <span style="color:#e6db74">&#39;æ”¶ç›˜&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[27]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">å…¬å¸    æ—¥æœŸ        
BIDU  2019-10-02    102.62
      2019-10-03    104.32
Name: æ”¶ç›˜, dtype: float64</code></pre>
  
</div><p class="component-content component">In [28]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># slice(None)ä»£è¡¨ç­›é€‰è¿™ä¸€ç´¢å¼•çš„æ‰€æœ‰å†…å®¹</span>
</span></span><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[(slice(<span style="color:#66d9ef">None</span>), [<span style="color:#e6db74">&#39;2019-10-02&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>]), :]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[28]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [29]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">stocks.reset_index()</code></pre>
  
</div><p class="component-content component">Out[29]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">168.01</td>
<td style="text-align:right">168.23</td>
<td style="text-align:right">163.64</td>
<td style="text-align:right">14.19</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">16.14</td>
<td style="text-align:right">16.22</td>
<td style="text-align:right">15.50</td>
<td style="text-align:right">11.65</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="18pandasçš„æ•°æ®è½¬æ¢å‡½æ•°mapapplyapplymap" class="pagebody-header">
    18ã€Pandasçš„æ•°æ®è½¬æ¢å‡½æ•°mapã€applyã€applymap
  </h1>
</div><p class="component-content component">æ•°æ®è½¬æ¢å‡½æ•°å¯¹æ¯”ï¼šmapã€applyã€applymapï¼š</p>
<div class="component-content component"><ol>
<li>mapï¼šåªç”¨äºSeriesï¼Œå®ç°æ¯ä¸ªå€¼-&gt;å€¼çš„æ˜ å°„ï¼›</li>
<li>applyï¼šç”¨äºSerieså®ç°æ¯ä¸ªå€¼çš„å¤„ç†ï¼Œç”¨äºDataframeå®ç°æŸä¸ªè½´çš„Seriesçš„å¤„ç†ï¼›</li>
<li>applymapï¼šåªèƒ½ç”¨äºDataFrameï¼Œç”¨äºå¤„ç†è¯¥DataFrameçš„æ¯ä¸ªå…ƒç´ ï¼›</li>
</ol></div>

<div class="component-content pagebody component">
  <h3 id="1-mapç”¨äºserieså€¼çš„è½¬æ¢" class="pagebody-header">
    1. mapç”¨äºSerieså€¼çš„è½¬æ¢
  </h3>
</div><p class="component-content component">å®ä¾‹ï¼šå°†è‚¡ç¥¨ä»£ç è‹±æ–‡è½¬æ¢æˆä¸­æ–‡åå­—</p>
<p class="component-content component">Series.map(dict) or Series.map(function)å‡å¯</p>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>stocks <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#39;./datas/stocks/äº’è”ç½‘å…¬å¸è‚¡ç¥¨.xlsx&#39;</span>)
</span></span><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[1]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks[<span style="color:#e6db74">&#34;å…¬å¸&#34;</span>]<span style="color:#f92672">.</span>unique()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;JD&#39;</span>], dtype<span style="color:#f92672">=</span>object)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å…¬å¸è‚¡ç¥¨ä»£ç åˆ°ä¸­æ–‡çš„æ˜ å°„ï¼Œæ³¨æ„è¿™é‡Œæ˜¯å°å†™</span>
</span></span><span style="display:flex;"><span>dict_company_names <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;bidu&#34;</span>: <span style="color:#e6db74">&#34;ç™¾åº¦&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;baba&#34;</span>: <span style="color:#e6db74">&#34;é˜¿é‡Œå·´å·´&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;iq&#34;</span>: <span style="color:#e6db74">&#34;çˆ±å¥‡è‰º&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;jd&#34;</span>: <span style="color:#e6db74">&#34;äº¬ä¸œ&#34;</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="æ–¹æ³•1seriesmapdict" class="pagebody-header">
    æ–¹æ³•1ï¼šSeries.map(dict)
  </h4>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks[<span style="color:#e6db74">&#34;å…¬å¸ä¸­æ–‡1&#34;</span>] <span style="color:#f92672">=</span> stocks[<span style="color:#e6db74">&#34;å…¬å¸&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>lower()<span style="color:#f92672">.</span>map(dict_company_names)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="æ–¹æ³•2seriesmapfunction" class="pagebody-header">
    æ–¹æ³•2ï¼šSeries.map(function)
  </h4>
</div><p class="component-content component">functionçš„å‚æ•°æ˜¯Seriesçš„æ¯ä¸ªå…ƒç´ çš„å€¼</p>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">stocks[&#34;å…¬å¸ä¸­æ–‡2&#34;] = stocks[&#34;å…¬å¸&#34;].map(lambda x : dict_company_names[x.lower()])</code></pre>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">stocks.head()</code></pre>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡1</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2-applyç”¨äºserieså’Œdataframeçš„è½¬æ¢" class="pagebody-header">
    2. applyç”¨äºSerieså’ŒDataFrameçš„è½¬æ¢
  </h3>
</div><div class="component-content component"><ul>
<li>Series.apply(function), å‡½æ•°çš„å‚æ•°æ˜¯æ¯ä¸ªå€¼</li>
<li>DataFrame.apply(function), å‡½æ•°çš„å‚æ•°æ˜¯Series</li>
</ul></div>

<div class="component-content pagebody component">
  <h4 id="seriesapplyfunction" class="pagebody-header">
    Series.apply(function)
  </h4>
</div><p class="component-content component">functionçš„å‚æ•°æ˜¯Seriesçš„æ¯ä¸ªå€¼</p>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks[<span style="color:#e6db74">&#34;å…¬å¸ä¸­æ–‡3&#34;</span>] <span style="color:#f92672">=</span> stocks[<span style="color:#e6db74">&#34;å…¬å¸&#34;</span>]<span style="color:#f92672">.</span>apply(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">lambda</span> x : dict_company_names[x<span style="color:#f92672">.</span>lower()])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡1</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡2</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡3</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="dataframeapplyfunction" class="pagebody-header">
    DataFrame.apply(function)
  </h4>
</div><p class="component-content component">functionçš„å‚æ•°æ˜¯å¯¹åº”è½´çš„Series</p>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks[<span style="color:#e6db74">&#34;å…¬å¸ä¸­æ–‡4&#34;</span>] <span style="color:#f92672">=</span> stocks<span style="color:#f92672">.</span>apply(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">lambda</span> x : dict_company_names[x[<span style="color:#e6db74">&#34;å…¬å¸&#34;</span>]<span style="color:#f92672">.</span>lower()], 
</span></span><span style="display:flex;"><span>    axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">æ³¨æ„è¿™ä¸ªä»£ç ï¼š
1ã€applyæ˜¯åœ¨stocksè¿™ä¸ªDataFrameä¸Šè°ƒç”¨ï¼›
2ã€lambda xçš„xæ˜¯ä¸€ä¸ªSeriesï¼Œå› ä¸ºæŒ‡å®šäº†axis=1æ‰€ä»¥Seiresçš„keyæ˜¯åˆ—åï¼Œå¯ä»¥ç”¨x[&lsquo;å…¬å¸&rsquo;]è·å–</p>
<p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡1</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡2</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡3</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3-applymapç”¨äºdataframeæ‰€æœ‰å€¼çš„è½¬æ¢" class="pagebody-header">
    3. applymapç”¨äºDataFrameæ‰€æœ‰å€¼çš„è½¬æ¢
  </h3>
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sub_df <span style="color:#f92672">=</span> stocks[[<span style="color:#e6db74">&#39;æ”¶ç›˜&#39;</span>, <span style="color:#e6db74">&#39;å¼€ç›˜&#39;</span>, <span style="color:#e6db74">&#39;é«˜&#39;</span>, <span style="color:#e6db74">&#39;ä½&#39;</span>, <span style="color:#e6db74">&#39;äº¤æ˜“é‡&#39;</span>]]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sub_df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å°†è¿™äº›æ•°å­—å–æ•´æ•°ï¼Œåº”ç”¨äºæ‰€æœ‰å…ƒç´ </span>
</span></span><span style="display:flex;"><span>sub_df<span style="color:#f92672">.</span>applymap(<span style="color:#66d9ef">lambda</span> x : int(x))</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">104</td>
<td style="text-align:right">102</td>
<td style="text-align:right">104</td>
<td style="text-align:right">101</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">102</td>
<td style="text-align:right">100</td>
<td style="text-align:right">103</td>
<td style="text-align:right">99</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">102</td>
<td style="text-align:right">102</td>
<td style="text-align:right">103</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">169</td>
<td style="text-align:right">166</td>
<td style="text-align:right">170</td>
<td style="text-align:right">165</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">165</td>
<td style="text-align:right">162</td>
<td style="text-align:right">166</td>
<td style="text-align:right">161</td>
<td style="text-align:right">11</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">165</td>
<td style="text-align:right">168</td>
<td style="text-align:right">168</td>
<td style="text-align:right">163</td>
<td style="text-align:right">14</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">15</td>
<td style="text-align:right">16</td>
<td style="text-align:right">15</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">15</td>
<td style="text-align:right">15</td>
<td style="text-align:right">15</td>
<td style="text-align:right">15</td>
<td style="text-align:right">8</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">15</td>
<td style="text-align:right">16</td>
<td style="text-align:right">16</td>
<td style="text-align:right">15</td>
<td style="text-align:right">11</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">27</td>
<td style="text-align:right">8</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">27</td>
<td style="text-align:right">9</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">27</td>
<td style="text-align:right">10</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ç›´æ¥ä¿®æ”¹åŸdfçš„è¿™å‡ åˆ—</span>
</span></span><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[:, [<span style="color:#e6db74">&#39;æ”¶ç›˜&#39;</span>, <span style="color:#e6db74">&#39;å¼€ç›˜&#39;</span>, <span style="color:#e6db74">&#39;é«˜&#39;</span>, <span style="color:#e6db74">&#39;ä½&#39;</span>, <span style="color:#e6db74">&#39;äº¤æ˜“é‡&#39;</span>]] <span style="color:#f92672">=</span> sub_df<span style="color:#f92672">.</span>applymap(<span style="color:#66d9ef">lambda</span> x : int(x))</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡1</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡2</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡3</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104</td>
<td style="text-align:right">102</td>
<td style="text-align:right">104</td>
<td style="text-align:right">101</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102</td>
<td style="text-align:right">100</td>
<td style="text-align:right">103</td>
<td style="text-align:right">99</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102</td>
<td style="text-align:right">102</td>
<td style="text-align:right">103</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169</td>
<td style="text-align:right">166</td>
<td style="text-align:right">170</td>
<td style="text-align:right">165</td>
<td style="text-align:right">10</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165</td>
<td style="text-align:right">162</td>
<td style="text-align:right">166</td>
<td style="text-align:right">161</td>
<td style="text-align:right">11</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
</tbody>
</table></div>

          </div><div class="component">
            <div class="component-content">
              <div class="article-copyright">
                <p class="content">
                  ç‰ˆæƒå£°æ˜: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">ç‰ˆæƒå£°æ˜ï¼šç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™… (CC BY-NC-SA 4.0)</a>
                </p>
                <p class="content">ä½œè€…:  yuanshuai </p>
                <p class="content">å‘è¡¨æ—¥æœŸ:  2021å¹´11æœˆ26æ—¥</p>
              </div>
            </div>
          </div></article>
      </section>
  </main>

  <script>
    var script = document.createElement("script");script.src = "https://yuanshuai1122.github.io/js/initPost.js";
    document.head.appendChild(script);
  </script>

    
    <div class="footer-main ">
  <div class="content-body footer-wraper">
    <div class="footer-box">
      <div class="foot-nav">
        <div class="foot-nav-items">
          <div class="item">
            <div class="logo"></div>
            <div class="email">Email: <a href="mailto:shuaiyuan@gmail.com">shuaiyuan@gmail.com</a></div>
          </div>

          <div class="item community">
            <div class="item-title">ç¤¾äº¤åª’ä½“</div>
            
              <a href="https://github.com/yuanshuai1122" target="_blank">Github</a>
            
          </div>

          <div class="item resources">
            <div class="item-title">å‹é“¾</div>
            
              <a href="https://yuanshuaicn.com/" target="_blank">ğŸ‘‹</a>
            
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="item copyright">
          &copy; 2023
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://github.com/floyd-li/hugo-theme-itheme" target="_blank">iTheme</a>
        </div>
      </div>
    </div>
  </div>
</div>

  </body>
    
    

    
    
</html>
