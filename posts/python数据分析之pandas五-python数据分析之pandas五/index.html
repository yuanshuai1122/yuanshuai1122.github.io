<!DOCTYPE html>
<html class="js no-touch  progressive-image  no-reduced-motion progressive" lang="zh-hans">
  <head>
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/img/favicon.ico">

    <meta name="keyword" content=""><meta property="og:title" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäº”ï¼‰" />
<meta property="og:description" content=": | &mdash;: | &mdash;: | &mdash;: | &mdash;: | &mdash;: | | 0 | S001 | æ€ æ¶µ | å¥³ | 23 | å±±ä¸œ | | 1 | S002 | å©‰æ¸… | å¥³ | 25 | æ²³å— | | 2 | S003 | æºªæ¦• | å¥³ | 23 | æ¹–åŒ— | | 3 | S004 | æ¼ æ¶“ | å¥³ | 19 | é™•" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuanshuai1122.github.io/posts/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%94-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%94/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-26T21:54:21+00:00" />
<meta property="article:modified_time" content="2021-11-26T21:54:21+00:00" />
<title>Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäº”ï¼‰</title>

    <link rel="canonical" href="/posts/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%94-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%94/">

    <link rel="stylesheet" href="/css/global.css">

    <link rel="stylesheet" href="/css/custom.css">

    <link rel="stylesheet" href="/css/search.css" />

    
    

    
    

</head>
  </head>
  <body class=" page-article   ">
    <header>
      <nav class="nav">
  <div class="nav-wrapper">
    <div class="nav-content-wrapper">
      <div class="nav-content">
        <a href="/ " class="nav-title">ğŸ§€</a>
        <div class="nav-menu">
          <div class="nav-item-wrapper">
            <a href="/posts " class="nav-item-content">ç›®å½•</a>
          </div><div class="nav-item-wrapper">
            <a href="/about" class="nav-item-content">å…³äº</a>
          </div><div class="nav-item-wrapper">
            <a href="/index.xml" class="nav-item-content" target="_blank">RSS</a>
          </div></div>
      </div>
    </div>
  </div>
</nav>

<script>
  function toggleSearchModal(){
    const template = `
    <div class="modal-body">
      <div id="autocomplete" onclick="event.stopPropagation();"></div>
    </div>
    `
    const modal = document.querySelector("#modal-wrapper")
    if(!modal){
      const div = document.createElement("div")
      document.body.setAttribute("style","overflow: hidden;")
      div.setAttribute("id", "modal-wrapper")
      div.setAttribute("onclick", "toggleSearchModal()")
      div.innerHTML = template
      const script = document.createElement("script");script.setAttribute("src", "https://yuanshuai1122.github.io/js/algolia.js")
      div.appendChild(script)
      document.body.append(div)
    } else {
      document.body.removeAttribute("style")
      document.body.removeChild(modal)
    }
  }
</script>
    </header>
    
  
  
  <main id="main" class="main">
      <section>
        <article class="article">
          
          <div class=" article-header ">
            <div class="category component">
              <div class="component-content">
                <div class="category-eyebrow">
                  <span class="category-eyebrow__category category_original">
                    
                      
                        Python
                      
                    
                  </span>
                  <span class="category-eyebrow__date">2021å¹´11æœˆ26æ—¥</span>
                </div>
              </div>
            </div>
            <div class="pagetitle component">
              <div class="component-content">
                <h1 class="hero-headline">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäº”ï¼‰</h1>
              </div>
            </div>
            <div class="component  article-subhead ">
              <div class="component-content"></div>
            </div>

            <div class="tagssheet component">
              <div class="component-content">
                
                  
                  <a href="/tags/python" class="tag">
                    Python
                  </a>
                
                  
                  <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90" class="tag">
                    æ•°æ®åˆ†æ
                  </a>
                
              </div>
            </div>
          </div>
          
          <div class="pagebody">
            
            
            
            
            
            
            
            
            <p class="component-content component">: | &mdash;: | &mdash;: | &mdash;: | &mdash;: | &mdash;: |
|    0 | S001 | æ€ æ¶µ |   å¥³ |   23 | å±±ä¸œ |
|    1 | S002 | å©‰æ¸… |   å¥³ |   25 | æ²³å— |
|    2 | S003 | æºªæ¦• |   å¥³ |   23 | æ¹–åŒ— |
|    3 | S004 | æ¼ æ¶“ |   å¥³ |   19 | é™•è¥¿ |
|    4 | S005 | ç¥ˆåš |   å¥³ |   24 | å±±ä¸œ |</p>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å±•ç¤ºç´¢å¼•çš„name</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>name</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;id&#34;</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
<th style="text-align:right">å¹´é¾„</th>
<th style="text-align:right">ç±è´¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">id</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">25</td>
<td style="text-align:right">æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">19</td>
<td style="text-align:right">é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">24</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="åˆ›å»ºsqlalchemyå¯¹è±¡è¿æ¥mysql" class="pagebody-header">
    åˆ›å»ºsqlalchemyå¯¹è±¡è¿æ¥MySQL
  </h3>
</div><p class="component-content component">SQLAlchemyæ˜¯Pythonä¸­çš„ORMæ¡†æ¶ï¼Œ Object-Relational Mappingï¼ŒæŠŠå…³ç³»æ•°æ®åº“çš„è¡¨ç»“æ„æ˜ å°„åˆ°å¯¹è±¡ä¸Šã€‚</p>
<div class="component-content component"><ul>
<li>å®˜ç½‘ï¼šhttps://www.sqlalchemy.org/</li>
<li>å¦‚æœsqlalchemyåŒ…ä¸å­˜åœ¨ï¼Œç”¨è¿™ä¸ªå‘½ä»¤å®‰è£…ï¼špip install sqlalchemy</li>
<li>éœ€è¦å®‰è£…ä¾èµ–Pythonåº“ï¼špip install mysql-connector-python</li>
</ul></div>
<p class="component-content component">å¯ä»¥ç›´æ¥æ‰§è¡ŒSQLè¯­å¥</p>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sqlalchemy <span style="color:#f92672">import</span> create_engine</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>engine <span style="color:#f92672">=</span> create_engine(<span style="color:#e6db74">&#34;mysql+mysqlconnector://root:123456@127.0.0.1:3306/test&#34;</span>, echo<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="æ–¹æ³•1å½“æ•°æ®è¡¨ä¸å­˜åœ¨æ—¶æ¯æ¬¡è¦†ç›–æ•´ä¸ªè¡¨" class="pagebody-header">
    æ–¹æ³•1ï¼šå½“æ•°æ®è¡¨ä¸å­˜åœ¨æ—¶ï¼Œæ¯æ¬¡è¦†ç›–æ•´ä¸ªè¡¨
  </h3>
</div><p class="component-content component">æ¯æ¬¡è¿è¡Œä¼šdrop tableï¼Œæ–°å»ºè¡¨</p>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>to_sql(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;student&#39;</span>, con<span style="color:#f92672">=</span>engine, if_exists<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;replace&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>engine<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;show create table student&#34;</span>)<span style="color:#f92672">.</span>first()[<span style="color:#ae81ff">1</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#39;CREATE TABLE `student` (</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">  `id` bigint(20) DEFAULT NULL,</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">  `å­¦å·` text,</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">  `å§“å` text,</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">  `æ€§åˆ«` text,</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">  `å¹´é¾„` bigint(20) DEFAULT NULL,</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">  `ç±è´¯` text,</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">  KEY `ix_student_id` (`id`)</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4&#39;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(engine<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;show create table student&#34;</span>)<span style="color:#f92672">.</span>first()[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>CREATE TABLE <span style="color:#960050;background-color:#1e0010">`</span>student<span style="color:#960050;background-color:#1e0010">`</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">`</span>id<span style="color:#960050;background-color:#1e0010">`</span> bigint(<span style="color:#ae81ff">20</span>) DEFAULT NULL,
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">`</span>å­¦å·<span style="color:#960050;background-color:#1e0010">`</span> text,
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">`</span>å§“å<span style="color:#960050;background-color:#1e0010">`</span> text,
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">`</span>æ€§åˆ«<span style="color:#960050;background-color:#1e0010">`</span> text,
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">`</span>å¹´é¾„<span style="color:#960050;background-color:#1e0010">`</span> bigint(<span style="color:#ae81ff">20</span>) DEFAULT NULL,
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">`</span>ç±è´¯<span style="color:#960050;background-color:#1e0010">`</span> text,
</span></span><span style="display:flex;"><span>  KEY <span style="color:#960050;background-color:#1e0010">`</span>ix_student_id<span style="color:#960050;background-color:#1e0010">`</span> (<span style="color:#960050;background-color:#1e0010">`</span>id<span style="color:#960050;background-color:#1e0010">`</span>)
</span></span><span style="display:flex;"><span>) ENGINE<span style="color:#f92672">=</span>InnoDB DEFAULT CHARSET<span style="color:#f92672">=</span>utf8mb4</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>engine<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;select count(1) from student&#34;</span>)<span style="color:#f92672">.</span>first()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">24</span>,)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>engine<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;select * from student limit 5&#34;</span>)<span style="color:#f92672">.</span>fetchall()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[(<span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;S001&#39;</span>, <span style="color:#e6db74">&#39;æ€ æ¶µ&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#e6db74">&#39;å±±ä¸œ&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;S002&#39;</span>, <span style="color:#e6db74">&#39;å©‰æ¸…&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">25</span>, <span style="color:#e6db74">&#39;æ²³å—&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;S003&#39;</span>, <span style="color:#e6db74">&#39;æºªæ¦•&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#e6db74">&#39;æ¹–åŒ—&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;S004&#39;</span>, <span style="color:#e6db74">&#39;æ¼ æ¶“&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">19</span>, <span style="color:#e6db74">&#39;é™•è¥¿&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;S005&#39;</span>, <span style="color:#e6db74">&#39;ç¥ˆåš&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">24</span>, <span style="color:#e6db74">&#39;å±±ä¸œ&#39;</span>)]</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="æ–¹æ³•2å½“æ•°æ®è¡¨å­˜åœ¨æ—¶æ¯æ¬¡æ–°å¢æ•°æ®" class="pagebody-header">
    æ–¹æ³•2ï¼šå½“æ•°æ®è¡¨å­˜åœ¨æ—¶ï¼Œæ¯æ¬¡æ–°å¢æ•°æ®
  </h3>
</div><p class="component-content component">åœºæ™¯ï¼šæ¯å¤©ä¼šæ–°å¢ä¸€éƒ¨åˆ†æ•°æ®ï¼Œè¦æ·»åŠ åˆ°æ•°æ®è¡¨ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ</p>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_new <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>loc[:<span style="color:#ae81ff">4</span>, :]
</span></span><span style="display:flex;"><span>df_new</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
<th style="text-align:right">å¹´é¾„</th>
<th style="text-align:right">ç±è´¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">id</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">25</td>
<td style="text-align:right">æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">19</td>
<td style="text-align:right">é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">24</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_new<span style="color:#f92672">.</span>to_sql(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;student&#39;</span>, con<span style="color:#f92672">=</span>engine, if_exists<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;append&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>engine<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;SELECT * FROM student where id&lt;5 &#34;</span>)<span style="color:#f92672">.</span>fetchall()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[(<span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;S001&#39;</span>, <span style="color:#e6db74">&#39;æ€ æ¶µ&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#e6db74">&#39;å±±ä¸œ&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;S002&#39;</span>, <span style="color:#e6db74">&#39;å©‰æ¸…&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">25</span>, <span style="color:#e6db74">&#39;æ²³å—&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;S003&#39;</span>, <span style="color:#e6db74">&#39;æºªæ¦•&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#e6db74">&#39;æ¹–åŒ—&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;S004&#39;</span>, <span style="color:#e6db74">&#39;æ¼ æ¶“&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">19</span>, <span style="color:#e6db74">&#39;é™•è¥¿&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;S005&#39;</span>, <span style="color:#e6db74">&#39;ç¥ˆåš&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">24</span>, <span style="color:#e6db74">&#39;å±±ä¸œ&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;S001&#39;</span>, <span style="color:#e6db74">&#39;æ€ æ¶µ&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#e6db74">&#39;å±±ä¸œ&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;S002&#39;</span>, <span style="color:#e6db74">&#39;å©‰æ¸…&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">25</span>, <span style="color:#e6db74">&#39;æ²³å—&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;S003&#39;</span>, <span style="color:#e6db74">&#39;æºªæ¦•&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#e6db74">&#39;æ¹–åŒ—&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;S004&#39;</span>, <span style="color:#e6db74">&#39;æ¼ æ¶“&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">19</span>, <span style="color:#e6db74">&#39;é™•è¥¿&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;S005&#39;</span>, <span style="color:#e6db74">&#39;ç¥ˆåš&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">24</span>, <span style="color:#e6db74">&#39;å±±ä¸œ&#39;</span>)]</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="é—®é¢˜è§£å†³å…ˆæ ¹æ®æ•°æ®keyåˆ é™¤æ—§æ•°æ®" class="pagebody-header">
    é—®é¢˜è§£å†³ï¼šå…ˆæ ¹æ®æ•°æ®KEYåˆ é™¤æ—§æ•°æ®
  </h4>
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_new<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RangeIndex(start<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, stop<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, step<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;id&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> id <span style="color:#f92672">in</span> df_new<span style="color:#f92672">.</span>index:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">## å…ˆåˆ é™¤è¦æ–°å¢çš„æ•°æ®</span>
</span></span><span style="display:flex;"><span>    delete_sql <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;delete from student where id=</span><span style="color:#e6db74">{</span>id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    print(delete_sql)
</span></span><span style="display:flex;"><span>    engine<span style="color:#f92672">.</span>execute(delete_sql)
</span></span><span style="display:flex;"><span>delete <span style="color:#f92672">from</span> student where id<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>delete <span style="color:#f92672">from</span> student where id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>delete <span style="color:#f92672">from</span> student where id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>delete <span style="color:#f92672">from</span> student where id<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>delete <span style="color:#f92672">from</span> student where id<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>engine<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;SELECT * FROM student where id&lt;5 &#34;</span>)<span style="color:#f92672">.</span>fetchall()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>engine<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;select count(1) from student&#34;</span>)<span style="color:#f92672">.</span>first()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">19</span>,)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ–°å¢æ•°æ®åˆ°è¡¨ä¸­</span>
</span></span><span style="display:flex;"><span>df_new<span style="color:#f92672">.</span>to_sql(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;student&#39;</span>, con<span style="color:#f92672">=</span>engine, if_exists<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;append&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>engine<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;SELECT * FROM student where id&lt;5 &#34;</span>)<span style="color:#f92672">.</span>fetchall()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[(<span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;S001&#39;</span>, <span style="color:#e6db74">&#39;æ€ æ¶µ&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#e6db74">&#39;å±±ä¸œ&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;S002&#39;</span>, <span style="color:#e6db74">&#39;å©‰æ¸…&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">25</span>, <span style="color:#e6db74">&#39;æ²³å—&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;S003&#39;</span>, <span style="color:#e6db74">&#39;æºªæ¦•&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#e6db74">&#39;æ¹–åŒ—&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;S004&#39;</span>, <span style="color:#e6db74">&#39;æ¼ æ¶“&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">19</span>, <span style="color:#e6db74">&#39;é™•è¥¿&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;S005&#39;</span>, <span style="color:#e6db74">&#39;ç¥ˆåš&#39;</span>, <span style="color:#e6db74">&#39;å¥³&#39;</span>, <span style="color:#ae81ff">24</span>, <span style="color:#e6db74">&#39;å±±ä¸œ&#39;</span>)]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>engine<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;SELECT count(1) FROM student&#34;</span>)<span style="color:#f92672">.</span>first()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">24</span>,)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="38pythonæ‰¹é‡ç¿»è¯‘è‹±è¯­å•è¯" class="pagebody-header">
    38ã€Pythonæ‰¹é‡ç¿»è¯‘è‹±è¯­å•è¯
  </h1>
</div><p class="component-content component">*<strong>ç”¨é€”ï¼š*</strong>
å¯¹æ‰¹é‡çš„è‹±è¯­æ–‡æœ¬ï¼Œç”Ÿæˆè‹±è¯­-æ±‰è¯­ç¿»è¯‘çš„å•è¯æœ¬ï¼Œæä¾›Excelä¸‹è½½</p>
<p class="component-content component">*<strong>æœ¬ä»£ç å®ç°ï¼š*</strong></p>
<div class="component-content component"><ol>
<li>
<p class="component-content component">æä¾›ä¸€ä¸ªè‹±æ–‡æ–‡ç« URLï¼Œè‡ªåŠ¨ä¸‹è½½ç½‘é¡µï¼›</p>
</li>
<li>
<p class="component-content component">å®ç°ç½‘é¡µä¸­æ‰€æœ‰è‹±è¯­å•è¯çš„ç¿»è¯‘ï¼›</p>
</li>
<li>
<p class="component-content component">ä¸‹è½½ç¿»è¯‘ç»“æœçš„Excel</p>
<p class="component-content component">*<strong>æ¶‰åŠæŠ€æœ¯ï¼š*</strong></p>
</li>
<li>
<p class="component-content component">pandasçš„è¯»å–csvã€å¤šæ•°æ®mergeã€è¾“å‡ºExcel</p>
</li>
<li>
<p class="component-content component">requestsåº“ä¸‹è½½HTMLç½‘é¡µ</p>
</li>
<li>
<p class="component-content component">BeautifulSoupè§£æHTMLç½‘é¡µ</p>
</li>
<li>
<p class="component-content component">Pythonæ­£åˆ™è¡¨è¾¾å¼å®ç°è‹±æ–‡åˆ†è¯</p>
</li>
</ol></div>

<div class="component-content pagebody component">
  <h3 id="1-è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶" class="pagebody-header">
    1. è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶
  </h3>
</div><p class="component-content component">è¯å…¸æ–‡ä»¶æ¥è‡ªï¼šhttps://github.com/skywind3000/ECDICT ä½¿ç”¨æ­¥éª¤ï¼š</p>
<div class="component-content component"><ol>
<li>ä¸‹è½½ä»£ç æ‰“åŒ…ï¼šhttps://github.com/skywind3000/ECDICT/archive/master.zip</li>
<li>è§£å‹master.zipï¼Œç„¶åè§£å‹å…¶ä¸­çš„â€ªstardict.csvæ–‡ä»¶</li>
</ol></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ³¨æ„ï¼šstardict.csvçš„åœ°å€éœ€è¦æ›¿æ¢æˆä½ è‡ªå·±çš„æ–‡ä»¶åœ°å€</span>
</span></span><span style="display:flex;"><span>df_dict <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;D:/tmp/ECDICT-master/stardict.csv&#34;</span>)
</span></span><span style="display:flex;"><span>d:\Anaconda3\lib\site<span style="color:#f92672">-</span>packages\IPython\core\interactiveshell<span style="color:#f92672">.</span>py:<span style="color:#ae81ff">3063</span>: DtypeWarning: Columns (<span style="color:#ae81ff">11</span>) have mixed types<span style="color:#f92672">.</span>Specify dtype option on <span style="color:#f92672">import</span> or set low_memory<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span><span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>  interactivity<span style="color:#f92672">=</span>interactivity, compiler<span style="color:#f92672">=</span>compiler, result<span style="color:#f92672">=</span>result)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_dict<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">3402564</span>, <span style="color:#ae81ff">13</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_dict<span style="color:#f92672">.</span>sample(<span style="color:#ae81ff">10</span>)<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">phonetic</th>
<th style="text-align:right">definition</th>
<th style="text-align:right">translation</th>
<th style="text-align:right">pos</th>
<th style="text-align:right">collins</th>
<th style="text-align:right">oxford</th>
<th style="text-align:right">tag</th>
<th style="text-align:right">bnc</th>
<th style="text-align:right">frq</th>
<th style="text-align:right">exchange</th>
<th style="text-align:right">detail</th>
<th style="text-align:right">audio</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">3370509</td>
<td style="text-align:right">WWDH</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[ç½‘ç»œ] æ·‡æ¥„å£‹</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">518014</td>
<td style="text-align:right">chauhtan (chotan)</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">å“ä¸¹</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">389953</td>
<td style="text-align:right">breviarist</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[ç½‘ç»œ] çŸ­ç¬›å¸ˆ</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">951231</td>
<td style="text-align:right">electric-vehicle</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">abbr. â€œEVâ€çš„å˜ä½“ï¼›â€œelectric carâ€çš„å˜ä½“\n[ç½‘ç»œ] ç”µåŠ¨æ±½è½¦</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">91258</td>
<td style="text-align:right">Albionian</td>
<td style="text-align:right">Ã¦l&rsquo;biÓ™niÓ™n</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[åœ°è´¨]é˜¿å°”æ¯”ç¿æœŸ</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æŠŠwordã€translationä¹‹å¤–çš„åˆ—æ‰”æ‰</span>
</span></span><span style="display:flex;"><span>df_dict <span style="color:#f92672">=</span> df_dict[[<span style="color:#e6db74">&#34;word&#34;</span>, <span style="color:#e6db74">&#34;translation&#34;</span>]]
</span></span><span style="display:flex;"><span>df_dict<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">translation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">&lsquo;a</td>
<td style="text-align:right">na. ä¸€\nn. è‹±æ–‡å­—æ¯è¡¨çš„ç¬¬ä¸€å­—æ¯ï¼›ã€ä¹ã€‘AéŸ³\nart. å† ä»¥ä¸å®šå† è¯ä¸»è¦è¡¨ç¤ºç±»åˆ«...</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">&lsquo;A&rsquo; game</td>
<td style="text-align:right">[ç½‘ç»œ] æ¸¸æˆï¼›ä¸€ä¸ªæ¸¸æˆï¼›ä¸€å±€</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">&lsquo;AbbÄsÄ«yah</td>
<td style="text-align:right">[åœ°å] é˜¿å·´è¥¿è€¶ ( åŸƒ )</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">&lsquo;Abd al KÅ«rÄ«</td>
<td style="text-align:right">[åœ°å] é˜¿åœæœå‹’åº“é‡Œå²› ( ä¹Ÿé—¨ )</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">&lsquo;Abd al MÄjid</td>
<td style="text-align:right">[åœ°å] é˜¿åœæœå‹’é©¬å‰å¾· ( è‹ä¸¹ )</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2-ä¸‹è½½ç½‘é¡µå¾—åˆ°ç½‘é¡µå†…å®¹" class="pagebody-header">
    2. ä¸‹è½½ç½‘é¡µï¼Œå¾—åˆ°ç½‘é¡µå†…å®¹
  </h3>
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Pandaså®˜æ–¹æ–‡æ¡£ä¸­çš„ä¸€ä¸ªURL</span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://pandas.pydata.org/docs/user_guide/indexing.html&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>html_cont <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url)<span style="color:#f92672">.</span>text</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>html_cont[:<span style="color:#ae81ff">100</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">&#39;\n\n&lt;!DOCTYPE html&gt;\n\n&lt;html xmlns=&#34;http://www.w3.org/1999/xhtml&#34;&gt;\n  &lt;head&gt;\n    &lt;meta charset=&#34;utf-8&#34; /&gt;&#39;</code></pre>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3-æå–htmlçš„æ­£æ–‡å†…å®¹" class="pagebody-header">
    3. æå–HTMLçš„æ­£æ–‡å†…å®¹
  </h3>
</div><p class="component-content component">å³ï¼šå»é™¤HTMLæ ‡ç­¾ï¼Œè·å–æ­£æ–‡</p>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> bs4 <span style="color:#f92672">import</span> BeautifulSoup
</span></span><span style="display:flex;"><span>soup <span style="color:#f92672">=</span> BeautifulSoup(html_cont)
</span></span><span style="display:flex;"><span>html_text <span style="color:#f92672">=</span> soup<span style="color:#f92672">.</span>get_text()</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>html_text[:<span style="color:#ae81ff">500</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">&#39;\n\n\nIndexing and selecting data â€” pandas 1.0.1 documentation\n\n\n\n\n\n\n\n\n\n\n\n\nMathJax.Hub.Config({&#34;tex2jax&#34;: {&#34;inlineMath&#34;: [[&#34;$&#34;, &#34;$&#34;], [&#34;\\\\(&#34;, &#34;\\\\)&#34;]], &#34;processEscapes&#34;: true, &#34;ignoreClass&#34;: &#34;document&#34;, &#34;processClass&#34;: &#34;math|output_area&#34;}})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHome\n\n\nWhat\&#39;s New in 1.0.0\n\n\nGetting started\n\n\nUser Guide\n\n\nAPI reference\n\n\nDevelopment\n\n\nRelease Notes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIO tools (text, CSV, HDF5, Ã¢\x80Â¦)\n\n\nIndexing and selecting data\n\n\nMultiIndex / advanced indexing\n\n\nMerge, join, a&#39;</code></pre>
  
</div>
<div class="component-content pagebody component">
  <h3 id="4-è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—" class="pagebody-header">
    4. è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—
  </h3>
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># åˆ†è¯</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>word_list <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&#34;&#34;[ ,.\(\)/</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">|\-:=\$\[&#34;&#39;]&#34;&#34;&#34;</span>,html_text)
</span></span><span style="display:flex;"><span>word_list[:<span style="color:#ae81ff">10</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#e6db74">&#39;Indexing&#39;</span>, <span style="color:#e6db74">&#39;and&#39;</span>, <span style="color:#e6db74">&#39;selecting&#39;</span>, <span style="color:#e6db74">&#39;data&#39;</span>, <span style="color:#e6db74">&#39;â€”&#39;</span>, <span style="color:#e6db74">&#39;pandas&#39;</span>, <span style="color:#e6db74">&#39;1&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># è¯»å–åœç”¨è¯è¡¨ï¼Œä»ç½‘ä¸Šå¤åˆ¶çš„ï¼Œä½äºå½“å‰ç›®å½•ä¸‹</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;./datas/stop_words/stop_words.txt&#34;</span>) <span style="color:#66d9ef">as</span> fin:
</span></span><span style="display:flex;"><span>    stop_words<span style="color:#f92672">=</span>set(fin<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>))
</span></span><span style="display:flex;"><span>list(stop_words)[:<span style="color:#ae81ff">10</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;itself&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;showed&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;throughout&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;pointed&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;n&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;against&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;name&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;none&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;ran&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ•°æ®æ¸…æ´—</span>
</span></span><span style="display:flex;"><span>word_list_clean <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> word_list:
</span></span><span style="display:flex;"><span>    word <span style="color:#f92672">=</span> str(word)<span style="color:#f92672">.</span>lower()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># è¿‡æ»¤æ‰ç©ºè¯ã€æ•°å­—ã€å•ä¸ªå­—ç¬¦çš„è¯ã€åœç”¨è¯</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> word <span style="color:#f92672">or</span> word<span style="color:#f92672">.</span>isnumeric() <span style="color:#f92672">or</span> len(word)<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">or</span> word <span style="color:#f92672">in</span> stop_words:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>    word_list_clean<span style="color:#f92672">.</span>append(word)
</span></span><span style="display:flex;"><span>word_list_clean[:<span style="color:#ae81ff">20</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;indexing&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;selecting&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;data&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;pandas&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;documentation&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;mathjax&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;hub&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;config&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;tex2jax&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;inlinemath&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\\\\</span><span style="color:#e6db74">&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\\\\</span><span style="color:#e6db74">&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;]]&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;processescapes&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;true&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;ignoreclass&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;document&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;processclass&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;math&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;output_area&#39;</span>]</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="5-åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªdataframe" class="pagebody-header">
    5. åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªDataFrame
  </h3>
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_words <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;word&#34;</span>: word_list_clean
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>df_words<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">indexing</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">selecting</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">data</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">pandas</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">documentation</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_words<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">4915</span>, <span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ç»Ÿè®¡è¯é¢‘</span>
</span></span><span style="display:flex;"><span>df_words <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>    df_words
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;word&#34;</span>)[<span style="color:#e6db74">&#34;word&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>agg(count<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;size&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>reset_index()
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;count&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>df_words<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">10</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">620</td>
<td style="text-align:right">df</td>
<td style="text-align:right">161</td>
</tr>
<tr>
<td style="text-align:right">659</td>
<td style="text-align:right">dtype</td>
<td style="text-align:right">87</td>
</tr>
<tr>
<td style="text-align:right">1274</td>
<td style="text-align:right">true</td>
<td style="text-align:right">86</td>
</tr>
<tr>
<td style="text-align:right">593</td>
<td style="text-align:right">dataframe</td>
<td style="text-align:right">80</td>
</tr>
<tr>
<td style="text-align:right">1038</td>
<td style="text-align:right">pd</td>
<td style="text-align:right">75</td>
</tr>
<tr>
<td style="text-align:right">917</td>
<td style="text-align:right">loc</td>
<td style="text-align:right">72</td>
</tr>
<tr>
<td style="text-align:right">970</td>
<td style="text-align:right">nan</td>
<td style="text-align:right">72</td>
</tr>
<tr>
<td style="text-align:right">721</td>
<td style="text-align:right">false</td>
<td style="text-align:right">58</td>
</tr>
<tr>
<td style="text-align:right">914</td>
<td style="text-align:right">list</td>
<td style="text-align:right">58</td>
</tr>
<tr>
<td style="text-align:right">835</td>
<td style="text-align:right">indexing</td>
<td style="text-align:right">53</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="6-å’Œå•è¯è¯å…¸å®ç°merge" class="pagebody-header">
    6. å’Œå•è¯è¯å…¸å®ç°merge
  </h3>
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(
</span></span><span style="display:flex;"><span>    left <span style="color:#f92672">=</span> df_dict,
</span></span><span style="display:flex;"><span>    right <span style="color:#f92672">=</span> df_words,
</span></span><span style="display:flex;"><span>    left_on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;word&#34;</span>,
</span></span><span style="display:flex;"><span>    right_on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;word&#34;</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>sample(<span style="color:#ae81ff">10</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">translation</th>
<th style="text-align:right">count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">658</td>
<td style="text-align:right">team</td>
<td style="text-align:right">n. é˜Ÿ, ç»„\nvt. æŠŠé©¬(ç‰›)å¥—åœ¨åŒä¸€è¾†è½¦ä¸Š, æŠŠ&hellip;ç¼–æˆä¸€ç»„\nvi. é©¾é©¶å¡è½¦, åä½œ</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">523</td>
<td style="text-align:right">providing</td>
<td style="text-align:right">conj. ä»¥&hellip;ä¸ºæ¡ä»¶, å‡å¦‚</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">394</td>
<td style="text-align:right">lines</td>
<td style="text-align:right">n. å°è¯</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">118</td>
<td style="text-align:right">columns</td>
<td style="text-align:right">å¡”å™¨</td>
<td style="text-align:right">49</td>
</tr>
<tr>
<td style="text-align:right">136</td>
<td style="text-align:right">conforms</td>
<td style="text-align:right">v. éµå®ˆ( conformçš„ç¬¬ä¸‰äººç§°å•æ•° ); é¡ºåº”; ç›¸ä¸€è‡´; ç›¸ç¬¦åˆ</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">529</td>
<td style="text-align:right">python</td>
<td style="text-align:right">n. å¤§èŸ’, å·¨èŸ’\n[è®¡] Python ç¨‹åºè®¾è®¡è¯­è¨€ï¼›äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨ Python</td>
<td style="text-align:right">26</td>
</tr>
<tr>
<td style="text-align:right">185</td>
<td style="text-align:right">determine</td>
<td style="text-align:right">v. å†³å®š, å†³å¿ƒ</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">285</td>
<td style="text-align:right">forward</td>
<td style="text-align:right">a. å‘å‰çš„, æ—©çš„, è¿…é€Ÿçš„, åœ¨å‰çš„, è¿›æ­¥çš„\nvt. ä¿ƒè¿›&hellip;çš„ç”Ÿé•¿, è½¬å¯„, è¿&hellip;</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">49</td>
<td style="text-align:right">arguments</td>
<td style="text-align:right">n. å‚æ•°</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">564</td>
<td style="text-align:right">reported</td>
<td style="text-align:right">a. æŠ¥å‘Šçš„ï¼›æ®æŠ¥é“çš„</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">718</span>, <span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="7-å­˜å…¥excel" class="pagebody-header">
    7. å­˜å…¥Excel
  </h3>
</div><p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">&#34;./38. batch_chinese_english.xlsx&#34;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="åç»­å‡çº§" class="pagebody-header">
    åç»­å‡çº§ï¼š
  </h3>
</div><div class="component-content component"><ol>
<li>å¯ä»¥æä¾›txt/excel/word/pdfçš„æ‰¹é‡è¾“å…¥ï¼Œç”Ÿæˆå•è¯æœ¬ï¼›</li>
<li>å¯ä»¥åšæˆç½‘é¡µã€å¾®ä¿¡å°ç¨‹åºçš„å½¢å¼ï¼Œåœ¨çº¿è®¿é—®å’Œä½¿ç”¨</li>
<li>ç”¨æˆ·å¯ä»¥æ ‡è®°æˆ–ä¸Šä¼ â€œå·²ç»è®¤è¯†çš„è¯è¯­â€ï¼Œæ¯æ¬¡è¿‡æ»¤æ‰</li>
</ol></div>

<div class="component-content pagebody component">
  <h1 id="39pythonè‡ªåŠ¨ç¿»è¯‘è‹±è¯­è®ºæ–‡pdf" class="pagebody-header">
    39ã€Pythonè‡ªåŠ¨ç¿»è¯‘è‹±è¯­è®ºæ–‡PDF
  </h1>
</div><p class="component-content component">*<strong>æ¶‰åŠæŠ€æœ¯ï¼š*</strong></p>
<div class="component-content component"><ol>
<li>Pythonè¯»å–PDFæ–‡æœ¬</li>
<li>pandasçš„è¯»å–csvã€å¤šæ•°æ®mergeã€è¾“å‡ºExcel</li>
<li>Pythonæ­£åˆ™è¡¨è¾¾å¼å®ç°è‹±æ–‡åˆ†è¯</li>
</ol></div>

<div class="component-content pagebody component">
  <h3 id="1-è¯»å–pdfæ–‡æœ¬å†…å®¹" class="pagebody-header">
    1. è¯»å–PDFæ–‡æœ¬å†…å®¹
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install <span style="color:#f92672">-</span>i https:<span style="color:#f92672">//</span>pypi<span style="color:#f92672">.</span>tuna<span style="color:#f92672">.</span>tsinghua<span style="color:#f92672">.</span>edu<span style="color:#f92672">.</span>cn<span style="color:#f92672">/</span>simple pdfplumber
</span></span><span style="display:flex;"><span>Looking <span style="color:#f92672">in</span> indexes: https:<span style="color:#f92672">//</span>pypi<span style="color:#f92672">.</span>tuna<span style="color:#f92672">.</span>tsinghua<span style="color:#f92672">.</span>edu<span style="color:#f92672">.</span>cn<span style="color:#f92672">/</span>simple
</span></span><span style="display:flex;"><span>Requirement already satisfied: pdfplumber <span style="color:#f92672">in</span> d:\anaconda3\lib\site<span style="color:#f92672">-</span>packages (<span style="color:#ae81ff">0.5.16</span>)
</span></span><span style="display:flex;"><span>Requirement already satisfied: chardet <span style="color:#f92672">in</span> d:\anaconda3\lib\site<span style="color:#f92672">-</span>packages (<span style="color:#f92672">from</span> pdfplumber) (<span style="color:#ae81ff">3.0.4</span>)
</span></span><span style="display:flex;"><span>Requirement already satisfied: pdfminer<span style="color:#f92672">.</span>six<span style="color:#f92672">==</span><span style="color:#ae81ff">20200104</span> <span style="color:#f92672">in</span> d:\anaconda3\lib\site<span style="color:#f92672">-</span>packages (<span style="color:#f92672">from</span> pdfplumber) (<span style="color:#ae81ff">20200104</span>)
</span></span><span style="display:flex;"><span>Requirement already satisfied: pillow<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">7.0.0</span> <span style="color:#f92672">in</span> d:\anaconda3\lib\site<span style="color:#f92672">-</span>packages (<span style="color:#f92672">from</span> pdfplumber) (<span style="color:#ae81ff">7.0.0</span>)
</span></span><span style="display:flex;"><span>Requirement already satisfied: unicodecsv<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0.14.1</span> <span style="color:#f92672">in</span> d:\anaconda3\lib\site<span style="color:#f92672">-</span>packages (<span style="color:#f92672">from</span> pdfplumber) (<span style="color:#ae81ff">0.14.1</span>)
</span></span><span style="display:flex;"><span>Requirement already satisfied: six <span style="color:#f92672">in</span> d:\anaconda3\lib\site<span style="color:#f92672">-</span>packages (<span style="color:#f92672">from</span> pdfplumber) (<span style="color:#ae81ff">1.14.0</span>)
</span></span><span style="display:flex;"><span>Requirement already satisfied: wand <span style="color:#f92672">in</span> d:\anaconda3\lib\site<span style="color:#f92672">-</span>packages (<span style="color:#f92672">from</span> pdfplumber) (<span style="color:#ae81ff">0.5.9</span>)
</span></span><span style="display:flex;"><span>Requirement already satisfied: pycryptodome <span style="color:#f92672">in</span> d:\anaconda3\lib\site<span style="color:#f92672">-</span>packages (<span style="color:#f92672">from</span> pdfplumber) (<span style="color:#ae81ff">3.9.7</span>)
</span></span><span style="display:flex;"><span>Requirement already satisfied: sortedcontainers <span style="color:#f92672">in</span> d:\anaconda3\lib\site<span style="color:#f92672">-</span>packages (<span style="color:#f92672">from</span> pdfminer.six<span style="color:#f92672">==</span><span style="color:#ae81ff">20200104</span><span style="color:#f92672">-&gt;</span>pdfplumber) (<span style="color:#ae81ff">2.1.0</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [48]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pdfplumber
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read_pdf</span>(pdf_fpath):
</span></span><span style="display:flex;"><span>    pdf <span style="color:#f92672">=</span> pdfplumber<span style="color:#f92672">.</span>open(pdf_fpath)
</span></span><span style="display:flex;"><span>    page_conts <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> page <span style="color:#f92672">in</span> pdf<span style="color:#f92672">.</span>pages:
</span></span><span style="display:flex;"><span>        page_conts<span style="color:#f92672">.</span>append(page<span style="color:#f92672">.</span>extract_text())
</span></span><span style="display:flex;"><span>    pdf<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">.</span>join(page_conts)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [49]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pdf_fpath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D:/tmp/Wide &amp; Deep Learning for Recommender Systems.pdf&#34;</span>
</span></span><span style="display:flex;"><span>pdf_cont <span style="color:#f92672">=</span> read_pdf(pdf_fpath)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [50]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(pdf_cont[:<span style="color:#ae81ff">2000</span>])
</span></span><span style="display:flex;"><span>Wide <span style="color:#f92672">&amp;</span> Deep Learning <span style="color:#66d9ef">for</span> Recommender Systems
</span></span><span style="display:flex;"><span>Heng<span style="color:#f92672">-</span>Tze Cheng, Levent Koc, Jeremiah Harmsen, Tal Shaked, Tushar Chandra,
</span></span><span style="display:flex;"><span>Hrishi Aradhye, Glen Anderson, Greg Corrado, Wei Chai, Mustafa Ispir, Rohan Anil,
</span></span><span style="display:flex;"><span>Zakaria Haque, Lichan Hong, Vihan Jain, Xiaobing Liu, Hemal Shah
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">âˆ—</span>
</span></span><span style="display:flex;"><span>GoogleInc<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>ABSTRACT
</span></span><span style="display:flex;"><span>have never <span style="color:#f92672">or</span> rarely occurred <span style="color:#f92672">in</span> the past<span style="color:#f92672">.</span> Recommenda<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>tions based on memorization are usually more topical <span style="color:#f92672">and</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> Generalized linear models <span style="color:#66d9ef">with</span> nonlinear feature transfor<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>directly relevant to the items on which users have already
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> mations are widely used <span style="color:#66d9ef">for</span> large<span style="color:#f92672">-</span>scale regression <span style="color:#f92672">and</span> clas<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>performed actions<span style="color:#f92672">.</span> Compared <span style="color:#66d9ef">with</span> memorization, general<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> siï¬cationproblemswithsparseinputs<span style="color:#f92672">.</span> Memorizationoffea<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>ization tends to improve the diversity of the recommended
</span></span><span style="display:flex;"><span>  tureinteractionsthroughawide setofcross<span style="color:#f92672">-</span>productfeature
</span></span><span style="display:flex;"><span>n items<span style="color:#f92672">.</span> Inthispaper,wefocusontheappsrecommendation
</span></span><span style="display:flex;"><span>transformationsareeï¬€ectiveandinterpretable,whilegener<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>u problemfortheGooglePlaystore,buttheapproachshould
</span></span><span style="display:flex;"><span>alizationrequiresmorefeatureengineeringeï¬€ort<span style="color:#f92672">.</span> Withless
</span></span><span style="display:flex;"><span>J apply to generic recommender systems<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>  featureengineering,deepneuralnetworkscangeneralizebet<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> Formassive<span style="color:#f92672">-</span>scaleonlinerecommendationandrankingsys<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>tertounseenfeaturecombinationsthroughlow<span style="color:#f92672">-</span>dimensional
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> temsinanindustrialsetting,generalizedlinearmodelssuch
</span></span><span style="display:flex;"><span>denseembeddingslearnedforthesparsefeatures<span style="color:#f92672">.</span> However,
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">as</span> logistic regression are widely used because they are sim<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>  deep neural networks <span style="color:#66d9ef">with</span> embeddings can over<span style="color:#f92672">-</span>generalize
</span></span><span style="display:flex;"><span>] ple,scalableandinterpretable<span style="color:#f92672">.</span> Themodelsareoftentrained
</span></span><span style="display:flex;"><span>G andrecommendlessrelevantitemswhentheuser<span style="color:#f92672">-</span>iteminter<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>onbinarizedsparsefeatureswithone<span style="color:#f92672">-</span>hotencoding<span style="color:#f92672">.</span> E<span style="color:#f92672">.</span>g<span style="color:#f92672">.</span>,the
</span></span><span style="display:flex;"><span>actions are sparse <span style="color:#f92672">and</span> high<span style="color:#f92672">-</span>rank<span style="color:#f92672">.</span> In this paper, we present
</span></span><span style="display:flex;"><span>L binary feature<span style="color:#960050;background-color:#1e0010">â€œ</span>user_installed_app<span style="color:#f92672">=</span>netflix<span style="color:#960050;background-color:#1e0010">â€</span>has value <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Wide <span style="color:#f92672">&amp;</span> Deep learning<span style="color:#960050;background-color:#1e0010">â€”</span>jointly trained wide linear models
</span></span><span style="display:flex;"><span><span style="color:#f92672">.</span> <span style="color:#66d9ef">if</span> the user installed Netï¬‚ix<span style="color:#f92672">.</span> Memorization can be achieved
</span></span><span style="display:flex;"><span>s anddeepneuralnetworks<span style="color:#960050;background-color:#1e0010">â€”</span>tocombinethebeneï¬tsofmem<span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>c orization <span style="color:#f92672">and</span> generalization <span style="color:#66d9ef">for</span> recommender systems<span style="color:#f92672">.</span> We eï¬€ectively using cross<span style="color:#f92672">-</span>product t</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2-è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶" class="pagebody-header">
    2. è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶
  </h3>
</div><p class="component-content component">è¯å…¸æ–‡ä»¶æ¥è‡ªï¼šhttps://github.com/skywind3000/ECDICT ä½¿ç”¨æ­¥éª¤ï¼š</p>
<div class="component-content component"><ol>
<li>ä¸‹è½½ä»£ç æ‰“åŒ…ï¼šhttps://github.com/skywind3000/ECDICT/archive/master.zip</li>
<li>è§£å‹master.zipï¼Œç„¶åè§£å‹å…¶ä¸­çš„â€ªstardict.csvæ–‡ä»¶</li>
</ol></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ³¨æ„ï¼šstardict.csvçš„åœ°å€éœ€è¦æ›¿æ¢æˆä½ è‡ªå·±çš„æ–‡ä»¶åœ°å€</span>
</span></span><span style="display:flex;"><span>df_dict <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;D:/tmp/ECDICT-master/stardict.csv&#34;</span>)
</span></span><span style="display:flex;"><span>d:\Anaconda3\lib\site<span style="color:#f92672">-</span>packages\IPython\core\interactiveshell<span style="color:#f92672">.</span>py:<span style="color:#ae81ff">3063</span>: DtypeWarning: Columns (<span style="color:#ae81ff">11</span>) have mixed types<span style="color:#f92672">.</span>Specify dtype option on <span style="color:#f92672">import</span> or set low_memory<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span><span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>  interactivity<span style="color:#f92672">=</span>interactivity, compiler<span style="color:#f92672">=</span>compiler, result<span style="color:#f92672">=</span>result)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_dict<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">3402564</span>, <span style="color:#ae81ff">13</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_dict<span style="color:#f92672">.</span>sample(<span style="color:#ae81ff">10</span>)<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">phonetic</th>
<th style="text-align:right">definition</th>
<th style="text-align:right">translation</th>
<th style="text-align:right">pos</th>
<th style="text-align:right">collins</th>
<th style="text-align:right">oxford</th>
<th style="text-align:right">tag</th>
<th style="text-align:right">bnc</th>
<th style="text-align:right">frq</th>
<th style="text-align:right">exchange</th>
<th style="text-align:right">detail</th>
<th style="text-align:right">audio</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">801655</td>
<td style="text-align:right">design height</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">è®¾è®¡é«˜åº¦</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2739800</td>
<td style="text-align:right">shibu</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[ç½‘ç»œ] æ–¹å›æ˜¥å ‚ï¼›å–Šå§</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1232187</td>
<td style="text-align:right">genus Testudo</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[ç½‘ç»œ] Testudoå±</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">s:genus testudoes</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2403094</td>
<td style="text-align:right">profit-and-loss statements</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[ä¼šè®¡] æŸç›Šè¡¨</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0:profit-and-loss statement/1:s</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1197174</td>
<td style="text-align:right">gain limited sensitivity</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">æé™å¢ç›Šçµæ•åº¦</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æŠŠwordã€translationä¹‹å¤–çš„åˆ—æ‰”æ‰</span>
</span></span><span style="display:flex;"><span>df_dict <span style="color:#f92672">=</span> df_dict[[<span style="color:#e6db74">&#34;word&#34;</span>, <span style="color:#e6db74">&#34;translation&#34;</span>]]
</span></span><span style="display:flex;"><span>df_dict<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">translation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">&lsquo;a</td>
<td style="text-align:right">na. ä¸€\nn. è‹±æ–‡å­—æ¯è¡¨çš„ç¬¬ä¸€å­—æ¯ï¼›ã€ä¹ã€‘AéŸ³\nart. å† ä»¥ä¸å®šå† è¯ä¸»è¦è¡¨ç¤ºç±»åˆ«...</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">&lsquo;A&rsquo; game</td>
<td style="text-align:right">[ç½‘ç»œ] æ¸¸æˆï¼›ä¸€ä¸ªæ¸¸æˆï¼›ä¸€å±€</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">&lsquo;AbbÄsÄ«yah</td>
<td style="text-align:right">[åœ°å] é˜¿å·´è¥¿è€¶ ( åŸƒ )</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">&lsquo;Abd al KÅ«rÄ«</td>
<td style="text-align:right">[åœ°å] é˜¿åœæœå‹’åº“é‡Œå²› ( ä¹Ÿé—¨ )</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">&lsquo;Abd al MÄjid</td>
<td style="text-align:right">[åœ°å] é˜¿åœæœå‹’é©¬å‰å¾· ( è‹ä¸¹ )</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3-è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—" class="pagebody-header">
    3. è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—
  </h3>
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># åˆ†è¯</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>word_list <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&#34;&#34;[ ,.\(\)/</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">|\-:=\$\[&#34;&#39;]&#34;&#34;&#34;</span>, pdf_cont)
</span></span><span style="display:flex;"><span>word_list[:<span style="color:#ae81ff">10</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;Wide&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;&amp;&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;Deep&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;Learning&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;for&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;Recommender&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;Systems&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;Heng&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;Tze&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;Cheng&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ•°æ®æ¸…æ´—</span>
</span></span><span style="display:flex;"><span>word_list_clean <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> word_list:
</span></span><span style="display:flex;"><span>    word <span style="color:#f92672">=</span> str(word)<span style="color:#f92672">.</span>lower()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># è¿‡æ»¤æ‰ç©ºè¯ã€æ•°å­—ã€å•ä¸ªå­—ç¬¦çš„è¯ã€åœç”¨è¯</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> word <span style="color:#f92672">or</span> word<span style="color:#f92672">.</span>isnumeric() <span style="color:#f92672">or</span> len(word)<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>    word_list_clean<span style="color:#f92672">.</span>append(word)
</span></span><span style="display:flex;"><span>word_list_clean[:<span style="color:#ae81ff">20</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;wide&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;deep&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;learning&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;for&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;recommender&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;systems&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;heng&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;tze&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;cheng&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;levent&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;koc&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;jeremiah&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;harmsen&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;tal&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;shaked&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;tushar&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;chandra&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;hrishi&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;aradhye&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;glen&#39;</span>]</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="4-åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªdataframe" class="pagebody-header">
    4. åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªDataFrame
  </h3>
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_words <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;word&#34;</span>: word_list_clean
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>df_words<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">wide</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">deep</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">learning</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">for</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">recommender</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_words<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">2322</span>, <span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ç»Ÿè®¡è¯é¢‘</span>
</span></span><span style="display:flex;"><span>df_words <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>    df_words
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;word&#34;</span>)[<span style="color:#e6db74">&#34;word&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>agg(count<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;size&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>reset_index()
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;count&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>df_words<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">10</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">804</td>
<td style="text-align:right">the</td>
<td style="text-align:right">128</td>
</tr>
<tr>
<td style="text-align:right">57</td>
<td style="text-align:right">and</td>
<td style="text-align:right">67</td>
</tr>
<tr>
<td style="text-align:right">546</td>
<td style="text-align:right">of</td>
<td style="text-align:right">46</td>
</tr>
<tr>
<td style="text-align:right">503</td>
<td style="text-align:right">model</td>
<td style="text-align:right">41</td>
</tr>
<tr>
<td style="text-align:right">939</td>
<td style="text-align:right">wide</td>
<td style="text-align:right">36</td>
</tr>
<tr>
<td style="text-align:right">374</td>
<td style="text-align:right">in</td>
<td style="text-align:right">36</td>
</tr>
<tr>
<td style="text-align:right">203</td>
<td style="text-align:right">deep</td>
<td style="text-align:right">35</td>
</tr>
<tr>
<td style="text-align:right">405</td>
<td style="text-align:right">is</td>
<td style="text-align:right">31</td>
</tr>
<tr>
<td style="text-align:right">286</td>
<td style="text-align:right">for</td>
<td style="text-align:right">30</td>
</tr>
<tr>
<td style="text-align:right">845</td>
<td style="text-align:right">to</td>
<td style="text-align:right">29</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="5-å’Œå•è¯è¯å…¸å®ç°merge" class="pagebody-header">
    5. å’Œå•è¯è¯å…¸å®ç°merge
  </h3>
</div><p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(
</span></span><span style="display:flex;"><span>    left <span style="color:#f92672">=</span> df_dict,
</span></span><span style="display:flex;"><span>    right <span style="color:#f92672">=</span> df_words,
</span></span><span style="display:flex;"><span>    left_on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;word&#34;</span>,
</span></span><span style="display:flex;"><span>    right_on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;word&#34;</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [32]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>sample(<span style="color:#ae81ff">10</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[32]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">translation</th>
<th style="text-align:right">count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">account</td>
<td style="text-align:right">n. æŠ¥å‘Š, è§£é‡Š, ä¼°ä»·, ç†ç”±, åˆ©æ¶¦, ç®—è´¦, å¸ç›®\nvi. æŠ¥å¸, è§£é‡Š, å¯¼è‡´,&hellip;</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">380</td>
<td style="text-align:right">prediction</td>
<td style="text-align:right">n. é¢„è¨€, é¢„æŠ¥\n[åŒ–] é¢„æµ‹</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">185</td>
<td style="text-align:right">generalization</td>
<td style="text-align:right">n. ä¸€èˆ¬åŒ–, æ™®éåŒ–, æ¦‚æ‹¬\n[åŒ–] æ¨å¹¿; æ™®é€‚åŒ–</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">56</td>
<td style="text-align:right">burget</td>
<td style="text-align:right">[äººå] ä¼¯å‰ç‰¹</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">372</td>
<td style="text-align:right">pipeline</td>
<td style="text-align:right">n. ç®¡é“, ä¼ é€’é€”å¾„\n[åŒ–] ç®¡è·¯; ç®¡çº¿</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">237</td>
<td style="text-align:right">include</td>
<td style="text-align:right">vt. åŒ…æ‹¬, æŠŠ&hellip;ç®—å…¥, åŒ…ä½\n[è®¡] DOSå†…éƒ¨å‘½ä»¤:åœ¨CONFIG.SYSæ–‡ä»¶çš„&hellip;</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">524</td>
<td style="text-align:right">threads</td>
<td style="text-align:right">n. çº¿ï¼›ç›¸å…³ä¸²è¿ï¼›çº¿ç¨‹ï¼ˆthreadçš„å¤æ•°ï¼‰</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">208</td>
<td style="text-align:right">heng</td>
<td style="text-align:right">n. æ’; ç©</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">62</td>
<td style="text-align:right">capacity</td>
<td style="text-align:right">n. å®¹é‡, èƒ½åŠ›, æ‰èƒ½, èµ„æ ¼\n[è®¡] å®¹é‡</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">228</td>
<td style="text-align:right">important</td>
<td style="text-align:right">a. é‡è¦çš„, æœ‰åœ°ä½çš„, å¤§é‡çš„, æ˜¾è¦çš„, è‡ªè´Ÿçš„\n[è®¡] è¦ç‚¹</td>
<td style="text-align:right">2</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [33]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[33]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">607</span>, <span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="6-å­˜å…¥excel" class="pagebody-header">
    6. å­˜å…¥Excel
  </h3>
</div><p class="component-content component">In [34]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">&#34;./39. pdf_chinese_english.xlsx&#34;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="40pandasæ€æ ·å®ç°groupbyèšåˆåå­—ç¬¦ä¸²åˆ—çš„åˆå¹¶" class="pagebody-header">
    40ã€Pandasæ€æ ·å®ç°groupbyèšåˆåå­—ç¬¦ä¸²åˆ—çš„åˆå¹¶
  </h1>
</div>
<div class="component-content pagebody component">
  <h4 id="éœ€æ±‚" class="pagebody-header">
    éœ€æ±‚ï¼š
  </h4>
</div><p class="component-content component">è®¡ç®—æ¯ä¸ªæœˆçš„æœ€é«˜æ¸©åº¦ã€æœ€ä½æ¸©åº¦ã€å‡ºç°çš„é£å‘åˆ—è¡¨ã€å‡ºç°çš„ç©ºæ°”è´¨é‡åˆ—è¡¨</p>

<div class="component-content pagebody component">
  <h4 id="æ•°æ®è¾“å…¥" class="pagebody-header">
    æ•°æ®è¾“å…¥
  </h4>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-49f0a1b8342c646fe56c5badfcf59506" id="lht49f0a1b8342c646fe56c5badfcf59506">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/31.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h4 id="æ•°æ®è¾“å‡º" class="pagebody-header">
    æ•°æ®è¾“å‡º
  </h4>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-107226b55056fefe9c4cce41008440f3" id="lht107226b55056fefe9c4cce41008440f3">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/32.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h3 id="è¯»å–æ•°æ®" class="pagebody-header">
    è¯»å–æ•°æ®
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fpath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(fpath)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3â„ƒ</td>
<td style="text-align:right">-6â„ƒ</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2â„ƒ</td>
<td style="text-align:right">-5â„ƒ</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2â„ƒ</td>
<td style="text-align:right">-5â„ƒ</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="çŸ¥è¯†ä½¿ç”¨dfinfoå¯ä»¥æŸ¥çœ‹æ¯åˆ—çš„ç±»å‹" class="pagebody-header">
    çŸ¥è¯†ï¼šä½¿ç”¨df.info()å¯ä»¥æŸ¥çœ‹æ¯åˆ—çš„ç±»å‹
  </h4>
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">365</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">364</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">9</span> columns):
</span></span><span style="display:flex;"><span> <span style="color:#75715e">#   Column     Non-Null Count  Dtype </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">---</span>  <span style="color:#f92672">------</span>     <span style="color:#f92672">--------------</span>  <span style="color:#f92672">-----</span> 
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">0</span>   ymd        <span style="color:#ae81ff">365</span> non<span style="color:#f92672">-</span>null    object
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">1</span>   bWendu     <span style="color:#ae81ff">365</span> non<span style="color:#f92672">-</span>null    object
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">2</span>   yWendu     <span style="color:#ae81ff">365</span> non<span style="color:#f92672">-</span>null    object
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">3</span>   tianqi     <span style="color:#ae81ff">365</span> non<span style="color:#f92672">-</span>null    object
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">4</span>   fengxiang  <span style="color:#ae81ff">365</span> non<span style="color:#f92672">-</span>null    object
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">5</span>   fengli     <span style="color:#ae81ff">365</span> non<span style="color:#f92672">-</span>null    object
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">6</span>   aqi        <span style="color:#ae81ff">365</span> non<span style="color:#f92672">-</span>null    int64 
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">7</span>   aqiInfo    <span style="color:#ae81ff">365</span> non<span style="color:#f92672">-</span>null    object
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">8</span>   aqiLevel   <span style="color:#ae81ff">365</span> non<span style="color:#f92672">-</span>null    int64 
</span></span><span style="display:flex;"><span>dtypes: int64(<span style="color:#ae81ff">2</span>), object(<span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">25.8</span><span style="color:#f92672">+</span> KB</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="çŸ¥è¯†seriesæ€æ ·ä»strç±»å‹å˜æˆint" class="pagebody-header">
    çŸ¥è¯†ï¼šseriesæ€æ ·ä»strç±»å‹å˜æˆint
  </h4>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;â„ƒ&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;yWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;yWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;â„ƒ&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="çŸ¥è¯†è¿›è¡Œæ—¥æœŸåˆ—è§£æå¯ä»¥æ–¹ä¾¿æå–æœˆä»½" class="pagebody-header">
    çŸ¥è¯†ï¼šè¿›è¡Œæ—¥æœŸåˆ—è§£æï¼Œå¯ä»¥æ–¹ä¾¿æå–æœˆä»½
  </h4>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ymd&#34;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_datetime(df[<span style="color:#e6db74">&#34;ymd&#34;</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>       <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>       <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">..</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>Name: ymd, Length: <span style="color:#ae81ff">365</span>, dtype: int64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="çŸ¥è¯†serieså¯ä»¥ç”¨seriesuniqueå»é‡" class="pagebody-header">
    çŸ¥è¯†ï¼šserieså¯ä»¥ç”¨Series.uniqueå»é‡
  </h4>
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;fengxiang&#34;</span>]<span style="color:#f92672">.</span>unique()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-v" data-lang="v"><span style="display:flex;"><span>array([<span style="color:#e6db74">&#39;ä¸œåŒ—é£&#39;</span>, <span style="color:#e6db74">&#39;åŒ—é£&#39;</span>, <span style="color:#e6db74">&#39;è¥¿åŒ—é£&#39;</span>, <span style="color:#e6db74">&#39;è¥¿å—é£&#39;</span>, <span style="color:#e6db74">&#39;å—é£&#39;</span>, <span style="color:#e6db74">&#39;ä¸œå—é£&#39;</span>, <span style="color:#e6db74">&#39;ä¸œé£&#39;</span>, <span style="color:#e6db74">&#39;è¥¿é£&#39;</span>], dtype<span style="color:#f92672">=</span>object)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="çŸ¥è¯†å¯ä»¥ç”¨joinserieså®ç°æ•°ç»„åˆå¹¶æˆå¤§å­—ç¬¦ä¸²" class="pagebody-header">
    çŸ¥è¯†ï¼šå¯ä»¥ç”¨&quot;,&quot;.join(series)å®ç°æ•°ç»„åˆå¹¶æˆå¤§å­—ç¬¦ä¸²
  </h4>
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">.</span>join(df[<span style="color:#e6db74">&#34;fengxiang&#34;</span>]<span style="color:#f92672">.</span>unique())</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#39;ä¸œåŒ—é£,åŒ—é£,è¥¿åŒ—é£,è¥¿å—é£,å—é£,ä¸œå—é£,ä¸œé£,è¥¿é£&#39;</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="æ–¹æ³•1" class="pagebody-header">
    æ–¹æ³•1
  </h3>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>result <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>    df<span style="color:#f92672">.</span>groupby(df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month)
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span>agg(
</span></span><span style="display:flex;"><span>          <span style="color:#75715e"># æ–°åˆ—å = (åŸåˆ—åï¼Œå‡½æ•°)</span>
</span></span><span style="display:flex;"><span>          æœ€é«˜æ¸©åº¦<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;bWendu&#34;</span>, <span style="color:#e6db74">&#34;max&#34;</span>),
</span></span><span style="display:flex;"><span>          æœ€ä½æ¸©åº¦<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;yWendu&#34;</span>, <span style="color:#e6db74">&#34;min&#34;</span>),
</span></span><span style="display:flex;"><span>          é£å‘åˆ—è¡¨<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;fengxiang&#34;</span>, <span style="color:#66d9ef">lambda</span> x : <span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">.</span>join(x<span style="color:#f92672">.</span>unique())),
</span></span><span style="display:flex;"><span>          ç©ºæ°”è´¨é‡åˆ—è¡¨<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;aqiInfo&#34;</span>, <span style="color:#66d9ef">lambda</span> x : <span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">.</span>join(x<span style="color:#f92672">.</span>unique()))
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span>reset_index()
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;ymd&#34;</span>:<span style="color:#e6db74">&#34;æœˆä»½&#34;</span>})
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>result</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æœˆä»½</th>
<th style="text-align:right">æœ€é«˜æ¸©åº¦</th>
<th style="text-align:right">æœ€ä½æ¸©åº¦</th>
<th style="text-align:right">é£å‘åˆ—è¡¨</th>
<th style="text-align:right">ç©ºæ°”è´¨é‡åˆ—è¡¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">ä¸œåŒ—é£,åŒ—é£,è¥¿åŒ—é£,è¥¿å—é£,å—é£,ä¸œå—é£,ä¸œé£</td>
<td style="text-align:right">è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">-10</td>
<td style="text-align:right">åŒ—é£,è¥¿å—é£,å—é£,è¥¿åŒ—é£,è¥¿é£,ä¸œåŒ—é£,ä¸œé£</td>
<td style="text-align:right">è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">27</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">è¥¿å—é£,åŒ—é£,ä¸œå—é£,å—é£,ä¸œåŒ—é£,ä¸œé£</td>
<td style="text-align:right">ä¼˜,è‰¯,é‡åº¦æ±¡æŸ“,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“,ä¸¥é‡æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">30</td>
<td style="text-align:right">1</td>
<td style="text-align:right">å—é£,åŒ—é£,ä¸œåŒ—é£,è¥¿å—é£,è¥¿åŒ—é£,ä¸œå—é£</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“,è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">35</td>
<td style="text-align:right">10</td>
<td style="text-align:right">ä¸œåŒ—é£,åŒ—é£,è¥¿å—é£,å—é£,ä¸œå—é£,ä¸œé£,è¥¿é£,è¥¿åŒ—é£</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“,ä¼˜,è‰¯,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">38</td>
<td style="text-align:right">17</td>
<td style="text-align:right">è¥¿å—é£,å—é£,åŒ—é£,ä¸œé£,ä¸œå—é£,ä¸œåŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
<td style="text-align:right">37</td>
<td style="text-align:right">22</td>
<td style="text-align:right">ä¸œå—é£,è¥¿å—é£,å—é£,ä¸œåŒ—é£,ä¸œé£,è¥¿é£,åŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
<td style="text-align:right">36</td>
<td style="text-align:right">20</td>
<td style="text-align:right">ä¸œå—é£,å—é£,ä¸œé£,ä¸œåŒ—é£,åŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">31</td>
<td style="text-align:right">11</td>
<td style="text-align:right">å—é£,åŒ—é£,è¥¿å—é£,è¥¿åŒ—é£</td>
<td style="text-align:right">ä¼˜,è‰¯,è½»åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">25</td>
<td style="text-align:right">1</td>
<td style="text-align:right">åŒ—é£,è¥¿åŒ—é£,å—é£,è¥¿é£,ä¸œåŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">ä¼˜,è‰¯,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
<td style="text-align:right">18</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">å—é£,åŒ—é£,è¥¿å—é£,ä¸œå—é£,è¥¿åŒ—é£,ä¸œåŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“,ä¼˜,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">12</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">ä¸œå—é£,ä¸œåŒ—é£,è¥¿åŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“,è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="æ–¹æ³•2" class="pagebody-header">
    æ–¹æ³•2
  </h3>
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">agg_func</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;æ³¨æ„ï¼Œè¿™ä¸ªxæ˜¯æ¯ä¸ªåˆ†ç»„çš„dataframe&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> pd<span style="color:#f92672">.</span>Series({
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;æœ€é«˜æ¸©åº¦&#34;</span>: x[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>max(),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;æœ€ä½æ¸©åº¦&#34;</span>: x[<span style="color:#e6db74">&#34;yWendu&#34;</span>]<span style="color:#f92672">.</span>min(),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;é£å‘åˆ—è¡¨&#34;</span>: <span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">.</span>join(x[<span style="color:#e6db74">&#34;fengxiang&#34;</span>]<span style="color:#f92672">.</span>unique()),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;ç©ºæ°”è´¨é‡åˆ—è¡¨&#34;</span>: <span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">.</span>join(x[<span style="color:#e6db74">&#34;aqiInfo&#34;</span>]<span style="color:#f92672">.</span>unique())
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> df \
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>groupby(df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month) \
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>apply(agg_func) \
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>reset_index() \
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;ymd&#34;</span>:<span style="color:#e6db74">&#34;æœˆä»½&#34;</span>})</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>result</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æœˆä»½</th>
<th style="text-align:right">æœ€é«˜æ¸©åº¦</th>
<th style="text-align:right">æœ€ä½æ¸©åº¦</th>
<th style="text-align:right">é£å‘åˆ—è¡¨</th>
<th style="text-align:right">ç©ºæ°”è´¨é‡åˆ—è¡¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">ä¸œåŒ—é£,åŒ—é£,è¥¿åŒ—é£,è¥¿å—é£,å—é£,ä¸œå—é£,ä¸œé£</td>
<td style="text-align:right">è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">-10</td>
<td style="text-align:right">åŒ—é£,è¥¿å—é£,å—é£,è¥¿åŒ—é£,è¥¿é£,ä¸œåŒ—é£,ä¸œé£</td>
<td style="text-align:right">è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">27</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">è¥¿å—é£,åŒ—é£,ä¸œå—é£,å—é£,ä¸œåŒ—é£,ä¸œé£</td>
<td style="text-align:right">ä¼˜,è‰¯,é‡åº¦æ±¡æŸ“,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“,ä¸¥é‡æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">30</td>
<td style="text-align:right">1</td>
<td style="text-align:right">å—é£,åŒ—é£,ä¸œåŒ—é£,è¥¿å—é£,è¥¿åŒ—é£,ä¸œå—é£</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“,è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">35</td>
<td style="text-align:right">10</td>
<td style="text-align:right">ä¸œåŒ—é£,åŒ—é£,è¥¿å—é£,å—é£,ä¸œå—é£,ä¸œé£,è¥¿é£,è¥¿åŒ—é£</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“,ä¼˜,è‰¯,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">38</td>
<td style="text-align:right">17</td>
<td style="text-align:right">è¥¿å—é£,å—é£,åŒ—é£,ä¸œé£,ä¸œå—é£,ä¸œåŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
<td style="text-align:right">37</td>
<td style="text-align:right">22</td>
<td style="text-align:right">ä¸œå—é£,è¥¿å—é£,å—é£,ä¸œåŒ—é£,ä¸œé£,è¥¿é£,åŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
<td style="text-align:right">36</td>
<td style="text-align:right">20</td>
<td style="text-align:right">ä¸œå—é£,å—é£,ä¸œé£,ä¸œåŒ—é£,åŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">31</td>
<td style="text-align:right">11</td>
<td style="text-align:right">å—é£,åŒ—é£,è¥¿å—é£,è¥¿åŒ—é£</td>
<td style="text-align:right">ä¼˜,è‰¯,è½»åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">25</td>
<td style="text-align:right">1</td>
<td style="text-align:right">åŒ—é£,è¥¿åŒ—é£,å—é£,è¥¿é£,ä¸œåŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">ä¼˜,è‰¯,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
<td style="text-align:right">18</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">å—é£,åŒ—é£,è¥¿å—é£,ä¸œå—é£,è¥¿åŒ—é£,ä¸œåŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“,ä¼˜,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">12</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">ä¸œå—é£,ä¸œåŒ—é£,è¥¿åŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“,è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="41pandasè¯»å–excelç»˜åˆ¶ç›´æ–¹å›¾" class="pagebody-header">
    41ã€Pandasè¯»å–Excelç»˜åˆ¶ç›´æ–¹å›¾
  </h1>
</div><p class="component-content component">*<strong>ç›´æ–¹å›¾(Histogram)ï¼š*</strong>
ç›´æ–¹å›¾æ˜¯æ•°å€¼æ•°æ®åˆ†å¸ƒçš„ç²¾ç¡®å›¾å½¢è¡¨ç¤ºï¼Œæ˜¯ä¸€ä¸ªè¿ç»­å˜é‡ï¼ˆå®šé‡å˜é‡ï¼‰çš„æ¦‚ç‡åˆ†å¸ƒçš„ä¼°è®¡ï¼Œå®ƒæ˜¯ä¸€ç§æ¡å½¢å›¾ã€‚
ä¸ºäº†æ„å»ºç›´æ–¹å›¾ï¼Œç¬¬ä¸€æ­¥æ˜¯å°†å€¼çš„èŒƒå›´åˆ†æ®µï¼Œå³å°†æ•´ä¸ªå€¼çš„èŒƒå›´åˆ†æˆä¸€ç³»åˆ—é—´éš”ï¼Œç„¶åè®¡ç®—æ¯ä¸ªé—´éš”ä¸­æœ‰å¤šå°‘å€¼ã€‚</p>

<div class="component-content pagebody component">
  <h3 id="1-è¯»å–æ•°æ®" class="pagebody-header">
    1. è¯»å–æ•°æ®
  </h3>
</div><p class="component-content component">æ³¢æ–¯é¡¿æˆ¿ä»·æ•°æ®é›†</p>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#34;./datas/boston-house-prices/housing.xlsx&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">CRIM</th>
<th style="text-align:right">ZN</th>
<th style="text-align:right">INDUS</th>
<th style="text-align:right">CHAS</th>
<th style="text-align:right">NOX</th>
<th style="text-align:right">RM</th>
<th style="text-align:right">AGE</th>
<th style="text-align:right">DIS</th>
<th style="text-align:right">RAD</th>
<th style="text-align:right">TAX</th>
<th style="text-align:right">PTRATIO</th>
<th style="text-align:right">B</th>
<th style="text-align:right">LSTAT</th>
<th style="text-align:right">MEDV</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0.00632</td>
<td style="text-align:right">18.0</td>
<td style="text-align:right">2.31</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.538</td>
<td style="text-align:right">6.575</td>
<td style="text-align:right">65.2</td>
<td style="text-align:right">4.0900</td>
<td style="text-align:right">1</td>
<td style="text-align:right">296</td>
<td style="text-align:right">15.3</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">4.98</td>
<td style="text-align:right">24.0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">0.02731</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">7.07</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.469</td>
<td style="text-align:right">6.421</td>
<td style="text-align:right">78.9</td>
<td style="text-align:right">4.9671</td>
<td style="text-align:right">2</td>
<td style="text-align:right">242</td>
<td style="text-align:right">17.8</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">9.14</td>
<td style="text-align:right">21.6</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">0.02729</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">7.07</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.469</td>
<td style="text-align:right">7.185</td>
<td style="text-align:right">61.1</td>
<td style="text-align:right">4.9671</td>
<td style="text-align:right">2</td>
<td style="text-align:right">242</td>
<td style="text-align:right">17.8</td>
<td style="text-align:right">392.83</td>
<td style="text-align:right">4.03</td>
<td style="text-align:right">34.7</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">0.03237</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">2.18</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.458</td>
<td style="text-align:right">6.998</td>
<td style="text-align:right">45.8</td>
<td style="text-align:right">6.0622</td>
<td style="text-align:right">3</td>
<td style="text-align:right">222</td>
<td style="text-align:right">18.7</td>
<td style="text-align:right">394.63</td>
<td style="text-align:right">2.94</td>
<td style="text-align:right">33.4</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">0.06905</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">2.18</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.458</td>
<td style="text-align:right">7.147</td>
<td style="text-align:right">54.2</td>
<td style="text-align:right">6.0622</td>
<td style="text-align:right">3</td>
<td style="text-align:right">222</td>
<td style="text-align:right">18.7</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">5.33</td>
<td style="text-align:right">36.2</td>
</tr>
<tr>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
</tr>
<tr>
<td style="text-align:right">501</td>
<td style="text-align:right">0.06263</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">11.93</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.573</td>
<td style="text-align:right">6.593</td>
<td style="text-align:right">69.1</td>
<td style="text-align:right">2.4786</td>
<td style="text-align:right">1</td>
<td style="text-align:right">273</td>
<td style="text-align:right">21.0</td>
<td style="text-align:right">391.99</td>
<td style="text-align:right">9.67</td>
<td style="text-align:right">22.4</td>
</tr>
<tr>
<td style="text-align:right">502</td>
<td style="text-align:right">0.04527</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">11.93</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.573</td>
<td style="text-align:right">6.120</td>
<td style="text-align:right">76.7</td>
<td style="text-align:right">2.2875</td>
<td style="text-align:right">1</td>
<td style="text-align:right">273</td>
<td style="text-align:right">21.0</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">9.08</td>
<td style="text-align:right">20.6</td>
</tr>
<tr>
<td style="text-align:right">503</td>
<td style="text-align:right">0.06076</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">11.93</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.573</td>
<td style="text-align:right">6.976</td>
<td style="text-align:right">91.0</td>
<td style="text-align:right">2.1675</td>
<td style="text-align:right">1</td>
<td style="text-align:right">273</td>
<td style="text-align:right">21.0</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">5.64</td>
<td style="text-align:right">23.9</td>
</tr>
<tr>
<td style="text-align:right">504</td>
<td style="text-align:right">0.10959</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">11.93</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.573</td>
<td style="text-align:right">6.794</td>
<td style="text-align:right">89.3</td>
<td style="text-align:right">2.3889</td>
<td style="text-align:right">1</td>
<td style="text-align:right">273</td>
<td style="text-align:right">21.0</td>
<td style="text-align:right">393.45</td>
<td style="text-align:right">6.48</td>
<td style="text-align:right">22.0</td>
</tr>
<tr>
<td style="text-align:right">505</td>
<td style="text-align:right">0.04741</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">11.93</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.573</td>
<td style="text-align:right">6.030</td>
<td style="text-align:right">80.8</td>
<td style="text-align:right">2.5050</td>
<td style="text-align:right">1</td>
<td style="text-align:right">273</td>
<td style="text-align:right">21.0</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">7.88</td>
<td style="text-align:right">11.9</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">506 rows Ã— 14 columns</p>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">506</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">505</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">14</span> columns):
</span></span><span style="display:flex;"><span> <span style="color:#75715e">#   Column   Non-Null Count  Dtype  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">---</span>  <span style="color:#f92672">------</span>   <span style="color:#f92672">--------------</span>  <span style="color:#f92672">-----</span>  
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">0</span>   CRIM     <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">1</span>   ZN       <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">2</span>   INDUS    <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">3</span>   CHAS     <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    int64  
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">4</span>   NOX      <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">5</span>   RM       <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">6</span>   AGE      <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">7</span>   DIS      <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">8</span>   RAD      <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    int64  
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">9</span>   TAX      <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    int64  
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">10</span>  PTRATIO  <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">11</span>  B        <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">12</span>  LSTAT    <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">13</span>  MEDV     <span style="color:#ae81ff">506</span> non<span style="color:#f92672">-</span>null    float64
</span></span><span style="display:flex;"><span>dtypes: float64(<span style="color:#ae81ff">11</span>), int64(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">55.5</span> KB</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;MEDV&#34;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">24.0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">21.6</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">34.7</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">33.4</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">36.2</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">...</span> 
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">501</span>    <span style="color:#ae81ff">22.4</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">502</span>    <span style="color:#ae81ff">20.6</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">503</span>    <span style="color:#ae81ff">23.9</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">504</span>    <span style="color:#ae81ff">22.0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">505</span>    <span style="color:#ae81ff">11.9</span>
</span></span><span style="display:flex;"><span>Name: MEDV, Length: <span style="color:#ae81ff">506</span>, dtype: float64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2-ä½¿ç”¨matplotlibç”»ç›´æ–¹å›¾" class="pagebody-header">
    2. ä½¿ç”¨matplotlibç”»ç›´æ–¹å›¾
  </h3>
</div><p class="component-content component">matplotlibç›´æ–¹å›¾æ–‡æ¡£ï¼šhttps://matplotlib.org/3.2.0/api/_as_gen/matplotlib.pyplot.hist.html</p>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(df[<span style="color:#e6db74">&#34;MEDV&#34;</span>], bins<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()</span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-b1a14f63b52df2d11112ab5001d0c1b2" id="lhtb1a14f63b52df2d11112ab5001d0c1b2">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/33.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h3 id="3-ä½¿ç”¨pyechartsç”»ç›´æ–¹å›¾" class="pagebody-header">
    3. ä½¿ç”¨pyechartsç”»ç›´æ–¹å›¾
  </h3>
</div><p class="component-content component">pyechartsç›´æ–¹å›¾æ–‡æ¡£ï¼šhttp://gallery.pyecharts.org/#/Bar/bar_histogram
numpyç›´æ–¹å›¾æ–‡æ¡£ï¼šhttps://docs.scipy.org/doc/numpy/reference/generated/numpy.histogram.html</p>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pyecharts <span style="color:#f92672">import</span> options <span style="color:#66d9ef">as</span> opts
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pyecharts.charts <span style="color:#f92672">import</span> Bar</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># éœ€è¦è‡ªå·±è®¡ç®—æœ‰å¤šå°‘ä¸ªé—´éš”ã€ä»¥åŠæ¯ä¸ªé—´éš”æœ‰å¤šå°‘ä¸ªå€¼</span>
</span></span><span style="display:flex;"><span>hist,bin_edges <span style="color:#f92672">=</span>  np<span style="color:#f92672">.</span>histogram(df[<span style="color:#e6db74">&#34;MEDV&#34;</span>], bins<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># è¿™æ˜¯æ¯ä¸ªé—´éš”çš„åˆ†å‰²ç‚¹</span>
</span></span><span style="display:flex;"><span>bin_edges</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([ <span style="color:#ae81ff">5.</span>  ,  <span style="color:#ae81ff">5.45</span>,  <span style="color:#ae81ff">5.9</span> ,  <span style="color:#ae81ff">6.35</span>,  <span style="color:#ae81ff">6.8</span> ,  <span style="color:#ae81ff">7.25</span>,  <span style="color:#ae81ff">7.7</span> ,  <span style="color:#ae81ff">8.15</span>,  <span style="color:#ae81ff">8.6</span> ,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">9.05</span>,  <span style="color:#ae81ff">9.5</span> ,  <span style="color:#ae81ff">9.95</span>, <span style="color:#ae81ff">10.4</span> , <span style="color:#ae81ff">10.85</span>, <span style="color:#ae81ff">11.3</span> , <span style="color:#ae81ff">11.75</span>, <span style="color:#ae81ff">12.2</span> , <span style="color:#ae81ff">12.65</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">13.1</span> , <span style="color:#ae81ff">13.55</span>, <span style="color:#ae81ff">14.</span>  , <span style="color:#ae81ff">14.45</span>, <span style="color:#ae81ff">14.9</span> , <span style="color:#ae81ff">15.35</span>, <span style="color:#ae81ff">15.8</span> , <span style="color:#ae81ff">16.25</span>, <span style="color:#ae81ff">16.7</span> ,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">17.15</span>, <span style="color:#ae81ff">17.6</span> , <span style="color:#ae81ff">18.05</span>, <span style="color:#ae81ff">18.5</span> , <span style="color:#ae81ff">18.95</span>, <span style="color:#ae81ff">19.4</span> , <span style="color:#ae81ff">19.85</span>, <span style="color:#ae81ff">20.3</span> , <span style="color:#ae81ff">20.75</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">21.2</span> , <span style="color:#ae81ff">21.65</span>, <span style="color:#ae81ff">22.1</span> , <span style="color:#ae81ff">22.55</span>, <span style="color:#ae81ff">23.</span>  , <span style="color:#ae81ff">23.45</span>, <span style="color:#ae81ff">23.9</span> , <span style="color:#ae81ff">24.35</span>, <span style="color:#ae81ff">24.8</span> ,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">25.25</span>, <span style="color:#ae81ff">25.7</span> , <span style="color:#ae81ff">26.15</span>, <span style="color:#ae81ff">26.6</span> , <span style="color:#ae81ff">27.05</span>, <span style="color:#ae81ff">27.5</span> , <span style="color:#ae81ff">27.95</span>, <span style="color:#ae81ff">28.4</span> , <span style="color:#ae81ff">28.85</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">29.3</span> , <span style="color:#ae81ff">29.75</span>, <span style="color:#ae81ff">30.2</span> , <span style="color:#ae81ff">30.65</span>, <span style="color:#ae81ff">31.1</span> , <span style="color:#ae81ff">31.55</span>, <span style="color:#ae81ff">32.</span>  , <span style="color:#ae81ff">32.45</span>, <span style="color:#ae81ff">32.9</span> ,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">33.35</span>, <span style="color:#ae81ff">33.8</span> , <span style="color:#ae81ff">34.25</span>, <span style="color:#ae81ff">34.7</span> , <span style="color:#ae81ff">35.15</span>, <span style="color:#ae81ff">35.6</span> , <span style="color:#ae81ff">36.05</span>, <span style="color:#ae81ff">36.5</span> , <span style="color:#ae81ff">36.95</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">37.4</span> , <span style="color:#ae81ff">37.85</span>, <span style="color:#ae81ff">38.3</span> , <span style="color:#ae81ff">38.75</span>, <span style="color:#ae81ff">39.2</span> , <span style="color:#ae81ff">39.65</span>, <span style="color:#ae81ff">40.1</span> , <span style="color:#ae81ff">40.55</span>, <span style="color:#ae81ff">41.</span>  ,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">41.45</span>, <span style="color:#ae81ff">41.9</span> , <span style="color:#ae81ff">42.35</span>, <span style="color:#ae81ff">42.8</span> , <span style="color:#ae81ff">43.25</span>, <span style="color:#ae81ff">43.7</span> , <span style="color:#ae81ff">44.15</span>, <span style="color:#ae81ff">44.6</span> , <span style="color:#ae81ff">45.05</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">45.5</span> , <span style="color:#ae81ff">45.95</span>, <span style="color:#ae81ff">46.4</span> , <span style="color:#ae81ff">46.85</span>, <span style="color:#ae81ff">47.3</span> , <span style="color:#ae81ff">47.75</span>, <span style="color:#ae81ff">48.2</span> , <span style="color:#ae81ff">48.65</span>, <span style="color:#ae81ff">49.1</span> ,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">49.55</span>, <span style="color:#ae81ff">50.</span>  ])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>len(bin_edges)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">101</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># è¿™æ˜¯é—´éš”çš„è®¡æ•°</span>
</span></span><span style="display:flex;"><span>hist</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([ <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">5</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">6</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">5</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">6</span>,  <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">14</span>,  <span style="color:#ae81ff">9</span>,  <span style="color:#ae81ff">9</span>,  <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">11</span>,  <span style="color:#ae81ff">8</span>,  <span style="color:#ae81ff">6</span>,  <span style="color:#ae81ff">8</span>,  <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>,  <span style="color:#ae81ff">9</span>,  <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">16</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">16</span>,  <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">14</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">5</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">5</span>,  <span style="color:#ae81ff">5</span>,  <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">6</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">6</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">5</span>,  <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">16</span>],
</span></span><span style="display:flex;"><span>      dtype<span style="color:#f92672">=</span>int64)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>len(hist)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">100</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="å¯¹bin_edgesçš„è§£é‡Šä¸ºä»€ä¹ˆæ˜¯101ä¸ªæ¯”histè®¡æ•°å¤š1ä¸ª" class="pagebody-header">
    å¯¹bin_edgesçš„è§£é‡Šï¼Œä¸ºä»€ä¹ˆæ˜¯101ä¸ªï¼Ÿæ¯”histè®¡æ•°å¤š1ä¸ªï¼Ÿ
  </h4>
</div><p class="component-content component">ä¸¾ä¾‹ï¼šå¦‚æœbinsæ˜¯[1, 2, 3, 4]ï¼Œé‚£ä¹ˆä¼šåˆ†æˆ3ä¸ªåŒºé—´ï¼š[1, 2)ã€[2, 3)ã€[3, 4]ï¼›
å…¶ä¸­binsçš„ç¬¬ä¸€ä¸ªå€¼æ˜¯æ•°ç»„çš„æœ€å°å€¼ï¼Œbinsçš„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯æ•°ç»„çš„æœ€å¤§å€¼</p>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ³¨æ„è§‚å¯Ÿï¼Œminæ˜¯binsçš„ç¬¬ä¸€ä¸ªå€¼ï¼Œmaxæ˜¯binsçš„æœ€åä¸€ä¸ªå…ƒç´ </span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;MEDV&#34;</span>]<span style="color:#f92672">.</span>describe()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>count    <span style="color:#ae81ff">506.000000</span>
</span></span><span style="display:flex;"><span>mean      <span style="color:#ae81ff">22.532806</span>
</span></span><span style="display:flex;"><span>std        <span style="color:#ae81ff">9.197104</span>
</span></span><span style="display:flex;"><span>min        <span style="color:#ae81ff">5.000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">25</span><span style="color:#f92672">%</span>       <span style="color:#ae81ff">17.025000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">50</span><span style="color:#f92672">%</span>       <span style="color:#ae81ff">21.200000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">75</span><span style="color:#f92672">%</span>       <span style="color:#ae81ff">25.000000</span>
</span></span><span style="display:flex;"><span>max       <span style="color:#ae81ff">50.000000</span>
</span></span><span style="display:flex;"><span>Name: MEDV, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class=""># æŸ¥çœ‹binsæ¯ä¸€ä¸ªå€¼å’Œå‰ä¸€ä¸ªå€¼çš„å·®å€¼ï¼Œå¯ä»¥çœ‹åˆ°è¿™æ˜¯ç­‰åˆ†çš„æ•°æ®
np.diff(bin_edges)</code></pre>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([<span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#ae81ff">0.45</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">0.45</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># è¿™äº›é—´éš”çš„æ•°ç›®ï¼Œåˆšå¥½ç­‰äºè®¡æ•°histçš„æ•°ç›®</span>
</span></span><span style="display:flex;"><span>len(np<span style="color:#f92672">.</span>diff(bin_edges))</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">100</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># pyechartsçš„ç›´æ–¹å›¾ä½¿ç”¨barå®ç°</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å–bins[:-1]ï¼Œæ„æ€æ˜¯ç”¨æ¯ä¸ªåŒºé—´çš„å·¦è¾¹å…ƒç´ ä½œä¸ºxè½´çš„å€¼</span>
</span></span><span style="display:flex;"><span>bar <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>    Bar()
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>add_xaxis([str(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> bin_edges[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]])
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>add_yaxis(<span style="color:#e6db74">&#34;ä»·æ ¼åˆ†å¸ƒ&#34;</span>, [float(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> hist], category_gap<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>set_global_opts(
</span></span><span style="display:flex;"><span>        title_opts<span style="color:#f92672">=</span>opts<span style="color:#f92672">.</span>TitleOpts(title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;æ³¢æ–¯é¡¿æˆ¿ä»·-ä»·æ ¼åˆ†å¸ƒ-ç›´æ–¹å›¾&#34;</span>, pos_left<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;center&#34;</span>),
</span></span><span style="display:flex;"><span>        legend_opts<span style="color:#f92672">=</span>opts<span style="color:#f92672">.</span>LegendOpts(is_show<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>bar<span style="color:#f92672">.</span>render_notebook()</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="42pythonå¤„ç†excelä¸€åˆ—å˜å¤šåˆ—" class="pagebody-header">
    42ã€Pythonå¤„ç†Excelä¸€åˆ—å˜å¤šåˆ—
  </h1>
</div>
<div class="component-content pagebody component">
  <h3 id="1-è¯»å–æ•°æ®-1" class="pagebody-header">
    1. è¯»å–æ•°æ®
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#34;./course_datas/c42_split_onecolumn_tomany/å­¦ç”Ÿæ•°æ®è¡¨.xlsx&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">æ•°æ®</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ:å¥³:23:å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…:å¥³:25:æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•:å¥³:23:æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“:å¥³:19:é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš:å¥³:24:å±±ä¸œ</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2-å®ç°æ‹†åˆ†" class="pagebody-header">
    2. å®ç°æ‹†åˆ†
  </h3>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">split_func</span>(line):
</span></span><span style="display:flex;"><span>    line[<span style="color:#e6db74">&#34;å§“å&#34;</span>], line[<span style="color:#e6db74">&#34;æ€§åˆ«&#34;</span>], line[<span style="color:#e6db74">&#34;å¹´é¾„&#34;</span>], line[<span style="color:#e6db74">&#34;åŸå¸‚&#34;</span>] <span style="color:#f92672">=</span> line[<span style="color:#e6db74">&#34;æ•°æ®&#34;</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;:&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> line
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>apply(split_func, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">æ•°æ®</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
<th style="text-align:right">å¹´é¾„</th>
<th style="text-align:right">åŸå¸‚</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ:å¥³:23:å±±ä¸œ</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…:å¥³:25:æ²³å—</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">25</td>
<td style="text-align:right">æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•:å¥³:23:æ¹–åŒ—</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“:å¥³:19:é™•è¥¿</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">19</td>
<td style="text-align:right">é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš:å¥³:24:å±±ä¸œ</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">24</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>drop([<span style="color:#e6db74">&#34;æ•°æ®&#34;</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
<th style="text-align:right">å¹´é¾„</th>
<th style="text-align:right">åŸå¸‚</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">25</td>
<td style="text-align:right">æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">19</td>
<td style="text-align:right">é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">24</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3-è¾“å‡ºåˆ°ç»“æœexcel" class="pagebody-header">
    3. è¾“å‡ºåˆ°ç»“æœExcel
  </h3>
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">&#34;./course_datas/c42_split_onecolumn_tomany/å­¦ç”Ÿæ•°æ®è¡¨_æ‹†åˆ†å.xlsx&#34;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="43pandasæŸ¥è¯¢æ•°æ®çš„ç®€ä¾¿æ–¹æ³•dfquery" class="pagebody-header">
    43ã€PandasæŸ¥è¯¢æ•°æ®çš„ç®€ä¾¿æ–¹æ³•df.query
  </h1>
</div><p class="component-content component">æ€æ ·è¿›è¡Œå¤æ‚ç»„åˆæ¡ä»¶å¯¹æ•°æ®æŸ¥è¯¢ï¼š</p>
<div class="component-content component"><ul>
<li>æ–¹å¼1. ä½¿ç”¨df[(df[&ldquo;a&rdquo;] &gt; 3) &amp; (df[&ldquo;b&rdquo;]&lt;5)]çš„æ–¹å¼ï¼›</li>
<li>æ–¹å¼2. ä½¿ç”¨df.query(&ldquo;a&gt;3 &amp; b&lt;5&rdquo;)çš„æ–¹å¼ï¼›</li>
</ul></div>
<p class="component-content component">æ–¹æ³•2çš„è¯­æ³•æ›´åŠ ç®€æ´</p>
<p class="component-content component">æ€§èƒ½å¯¹æ¯”ï¼š</p>
<div class="component-content component"><ul>
<li>å½“æ•°æ®é‡å°æ—¶ï¼Œæ–¹æ³•1æ›´å¿«ï¼›</li>
<li>å½“æ•°æ®é‡å¤§æ—¶ï¼Œå› ä¸ºæ–¹æ³•2ç›´æ¥ç”¨Cè¯­è¨€å®ç°ï¼ŒèŠ‚çœæ–¹æ³•1ä¸´æ—¶æ•°ç»„çš„å¤šæ¬¡å¤åˆ¶ï¼Œæ–¹æ³•2æ›´å¿«ï¼›</li>
</ul></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>print(pd<span style="color:#f92672">.</span>__version__)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1.0.1</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="0è¯»å–æ•°æ®" class="pagebody-header">
    0ã€è¯»å–æ•°æ®
  </h3>
</div><p class="component-content component">æ•°æ®ä¸ºåŒ—äº¬2018å¹´å…¨å¹´å¤©æ°”é¢„æŠ¥</p>
<p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3â„ƒ</td>
<td style="text-align:right">-6â„ƒ</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2â„ƒ</td>
<td style="text-align:right">-5â„ƒ</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2â„ƒ</td>
<td style="text-align:right">-5â„ƒ</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0â„ƒ</td>
<td style="text-align:right">-8â„ƒ</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3â„ƒ</td>
<td style="text-align:right">-6â„ƒ</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ›¿æ¢æ‰æ¸©åº¦çš„åç¼€â„ƒ</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#34;bWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;â„ƒ&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#34;yWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;yWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;â„ƒ&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="1ä½¿ç”¨dataframeæ¡ä»¶è¡¨è¾¾å¼æŸ¥è¯¢" class="pagebody-header">
    1ã€ä½¿ç”¨dataframeæ¡ä»¶è¡¨è¾¾å¼æŸ¥è¯¢
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="æœ€ä½æ¸©åº¦ä½äº-10åº¦çš„åˆ—è¡¨" class="pagebody-header">
    æœ€ä½æ¸©åº¦ä½äº-10åº¦çš„åˆ—è¡¨
  </h4>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[df[<span style="color:#e6db74">&#34;yWendu&#34;</span>] <span style="color:#f92672">&lt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>]<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">22</td>
<td style="text-align:right">2018-01-23</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">31</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">23</td>
<td style="text-align:right">2018-01-24</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">-11</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">34</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">24</td>
<td style="text-align:right">2018-01-25</td>
<td style="text-align:right">-3</td>
<td style="text-align:right">-11</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">27</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">359</td>
<td style="text-align:right">2018-12-26</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">-11</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">2çº§</td>
<td style="text-align:right">26</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">360</td>
<td style="text-align:right">2018-12-27</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">3çº§</td>
<td style="text-align:right">48</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="å¤æ‚æ¡ä»¶æŸ¥è¯¢" class="pagebody-header">
    å¤æ‚æ¡ä»¶æŸ¥è¯¢
  </h4>
</div><p class="component-content component">æ³¨æ„ï¼Œç»„åˆæ¡ä»¶ç”¨&amp;ç¬¦å·åˆå¹¶ï¼Œæ¯ä¸ªæ¡ä»¶åˆ¤æ–­éƒ½å¾—å¸¦æ‹¬å·</p>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">## æŸ¥è¯¢æœ€é«˜æ¸©åº¦å°äº30åº¦ï¼Œå¹¶ä¸”æœ€ä½æ¸©åº¦å¤§äº15åº¦ï¼Œå¹¶ä¸”æ˜¯æ™´å¤©ï¼Œå¹¶ä¸”å¤©æ°”ä¸ºä¼˜çš„æ•°æ®</span>
</span></span><span style="display:flex;"><span>df[
</span></span><span style="display:flex;"><span>    (df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">30</span>) 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#34;yWendu&#34;</span>]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">15</span>) 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#34;tianqi&#34;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;æ™´&#39;</span>) 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#34;aqiLevel&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>)]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">235</td>
<td style="text-align:right">2018-08-24</td>
<td style="text-align:right">30</td>
<td style="text-align:right">20</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">40</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">249</td>
<td style="text-align:right">2018-09-07</td>
<td style="text-align:right">27</td>
<td style="text-align:right">16</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">22</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2ä½¿ç”¨dfqueryå¯ä»¥ç®€åŒ–æŸ¥è¯¢" class="pagebody-header">
    2ã€ä½¿ç”¨df.queryå¯ä»¥ç®€åŒ–æŸ¥è¯¢
  </h3>
</div><p class="component-content component">å½¢å¼ï¼šDataFrame.query(expr, inplace=False, **kwargs)</p>
<p class="component-content component">å…¶ä¸­exprä¸ºè¦è¿”å›booleanç»“æœçš„å­—ç¬¦ä¸²è¡¨è¾¾å¼</p>
<p class="component-content component">å½¢å¦‚ï¼š</p>
<div class="component-content component"><ul>
<li>df.query(&lsquo;a&lt;100&rsquo;)</li>
<li>df.query(&lsquo;a &lt; b &amp; b &lt; c&rsquo;)ï¼Œæˆ–è€…df.query(&rsquo;(a&lt;b)&amp;(b&lt;c)&rsquo;)</li>
</ul></div>
<p class="component-content component">df.queryå¯æ”¯æŒçš„è¡¨è¾¾å¼è¯­æ³•ï¼š</p>
<div class="component-content component"><ul>
<li>é€»è¾‘æ“ä½œç¬¦: &amp;, |, ~</li>
<li>æ¯”è¾ƒæ“ä½œç¬¦: &lt;, &lt;=, ==, !=, &gt;=, &gt;</li>
<li>å•å˜é‡æ“ä½œç¬¦: -</li>
<li>å¤šå˜é‡æ“ä½œç¬¦: +, -, *, /, %</li>
</ul></div>
<p class="component-content component">df.queryä¸­å¯ä»¥ä½¿ç”¨@varçš„æ–¹å¼ä¼ å…¥å¤–éƒ¨å˜é‡</p>
<p class="component-content component">df.queryæ”¯æŒçš„è¯­æ³•æ¥è‡ªNumExprï¼Œåœ°å€ï¼š
<a href="https://numexpr.readthedocs.io/projects/NumExpr3/en/latest/index.html">https://numexpr.readthedocs.io/projects/NumExpr3/en/latest/index.html</a></p>

<div class="component-content pagebody component">
  <h4 id="æŸ¥è¯¢æœ€ä½æ¸©åº¦ä½äº-10åº¦çš„åˆ—è¡¨" class="pagebody-header">
    æŸ¥è¯¢æœ€ä½æ¸©åº¦ä½äº-10åº¦çš„åˆ—è¡¨
  </h4>
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>query(<span style="color:#e6db74">&#34;yWendu &lt; 3&#34;</span>)<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="æŸ¥è¯¢æœ€é«˜æ¸©åº¦å°äº30åº¦å¹¶ä¸”æœ€ä½æ¸©åº¦å¤§äº15åº¦å¹¶ä¸”æ˜¯æ™´å¤©å¹¶ä¸”å¤©æ°”ä¸ºä¼˜çš„æ•°æ®" class="pagebody-header">
    æŸ¥è¯¢æœ€é«˜æ¸©åº¦å°äº30åº¦ï¼Œå¹¶ä¸”æœ€ä½æ¸©åº¦å¤§äº15åº¦ï¼Œå¹¶ä¸”æ˜¯æ™´å¤©ï¼Œå¹¶ä¸”å¤©æ°”ä¸ºä¼˜çš„æ•°æ®
  </h4>
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">## æŸ¥è¯¢æœ€é«˜æ¸©åº¦å°äº30åº¦ï¼Œå¹¶ä¸”æœ€ä½æ¸©åº¦å¤§äº15åº¦ï¼Œå¹¶ä¸”æ˜¯æ™´å¤©ï¼Œå¹¶ä¸”å¤©æ°”ä¸ºä¼˜çš„æ•°æ®</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>query(<span style="color:#e6db74">&#34;bWendu&lt;=30 &amp; yWendu&gt;=15 &amp; tianqi==&#39;æ™´&#39; &amp; aqiLevel==1&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">235</td>
<td style="text-align:right">2018-08-24</td>
<td style="text-align:right">30</td>
<td style="text-align:right">20</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">40</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">249</td>
<td style="text-align:right">2018-09-07</td>
<td style="text-align:right">27</td>
<td style="text-align:right">16</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">22</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="æŸ¥è¯¢æ¸©å·®å¤§äº15åº¦çš„æ—¥å­" class="pagebody-header">
    æŸ¥è¯¢æ¸©å·®å¤§äº15åº¦çš„æ—¥å­
  </h4>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>query(<span style="color:#e6db74">&#34;bWendu-yWendu &gt;= 15&#34;</span>)<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">68</td>
<td style="text-align:right">2018-03-10</td>
<td style="text-align:right">14</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">ä¸œå—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">171</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">82</td>
<td style="text-align:right">2018-03-24</td>
<td style="text-align:right">22</td>
<td style="text-align:right">5</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">119</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">83</td>
<td style="text-align:right">2018-03-25</td>
<td style="text-align:right">24</td>
<td style="text-align:right">7</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">78</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">84</td>
<td style="text-align:right">2018-03-26</td>
<td style="text-align:right">25</td>
<td style="text-align:right">7</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">151</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">85</td>
<td style="text-align:right">2018-03-27</td>
<td style="text-align:right">27</td>
<td style="text-align:right">11</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">243</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“</td>
<td style="text-align:right">5</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="å¯ä»¥ä½¿ç”¨å¤–éƒ¨çš„å˜é‡" class="pagebody-header">
    å¯ä»¥ä½¿ç”¨å¤–éƒ¨çš„å˜é‡
  </h4>
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æŸ¥è¯¢æ¸©åº¦åœ¨è¿™ä¸¤ä¸ªæ¸©åº¦ä¹‹é—´çš„æ•°æ®</span>
</span></span><span style="display:flex;"><span>high_temperature <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>
</span></span><span style="display:flex;"><span>low_temperature <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>query(<span style="color:#e6db74">&#34;yWendu&lt;=@high_temperature &amp; yWendu&gt;=@low_temperature&#34;</span>)<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">107</td>
<td style="text-align:right">2018-04-18</td>
<td style="text-align:right">27</td>
<td style="text-align:right">14</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">147</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">108</td>
<td style="text-align:right">2018-04-19</td>
<td style="text-align:right">26</td>
<td style="text-align:right">13</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">ä¸œå—é£</td>
<td style="text-align:right">4-5çº§</td>
<td style="text-align:right">170</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">109</td>
<td style="text-align:right">2018-04-20</td>
<td style="text-align:right">28</td>
<td style="text-align:right">14</td>
<td style="text-align:right">å¤šäº‘~å°é›¨</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">4-5çº§</td>
<td style="text-align:right">164</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">116</td>
<td style="text-align:right">2018-04-27</td>
<td style="text-align:right">25</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">112</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">119</td>
<td style="text-align:right">2018-04-30</td>
<td style="text-align:right">24</td>
<td style="text-align:right">14</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">62</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="44pandasæŒ‰è¡Œéå†dataframeçš„3ç§æ–¹æ³•" class="pagebody-header">
    44ã€PandasæŒ‰è¡Œéå†DataFrameçš„3ç§æ–¹æ³•
  </h1>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> collections</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(
</span></span><span style="display:flex;"><span>    np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>random(size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">100000</span>, <span style="color:#ae81ff">4</span>)), 
</span></span><span style="display:flex;"><span>    columns<span style="color:#f92672">=</span>list(<span style="color:#e6db74">&#39;ABCD&#39;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0.329292</td>
<td style="text-align:right">0.975468</td>
<td style="text-align:right">0.133584</td>
<td style="text-align:right">0.224582</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">0.535746</td>
<td style="text-align:right">0.451585</td>
<td style="text-align:right">0.713250</td>
<td style="text-align:right">0.409770</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">0.735287</td>
<td style="text-align:right">0.667472</td>
<td style="text-align:right">0.950622</td>
<td style="text-align:right">0.245938</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">100000</span>, <span style="color:#ae81ff">4</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="1-dfiterrows" class="pagebody-header">
    1. df.iterrows()
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="ä½¿ç”¨æ–¹å¼" class="pagebody-header">
    ä½¿ç”¨æ–¹å¼
  </h4>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> idx, row <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>iterrows():
</span></span><span style="display:flex;"><span>    print(idx, row)
</span></span><span style="display:flex;"><span>    print(idx, row[<span style="color:#e6db74">&#34;A&#34;</span>], row[<span style="color:#e6db74">&#34;B&#34;</span>], row[<span style="color:#e6db74">&#34;C&#34;</span>], row[<span style="color:#e6db74">&#34;D&#34;</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> A    <span style="color:#ae81ff">0.329292</span>
</span></span><span style="display:flex;"><span>B    <span style="color:#ae81ff">0.975468</span>
</span></span><span style="display:flex;"><span>C    <span style="color:#ae81ff">0.133584</span>
</span></span><span style="display:flex;"><span>D    <span style="color:#ae81ff">0.224582</span>
</span></span><span style="display:flex;"><span>Name: <span style="color:#ae81ff">0</span>, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0.3292915092119043</span> <span style="color:#ae81ff">0.9754683984716609</span> <span style="color:#ae81ff">0.1335841433264423</span> <span style="color:#ae81ff">0.22458227907355865</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="æ—¶é—´è€—è´¹" class="pagebody-header">
    æ—¶é—´è€—è´¹
  </h4>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">%%</span>time
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> collections<span style="color:#f92672">.</span>defaultdict(int)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> idx, row <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>iterrows():
</span></span><span style="display:flex;"><span>    result[(row[<span style="color:#e6db74">&#34;A&#34;</span>], row[<span style="color:#e6db74">&#34;B&#34;</span>])] <span style="color:#f92672">+=</span> row[<span style="color:#e6db74">&#34;A&#34;</span>] <span style="color:#f92672">+</span> row[<span style="color:#e6db74">&#34;B&#34;</span>]
</span></span><span style="display:flex;"><span>CPU times: user <span style="color:#ae81ff">7.82</span> s, sys: <span style="color:#ae81ff">35.6</span> ms, total: <span style="color:#ae81ff">7.85</span> s
</span></span><span style="display:flex;"><span>Wall time: <span style="color:#ae81ff">7.89</span> s</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2-dfitertuples" class="pagebody-header">
    2. df.itertuples()
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="ä½¿ç”¨æ–¹å¼-1" class="pagebody-header">
    ä½¿ç”¨æ–¹å¼
  </h4>
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>itertuples():
</span></span><span style="display:flex;"><span>    print(row)
</span></span><span style="display:flex;"><span>    print(row<span style="color:#f92672">.</span>Index, row<span style="color:#f92672">.</span>A, row<span style="color:#f92672">.</span>B, row<span style="color:#f92672">.</span>C, row<span style="color:#f92672">.</span>D)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>Pandas(Index<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, A<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3292915092119043</span>, B<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9754683984716609</span>, C<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1335841433264423</span>, D<span style="color:#f92672">=</span><span style="color:#ae81ff">0.22458227907355865</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0.3292915092119043</span> <span style="color:#ae81ff">0.9754683984716609</span> <span style="color:#ae81ff">0.1335841433264423</span> <span style="color:#ae81ff">0.22458227907355865</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="æ—¶é—´è€—è´¹-1" class="pagebody-header">
    æ—¶é—´è€—è´¹
  </h4>
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">%%</span>time
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> collections<span style="color:#f92672">.</span>defaultdict(int)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>itertuples():
</span></span><span style="display:flex;"><span>    result[(row<span style="color:#f92672">.</span>A, row<span style="color:#f92672">.</span>B)] <span style="color:#f92672">+=</span> row<span style="color:#f92672">.</span>A <span style="color:#f92672">+</span> row<span style="color:#f92672">.</span>B
</span></span><span style="display:flex;"><span>CPU times: user <span style="color:#ae81ff">168</span> ms, sys: <span style="color:#ae81ff">8.35</span> ms, total: <span style="color:#ae81ff">177</span> ms
</span></span><span style="display:flex;"><span>Wall time: <span style="color:#ae81ff">178</span> ms</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3-forzip" class="pagebody-header">
    3. for+zip
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="ä½¿ç”¨æ–¹å¼-2" class="pagebody-header">
    ä½¿ç”¨æ–¹å¼
  </h4>
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ—¢ä¸éœ€è¦ç±»å‹æ£€æŸ¥ï¼Œä¹Ÿä¸éœ€è¦æ„å»ºnamedtuple</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç¼ºç‚¹æ˜¯éœ€è¦æŒ¨ä¸ªæŒ‡å®šå˜é‡</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> A, B <span style="color:#f92672">in</span> zip(df[<span style="color:#e6db74">&#34;A&#34;</span>], df[<span style="color:#e6db74">&#34;B&#34;</span>]):
</span></span><span style="display:flex;"><span>    print(A, B)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.3292915092119043</span> <span style="color:#ae81ff">0.9754683984716609</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="æ—¶é—´è€—è´¹-2" class="pagebody-header">
    æ—¶é—´è€—è´¹
  </h4>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">%%</span>time
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> collections<span style="color:#f92672">.</span>defaultdict(int)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> A, B <span style="color:#f92672">in</span> zip(df[<span style="color:#e6db74">&#34;A&#34;</span>], df[<span style="color:#e6db74">&#34;B&#34;</span>]):
</span></span><span style="display:flex;"><span>    result[(A, B)] <span style="color:#f92672">+=</span> A <span style="color:#f92672">+</span> B
</span></span><span style="display:flex;"><span>CPU times: user <span style="color:#ae81ff">82.2</span> ms, sys: <span style="color:#ae81ff">7.05</span> ms, total: <span style="color:#ae81ff">89.2</span> ms
</span></span><span style="display:flex;"><span>Wall time: <span style="color:#ae81ff">89.9</span> ms</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="45pandaså®ç°æ¨¡ç³ŠåŒ¹é…mergeæ•°æ®çš„æ–¹æ³•" class="pagebody-header">
    45ã€Pandaså®ç°æ¨¡ç³ŠåŒ¹é…Mergeæ•°æ®çš„æ–¹æ³•
  </h1>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="1-ä¸¤ä»½æ•°æ®" class="pagebody-header">
    1. ä¸¤ä»½æ•°æ®
  </h3>
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å…³é”®è¯æ•°æ®</span>
</span></span><span style="display:flex;"><span>df_keyword <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;keyid&#34;</span>: np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">5</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;keyword&#34;</span>: [<span style="color:#e6db74">&#34;numpy&#34;</span>, <span style="color:#e6db74">&#34;pandas&#34;</span>, <span style="color:#e6db74">&#34;matplotlib&#34;</span>, <span style="color:#e6db74">&#34;sklearn&#34;</span>, <span style="color:#e6db74">&#34;tensorflow&#34;</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>df_keyword</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">keyid</th>
<th style="text-align:right">keyword</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å¥å­æ•°æ®</span>
</span></span><span style="display:flex;"><span>df_sentence <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;senid&#34;</span>: np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">17</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;sentence&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Tensorflowå’ŒNumpyçš„å…³ç³»&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç &#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>df_sentence</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="æ–¹æ³•1æš´åŠ›ç¬›å¡å°”ç§¯--è¿‡æ»¤" class="pagebody-header">
    æ–¹æ³•1ï¼šæš´åŠ›ç¬›å¡å°”ç§¯ + è¿‡æ»¤
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="æ–°å¢æ•°å­—å®Œå…¨ä¸€æ ·çš„åˆ—" class="pagebody-header">
    æ–°å¢æ•°å­—å®Œå…¨ä¸€æ ·çš„åˆ—
  </h4>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_keyword[<span style="color:#e6db74">&#34;match&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>df_sentence[<span style="color:#e6db74">&#34;match&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_keyword</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">keyid</th>
<th style="text-align:right">keyword</th>
<th style="text-align:right">match</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_sentence</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
<th style="text-align:right">match</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="å®ç°merge" class="pagebody-header">
    å®ç°merge
  </h4>
</div><p class="component-content component">ç»“æœè¡Œæ•° = Aè¡¨è¡Œæ•° * Bè¡¨è¡Œæ•°</p>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(df_keyword, df_sentence)
</span></span><span style="display:flex;"><span>df_merge</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">keyid</th>
<th style="text-align:right">keyword</th>
<th style="text-align:right">match</th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">12</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">13</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:right">14</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">15</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">16</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">17</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">18</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">19</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">20</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:right">21</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">22</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">23</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">24</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">25</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">26</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">27</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:right">28</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">29</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">30</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">31</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">32</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">33</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">34</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="è¿‡æ»¤å‡ºç»“æœ" class="pagebody-header">
    è¿‡æ»¤å‡ºç»“æœ
  </h4>
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">match_func</span>(row):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> re<span style="color:#f92672">.</span>search(row[<span style="color:#e6db74">&#34;keyword&#34;</span>], row[<span style="color:#e6db74">&#34;sentence&#34;</span>], re<span style="color:#f92672">.</span>IGNORECASE) <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df_merge[df_merge<span style="color:#f92672">.</span>apply(match_func, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">keyid</th>
<th style="text-align:right">keyword</th>
<th style="text-align:right">match</th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">27</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:right">32</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">33</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="æ–¹æ³•2å°è¡¨å˜å­—å…¸åšmergeæœ€åexplode" class="pagebody-header">
    æ–¹æ³•2ï¼šå°è¡¨å˜å­—å…¸åšmergeæœ€åexplode
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="æ„å»ºè¦joinçš„keyindexçš„å…³ç³»" class="pagebody-header">
    æ„å»ºè¦joinçš„key:indexçš„å…³ç³»
  </h4>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>key_word_dict <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    row<span style="color:#f92672">.</span>keyword : row<span style="color:#f92672">.</span>keyid 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> df_keyword<span style="color:#f92672">.</span>itertuples()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>key_word_dict</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#e6db74">&#39;numpy&#39;</span>: <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;pandas&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;matplotlib&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;sklearn&#39;</span>: <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;tensorflow&#39;</span>: <span style="color:#ae81ff">4</span>}</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="å¤§è¡¨æœå¯»å°è¡¨å­—å…¸" class="pagebody-header">
    å¤§è¡¨æœå¯»å°è¡¨å­—å…¸
  </h4>
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">merge_func</span>(row):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># æ–°å¢ä¸€åˆ—ï¼Œè¡¨ç¤ºèƒ½åŒ¹é…çš„keyids</span>
</span></span><span style="display:flex;"><span>    row[<span style="color:#e6db74">&#34;keyids&#34;</span>] <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>        keyid
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> key_word, keyid <span style="color:#f92672">in</span> key_word_dict<span style="color:#f92672">.</span>items()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> re<span style="color:#f92672">.</span>search(key_word, row[<span style="color:#e6db74">&#34;sentence&#34;</span>], re<span style="color:#f92672">.</span>IGNORECASE)
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> row
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df_merge <span style="color:#f92672">=</span> df_sentence<span style="color:#f92672">.</span>apply(merge_func, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
<th style="text-align:right">match</th>
<th style="text-align:right">keyids</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[1]</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[0]</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[1]</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[1]</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[4]</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[0, 4]</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
<td style="text-align:right">1</td>
<td style="text-align:right">[3]</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="å±•å¼€ç„¶ååšmerge" class="pagebody-header">
    å±•å¼€ç„¶ååšmerge
  </h4>
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>explode(<span style="color:#e6db74">&#34;keyids&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
<th style="text-align:right">match</th>
<th style="text-align:right">keyids</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(
</span></span><span style="display:flex;"><span>    left <span style="color:#f92672">=</span> df_merge<span style="color:#f92672">.</span>explode(<span style="color:#e6db74">&#34;keyids&#34;</span>),
</span></span><span style="display:flex;"><span>    right <span style="color:#f92672">=</span> df_keyword,
</span></span><span style="display:flex;"><span>    left_on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;keyids&#34;</span>,
</span></span><span style="display:flex;"><span>    right_on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;keyid&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>df_result</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
<th style="text-align:right">match_x</th>
<th style="text-align:right">keyids</th>
<th style="text-align:right">keyid</th>
<th style="text-align:right">keyword</th>
<th style="text-align:right">match_y</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

          </div><div class="component">
            <div class="component-content">
              <div class="article-copyright">
                <p class="content">
                  ç‰ˆæƒå£°æ˜: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">ç‰ˆæƒå£°æ˜ï¼šç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™… (CC BY-NC-SA 4.0)</a>
                </p>
                <p class="content">ä½œè€…:  yuanshuai </p>
                <p class="content">å‘è¡¨æ—¥æœŸ:  2021å¹´11æœˆ26æ—¥</p>
              </div>
            </div>
          </div></article>
      </section>
  </main>

  <script>
    var script = document.createElement("script");script.src = "https://yuanshuai1122.github.io/js/initPost.js";
    document.head.appendChild(script);
  </script>

    
    <div class="footer-main ">
  <div class="content-body footer-wraper">
    <div class="footer-box">
      <div class="foot-nav">
        <div class="foot-nav-items">
          <div class="item">
            <div class="logo"></div>
            <div class="email">Email: <a href="mailto:shuaiyuan@gmail.com">shuaiyuan@gmail.com</a></div>
          </div>

          <div class="item community">
            <div class="item-title">ç¤¾äº¤åª’ä½“</div>
            
              <a href="https://github.com/yuanshuai1122" target="_blank">Github</a>
            
          </div>

          <div class="item resources">
            <div class="item-title">å‹é“¾</div>
            
              <a href="https://yuanshuaicn.com/" target="_blank">ğŸ‘‹</a>
            
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="item copyright">
          &copy; 2023
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://github.com/floyd-li/hugo-theme-itheme" target="_blank">iTheme</a>
        </div>
      </div>
    </div>
  </div>
</div>

  </body>
    
    

    
    
</html>
