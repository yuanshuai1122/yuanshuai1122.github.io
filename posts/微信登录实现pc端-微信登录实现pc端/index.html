<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>微信登录实现（PC端） - CN.yuanshuai</title><meta name="author" content="">
<meta name="author-link" content="">
<meta name="description" content="微信登录实现（PC端） 中心思想： 通过微信扫码和微信交互，最终拿到openid（相当于数据库主键id，是微信用户唯一标识），然后通过openi" /><meta name="keywords" content='微信, OAuth2.0' /><meta itemprop="name" content="微信登录实现（PC端）">
<meta itemprop="description" content="微信登录实现（PC端） 中心思想： 通过微信扫码和微信交互，最终拿到openid（相当于数据库主键id，是微信用户唯一标识），然后通过openi"><meta itemprop="datePublished" content="2022-07-12T17:58:33+00:00" />
<meta itemprop="dateModified" content="2022-07-12T17:58:33+00:00" />
<meta itemprop="wordCount" content="1578">
<meta itemprop="keywords" content="微信,OAuth2.0," /><meta property="og:title" content="微信登录实现（PC端）" />
<meta property="og:description" content="微信登录实现（PC端） 中心思想： 通过微信扫码和微信交互，最终拿到openid（相当于数据库主键id，是微信用户唯一标识），然后通过openi" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://yuanshuai1122.github.io/posts/%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-12T17:58:33+00:00" />
<meta property="article:modified_time" content="2022-07-12T17:58:33+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="微信登录实现（PC端）"/>
<meta name="twitter:description" content="微信登录实现（PC端） 中心思想： 通过微信扫码和微信交互，最终拿到openid（相当于数据库主键id，是微信用户唯一标识），然后通过openi"/>
<meta name="application-name" content="CN.yuanshuai">
<meta name="apple-mobile-web-app-title" content="CN.yuanshuai"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://yuanshuai1122.github.io/posts/%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF/" /><link rel="prev" href="http://yuanshuai1122.github.io/posts/jvm%E5%86%85%E5%AD%98%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AF%87%E7%AC%AC10%E7%AB%A0%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80%E4%B8%8E%E8%AE%BF%E9%97%AE%E5%AE%9A%E4%BD%8D-jvm%E5%86%85%E5%AD%98%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AF%87%E7%AC%AC10%E7%AB%A0%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80%E4%B8%8E%E8%AE%BF%E9%97%AE%E5%AE%9A%E4%BD%8D/" /><link rel="next" href="http://yuanshuai1122.github.io/posts/%E7%99%BD%E8%AF%9D%E5%AE%B9%E5%99%A8%E5%9F%BA%E7%A1%80%E4%B8%80%E4%BB%8E%E8%BF%9B%E7%A8%8B%E8%AF%B4%E5%BC%80%E5%8E%BB-bai-hua-rong-qi-ji-chu--yi--cong-jin-cheng-shuo-kai-qu/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "微信登录实现（PC端）",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/yuanshuai1122.github.io\/posts\/%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF\/"
    },"genre": "posts","keywords": "微信, OAuth2.0","wordcount":  1578 ,
    "url": "http:\/\/yuanshuai1122.github.io\/posts\/%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF\/","datePublished": "2022-07-12T17:58:33+00:00","dateModified": "2022-07-12T17:58:33+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "yuanshuai"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="CN.yuanshuai"><img loading="lazy" src="/fixit.min.svg" srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x" sizes="auto" data-title="CN.yuanshuai" data-alt="CN.yuanshuai" class="logo" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/><span class="header-title-text">CN.yuanshuai</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="CN.yuanshuai"><img loading="lazy" src="/fixit.min.svg" srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x" sizes="auto" data-title="/fixit.min.svg" data-alt="/fixit.min.svg" class="logo" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/><span class="header-title-text">CN.yuanshuai</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><main class="container"><aside class="toc" id="toc-auto"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>微信登录实现（PC端）</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://cloud.tencent.com/developer/user/8180692" title="作者"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><img loading="lazy" src="https://aabb-2023.oss-cn-beijing.aliyuncs.com/hjscijg3uw.png" srcset="https://aabb-2023.oss-cn-beijing.aliyuncs.com/hjscijg3uw.png, https://aabb-2023.oss-cn-beijing.aliyuncs.com/hjscijg3uw.png 1.5x, https://aabb-2023.oss-cn-beijing.aliyuncs.com/hjscijg3uw.png 2x" sizes="auto" data-title="yuanshuai" data-alt="yuanshuai" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;yuanshuai</a></span></div>
      <div class="post-meta-line"><span title="发布于 2022-07-12 17:58:33"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden="true"></i><time datetime="2022-07-12">2022-07-12</time></span>&nbsp;<span title="更新于 2022-07-12 17:58:33"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden="true"></i><time datetime="2022-07-12">2022-07-12</time></span>&nbsp;<span title="1578 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 1600 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 4 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#中心思想">中心思想：</a></li>
        <li><a href="#具体实现">具体实现：</a></li>
        <li><a href="#准备工作">准备工作：</a></li>
        <li><a href="#前端微信登录二维码展示">前端微信登录二维码展示：</a></li>
        <li><a href="#后端验证用户是否扫码成功">后端验证用户是否扫码成功</a></li>
        <li><a href="#微信登录后端回调业务">微信登录后端回调业务</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h1 id="微信登录实现pc端">微信登录实现（PC端）</h1>
<h3 id="中心思想">中心思想：</h3>
<p><code>通过微信扫码和微信交互，最终拿到openid（相当于数据库主键id，是微信用户唯一标识），然后通过openid和业务交互。</code></p>
<h3 id="具体实现">具体实现：</h3>
<p>一共4个步骤，其实不论是微信授权登录，还是QQ授权登录,或者支付宝授权登录&hellip;..等只要是OAuth2.0协议都是这逻辑</p>
<blockquote>
<p>1 第一步：用户同意授权，获取code</p>
<p>2 第二步：通过code换取网页授权access_token</p>
<p>3 第三步：刷新access_token（如果需要）</p>
<p>4 第四步：拉取用户信息(需scope为 snsapi_userinfo)</p>
</blockquote>
<h3 id="准备工作">准备工作：</h3>
<h4 id="1注册账号">1、注册账号</h4>
<p><code>https://open.weixin.qq.com</code> 注册微信开发平台</p>
<h4 id="2开发者资质认证">2、开发者资质认证</h4>
<p>准备营业执照，1-2个工作日审批，300元</p>
<h4 id="3创建网站应用">3、创建网站应用</h4>
<p>提交审核，七个工作日审批</p>
<h4 id="4开发流程">4、开发流程</h4>
<p><code>https://developers.weixin.qq.com/doc/oplatform/Website_App/WeChat_Login/Wechat_Login.html</code></p>
<blockquote>
<ol>
<li>第三方发起微信授权登录请求，微信用户允许授权第三方应用后，微信会拉起应用或重定向到第三方网站，并且带上授权临时票据 code 参数；</li>
<li>通过 code 参数加上 AppID 和AppSecret等，通过 API 换取access_token；</li>
<li>通过access_token进行接口调用，获取用户基本数据资源或帮助用户实现基本操作。</li>
</ol>
</blockquote>
<p>获取access_token时序图：</p>
<!-- raw HTML omitted -->
<h3 id="前端微信登录二维码展示">前端微信登录二维码展示：</h3>
<p>以<code>vue.js</code>为例：</p>
<p>需要在<code>loginApi.js</code>中配置接口，检查是否登录。</p>
<div class="highlight" id="id-1"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">checkLogin</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">request</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="nx">url</span><span class="o">:</span> <span class="sb">`/user/wx/checklogin`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;get&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>在<code>login.vue</code>中添加属性</p>
<div class="highlight" id="id-2"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="c1">// 需要在页面head中先引入如下 JS 文件（支持https）：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">head</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">script</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;http://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 定义对话框开启关闭的boolean类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">data</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">wxDialog</span><span class="o">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>添加微信登录对话框</p>
<div class="highlight" id="id-3"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="c1">// @opened 对话框打开后的回调
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">&lt;</span><span class="nt">el-dialog</span>
</span></span><span class="line"><span class="cl">    <span class="nt">:visible.sync</span><span class="s">=&#34;wxDialog&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">@opened</span><span class="s">=&#34;wxOpen&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="na">width</span><span class="o">=</span><span class="s">&#34;30%&#34;</span><span class="err">,</span>
</span></span><span class="line"><span class="cl">    <span class="na">center</span>
</span></span><span class="line"><span class="cl"><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;qrCode&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;padding-left: 110px;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/el-dialog&gt;</span></span></span></code></pre></div><p>在微信图标添加点击事件</p>
<div class="highlight" id="id-4"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;weixin&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;weixin&#34;</span> <span class="na">target</span><span class="o">=</span><span class="s">&#34;_blank&#34;</span> <span class="nt">@click</span><span class="s">=&#34;wxDialog=true&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;iconfont icon-weixin&#34;</span><span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span></span></span></code></pre></div><p>在<code>methods</code>中添加弹出二维码方法，这里用到了之前申请的<code>appid</code>，<code>redirect_uri</code>等，注意了解下<code>scope</code></p>
<div class="highlight" id="id-5"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">wxCreate</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		 <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WxLogin</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">         <span class="nx">self_redirect</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nx">id</span><span class="o">:</span><span class="s2">&#34;qrCode&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">         <span class="nx">appid</span><span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">         <span class="nx">scope</span><span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">         <span class="nx">redirect_uri</span><span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nx">state</span><span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nx">style</span><span class="o">:</span> <span class="s2">&#34;black&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nx">href</span><span class="o">:</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span>
</span></span><span class="line"><span class="cl">	<span class="nx">wxOpen</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 生成登录二维码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">this</span><span class="p">.</span><span class="nx">wxCreate</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 验证是否已经扫码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">loginApi</span><span class="p">.</span><span class="nx">checkLogin</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 携带token跳转到到首页
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">this</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="nx">query</span><span class="o">:</span><span class="p">{</span><span class="nx">token</span><span class="o">:</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">token</span><span class="p">}})</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">$message</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">                <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;登录失败，请重试&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">});</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">wxOpen</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p><code>前端的总体思路就是：点击微信icon打开对话框，此时不断检查是否登录，如果已经登录，跳转首页，登陆成功，未登录，等待扫码，扫码后回调</code></p>
<h3 id="后端验证用户是否扫码成功">后端验证用户是否扫码成功</h3>
<p><code>总体思路为：再死循环中不断检查isLogin标志位是否为TRUE</code></p>
<div class="highlight" id="id-6"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@RestController</span>
</span></span><span class="line"><span class="cl"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;/user&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WxLoginController</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">final</span> <span class="n">String</span> <span class="n">app_id</span> <span class="o">=</span> <span class="s">&#34;wx92b66fgfg8c01fc87&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">final</span> <span class="n">String</span> <span class="n">app_secret</span> <span class="o">=</span> <span class="s">&#34;d734ba63fgfggb3b573d7cb1cdcb958eea&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">final</span> <span class="n">String</span> <span class="n">redirect_url</span> <span class="o">=</span> <span class="s">&#34;http://wwwxxxx.com/wechat/callBack&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 记录当前用户是否已经登录
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">isLogin</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 记录当前用户是否扫码登录失败
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">isLoginFail</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 检查是否登录
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 是否登录
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/wx/checklogin&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">checkLogin</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">responseEntity</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 定义flag
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 一直查询是否登录
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 检查flag是否超过120 即60s
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">flag</span> <span class="o">&gt;</span> <span class="mi">120</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">responseEntity</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">&#34;登录超时&#34;</span><span class="o">,</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 登陆成功
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">isLogin</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 如果已经登录，返回用户token
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">responseEntity</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="n">token</span><span class="o">,</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 登录状态复位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">isLogin</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 登录失败
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">isLoginFail</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">responseEntity</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">&#34;登录失败&#34;</span><span class="o">,</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 每隔0.5s查询一次状态
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">500</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">responseEntity</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div><h3 id="微信登录后端回调业务">微信登录后端回调业务</h3>
<div class="highlight" id="id-7"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">    <span class="kd">final</span> <span class="n">String</span> <span class="n">app_id</span> <span class="o">=</span> <span class="s">&#34;wx92b66fgfg8c01fc87&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">final</span> <span class="n">String</span> <span class="n">app_secret</span> <span class="o">=</span> <span class="s">&#34;d734ba63fgfggb3b573d7cb1cdcb958eea&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">final</span> <span class="n">String</span> <span class="n">redirect_url</span> <span class="o">=</span> <span class="s">&#34;http://wwwxxxx.com/wechat/callBack&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/wx/callback&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">callback</span><span class="o">(</span><span class="n">String</span> <span class="n">code</span><span class="o">,</span> <span class="n">String</span> <span class="n">state</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="s">&#34;fm&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">state</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 1.换取access_token
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">String</span> <span class="n">getToken</span> <span class="o">=</span> <span class="s">&#34;https://api.weixin.qq.com/sns/oauth2/access_token?&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;appid=%s&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;&amp;secret=%s&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;&amp;code=%s&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;&amp;grant_type=authorization_code&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 拼接请求地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">getToken</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">getToken</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">app_id</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">app_secret</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">code</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 2.发送请求，换取access_token
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">tokenMap</span> <span class="o">=</span> <span class="n">CommonUtils</span><span class="o">.</span><span class="na">doGet</span><span class="o">(</span><span class="n">getToken</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">Object</span> <span class="n">rsStr</span> <span class="o">=</span> <span class="n">tokenMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;rsStr&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">Map</span> <span class="n">resMap</span> <span class="o">=</span> <span class="o">(</span><span class="n">Map</span><span class="o">)</span><span class="n">rsStr</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 3.解析返回值,拿到access_token 和 open_id
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">String</span> <span class="n">accessToken</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">resMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;access_token&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">String</span> <span class="n">openid</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">resMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;openid&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">JSONObject</span> <span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">jsonObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;accessToken&#34;</span><span class="o">,</span><span class="n">accessToken</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">jsonObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;openid&#34;</span><span class="o">,</span><span class="n">openid</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// TODO 根据openid去换id
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// TODO 成功登录，返回token
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// 修改标志
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">this</span><span class="o">.</span><span class="na">isLogin</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// ......这里就可以和我们具体业务对接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">......</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="k">new</span> <span class="n">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="n">jsonObject</span><span class="o">,</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">this</span><span class="o">.</span><span class="na">isLoginFail</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="k">new</span> <span class="n">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span></span></span></code></pre></div><h4 id="这样就可以完成微信的扫码登录qq微博同理到此结束">这样就可以完成微信的扫码登录，qq微博同理，到此结束</h4>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2022-07-12 17:58:33">更新于 2022-07-12&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"></div>
      <div class="post-info-share">
        <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="http://yuanshuai1122.github.io/posts/%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF/" data-title="微信登录实现（PC端）" data-hashtags="微信,OAuth2.0"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="http://yuanshuai1122.github.io/posts/%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF/" data-hashtag="微信"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="http://yuanshuai1122.github.io/posts/%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0pc%E7%AB%AF/" data-title="微信登录实现（PC端）"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/%E5%BE%AE%E4%BF%A1/' class="post-tag">微信</a><a href='/tags/oauth2.0/' class="post-tag">OAuth2.0</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/jvm%E5%86%85%E5%AD%98%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AF%87%E7%AC%AC10%E7%AB%A0%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80%E4%B8%8E%E8%AE%BF%E9%97%AE%E5%AE%9A%E4%BD%8D-jvm%E5%86%85%E5%AD%98%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AF%87%E7%AC%AC10%E7%AB%A0%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80%E4%B8%8E%E8%AE%BF%E9%97%AE%E5%AE%9A%E4%BD%8D/" class="post-nav-item" rel="prev" title="JVM内存与垃圾回收篇第10章对象的实例化内存布局与访问定位"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>JVM内存与垃圾回收篇第10章对象的实例化内存布局与访问定位</a>
      <a href="/posts/%E7%99%BD%E8%AF%9D%E5%AE%B9%E5%99%A8%E5%9F%BA%E7%A1%80%E4%B8%80%E4%BB%8E%E8%BF%9B%E7%A8%8B%E8%AF%B4%E5%BC%80%E5%8E%BB-bai-hua-rong-qi-ji-chu--yi--cong-jin-cheng-shuo-kai-qu/" class="post-nav-item" rel="next" title="白话容器基础（一）：从进程说开去">白话容器基础（一）：从进程说开去<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.119.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.2.18-lts.2"><img class="fixit-icon" src="/fixit.min.svg" alt="FixIt logo" />&nbsp;FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div><div class="footer-line statistics"></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
