<!DOCTYPE html>
<html class="js no-touch  progressive-image  no-reduced-motion progressive" lang="en">
  <head>
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/img/favicon.ico">

    <meta name="keyword" content=""><meta property="og:title" content="Python数据分析之Pandas（四）" />
<meta property="og:description" content=": | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;&mdash;: | &mdash;&mdash;-: | | 0 | 1 | F | 1 | 10 | 48067 | | 1 | 2 | M | 56 | 16 | 70072 | | 2 | 3 | M | 25 | 15 | 55117 | | 3 | 4 | M | 45 | 7 | 02460 | | 4 | 5 | M" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuanshuai1122.github.io/archives/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E5%9B%9B/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-26T21:54:16+00:00" />
<meta property="article:modified_time" content="2021-11-26T21:54:16+00:00" />
<title>Python数据分析之Pandas（四）</title>

    <link rel="canonical" href="/archives/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E5%9B%9B/">

    <link rel="stylesheet" href="/css/global.css">

    <link rel="stylesheet" href="/css/custom.css">

    <link rel="stylesheet" href="/css/search.css" />

    
    

    
    

</head>
  </head>
  <body class=" page-article   ">
    <header>
      <nav class="nav">
  <div class="nav-wrapper">
    <div class="nav-content-wrapper">
      <div class="nav-content">
        <a href="/ " class="nav-title">iTheme</a>
        <div class="nav-menu">
          <div class="nav-item-wrapper">
            <a href="/posts " class="nav-item-content">Articles</a>
          </div><div class="nav-item-wrapper">
            <a href="/about" class="nav-item-content">About</a>
          </div><div class="nav-item-wrapper">
            <a href="/index.xml" class="nav-item-content" target="_blank">RSS</a>
          </div></div>
      </div>
    </div>
  </div>
</nav>

<script>
  function toggleSearchModal(){
    const template = `
    <div class="modal-body">
      <div id="autocomplete" onclick="event.stopPropagation();"></div>
    </div>
    `
    const modal = document.querySelector("#modal-wrapper")
    if(!modal){
      const div = document.createElement("div")
      document.body.setAttribute("style","overflow: hidden;")
      div.setAttribute("id", "modal-wrapper")
      div.setAttribute("onclick", "toggleSearchModal()")
      div.innerHTML = template
      const script = document.createElement("script");script.setAttribute("src", "https://yuanshuai1122.github.io/js/algolia.js")
      div.appendChild(script)
      document.body.append(div)
    } else {
      document.body.removeAttribute("style")
      document.body.removeChild(modal)
    }
  }
</script>
    </header>
    
  
  
  <main id="main" class="main">
      <section>
        <article class="article">
          
          <div class=" article-header ">
            <div class="category component">
              <div class="component-content">
                <div class="category-eyebrow">
                  <span class="category-eyebrow__category category_original">
                    
                      
                        Python
                      
                    
                  </span>
                  <span class="category-eyebrow__date">November 26, 2021</span>
                </div>
              </div>
            </div>
            <div class="pagetitle component">
              <div class="component-content">
                <h1 class="hero-headline">Python数据分析之Pandas（四）</h1>
              </div>
            </div>
            <div class="component  article-subhead ">
              <div class="component-content"></div>
            </div>

            <div class="tagssheet component">
              <div class="component-content">
                
                  
                  <a href="/tags/python" class="tag">
                    Python
                  </a>
                
                  
                  <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90" class="tag">
                    数据分析
                  </a>
                
              </div>
            </div>
          </div>
          
          <div class="pagebody">
            
            
            
            
            
            
            
            
            <p class="component-content component">: | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;&mdash;: | &mdash;&mdash;-: |
|    0 |      1 |      F |    1 |         10 |    48067 |
|    1 |      2 |      M |   56 |         16 |    70072 |
|    2 |      3 |      M |   25 |         15 |    55117 |
|    3 |      4 |      M |   45 |          7 |    02460 |
|    4 |      5 |      M |   25 |         20 |    55455 |</p>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">6040</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">6039</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">5</span> columns):
</span></span><span style="display:flex;"><span>UserID        <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Gender        <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Age           <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Occupation    <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Zip<span style="color:#f92672">-</span>code      <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>dtypes: int64(<span style="color:#ae81ff">3</span>), object(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">236.1</span><span style="color:#f92672">+</span> KB</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>info(memory_usage<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;deep&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">6040</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">6039</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">5</span> columns):
</span></span><span style="display:flex;"><span>UserID        <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Gender        <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Age           <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Occupation    <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Zip<span style="color:#f92672">-</span>code      <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>dtypes: int64(<span style="color:#ae81ff">3</span>), object(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">873.4</span> KB</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_cat <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>df_cat<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">M</td>
<td style="text-align:right">56</td>
<td style="text-align:right">16</td>
<td style="text-align:right">70072</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">15</td>
<td style="text-align:right">55117</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">M</td>
<td style="text-align:right">45</td>
<td style="text-align:right">7</td>
<td style="text-align:right">02460</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">20</td>
<td style="text-align:right">55455</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2使用categorical类型降低存储量" class="pagebody-header">
    2、使用categorical类型降低存储量
  </h3>
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_cat[<span style="color:#e6db74">&#34;Gender&#34;</span>] <span style="color:#f92672">=</span> df_cat[<span style="color:#e6db74">&#34;Gender&#34;</span>]<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;category&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_cat<span style="color:#f92672">.</span>info(memory_usage<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;deep&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">6040</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">6039</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">5</span> columns):
</span></span><span style="display:flex;"><span>UserID        <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Gender        <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null category
</span></span><span style="display:flex;"><span>Age           <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Occupation    <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Zip<span style="color:#f92672">-</span>code      <span style="color:#ae81ff">6040</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>dtypes: category(<span style="color:#ae81ff">1</span>), int64(<span style="color:#ae81ff">3</span>), object(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">513.8</span> KB</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">df_cat.head()</code></pre>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">M</td>
<td style="text-align:right">56</td>
<td style="text-align:right">16</td>
<td style="text-align:right">70072</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">15</td>
<td style="text-align:right">55117</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">M</td>
<td style="text-align:right">45</td>
<td style="text-align:right">7</td>
<td style="text-align:right">02460</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">20</td>
<td style="text-align:right">55455</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_cat[<span style="color:#e6db74">&#34;Gender&#34;</span>]<span style="color:#f92672">.</span>value_counts()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>M    <span style="color:#ae81ff">4331</span>
</span></span><span style="display:flex;"><span>F    <span style="color:#ae81ff">1709</span>
</span></span><span style="display:flex;"><span>Name: Gender, dtype: int64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3提升运算速度" class="pagebody-header">
    3、提升运算速度
  </h3>
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">%</span>timeit df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;Gender&#34;</span>)<span style="color:#f92672">.</span>size()
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">564</span> µs <span style="color:#960050;background-color:#1e0010">±</span> <span style="color:#ae81ff">10.8</span> µs per loop (mean <span style="color:#960050;background-color:#1e0010">±</span> std<span style="color:#f92672">.</span> dev<span style="color:#f92672">.</span> of <span style="color:#ae81ff">7</span> runs, <span style="color:#ae81ff">1000</span> loops each)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">%</span>timeit df_cat<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;Gender&#34;</span>)<span style="color:#f92672">.</span>size()
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">324</span> µs <span style="color:#960050;background-color:#1e0010">±</span> <span style="color:#ae81ff">5</span> µs per loop (mean <span style="color:#960050;background-color:#1e0010">±</span> std<span style="color:#f92672">.</span> dev<span style="color:#f92672">.</span> of <span style="color:#ae81ff">7</span> runs, <span style="color:#ae81ff">1000</span> loops each)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="29pandas和flask配合实现快速在网页上展示表格数据" class="pagebody-header">
    29、Pandas和Flask配合实现快速在网页上展示表格数据
  </h1>
</div><p class="component-content component">本次演示是使用PyCharm实现的</p>
<p class="component-content component">在当前目录下有一个子目录就是代码：pandas-flask</p>
<p class="component-content component">打开Pycharm，然后打开pandas-flask这个目录，然后运行app.py就可以启动web服务器</p>

<div class="component-content pagebody component">
  <h1 id="30pandas的get_dummies用于机器学习的特征处理" class="pagebody-header">
    30、Pandas的get_dummies用于机器学习的特征处理
  </h1>
</div><p class="component-content component">分类特征有两种：</p>
<div class="component-content component"><ul>
<li>普通分类：性别、颜色</li>
<li>顺序分类：评分、级别</li>
</ul></div>
<p class="component-content component">对于评分，可以把这个分类直接转换成1、2、3、4、5表示，因为它们之间有顺序、大小关系</p>
<p class="component-content component">但是对于颜色这种分类，直接用1/2/3/4/5/6/7表达，是不合适的，因为机器学习会误以为这些数字之间有大小关系</p>
<p class="component-content component">get_dummies就是用于颜色、性别这种特征的处理，也叫作one-hot-encoding处理</p>
<p class="component-content component">比如：</p>
<div class="component-content component"><ul>
<li>男性：1 0</li>
<li>女性：0 1</li>
</ul></div>
<p class="component-content component">这就叫做one-hot-encoding，是机器学习对类别的特征处理</p>

<div class="component-content pagebody component">
  <h3 id="1读取泰坦尼克数据集" class="pagebody-header">
    1、读取泰坦尼克数据集
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_train <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./datas/titanic/titanic_train.csv&#34;</span>)
</span></span><span style="display:flex;"><span>df_train<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cumings, Mrs. John Bradley (Florence Briggs Th&hellip;</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17599</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C85</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Heikkinen, Miss. Laina</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">STON/O2. 3101282</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113803</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">C123</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_train<span style="color:#f92672">.</span>drop(columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;Name&#34;</span>, <span style="color:#e6db74">&#34;Ticket&#34;</span>, <span style="color:#e6db74">&#34;Cabin&#34;</span>], inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>df_train<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_train<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">891</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">890</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">9</span> columns):
</span></span><span style="display:flex;"><span>PassengerId    <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Survived       <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Pclass         <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Sex            <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Age            <span style="color:#ae81ff">714</span> non<span style="color:#f92672">-</span>null float64
</span></span><span style="display:flex;"><span>SibSp          <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Parch          <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Fare           <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null float64
</span></span><span style="display:flex;"><span>Embarked       <span style="color:#ae81ff">889</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>dtypes: float64(<span style="color:#ae81ff">2</span>), int64(<span style="color:#ae81ff">5</span>), object(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">62.8</span><span style="color:#f92672">+</span> KB</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="特征说明" class="pagebody-header">
    特征说明：
  </h4>
</div><div class="component-content component"><ul>
<li>数值特征：Fare</li>
<li>分类-有序特征：Age</li>
<li>分类-普通特征：PassengerId、Pclass、Sex、SibSp、Parch、Embarked</li>
</ul></div>
<p class="component-content component">Survived为要预测的Label</p>

<div class="component-content pagebody component">
  <h3 id="2分类有序特征可以用数字的方法处理" class="pagebody-header">
    2、分类有序特征可以用数字的方法处理
  </h3>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 使用年龄的平均值，填充空值</span>
</span></span><span style="display:flex;"><span>df_train[<span style="color:#e6db74">&#34;Age&#34;</span>] <span style="color:#f92672">=</span> df_train[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">.</span>fillna(df_train[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">.</span>mean())</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_train<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">891</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">890</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">9</span> columns):
</span></span><span style="display:flex;"><span>PassengerId    <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Survived       <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Pclass         <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Sex            <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Age            <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null float64
</span></span><span style="display:flex;"><span>SibSp          <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Parch          <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Fare           <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null float64
</span></span><span style="display:flex;"><span>Embarked       <span style="color:#ae81ff">889</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>dtypes: float64(<span style="color:#ae81ff">2</span>), int64(<span style="color:#ae81ff">5</span>), object(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">62.8</span><span style="color:#f92672">+</span> KB</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3普通无序分类特征可以用get_dummies编码" class="pagebody-header">
    3、普通无序分类特征可以用get_dummies编码
  </h3>
</div><p class="component-content component">其实就是one-hot编码</p>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># series</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>get_dummies(df_train[<span style="color:#e6db74">&#34;Sex&#34;</span>])<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">female</th>
<th style="text-align:right">male</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">***注意，One-hot-Encoding一般要去掉一列，不然会出现dummy variable trap，因为一个人不是male就是femal，它俩有推导关系***<a href="https://www.geeksforgeeks.org/ml-dummy-variable-trap-in-regression-models/">https://www.geeksforgeeks.org/ml-dummy-variable-trap-in-regression-models/</a></p>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 便捷方法，用df全部替换</span>
</span></span><span style="display:flex;"><span>needcode_cat_columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;Pclass&#34;</span>,<span style="color:#e6db74">&#34;Sex&#34;</span>,<span style="color:#e6db74">&#34;SibSp&#34;</span>,<span style="color:#e6db74">&#34;Parch&#34;</span>,<span style="color:#e6db74">&#34;Embarked&#34;</span>]
</span></span><span style="display:flex;"><span>df_coded <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>get_dummies(
</span></span><span style="display:flex;"><span>    df_train,
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 要转码的列</span>
</span></span><span style="display:flex;"><span>    columns<span style="color:#f92672">=</span>needcode_cat_columns,
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 生成的列名的前缀</span>
</span></span><span style="display:flex;"><span>    prefix<span style="color:#f92672">=</span>needcode_cat_columns,
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 把空值也做编码</span>
</span></span><span style="display:flex;"><span>    dummy_na<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 把1 of k移除（dummy variable trap）</span>
</span></span><span style="display:flex;"><span>    drop_first<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">df_coded.head()</code></pre>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Pclass_2.0</th>
<th style="text-align:right">Pclass_3.0</th>
<th style="text-align:right">Pclass_nan</th>
<th style="text-align:right">Sex_male</th>
<th style="text-align:right">Sex_nan</th>
<th style="text-align:right">SibSp_1.0</th>
<th style="text-align:right">&hellip;</th>
<th style="text-align:right">Parch_1.0</th>
<th style="text-align:right">Parch_2.0</th>
<th style="text-align:right">Parch_3.0</th>
<th style="text-align:right">Parch_4.0</th>
<th style="text-align:right">Parch_5.0</th>
<th style="text-align:right">Parch_6.0</th>
<th style="text-align:right">Parch_nan</th>
<th style="text-align:right">Embarked_Q</th>
<th style="text-align:right">Embarked_S</th>
<th style="text-align:right">Embarked_nan</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">5 rows × 26 columns</p>

<div class="component-content pagebody component">
  <h3 id="4机器学习模型训练" class="pagebody-header">
    4、机器学习模型训练
  </h3>
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y <span style="color:#f92672">=</span> df_coded<span style="color:#f92672">.</span>pop(<span style="color:#e6db74">&#34;Survived&#34;</span>)
</span></span><span style="display:flex;"><span>y<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Name: Survived, dtype: int64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">X = df_coded
X.head()</code></pre>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Pclass_2.0</th>
<th style="text-align:right">Pclass_3.0</th>
<th style="text-align:right">Pclass_nan</th>
<th style="text-align:right">Sex_male</th>
<th style="text-align:right">Sex_nan</th>
<th style="text-align:right">SibSp_1.0</th>
<th style="text-align:right">SibSp_2.0</th>
<th style="text-align:right">&hellip;</th>
<th style="text-align:right">Parch_1.0</th>
<th style="text-align:right">Parch_2.0</th>
<th style="text-align:right">Parch_3.0</th>
<th style="text-align:right">Parch_4.0</th>
<th style="text-align:right">Parch_5.0</th>
<th style="text-align:right">Parch_6.0</th>
<th style="text-align:right">Parch_nan</th>
<th style="text-align:right">Embarked_Q</th>
<th style="text-align:right">Embarked_S</th>
<th style="text-align:right">Embarked_nan</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">5 rows × 25 columns</p>
<p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 创建模型对象</span>
</span></span><span style="display:flex;"><span>logreg <span style="color:#f92672">=</span> LogisticRegression(solver<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;liblinear&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 实现模型训练</span>
</span></span><span style="display:flex;"><span>logreg<span style="color:#f92672">.</span>fit(X, y)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>LogisticRegression(C<span style="color:#f92672">=</span><span style="color:#ae81ff">1.0</span>, class_weight<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, dual<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, fit_intercept<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>                   intercept_scaling<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, l1_ratio<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, max_iter<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>                   multi_class<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;warn&#39;</span>, n_jobs<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, penalty<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;l2&#39;</span>,
</span></span><span style="display:flex;"><span>                   random_state<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, solver<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;liblinear&#39;</span>, tol<span style="color:#f92672">=</span><span style="color:#ae81ff">0.0001</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>                   warm_start<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>logreg<span style="color:#f92672">.</span>score(X, y)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0.8148148148148148</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="31pandas使用explode实现一行变多行统计" class="pagebody-header">
    31、Pandas使用explode实现一行变多行统计
  </h1>
</div><p class="component-content component">解决实际问题：一个字段包含多个值，怎样将这个值拆分成多行，然后实现统计</p>
<p class="component-content component">比如：一个电影有多个分类、一个人有多个喜好，需要按分类、喜好做统计</p>

<div class="component-content pagebody component">
  <h3 id="1读取数据" class="pagebody-header">
    1、读取数据
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;./datas/movielens-1m/movies.dat&#34;</span>,
</span></span><span style="display:flex;"><span>    header<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>,
</span></span><span style="display:flex;"><span>    names<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;MovieID::Title::Genres&#34;</span><span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;::&#34;</span>),
</span></span><span style="display:flex;"><span>    sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;::&#34;</span>,
</span></span><span style="display:flex;"><span>    engine<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;python&#34;</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">Father of the Bride Part II (1995)</td>
<td style="text-align:right">Comedy</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>问题：怎样实现这样的统计，每个题材有多少部电影？*</strong></p>
<p class="component-content component">解决思路：</p>
<div class="component-content component"><ul>
<li>将Genres按照分隔符|拆分</li>
<li>按Genres拆分成多行</li>
<li>统计每个Genres下的电影数目</li>
</ul></div>

<div class="component-content pagebody component">
  <h3 id="2将genres字段拆分成列表" class="pagebody-header">
    2、将Genres字段拆分成列表
  </h3>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">3883</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">3882</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">3</span> columns):
</span></span><span style="display:flex;"><span>MovieID    <span style="color:#ae81ff">3883</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Title      <span style="color:#ae81ff">3883</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Genres     <span style="color:#ae81ff">3883</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>dtypes: int64(<span style="color:#ae81ff">1</span>), object(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">91.1</span><span style="color:#f92672">+</span> KB</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 当前的Genres字段是字符串类型</span>
</span></span><span style="display:flex;"><span>type(df<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#34;Genres&#34;</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>str</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 新增一列</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;Genre&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;Genres&#34;</span>]<span style="color:#f92672">.</span>map(<span style="color:#66d9ef">lambda</span> x:x<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;|&#34;</span>))</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
<th style="text-align:right">Genre</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
<td style="text-align:right">[Animation, Children&rsquo;s, Comedy]</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
<td style="text-align:right">[Adventure, Children&rsquo;s, Fantasy]</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
<td style="text-align:right">[Comedy, Romance]</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
<td style="text-align:right">[Comedy, Drama]</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">Father of the Bride Part II (1995)</td>
<td style="text-align:right">Comedy</td>
<td style="text-align:right">[Comedy]</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Genre的类型是列表</span>
</span></span><span style="display:flex;"><span>print(df[<span style="color:#e6db74">&#34;Genre&#34;</span>][<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>print(type(df[<span style="color:#e6db74">&#34;Genre&#34;</span>][<span style="color:#ae81ff">0</span>]))
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;Animation&#39;</span>, <span style="color:#e6db74">&#34;Children&#39;s&#34;</span>, <span style="color:#e6db74">&#39;Comedy&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">list</span><span style="color:#e6db74">&#39;&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">3883</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">3882</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">4</span> columns):
</span></span><span style="display:flex;"><span>MovieID    <span style="color:#ae81ff">3883</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Title      <span style="color:#ae81ff">3883</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Genres     <span style="color:#ae81ff">3883</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Genre      <span style="color:#ae81ff">3883</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>dtypes: int64(<span style="color:#ae81ff">1</span>), object(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">121.5</span><span style="color:#f92672">+</span> KB</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3使用explode将一行拆分成多行" class="pagebody-header">
    3、使用explode将一行拆分成多行
  </h3>
</div><p class="component-content component">语法：pandas.DataFrame.explode(column)
将dataframe的一个list-like的元素按行复制，index索引随之复制</p>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_new <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>explode(<span style="color:#e6db74">&#34;Genre&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_new<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">10</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
<th style="text-align:right">Genre</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
<td style="text-align:right">Animation</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
<td style="text-align:right">Children&rsquo;s</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
<td style="text-align:right">Comedy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
<td style="text-align:right">Adventure</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
<td style="text-align:right">Children&rsquo;s</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
<td style="text-align:right">Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
<td style="text-align:right">Comedy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
<td style="text-align:right">Romance</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
<td style="text-align:right">Comedy</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
<td style="text-align:right">Drama</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="4实现拆分后的题材的统计" class="pagebody-header">
    4、实现拆分后的题材的统计
  </h3>
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline
</span></span><span style="display:flex;"><span>df_new[<span style="color:#e6db74">&#34;Genre&#34;</span>]<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>plot<span style="color:#f92672">.</span>bar()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x23d73917cc8</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-4da6aa3f82d219787ecd16e46d6cad1f" id="lht4da6aa3f82d219787ecd16e46d6cad1f">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/25.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h1 id="32pandas借助python爬虫读取html网页表格存储到excel文件" class="pagebody-header">
    32、Pandas借助Python爬虫读取HTML网页表格存储到Excel文件
  </h1>
</div><p class="component-content component">实现目标：</p>
<div class="component-content component"><ul>
<li>网易有道词典可以用于英语单词查询，可以将查询的单词加入到单词本;</li>
<li>当前没有导出全部单词列表的功能。为了复习方便，可以爬取所有的单词列表，存入Excel方便复习</li>
</ul></div>
<p class="component-content component">涉及技术：</p>
<div class="component-content component"><ul>
<li>Pandas：Python语言最强大的数据处理和数据分析库</li>
<li>Python爬虫：可以将网页下载下来然后解析，使用requests库实现，需要绕过登录验证</li>
</ul></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests.cookies
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="0-处理流程" class="pagebody-header">
    0. 处理流程
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="输入网页有道词典-单词本" class="pagebody-header">
    输入网页：有道词典-单词本
  </h4>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-9854e91d93412f8bda660947e0a4ca17" id="lht9854e91d93412f8bda660947e0a4ca17">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/26.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h4 id="处理流程" class="pagebody-header">
    处理流程
  </h4>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-6b1998bf5c07e39e348b11b8c73bbb98" id="lht6b1998bf5c07e39e348b11b8c73bbb98">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/27.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h4 id="数据结果到excel文件方便打印复习" class="pagebody-header">
    数据结果到Excel文件（方便打印复习）：
  </h4>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-31a2badb3fe1d2c6ee624f7fa04683b7" id="lht31a2badb3fe1d2c6ee624f7fa04683b7">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/28.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h3 id="1-登录网易有道词典的pc版微信扫码登录复制cookies到文件" class="pagebody-header">
    1. 登录网易有道词典的PC版，微信扫码登录，复制cookies到文件
  </h3>
</div><div class="component-content component"><ul>
<li>PC版地址：http://dict.youdao.com/</li>
<li>Chrome插件可以复制Cookies为Json格式：http://www.editthiscookie.com/</li>
</ul></div>
<p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cookie_jar <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>cookies<span style="color:#f92672">.</span>RequestsCookieJar()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;./course_datas/c32_read_html/cookie.txt&#34;</span>) <span style="color:#66d9ef">as</span> fin:
</span></span><span style="display:flex;"><span>    cookiejson <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(fin<span style="color:#f92672">.</span>read())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> cookie <span style="color:#f92672">in</span> cookiejson:
</span></span><span style="display:flex;"><span>        cookie_jar<span style="color:#f92672">.</span>set(
</span></span><span style="display:flex;"><span>            name<span style="color:#f92672">=</span>cookie[<span style="color:#e6db74">&#34;name&#34;</span>],
</span></span><span style="display:flex;"><span>            value<span style="color:#f92672">=</span>cookie[<span style="color:#e6db74">&#34;value&#34;</span>],
</span></span><span style="display:flex;"><span>            domain<span style="color:#f92672">=</span>cookie[<span style="color:#e6db74">&#34;domain&#34;</span>],
</span></span><span style="display:flex;"><span>            path<span style="color:#f92672">=</span>cookie[<span style="color:#e6db74">&#34;path&#34;</span>]
</span></span><span style="display:flex;"><span>        )</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cookie_jar</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">&lt;RequestsCookieJar[Cookie(version=0, name=&#39;DICT_LOGIN&#39;, value=&#39;3||1578922508302&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;DICT_PERS&#39;, value=&#39;v2|weixin||DICT||web||2592000000||1578922508299||114.244.161.198||wxoXQUDj_FtHSw23tfJWsboPkq38ok||gFnMeLRLQLRpBOMYMhf6LRUf0Mz5P4TLRqSOM6uhfY5RzW0L6ZhHTB0kGRHeukLg40QZOMOMkMwu0gBkfJF0LTL0&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;DICT_SESS&#39;, value=&#39;v2|odmTRIUgTmgz6MlEOMqB0TBnfk5h4pZ0Py0MeBP4Q40qynHeuPMOWRpLPMY5RHJuRQykfJBOLQBRPKO4YYOLquR6zhLwBnMYMR&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;DICT_UGC&#39;, value=&#39;be3af0da19b5c5e6aa4e17bd8d90b28a|&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;JSESSIONID&#39;, value=&#39;abc46uQPL03Au_P0ghF_w&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;OUTFOX_SEARCH_USER_ID&#39;, value=&#39;&#34;1678365514@10.108.160.18&#34;&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;OUTFOX_SEARCH_USER_ID_NCOO&#39;, value=&#39;1349541628.6994112&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;ACCSESSIONID&#39;, value=&#39;8F00E30693F3BD052C9A4F293394BE0A&#39;, port=None, port_specified=False, domain=&#39;dict.youdao.com&#39;, domain_specified=True, domain_initial_dot=False, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;___rl__test__cookies&#39;, value=&#39;1578922438675&#39;, port=None, port_specified=False, domain=&#39;dict.youdao.com&#39;, domain_specified=True, domain_initial_dot=False, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False)]&gt;</code></pre>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2-将html都下载下来存入列表" class="pagebody-header">
    2. 将html都下载下来存入列表
  </h3>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>htmls <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://dict.youdao.com/wordbook/wordlist?p=</span><span style="color:#e6db74">{idx}</span><span style="color:#e6db74">&amp;tags=&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> idx <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">6</span>):
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;**爬数据：第</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">页&#34;</span> <span style="color:#f92672">%</span> idx)
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">.</span>format(idx<span style="color:#f92672">=</span>idx), cookies<span style="color:#f92672">=</span>cookie_jar)
</span></span><span style="display:flex;"><span>    htmls<span style="color:#f92672">.</span>append(r<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span><span style="color:#f92672">**</span>爬数据<span style="color:#960050;background-color:#1e0010">：</span>第0页
</span></span><span style="display:flex;"><span><span style="color:#f92672">**</span>爬数据<span style="color:#960050;background-color:#1e0010">：</span>第1页
</span></span><span style="display:flex;"><span><span style="color:#f92672">**</span>爬数据<span style="color:#960050;background-color:#1e0010">：</span>第2页
</span></span><span style="display:flex;"><span><span style="color:#f92672">**</span>爬数据<span style="color:#960050;background-color:#1e0010">：</span>第3页
</span></span><span style="display:flex;"><span><span style="color:#f92672">**</span>爬数据<span style="color:#960050;background-color:#1e0010">：</span>第4页
</span></span><span style="display:flex;"><span><span style="color:#f92672">**</span>爬数据<span style="color:#960050;background-color:#1e0010">：</span>第5页</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>htmls[<span style="color:#ae81ff">0</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">&#39;&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=UTF-8&#34;/&gt;\n&lt;title&gt;有道单词本&lt;/title&gt;\n\n&lt;link rel=&#34;canonical&#34; href=&#34;http://dict.youdao.com/wordbook/&#34;/&gt; \n&lt;meta name=&#34;Keywords&#34; content=&#34;单词本,web单词本,有道,词典,youdao&#34; /&gt;\n&lt;meta name=&#34;Description&#34; content=&#34;有道词典单词本&#34; /&gt;\n&lt;link rel=&#34;shortcut icon&#34; href=&#34;http://shared.ydstatic.com/images/favicon.ico?213&#34; type=&#34;image/x-icon&#34;/&gt;\n&lt;link href=&#34;http://shared.ydstatic.com/r/1.0/s/g3.css?20110428&#34; rel=&#34;stylesheet&#34; type=&#34;text/css&#34;/&gt;\n&lt;link type=&#34;text/css&#34; href=&#34;resources/styles/main.css&#34; rel=&#34;stylesheet&#34;&gt;\n\n&lt;style type=&#34;text/css&#34;&gt;\n\n#f{background-image:url(http://shared.ydstatic.com/images/skins/default/skin-x.jpg)}\n#fbl{background:url(http://shared.ydstatic.com/images/skins/default/skin_.jpg) left top}\n#fbr{background:url(http://shared.ydstatic.com/images/skins/default/skin_.jpg) right -200px}\n\n&lt;/style&gt;\n&lt;script type=&#34;text/javascript&#34;&gt;\nvar VARIABLES={ \n                tags:&#34;&#34;,\n                page:&#34;0&#34;,\n                sort:&#34;&#34;,\n                querystring:&#34;&#34;\n        };\n&lt;/script&gt;\n\n\n&lt;/head&gt;\n\n&lt;body&gt;\n\n&lt;div id=&#34;t&#34;&gt;\n    &lt;div id=&#34;u&#34;&gt;\n                    &lt;span id=&#34;un&#34;&gt;\n        &lt;span class=&#34;un_n&#34;&gt;晚上好，&lt;/span&gt;\n        &lt;span id=&#34;mun&#34; class=&#34;un_box&#34;&gt;&lt;b class=&#34;un_l&#34;&gt;&lt;q&gt;&lt;/q&gt;&lt;/b&gt;&lt;b class=&#34;un_r&#34;&gt;&lt;q&gt;&lt;/q&gt;&lt;/b&gt;\n                 &lt;span class=&#34;un_btn&#34;&gt;&lt;b class=&#34;un_m&#34;&gt;&amp;nbsp;&lt;q&gt;&lt;/q&gt;&lt;/b&gt;\n               &lt;span class=&#34;un_ml&#34;&gt;\n                    wxoXQUDj_FtHSw23tfJWsboPkq38ok\n                                  &lt;/span&gt;\n                                    &lt;/span&gt;\n            &lt;/span&gt;\n       &lt;/span&gt;\n                       &lt;span class=&#34;sl&#34;&gt;|&lt;/span&gt;\n                            &lt;a href=&#34;http://account.youdao.com/logout?service=dict&amp;back_url=http%3A%2F%2Fdict.youdao.com%2Fwordbook%2Fwordlist&#34;&gt;登出&lt;/a&gt;\n            &lt;/div&gt;\n    &lt;div id=&#34;n&#34;&gt;\n        &lt;a href=&#34;http://www.163.com/&#34; id=&#34;mn&#34; class=&#34;mn&#34; target=&#34;_blank&#34;&gt;&lt;u&gt;网易&lt;/u&gt;&lt;s&gt;▼&lt;/s&gt;&lt;/a&gt;\n        &lt;span class=&#34;sl&#34;&gt;|&lt;/span&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;www\&#39; href=&#34;http://www.youdao.com&#34;&gt;网页&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;image\&#39; href=&#34;http://image.youdao.com&#34;&gt;图片&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;news\&#39; href=&#34;http://news.youdao.com&#34;&gt;热闻&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;gouwu\&#39; href=&#34;http://gouwu.youdao.com&#34;&gt;购物&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;dict\&#39; href=&#34;http://dict.youdao.com&#34;&gt;词典&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;fanyi\&#39; data-trans=\&#39;translate?i=\&#39; href=&#34;http://fanyi.youdao.com/&#34;&gt;翻译&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;note\&#39; href=&#34;http://note.youdao.com&#34;&gt;笔记&lt;/a&gt;\n        &lt;strong&gt;单词本&lt;/strong&gt;\n\t&lt;a class=&#34;mn&#34; target=&#34;_blank&#34; href=&#34;http://www.youdao.com/about/productlist.html&#34;&gt;&lt;u&gt;更多»&lt;/u&gt;&lt;/a&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;\n\n\n&lt;div id=&#34;ym&#34; class=&#34;pm&#34;&gt;\n    &lt;ul&gt;\n        &lt;li&gt;&lt;a href=&#34;http://video.youdao.com&#34; class=&#34;search-js&#34; data-product=\&#39;video\&#39;&gt;视频&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://blog.youdao.com/&#34; class=&#34;search-js&#34; data-product=\&#39;blog\&#39;&gt;博客&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://tie.youdao.com/&#34; class=&#34;search-js&#34; data-product=\&#39;tie\&#39;&gt;快贴&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://ditu.youdao.com/&#34; class=&#34;search-js&#34; data-product=\&#39;ditu\&#39;&gt;地图&lt;/a&gt;&lt;/li&gt;\n\n        &lt;li class=&#34;sl&#34;&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://reader.youdao.com&#34;&gt;阅读&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://m.youdao.com/help&#34;&gt;手机&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://shuqian.youdao.com&#34;&gt;书签&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://cidian.youdao.com&#34; class=&#34;search-js&#34; data-product=\&#39;cidian\&#39;&gt;桌面词典&lt;/a&gt;&lt;/li&gt;\n        &lt;li class=&#34;sl&#34;&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://www.youdao.com/about/productlist.html&#34;&gt;全部产品&lt;/a&gt;&lt;/li&gt;\n\n    &lt;/ul&gt;\n&lt;/div&gt;\n&lt;div id=&#34;nm&#34; class=&#34;pm&#34;&gt;\n    &lt;ul&gt;\n        &lt;li&gt;&lt;a href=&#34;http://www.163.com/&#34; target=&#34;_blank&#34;&gt;首页&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://news.163.com/&#34; target=&#34;_blank&#34;&gt;新闻&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://email.163.com/&#34; target=&#34;_blank&#34;&gt;邮箱&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://blog.163.com/&#34; target=&#34;_blank&#34;&gt;博客&lt;/a&gt;&lt;/li&gt;\n\n        &lt;li&gt;&lt;a href=&#34;http://photo.163.com/&#34; target=&#34;_blank&#34;&gt;相册&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://nie.163.com/&#34; target=&#34;_blank&#34;&gt;游戏&lt;/a&gt;&lt;/li&gt;\n        &lt;li class=&#34;sl&#34;&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://sitemap.163.com/&#34; target=&#34;_blank&#34;&gt;全部产品&lt;/a&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n&lt;/div&gt;\n\n\n&lt;!-- 图标与搜索框 --&gt;\n&lt;form id=&#34;f&#34; method=&#34;get&#34; action=&#34;#&#34; name=&#34;sb&#34;&gt;\n  &lt;h1 id=&#34;yd&#34;&gt;&lt;a href=&#34;/wordbook/wordlist&#34;&gt;有道单词本&lt;/a&gt;&lt;/h1&gt;\n   &lt;!--&lt;div id=&#34;ts&#34; class=&#34;fc&#34;&gt;\n \n    &lt;div class=&#34;qc no-suggest&#34; id=&#34;qc&#34;&gt;\n      &lt;input name=&#34;tab&#34; value=&#34;chn&#34; type=&#34;hidden&#34;&gt;\n      &lt;input name=&#34;keyfrom&#34; value=&#34;shuqian.top&#34; type=&#34;hidden&#34;&gt;\n      &lt;input type=&#34;text&#34; class=&#34;q&#34; name=&#34;q&#34; id=&#34;query&#34; autocomplete=&#34;off&#34;  value=&#34;&#34;/&gt;\n    &lt;/div&gt;\n    &lt;input type=&#34;submit&#34; value=&#34;搜 索&#34; class=&#34;qb&#34; name=&#34;btnSearchTag&#34;/&gt;\n    \n  &lt;/div&gt;--&gt;\n  &lt;div class=&#34;ao&#34;&gt;&lt;/div&gt;\n  &lt;div id=&#34;fbl&#34;&gt; &lt;/div&gt;\n  &lt;div id=&#34;fbr&#34;&gt; &lt;/div&gt;\n&lt;/form&gt; \n \n\n&lt;div id=&#34;wrapper&#34;&gt;\n\n\n    &lt;div id=&#34;top&#34; &gt;\n        \n\n                &lt;a href=&#34;#&#34; id=&#34;addword&#34;&gt;&lt;/a&gt;\n\n                \n              \n            &lt;div style=&#34;width:500px;float:right;text-align:right;&#34;&gt;    \n                &lt;label for=&#34;select_category&#34;&gt;分类&lt;/label&gt;\n                &lt;select id=&#34;select_category&#34;&gt;\n                    &lt;option value=&#34;&#34;&gt;全部分类&lt;/option&gt;\n                                            &lt;option value=&#34;无标签&#34; &gt;无标签 &lt;/option&gt;\n                                    &lt;/select&gt;  \n                        \n        &lt;a href=&#34;#&#34; id=&#34;toggle_listmode&#34; class=&#34;active&#34;&gt;&lt;/a&gt;&lt;a href=&#34;#&#34; id=&#34;toggle_cardmode&#34; &gt;&lt;/a&gt;\n        &lt;/div&gt;\n        &lt;div class=&#34;clear&#34;&gt;&lt;/div&gt;\n\n    &lt;/div&gt;   \n    \n    &lt;div id=&#34;listmode&#34;&gt;\n               &lt;div id=&#34;wordhead&#34;&gt;\n            &lt;table  width=&#34;100%&#34; style=&#34;table-layout:fixed;background:#fff;&#34;&gt;\n                    &lt;tr&gt;\n                        &lt;th width=&#34;50px&#34;&gt;序号&lt;/th&gt;\n                        &lt;th width=&#34;80px&#34;&gt;单词&lt;/th&gt;\n                        &lt;th width=&#34;80px&#34;&gt;音标&lt;/th&gt;\n                        &lt;th width=&#34;320px&#34;&gt;解释&lt;/th&gt;\n                       &lt;!--  &lt;th width=&#34;50px&#34;&gt;难度&lt;/th&gt; --&gt;\n                        &lt;th width=&#34;85px&#34;&gt;时间&lt;/th&gt;\n                        &lt;th&gt;分类&lt;/th&gt;\n                        &lt;th width=&#34;65px&#34;&gt;操作&lt;/th&gt;\n                    &lt;/tr&gt;\n            &lt;/table&gt;\n        &lt;/div&gt; \n        \n        &lt;div id=&#34;wordlist&#34; &gt;\n            &lt;table  width=&#34;100%&#34; style=&#34;table-layout:fixed&#34;&gt;\n\n                &lt;tbody&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 1&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;agglomerative&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=agglomerative&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;agglomerative&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;&#34;&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;adj. 会凝聚的；[冶] 烧结的，凝结的&#34;&gt;adj. 会凝聚的；[冶] 烧结的，凝结的&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2020-1-13&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑agglomerative&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=agglomerative&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除agglomerative&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 agglomerative 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 2&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;anatomy&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=anatomy&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;anatomy&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[ə&amp;#39;nætəmɪ]&#34;&gt;[ə&amp;#39;nætəmɪ]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. 解剖；解剖学；剖析；骨骼&#34;&gt;n. 解剖；解剖学；剖析；骨骼&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2017-7-17&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑anatomy&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=anatomy&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除anatomy&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 anatomy 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 3&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;backbone&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=backbone&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;backbone&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[&amp;#39;bækbəʊn]&#34;&gt;[&amp;#39;bækbəʊn]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. 支柱;主干网;决心,毅力;脊椎&#34;&gt;n. 支柱;主干网;决心,毅力;脊椎&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2017-7-13&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑backbone&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=backbone&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除backbone&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 backbone 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 4&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;ballpark&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=ballpark&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;ballpark&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[&amp;#39;bɔːlpɑːk]&#34;&gt;[&amp;#39;bɔːlpɑːk]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. (美)棒球场;活动领域;可变通范围\nadj. 大约的&#34;&gt;n. (美)棒球场;活动领域;可变通范围\nadj. 大约的&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-16&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑ballpark&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=ballpark&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除ballpark&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 ballpark 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 5&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;bilingual&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=bilingual&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;bilingual&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[baɪ&amp;#39;lɪŋgw(ə)l]&#34;&gt;[baɪ&amp;#39;lɪŋgw(ə)l]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;adj. 双语的\nn. 通两种语言的人&#34;&gt;adj. 双语的\nn. 通两种语言的人&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-15&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑bilingual&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=bilingual&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除bilingual&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 bilingual 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 6&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;canonical&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=canonical&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;canonical&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[kə&amp;#39;nɒnɪk(ə)l]&#34;&gt;[kə&amp;#39;nɒnɪk(ə)l]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;adj. 依教规的;权威的;牧师的\nn. 牧师礼服&#34;&gt;adj. 依教规的;权威的;牧师的\nn. 牧师礼服&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-14&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑canonical&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=canonical&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除canonical&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 canonical 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 7&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;cater&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=cater&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;cater&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[&amp;#39;keɪtə]&#34;&gt;[&amp;#39;keɪtə]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;vt. 投合，迎合；满足需要；提供饮食及服务\nn. (Cater)人名；(英)凯特&#34;&gt;vt. 投合，迎合；满足需要；提供饮食及服务\nn. (Cater)人名；(英)凯特&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2017-7-17&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑cater&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=cater&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除cater&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 cater 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 8&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;clarity&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=clarity&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;clarity&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[&amp;#39;klærɪtɪ]&#34;&gt;[&amp;#39;klærɪtɪ]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. 清楚,明晰;透明\nn. (Clarity)人名;(英)克拉里蒂&#34;&gt;n. 清楚,明晰;透明\nn. (Clarity)人名;(英)克拉里蒂&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-16&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑clarity&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=clarity&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除clarity&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 clarity 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 9&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;compression&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=compression&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;compression&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[kəm&amp;#39;preʃ(ə)n]&#34;&gt;[kəm&amp;#39;preʃ(ə)n]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. 压缩,浓缩;压榨,压迫&#34;&gt;n. 压缩,浓缩;压榨,压迫&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-15&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑compression&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=compression&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除compression&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 compression 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 10&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;contaminated&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=contaminated&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;contaminated&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;&#34;&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;adj. 受污染的，弄脏的 v. 污染；玷污，毒害（contaminate 的过去式和过去分词）&#34;&gt;adj. 受污染的，弄脏的 v. 污染；玷污，毒害（contaminate 的过去式和过去分词）&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2020-1-13&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑contaminated&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=contaminated&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除contaminated&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 contaminated 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 11&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;counterparts&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=counterparts&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;counterparts&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[]&#34;&gt;[]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. （契约）副本（counterpart的复数）；相对物；相对应的人&#34;&gt;n. （契约）副本（counterpart的复数）；相对物；相对应的人&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2017-7-16&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑counterparts&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=counterparts&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除counterparts&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 counterparts 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 12&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;criteria&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=criteria&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;criteria&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[kraɪ&amp;#39;tɪərɪə]&#34;&gt;[kraɪ&amp;#39;tɪərɪə]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. 标准，条件（criterion的复数）&#34;&gt;n. 标准，条件（criterion的复数）&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2017-7-6&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑criteria&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=criteria&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除criteria&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 criteria 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 13&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;crunch&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=crunch&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;crunch&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[krʌntʃ]&#34;&gt;[krʌntʃ]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n.咬碎，咬碎声；扎扎地踏\nvt.压碎；嘎扎嘎扎的咬嚼；扎扎地踏过\nvi.嘎吱作响地咀嚼；嘎吱嘎吱地踏过&#34;&gt;n.咬碎，咬碎声；扎扎地踏\nvt.压碎；嘎扎嘎扎的咬嚼；扎扎地踏过\nvi.嘎吱作响地咀嚼；嘎吱嘎吱地踏过&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-8&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑crunch&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=crunch&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除crunch&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 crunch 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 14&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;delighted&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=delighted&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;delighted&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[dɪ&amp;#39;laɪtɪd]&#34;&gt;[dɪ&amp;#39;laɪtɪd]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;adj. 高兴的;欣喜的\nv. 使…兴高采烈;感到快乐(delight的过去分词)&#34;&gt;adj. 高兴的;欣喜的\nv. 使…兴高采烈;感到快乐(delight的过去分词)&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-16&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑delighted&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=delighted&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除delighted&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 delighted 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 15&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;denominator&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=denominator&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;denominator&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;&#34;&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. [数] 分母；命名者；共同特征或共同性质；平均水平或标准&#34;&gt;n. [数] 分母；命名者；共同特征或共同性质；平均水平或标准&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2020-1-13&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;编辑denominator&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=denominator&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;删除denominator&#34; onclick=\&#39;if(!confirm(&#34;您确定删除单词 denominator 吗？&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                    &lt;/tbody&gt;\n            &lt;/table&gt;\n        &lt;/div&gt;\n      \n  \n        &lt;div id=&#34;wordfoot&#34; &gt;\n            \n                                &lt;div id=&#34;pagination&#34;&gt;\n                                                             &lt;span class=&#34;current-page&#34;&gt;1 &lt;/span&gt;\n                    \n                    \n                                                                                                                                                                                                                                                    &lt;a href=&#34;wordlist?p=1&amp;tags=&#34;&gt;2&lt;/a&gt; \n                                                                                                                                                                                                                                                                                                                                                                                            &lt;a href=&#34;wordlist?p=2&amp;tags=&#34;&gt;3&lt;/a&gt; \n                                                                                                                                                                                                                                                                                                        &lt;span style=&#34;border:none;&#34;&gt;...&lt;/span&gt;\n                                \n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \n                                        &lt;a href=&#34;wordlist?p=1&amp;tags=&#34; class=&#34;next-page&#34;&gt;下一页&lt;/a&gt;\n                                        &lt;a href=&#34;wordlist?p=7&amp;tags=&#34; class=&#34;next-page&#34;&gt;最后一页&lt;/a&gt;\n                &lt;/div&gt;\n               &lt;form id=&#34;pagejumpform&#34; action=&#34;#&#34;&gt;\n               跳至第&lt;input type=&#34;text&#34; value=&#34;&#34;/&gt;页&lt;button type=&#34;submit&#34;&gt;确定&lt;/button&gt;\n               &lt;/form&gt;                \n                              \n\n               \n             \n             \n             &lt;div class=&#34;right&#34; &gt;当前分类：&lt;strong&gt; 全部分类 &lt;/strong&gt; &amp;nbsp;&amp;nbsp;共计 &lt;strong&gt;86&lt;/strong&gt; 个单词 &lt;/div&gt;\n             &lt;div class=&#34;clear&#34;&gt;&lt;/div&gt;\n        &lt;/div&gt;\n            &lt;/div&gt;\n    \n\n    \n    &lt;div id=&#34;cardmode&#34;&gt;\n          &lt;div id=&#34;cardmode-wrap&#34;&gt;\n        &lt;div id=&#34;card&#34;&gt;\n                                            &lt;h1 &gt;&lt;span id=&#34;card_word&#34;&gt;agglomerative&lt;/span&gt;&lt;a href=&#34;#&#34; id=&#34;phonetic-voice&#34;&gt;&lt;/a&gt;&lt;/h1&gt; \n                &lt;div id=&#34;card_pronounce&#34;&gt;\n                    \n                &lt;/div&gt;\n\n                &lt;div id=&#34;description&#34; style=&#34;display:none;&#34;&gt;\n                    adj. 会凝聚的；[冶] 烧结的，凝结的\n                &lt;/div&gt;\n\n                &lt;div id=&#34;mask&#34; &gt;\n                    &lt;span id=&#34;toggle-description&#34; &gt;&lt;img src=&#34;http://shared.ydstatic.com/dict/wordbook-v1/images/mask.png&#34;&gt;&lt;/span&gt;\n                &lt;/div&gt;\n            \n                &lt;div id=&#34;action&#34;&gt;\n                    &lt;a id=&#34;pre&#34; href=&#34;#&#34;&gt;&lt;/a&gt;\n                    &lt;a id=&#34;next&#34; href=&#34;#&#34;&gt;&lt;/a&gt;\n                    &lt;div style=&#34;clear:both;&#34;&gt;&lt;/div&gt;\n                &lt;/div&gt;\n                \n                                                                                                                                                                                                                                                                                                                                                                                                                                            &lt;/div&gt;\n      &lt;/div&gt;\n        &lt;div style=&#34;line-height:28px;text-align:right;&#34;&gt;\n            当前分类：&lt;strong&gt; 全部分类 &lt;/strong&gt; &amp;nbsp;&amp;nbsp;共计 \n            &lt;strong id=&#34;card_max_id&#34;&gt;86&lt;/strong&gt; 个单词 现在是第&lt;span id=&#34;card_id&#34;&gt; 1&lt;/span&gt;个\n        &lt;/div&gt;\n              \n    &lt;/div&gt;\n    \n\n\n\n\n\n&lt;div id=&#34;footarea&#34; &gt;\n    &lt;div style=&#34; line-height:2; margin:10px 0 20px;&#34;&gt;更好的进行生词的整理/记忆，请使用桌面版和手机版有道词典中的单词本&lt;/div&gt;\n    &lt;div id=&#34;foot-ad&#34;&gt;\n    \n        &lt;a href=&#34;http://cidian.youdao.com/?keyform=webwordbook&#34; class=&#34;go-to-desktop&#34; target=&#34;_blank&#34;&gt;&lt;/a&gt;\n        &lt;a href=&#34;http://cidian.youdao.com/android.html?keyform=webwordbook&#34; class=&#34;go-to-mobile&#34; target=&#34;_blank&#34;&gt;&lt;/a&gt;\n\n    &lt;/div&gt;\n&lt;/div&gt;   \n\n&lt;/div&gt;\n\n&lt;div id=&#34;bottom&#34;&gt;\n  &lt;p&gt;&lt;a href=&#34;http://youdao.com/&#34;&gt;有道首页&lt;/a&gt; - &lt;a href=&#34;http://www.youdao.com/help/dict/description/001/&#34;&gt;帮助&lt;/a&gt; - &lt;a href=&#34;http://www.youdao.com/about/&#34;&gt;关于有道&lt;/a&gt; - &lt;a href=&#34;http://i.youdao.com/&#34;&gt;官方博客&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;copy; 2020 网易公司 京ICP证080268号&lt;/p&gt;\n  \n&lt;/div&gt;\n\n\n\n    &lt;div id=&#34;editwordform&#34;&gt;\n        &lt;h1&gt;danci&lt;/h1&gt;\n        &lt;a href=&#34;#&#34; id=&#34;close-editwordform&#34;&gt;&lt;/a&gt;\n        &lt;form method=&#34;post&#34; action=&#34;wordlist?action=modify&#34;&gt;\n        \n        &lt;label for=&#34;word&#34;&gt;单词&lt;span id=&#34;waittext&#34;&gt;&lt;/span&gt;&lt;/label&gt;\n        &lt;input id=&#34;word&#34; type=&#34;text&#34; value=&#34;&#34; name=&#34;word&#34; autocomplete=&#34;off&#34; /&gt;\n        &lt;label for=&#34;phonetic&#34;&gt;音标&lt;/label&gt;\n        &lt;input id=&#34;phonetic&#34; type=&#34;text&#34; value=&#34;&#34; name=&#34;phonetic&#34; /&gt;\n        &lt;label for=&#34;desc&#34;&gt;解释&lt;/label&gt;\n        &lt;textarea id=&#34;desc&#34; name=&#34;desc&#34; &gt;&lt;/textarea&gt;\n        \n        &lt;label style=&#34;color:blue;&#34;&gt;更多（可不填）&lt;/label&gt;\n\n        &lt;label for=&#34;tags&#34;&gt;分类&lt;/label&gt;&lt;input id=&#34;tags&#34; type=&#34;text&#34; value=&#34;&#34; name=&#34;tags&#34; autocomplete=&#34;off&#34; /&gt;\n        &lt;ul id=&#34;tag-select-list&#34;&gt;\n                                            &lt;li&gt;无标签&lt;/li&gt;\n                                    &lt;/ul&gt;\n            \n        &lt;div class=&#34;center-content&#34;&gt;&lt;button type=&#34;submit&#34;&gt;&lt;/button&gt;&lt;/div&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;        \n\n&lt;div id=&#34;leftbar&#34;&gt;\n&lt;a href=&#34;/?keyfrom=webwordbook&#34;&gt;返回词典首页&lt;/a&gt;\n&lt;br/&gt;&lt;br/&gt;\n&lt;a href=&#34;http://xue.youdao.com/&#34;&gt;返回有道学堂&lt;/a&gt;\n&lt;/div&gt;    \n    &lt;object width=&#34;1&#34; height=&#34;1&#34; type=&#34;application/x-shockwave-flash&#34; id=&#34;dictVoice&#34; data=&#34;/dictVoice.swf&#34;&gt;\n        &lt;param name=&#34;movie&#34; value=&#34;/dictVoice.swf&#34;/&gt;\n        &lt;param name=&#34;menu&#34; value=&#34;false&#34;/&gt;\n        &lt;param name=&#34;allowScriptAccess&#34; value=&#34;always&#34;/&gt;\n        &lt;param name=&#34;wmode&#34; value=&#34;transparent&#34;/&gt;\n    &lt;/object&gt;\n    \n&lt;script type=&#34;text/javascript&#34; src=&#34;http://shared.ydstatic.com/dict/wordbook-v1/scripts/jquery-1.5.2.min.js&#34;&gt;&lt;/script&gt;\n&lt;script type=&#34;text/javascript&#34; src=&#34;http://shared.ydstatic.com/dict/wordbook-v1/scripts/jquery.extention.dict4.js&#34;&gt;&lt;/script&gt;\n&lt;script type=&#34;text/javascript&#34; src=&#34;http://shared.ydstatic.com/dict/wordbook-v1/scripts/navigatorBar.js&#34;&gt;&lt;/script&gt;\n&lt;script type=&#34;text/javascript&#34; src=&#34;resources/scripts/main.js&#34;&gt;&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&#39;</code></pre>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3-使用pandas解析网页中的表格" class="pagebody-header">
    3. 使用Pandas解析网页中的表格
  </h3>
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_html(htmls[<span style="color:#ae81ff">0</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(len(df))
</span></span><span style="display:flex;"><span>print(type(df))
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">list</span><span style="color:#e6db74">&#39;&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">序号</th>
<th style="text-align:right">单词</th>
<th style="text-align:right">音标</th>
<th style="text-align:right">解释</th>
<th style="text-align:right">时间</th>
<th style="text-align:right">分类</th>
<th style="text-align:right">操作</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
<th style="text-align:right">2</th>
<th style="text-align:right">3</th>
<th style="text-align:right">4</th>
<th style="text-align:right">5</th>
<th style="text-align:right">6</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">agglomerative</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">adj. 会凝聚的；[冶] 烧结的，凝结的</td>
<td style="text-align:right">2020-1-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">anatomy</td>
<td style="text-align:right">[ə&rsquo;nætəmɪ]</td>
<td style="text-align:right">n. 解剖；解剖学；剖析；骨骼</td>
<td style="text-align:right">2017-7-17</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">backbone</td>
<td style="text-align:right">[&lsquo;bækbəʊn]</td>
<td style="text-align:right">n. 支柱;主干网;决心,毅力;脊椎</td>
<td style="text-align:right">2017-7-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_cont <span style="color:#f92672">=</span> df[<span style="color:#ae81ff">1</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_cont<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> df[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>columns</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_cont<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">序号</th>
<th style="text-align:right">单词</th>
<th style="text-align:right">音标</th>
<th style="text-align:right">解释</th>
<th style="text-align:right">时间</th>
<th style="text-align:right">分类</th>
<th style="text-align:right">操作</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">agglomerative</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">adj. 会凝聚的；[冶] 烧结的，凝结的</td>
<td style="text-align:right">2020-1-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">anatomy</td>
<td style="text-align:right">[ə&rsquo;nætəmɪ]</td>
<td style="text-align:right">n. 解剖；解剖学；剖析；骨骼</td>
<td style="text-align:right">2017-7-17</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">backbone</td>
<td style="text-align:right">[&lsquo;bækbəʊn]</td>
<td style="text-align:right">n. 支柱;主干网;决心,毅力;脊椎</td>
<td style="text-align:right">2017-7-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 收集6个网页的表格</span>
</span></span><span style="display:flex;"><span>df_list <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> html <span style="color:#f92672">in</span> htmls:
</span></span><span style="display:flex;"><span>    df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_html(html)
</span></span><span style="display:flex;"><span>    df_cont <span style="color:#f92672">=</span> df[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    df_cont<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> df[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>columns
</span></span><span style="display:flex;"><span>    df_list<span style="color:#f92672">.</span>append(df_cont)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 合并多个表格</span>
</span></span><span style="display:flex;"><span>df_all <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(df_list)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_all<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">序号</th>
<th style="text-align:right">单词</th>
<th style="text-align:right">音标</th>
<th style="text-align:right">解释</th>
<th style="text-align:right">时间</th>
<th style="text-align:right">分类</th>
<th style="text-align:right">操作</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">agglomerative</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">adj. 会凝聚的；[冶] 烧结的，凝结的</td>
<td style="text-align:right">2020-1-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">anatomy</td>
<td style="text-align:right">[ə&rsquo;nætəmɪ]</td>
<td style="text-align:right">n. 解剖；解剖学；剖析；骨骼</td>
<td style="text-align:right">2017-7-17</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">backbone</td>
<td style="text-align:right">[&lsquo;bækbəʊn]</td>
<td style="text-align:right">n. 支柱;主干网;决心,毅力;脊椎</td>
<td style="text-align:right">2017-7-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_all<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">(86, 7)</code></pre>
  
</div>
<div class="component-content pagebody component">
  <h3 id="4-将结果数据输出到excel文件" class="pagebody-header">
    4. 将结果数据输出到Excel文件
  </h3>
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_all[[<span style="color:#e6db74">&#34;单词&#34;</span>, <span style="color:#e6db74">&#34;音标&#34;</span>, <span style="color:#e6db74">&#34;解释&#34;</span>]]<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">&#34;./course_datas/c32_read_html/网易有道单词本列表.xlsx&#34;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="33pandas计算同比环比指标的3种方法" class="pagebody-header">
    33、Pandas计算同比环比指标的3种方法
  </h1>
</div>
<div class="component-content pagebody component">
  <h4 id="同比和环比环比和同比用于描述统计数据的变化情况" class="pagebody-header">
    同比和环比：环比和同比用于描述统计数据的变化情况
  </h4>
</div><div class="component-content component"><ul>
<li>环比：表示本次统计段与相连的上次统计段之间的比较。
<div class="component-content component"><ul>
<li>比如2010年中国第一季度GDP为G2010Q1亿元，第二季度GDP为G2010Q2亿元，则第二季度GDP环比增长（G2010Q2-G2010Q1)/G2010Q1；</li>
</ul></div>
</li>
<li>同比：即同期相比，表示某个特定统计段今年与去年之间的比较。
<div class="component-content component"><ul>
<li>比如2009年中国第一季度GDP为G2009Q1亿元，则2010年第一季度的GDP同比增长为（G2010Q1-G2009Q1)/G2009Q1。</li>
</ul></div>
</li>
</ul></div>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-5cb0ff111723e703733450ff76b1cb42" id="lht5cb0ff111723e703733450ff76b1cb42">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/29.jpg" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">演示步骤：</p>
<div class="component-content component"><ol>
<li>读取连续3年的天气数据</li>
<li>方法1：pandas.Series.pct_change</li>
<li>方法2：pandas.Series.shift</li>
<li>方法3：pandas.Series.diff</li>
</ol></div>
<p class="component-content component">pct_change、shift、diff，都实现了跨越多行的数据计算</p>

<div class="component-content pagebody component">
  <h3 id="0-读取连续3年的天气数据" class="pagebody-header">
    0. 读取连续3年的天气数据
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fpath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./datas/beijing_tianqi/beijing_tianqi_2017-2019.csv&#34;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(fpath, index_col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ymd&#34;</span>, parse_dates<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-01</td>
<td style="text-align:right">5℃</td>
<td style="text-align:right">-3℃</td>
<td style="text-align:right">霾~晴</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">450</td>
<td style="text-align:right">严重污染</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">2017-01-02</td>
<td style="text-align:right">7℃</td>
<td style="text-align:right">-6℃</td>
<td style="text-align:right">晴~霾</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">246</td>
<td style="text-align:right">重度污染</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2017-01-03</td>
<td style="text-align:right">5℃</td>
<td style="text-align:right">-5℃</td>
<td style="text-align:right">霾</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">320</td>
<td style="text-align:right">严重污染</td>
<td style="text-align:right">6</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 替换掉温度的后缀℃</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;℃&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-01</td>
<td style="text-align:right">5</td>
<td style="text-align:right">-3℃</td>
<td style="text-align:right">霾~晴</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">450</td>
<td style="text-align:right">严重污染</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">2017-01-02</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-6℃</td>
<td style="text-align:right">晴~霾</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">246</td>
<td style="text-align:right">重度污染</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2017-01-03</td>
<td style="text-align:right">5</td>
<td style="text-align:right">-5℃</td>
<td style="text-align:right">霾</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">320</td>
<td style="text-align:right">严重污染</td>
<td style="text-align:right">6</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 新的df，为每个月的平均最高温</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df[[<span style="color:#e6db74">&#34;bWendu&#34;</span>]]<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#34;M&#34;</span>)<span style="color:#f92672">.</span>mean()</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 将索引按照日期升序排列</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>sort_index(ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>DatetimeIndex([<span style="color:#e6db74">&#39;2017-01-31&#39;</span>, <span style="color:#e6db74">&#39;2017-02-28&#39;</span>, <span style="color:#e6db74">&#39;2017-03-31&#39;</span>, <span style="color:#e6db74">&#39;2017-04-30&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2017-05-31&#39;</span>, <span style="color:#e6db74">&#39;2017-06-30&#39;</span>, <span style="color:#e6db74">&#39;2017-07-31&#39;</span>, <span style="color:#e6db74">&#39;2017-08-31&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2017-09-30&#39;</span>, <span style="color:#e6db74">&#39;2017-10-31&#39;</span>, <span style="color:#e6db74">&#39;2017-11-30&#39;</span>, <span style="color:#e6db74">&#39;2017-12-31&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-01-31&#39;</span>, <span style="color:#e6db74">&#39;2018-02-28&#39;</span>, <span style="color:#e6db74">&#39;2018-03-31&#39;</span>, <span style="color:#e6db74">&#39;2018-04-30&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-05-31&#39;</span>, <span style="color:#e6db74">&#39;2018-06-30&#39;</span>, <span style="color:#e6db74">&#39;2018-07-31&#39;</span>, <span style="color:#e6db74">&#39;2018-08-31&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-09-30&#39;</span>, <span style="color:#e6db74">&#39;2018-10-31&#39;</span>, <span style="color:#e6db74">&#39;2018-11-30&#39;</span>, <span style="color:#e6db74">&#39;2018-12-31&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2019-01-31&#39;</span>, <span style="color:#e6db74">&#39;2019-02-28&#39;</span>, <span style="color:#e6db74">&#39;2019-03-31&#39;</span>, <span style="color:#e6db74">&#39;2019-04-30&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2019-05-31&#39;</span>, <span style="color:#e6db74">&#39;2019-06-30&#39;</span>, <span style="color:#e6db74">&#39;2019-07-31&#39;</span>, <span style="color:#e6db74">&#39;2019-08-31&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2019-09-30&#39;</span>, <span style="color:#e6db74">&#39;2019-10-31&#39;</span>, <span style="color:#e6db74">&#39;2019-11-30&#39;</span>, <span style="color:#e6db74">&#39;2019-12-31&#39;</span>],
</span></span><span style="display:flex;"><span>              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ymd&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;M&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x13d8d77dc48</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-e8575737e5973ac6997c0fed56a20e39" id="lhte8575737e5973ac6997c0fed56a20e39">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/30.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h3 id="方法1pandasseriespct_change" class="pagebody-header">
    方法1：pandas.Series.pct_change
  </h3>
</div><p class="component-content component">pct_change方法直接算好了&quot;(新-旧)/旧&quot;的百分比</p>
<p class="component-content component">官方文档地址：https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.pct_change.html</p>
<p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu_way1_huanbi&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>pct_change(periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu_way1_tongbi&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>pct_change(periods<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">15</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu_way1_huanbi</th>
<th style="text-align:right">bWendu_way1_tongbi</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-06-30</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-07-31</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-08-31</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-09-30</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-10-31</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-11-30</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-12-31</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2018-01-31</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
</tr>
<tr>
<td style="text-align:right">2018-02-28</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="方法2pandasseriesshift" class="pagebody-header">
    方法2：pandas.Series.shift
  </h3>
</div><p class="component-content component">shift用于移动数据，但是保持索引不变</p>
<p class="component-content component">官方文档地址：https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.shift.html</p>
<p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 见识一下shift做了什么事情</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 使用pd.concat合并Series列表变成一个大的df</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat(
</span></span><span style="display:flex;"><span>    [df[<span style="color:#e6db74">&#34;bWendu&#34;</span>], 
</span></span><span style="display:flex;"><span>     df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>shift(periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>), 
</span></span><span style="display:flex;"><span>     df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>shift(periods<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>)],
</span></span><span style="display:flex;"><span>    axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>)<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">15</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-06-30</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-07-31</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-08-31</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-09-30</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-10-31</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-11-30</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-12-31</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2018-01-31</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">3.322581</td>
</tr>
<tr>
<td style="text-align:right">2018-02-28</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">7.642857</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">14.129032</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 环比</span>
</span></span><span style="display:flex;"><span>series_shift1 <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>shift(periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu_way2_huanbi&#34;</span>] <span style="color:#f92672">=</span> (df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">-</span>series_shift1)<span style="color:#f92672">/</span>series_shift1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 同比</span>
</span></span><span style="display:flex;"><span>series_shift2 <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>shift(periods<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu_way2_tongbi&#34;</span>] <span style="color:#f92672">=</span> (df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">-</span>series_shift2)<span style="color:#f92672">/</span>series_shift2</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">15</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu_way1_huanbi</th>
<th style="text-align:right">bWendu_way1_tongbi</th>
<th style="text-align:right">bWendu_way2_huanbi</th>
<th style="text-align:right">bWendu_way2_tongbi</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-06-30</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-07-31</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-08-31</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-09-30</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-10-31</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-11-30</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-12-31</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2018-01-31</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
</tr>
<tr>
<td style="text-align:right">2018-02-28</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="方法3-pandasseriesdiff" class="pagebody-header">
    方法3. pandas.Series.diff
  </h3>
</div><p class="component-content component">pandas.Series.diff用于新值减去旧值</p>
<p class="component-content component">官方文档：https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.diff.html</p>
<p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">pd.concat(
    [df[&#34;bWendu&#34;], 
     df[&#34;bWendu&#34;].diff(periods=1), 
     df[&#34;bWendu&#34;].diff(periods=12)],
    axis=1
).head(15)</code></pre>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">4.320276</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">6.486175</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">9.570968</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">6.074194</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-06-30</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">1.192473</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-07-31</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">0.646237</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-08-31</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">-1.483871</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-09-30</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">-2.262366</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-10-31</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">-10.640860</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-11-30</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">-7.659140</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-12-31</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">-5.082796</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2018-01-31</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">-3.161290</td>
<td style="text-align:right">-2.00</td>
</tr>
<tr>
<td style="text-align:right">2018-02-28</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">3.570276</td>
<td style="text-align:right">-2.75</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">9.236175</td>
<td style="text-align:right">0.00</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 环比</span>
</span></span><span style="display:flex;"><span>series_diff1 <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>diff(periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu_way3_huanbi&#34;</span>] <span style="color:#f92672">=</span> series_diff1<span style="color:#f92672">/</span>(df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">-</span>series_diff1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 同比</span>
</span></span><span style="display:flex;"><span>series_diff2 <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>diff(periods<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu_way3_tongbi&#34;</span>] <span style="color:#f92672">=</span> series_diff2<span style="color:#f92672">/</span>(df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">-</span>series_diff2)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">15</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu_way1_huanbi</th>
<th style="text-align:right">bWendu_way1_tongbi</th>
<th style="text-align:right">bWendu_way2_huanbi</th>
<th style="text-align:right">bWendu_way2_tongbi</th>
<th style="text-align:right">bWendu_way3_huanbi</th>
<th style="text-align:right">bWendu_way3_tongbi</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-06-30</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-07-31</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-08-31</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-09-30</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-10-31</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-11-30</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-12-31</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2018-01-31</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
</tr>
<tr>
<td style="text-align:right">2018-02-28</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="34pandas和数据库查询语言sql的对比" class="pagebody-header">
    34、Pandas和数据库查询语言SQL的对比
  </h1>
</div><div class="component-content component"><ul>
<li>Pandas：Python最流行的数据处理与数据分析的类库</li>
<li>SQL：结构化查询语言，用于对MySQL、Oracle等关系型数据库的增删改查</li>
</ul></div>
<p class="component-content component">两者都是对“表格型”数据的操作和查询，所以很多语法都能对应起来</p>
<p class="component-content component">对比列表：</p>
<div class="component-content component"><ol>
<li>SELECT数据查询</li>
<li>WHERE按条件查询</li>
<li>in和not in的条件查询</li>
<li>groupby分组统计</li>
<li>JOIN数据关联</li>
<li>UNION数据合并</li>
<li>Order Limit先排序后分页</li>
<li>取每个分组group的top n</li>
<li>UPDATE数据更新</li>
<li>DELETE删除数据</li>
</ol></div>

<div class="component-content pagebody component">
  <h3 id="0-读取泰坦尼克数据集" class="pagebody-header">
    0. 读取泰坦尼克数据集
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./datas/titanic/titanic_train.csv&#34;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cumings, Mrs. John Bradley (Florence Briggs Th&hellip;</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17599</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C85</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Heikkinen, Miss. Laina</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">STON/O2. 3101282</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113803</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">C123</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="1-select数据查询" class="pagebody-header">
    1. SELECT数据查询
  </h3>
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># SQL：</span>
</span></span><span style="display:flex;"><span>sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SELECT PassengerId, Sex, Age, Survived
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    FROM titanic
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    LIMIT 5;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Pandas</span>
</span></span><span style="display:flex;"><span>df[[<span style="color:#e6db74">&#34;PassengerId&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>, <span style="color:#e6db74">&#34;Age&#34;</span>, <span style="color:#e6db74">&#34;Survived&#34;</span>]]<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Survived</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">df.head(5)类似select * from table limit 5，查询所有的字段</p>

<div class="component-content pagebody component">
  <h3 id="2-where按条件查询" class="pagebody-header">
    2. WHERE按条件查询
  </h3>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># SQL：</span>
</span></span><span style="display:flex;"><span>sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SELECT *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    FROM titanic
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    where Sex=&#39;male&#39; and Age&gt;=20.0 and Age&lt;=40.0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    LIMIT 5;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 使用括号的方式，级联多个条件|</span>
</span></span><span style="display:flex;"><span>condition <span style="color:#f92672">=</span> (df[<span style="color:#e6db74">&#34;Sex&#34;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;male&#34;</span>) <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">20.0</span>) <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">40.0</span>)
</span></span><span style="display:flex;"><span>condition<span style="color:#f92672">.</span>value_counts()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">False</span>    <span style="color:#ae81ff">629</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">True</span>     <span style="color:#ae81ff">262</span>
</span></span><span style="display:flex;"><span>dtype: int64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[condition]<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.050</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">12</td>
<td style="text-align:right">13</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Saundercock, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">20.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5. 2151</td>
<td style="text-align:right">8.050</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">13</td>
<td style="text-align:right">14</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Andersson, Mr. Anders Johan</td>
<td style="text-align:right">male</td>
<td style="text-align:right">39.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">347082</td>
<td style="text-align:right">31.275</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">20</td>
<td style="text-align:right">21</td>
<td style="text-align:right">0</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Fynney, Mr. Joseph J</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">239865</td>
<td style="text-align:right">26.000</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3-in和not-in的条件查询" class="pagebody-header">
    3. in和not in的条件查询
  </h3>
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;Pclass&#34;</span>]<span style="color:#f92672">.</span>unique()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], dtype<span style="color:#f92672">=</span>int64)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># SQL：</span>
</span></span><span style="display:flex;"><span>sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SELECT *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    FROM titanic
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    where Pclass in (1,2)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    LIMIT 5;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># in </span>
</span></span><span style="display:flex;"><span>df[df[<span style="color:#e6db74">&#34;Pclass&#34;</span>]<span style="color:#f92672">.</span>isin((<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>))]<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cumings, Mrs. John Bradley (Florence Briggs Th&hellip;</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17599</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C85</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113803</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">C123</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">McCarthy, Mr. Timothy J</td>
<td style="text-align:right">male</td>
<td style="text-align:right">54.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">17463</td>
<td style="text-align:right">51.8625</td>
<td style="text-align:right">E46</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Nasser, Mrs. Nicholas (Adele Achem)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">14.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">237736</td>
<td style="text-align:right">30.0708</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">12</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Bonnell, Miss. Elizabeth</td>
<td style="text-align:right">female</td>
<td style="text-align:right">58.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113783</td>
<td style="text-align:right">26.5500</td>
<td style="text-align:right">C103</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># not in </span>
</span></span><span style="display:flex;"><span>df[<span style="color:#f92672">~</span>df[<span style="color:#e6db74">&#34;Pclass&#34;</span>]<span style="color:#f92672">.</span>isin((<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>))]<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Heikkinen, Miss. Laina</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">STON/O2. 3101282</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Moran, Mr. James</td>
<td style="text-align:right">male</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">330877</td>
<td style="text-align:right">8.4583</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">Q</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Palsson, Master. Gosta Leonard</td>
<td style="text-align:right">male</td>
<td style="text-align:right">2.0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">349909</td>
<td style="text-align:right">21.0750</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="4-groupby分组统计" class="pagebody-header">
    4. groupby分组统计
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="41-单个列的聚合" class="pagebody-header">
    4.1 单个列的聚合
  </h4>
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># SQL：</span>
</span></span><span style="display:flex;"><span>sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SELECT 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        -- 分性别的存活人数
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        sum(Survived),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        -- 分性别的平均年龄
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        mean(Age)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        -- 分性别的平均票价
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        mean(Fare)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    FROM titanic
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    group by Sex
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;Sex&#34;</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#34;Survived&#34;</span>:np<span style="color:#f92672">.</span>sum, <span style="color:#e6db74">&#34;Age&#34;</span>:np<span style="color:#f92672">.</span>mean, <span style="color:#e6db74">&#34;Fare&#34;</span>:np<span style="color:#f92672">.</span>mean})</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Fare</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Sex</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">female</td>
<td style="text-align:right">233</td>
<td style="text-align:right">27.915709</td>
<td style="text-align:right">44.479818</td>
</tr>
<tr>
<td style="text-align:right">male</td>
<td style="text-align:right">109</td>
<td style="text-align:right">30.726645</td>
<td style="text-align:right">25.523893</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="42-多个列的聚合" class="pagebody-header">
    4.2 多个列的聚合
  </h4>
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># SQL：</span>
</span></span><span style="display:flex;"><span>sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SELECT 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        -- 不同存活和性别分组的，平均年龄
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        mean(Age)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        -- 不同存活和性别分组的，平均票价
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        mean(Fare)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    FROM titanic
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    group by Survived, Sex
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#34;Survived&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>])<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#34;Age&#34;</span>:np<span style="color:#f92672">.</span>mean, <span style="color:#e6db74">&#34;Fare&#34;</span>:np<span style="color:#f92672">.</span>mean})</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Fare</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Survived</td>
<td style="text-align:right">Sex</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">female</td>
<td style="text-align:right">25.046875</td>
<td style="text-align:right">23.024385</td>
</tr>
<tr>
<td style="text-align:right">male</td>
<td style="text-align:right">31.618056</td>
<td style="text-align:right">21.960993</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">28.847716</td>
<td style="text-align:right">51.938573</td>
</tr>
<tr>
<td style="text-align:right">male</td>
<td style="text-align:right">27.276022</td>
<td style="text-align:right">40.821484</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="5-join数据关联" class="pagebody-header">
    5. JOIN数据关联
  </h3>
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 电影评分数据集，评分表</span>
</span></span><span style="display:flex;"><span>df_rating <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./datas/ml-latest-small/ratings.csv&#34;</span>)
</span></span><span style="display:flex;"><span>df_rating<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982703</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964981247</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">47</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964983815</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">50</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964982931</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 电影评分数据集，电影信息表</span>
</span></span><span style="display:flex;"><span>df_movies <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./datas/ml-latest-small/movies.csv&#34;</span>)
</span></span><span style="display:flex;"><span>df_movies<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">title</th>
<th style="text-align:right">genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama|Romance</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">Father of the Bride Part II (1995)</td>
<td style="text-align:right">Comedy</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># SQL：</span>
</span></span><span style="display:flex;"><span>sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SELECT *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    FROM 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        rating join movies 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        on(rating.movieId=movies.movieId)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    limit 5
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left<span style="color:#f92672">=</span>df_rating, right<span style="color:#f92672">=</span>df_movies, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;movieId&#34;</span>)
</span></span><span style="display:flex;"><span>df_merged<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
<th style="text-align:right">title</th>
<th style="text-align:right">genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982703</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">847434962</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">7</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.5</td>
<td style="text-align:right">1106635946</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">15</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2.5</td>
<td style="text-align:right">1510577970</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">17</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.5</td>
<td style="text-align:right">1305696483</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="6-union数据合并" class="pagebody-header">
    6. UNION数据合并
  </h3>
</div><p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;city&#39;</span>: [<span style="color:#e6db74">&#39;Chicago&#39;</span>, <span style="color:#e6db74">&#39;San Francisco&#39;</span>, <span style="color:#e6db74">&#39;New York City&#39;</span>],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;rank&#39;</span>: range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>)}) 
</span></span><span style="display:flex;"><span>df1</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">city</th>
<th style="text-align:right">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Chicago</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">San Francisco</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">New York City</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;city&#39;</span>: [<span style="color:#e6db74">&#39;Chicago&#39;</span>, <span style="color:#e6db74">&#39;Boston&#39;</span>, <span style="color:#e6db74">&#39;Los Angeles&#39;</span>],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;rank&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>]})
</span></span><span style="display:flex;"><span>df2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">city</th>
<th style="text-align:right">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Chicago</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Boston</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Los Angeles</td>
<td style="text-align:right">5</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># SQL：</span>
</span></span><span style="display:flex;"><span>sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SELECT city, rank
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    FROM df1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    UNION ALL
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SELECT city, rank
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    FROM df2;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># pandas</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1, df2])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">city</th>
<th style="text-align:right">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Chicago</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">San Francisco</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">New York City</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Chicago</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Boston</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Los Angeles</td>
<td style="text-align:right">5</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="7-order-limit先排序后分页" class="pagebody-header">
    7. Order Limit先排序后分页
  </h3>
</div><p class="component-content component">In [24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># SQL：</span>
</span></span><span style="display:flex;"><span>sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SELECT *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    from titanic
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    order by Fare
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    limit 5
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [25]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#34;Fare&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[25]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">258</td>
<td style="text-align:right">259</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Ward, Miss. Anna</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17755</td>
<td style="text-align:right">512.3292</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">737</td>
<td style="text-align:right">738</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Lesurer, Mr. Gustave J</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17755</td>
<td style="text-align:right">512.3292</td>
<td style="text-align:right">B101</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">679</td>
<td style="text-align:right">680</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cardeza, Mr. Thomas Drake Martinez</td>
<td style="text-align:right">male</td>
<td style="text-align:right">36.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">PC 17755</td>
<td style="text-align:right">512.3292</td>
<td style="text-align:right">B51 B53 B55</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">88</td>
<td style="text-align:right">89</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Fortune, Miss. Mabel Helen</td>
<td style="text-align:right">female</td>
<td style="text-align:right">23.0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
<td style="text-align:right">19950</td>
<td style="text-align:right">263.0000</td>
<td style="text-align:right">C23 C25 C27</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">27</td>
<td style="text-align:right">28</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Fortune, Mr. Charles Alexander</td>
<td style="text-align:right">male</td>
<td style="text-align:right">19.0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
<td style="text-align:right">19950</td>
<td style="text-align:right">263.0000</td>
<td style="text-align:right">C23 C25 C27</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="8-取每个分组group的top-n" class="pagebody-header">
    8. 取每个分组group的top n
  </h3>
</div><p class="component-content component">In [26]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># MYSQL不支持</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Oracle有ROW_NUMBER语法</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [27]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 按（Survived，Sex）分组，取Age的TOP 2</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#34;Survived&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>])<span style="color:#f92672">.</span>apply(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">lambda</span> df:df<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#34;Age&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">2</span>))</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[27]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Survived</td>
<td style="text-align:right">Sex</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">female</td>
<td style="text-align:right">772</td>
<td style="text-align:right">773</td>
<td style="text-align:right">0</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Mack, Mrs. (Mary)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">57.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">S.O./P.P. 3</td>
<td style="text-align:right">10.5000</td>
<td style="text-align:right">E77</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">177</td>
<td style="text-align:right">178</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Isham, Miss. Ann Elizabeth</td>
<td style="text-align:right">female</td>
<td style="text-align:right">50.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17595</td>
<td style="text-align:right">28.7125</td>
<td style="text-align:right">C49</td>
<td style="text-align:right">C</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">male</td>
<td style="text-align:right">851</td>
<td style="text-align:right">852</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Svensson, Mr. Johan</td>
<td style="text-align:right">male</td>
<td style="text-align:right">74.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">347060</td>
<td style="text-align:right">7.7750</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">493</td>
<td style="text-align:right">494</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Artagaveytia, Mr. Ramon</td>
<td style="text-align:right">male</td>
<td style="text-align:right">71.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17609</td>
<td style="text-align:right">49.5042</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">483</td>
<td style="text-align:right">484</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Turkula, Mrs. (Hedwig)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">63.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">4134</td>
<td style="text-align:right">9.5875</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">275</td>
<td style="text-align:right">276</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Andrews, Miss. Kornelia Theodosia</td>
<td style="text-align:right">female</td>
<td style="text-align:right">63.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">13502</td>
<td style="text-align:right">77.9583</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">S</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">male</td>
<td style="text-align:right">630</td>
<td style="text-align:right">631</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Barkworth, Mr. Algernon Henry Wilson</td>
<td style="text-align:right">male</td>
<td style="text-align:right">80.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">27042</td>
<td style="text-align:right">30.0000</td>
<td style="text-align:right">A23</td>
<td style="text-align:right">S</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">570</td>
<td style="text-align:right">571</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Harris, Mr. George</td>
<td style="text-align:right">male</td>
<td style="text-align:right">62.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">S.W./PP 752</td>
<td style="text-align:right">10.5000</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="9-update数据更新" class="pagebody-header">
    9. UPDATE数据更新
  </h3>
</div><p class="component-content component">In [28]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">891</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">890</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">12</span> columns):
</span></span><span style="display:flex;"><span>PassengerId    <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Survived       <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Pclass         <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Name           <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Sex            <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Age            <span style="color:#ae81ff">714</span> non<span style="color:#f92672">-</span>null float64
</span></span><span style="display:flex;"><span>SibSp          <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Parch          <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Ticket         <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Fare           <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null float64
</span></span><span style="display:flex;"><span>Cabin          <span style="color:#ae81ff">204</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Embarked       <span style="color:#ae81ff">889</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>dtypes: float64(<span style="color:#ae81ff">2</span>), int64(<span style="color:#ae81ff">5</span>), object(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">83.7</span><span style="color:#f92672">+</span> KB</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [29]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># SQL：</span>
</span></span><span style="display:flex;"><span>sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    UPDATE titanic
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    set Age=0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    where Age is null
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [30]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>condition <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">.</span>isna()
</span></span><span style="display:flex;"><span>condition<span style="color:#f92672">.</span>value_counts()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[30]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">False</span>    <span style="color:#ae81ff">714</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">True</span>     <span style="color:#ae81ff">177</span>
</span></span><span style="display:flex;"><span>Name: Age, dtype: int64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [31]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[condition] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [32]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">.</span>isna()<span style="color:#f92672">.</span>value_counts()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[32]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">False</span>    <span style="color:#ae81ff">891</span>
</span></span><span style="display:flex;"><span>Name: Age, dtype: int64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="10-delete删除数据" class="pagebody-header">
    10. DELETE删除数据
  </h3>
</div><p class="component-content component">In [33]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># SQL：</span>
</span></span><span style="display:flex;"><span>sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    DELETE FROM titanic
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    where Age=0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [34]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_new <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">!=</span><span style="color:#ae81ff">0</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [35]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_new[df_new[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[35]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="35pandas实现groupby聚合后不同列数据统计" class="pagebody-header">
    35、Pandas实现groupby聚合后不同列数据统计
  </h1>
</div><p class="component-content component">电影评分数据集（UserID，MovieID，Rating，Timestamp）</p>
<p class="component-content component"><strong>聚合后单列-单指标统计：每个MovieID的平均评分</strong>
df.groupby(&ldquo;MovieID&rdquo;)[&ldquo;Rating&rdquo;].mean()</p>
<p class="component-content component"><strong>聚合后单列-多指标统计：每个MoiveID的最高评分、最低评分、平均评分</strong>
df.groupby(&ldquo;MovieID&rdquo;)[&ldquo;Rating&rdquo;].agg(mean=&ldquo;mean&rdquo;, max=&ldquo;max&rdquo;, min=np.min)
df.groupby(&ldquo;MovieID&rdquo;).agg({&ldquo;Rating&rdquo;:[&lsquo;mean&rsquo;, &lsquo;max&rsquo;, np.min]})</p>
<p class="component-content component"><strong>聚合后多列-多指标统计：每个MoiveID的评分人数，最高评分、最低评分、平均评分</strong>
df.groupby(&ldquo;MovieID&rdquo;).agg( rating_mean=(&ldquo;Rating&rdquo;, &ldquo;mean&rdquo;), user_count=(&ldquo;UserID&rdquo;, lambda x : x.nunique())
df.groupby(&ldquo;MovieID&rdquo;).agg( {&ldquo;Rating&rdquo;: [&lsquo;mean&rsquo;, &lsquo;min&rsquo;, &lsquo;max&rsquo;], &ldquo;UserID&rdquo;: lambda x :x.nunique()})
df.groupby(&ldquo;MovieID&rdquo;).apply( lambda x: pd.Series( {&ldquo;min&rdquo;: x[&ldquo;Rating&rdquo;].min(), &ldquo;mean&rdquo;: x[&ldquo;Rating&rdquo;].mean()}))</p>
<p class="component-content component">**记忆：**agg(新列名=函数)、agg(新列名=(原列名，函数))、agg({&ldquo;原列名&rdquo;：函数/列表})
agg函数的两种形式，等号代表“把结果赋值给新列”，字典/元组代表“对这个列运用这些函数”</p>
<p class="component-content component">官网文档：https://pandas.pydata.org/pandas-docs/version/0.23.4/generated/pandas.core.groupby.DataFrameGroupBy.agg.html</p>

<div class="component-content pagebody component">
  <h3 id="读取数据" class="pagebody-header">
    读取数据
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;./datas/movielens-1m/ratings.dat&#34;</span>, 
</span></span><span style="display:flex;"><span>    sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;::&#34;</span>,
</span></span><span style="display:flex;"><span>    engine<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;python&#39;</span>, 
</span></span><span style="display:flex;"><span>    names<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UserID::MovieID::Rating::Timestamp&#34;</span><span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;::&#34;</span>)
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="聚合后单列-单指标统计" class="pagebody-header">
    聚合后单列-单指标统计
  </h3>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 每个MovieID的平均评分</span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;MovieID&#34;</span>)[<span style="color:#e6db74">&#34;Rating&#34;</span>]<span style="color:#f92672">.</span>mean()
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>MovieID
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">4.146846</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    <span style="color:#ae81ff">3.201141</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    <span style="color:#ae81ff">3.016736</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    <span style="color:#ae81ff">2.729412</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>    <span style="color:#ae81ff">3.006757</span>
</span></span><span style="display:flex;"><span>Name: Rating, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>type(result)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pandas<span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="聚合后单列-多指标统计" class="pagebody-header">
    聚合后单列-多指标统计
  </h3>
</div><p class="component-content component">每个MoiveID的最高评分、最低评分、平均评分</p>

<div class="component-content pagebody component">
  <h4 id="方法1agg函数传入多个结果列名函数名形式" class="pagebody-header">
    方法1：agg函数传入多个结果列名=函数名形式
  </h4>
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>result <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;MovieID&#34;</span>)[<span style="color:#e6db74">&#34;Rating&#34;</span>]<span style="color:#f92672">.</span>agg(
</span></span><span style="display:flex;"><span>    mean<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;mean&#34;</span>, max<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;max&#34;</span>, min<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>min
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">mean</th>
<th style="text-align:right">max</th>
<th style="text-align:right">min</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="方法2agg函数传入字典key是column名value是函数列表" class="pagebody-header">
    方法2：agg函数传入字典，key是column名，value是函数列表
  </h4>
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 每个MoiveID的最高评分、最低评分、平均评分</span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;MovieID&#34;</span>)<span style="color:#f92672">.</span>agg(
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;Rating&#34;</span>:[<span style="color:#e6db74">&#39;mean&#39;</span>, <span style="color:#e6db74">&#39;max&#39;</span>, np<span style="color:#f92672">.</span>min]}
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Rating</th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right">mean</td>
<td style="text-align:right">max</td>
<td style="text-align:right">amin</td>
</tr>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>result<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;age_mean&#39;</span>, <span style="color:#e6db74">&#39;age_min&#39;</span>, <span style="color:#e6db74">&#39;age_max&#39;</span>]
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">age_mean</th>
<th style="text-align:right">age_min</th>
<th style="text-align:right">age_max</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="聚合后多列-多指标统计" class="pagebody-header">
    聚合后多列-多指标统计
  </h3>
</div><p class="component-content component">每个MoiveID的评分人数，最高评分、最低评分、平均评分</p>

<div class="component-content pagebody component">
  <h4 id="方法1agg函数传入字典key是原列名value是原列名和函数元组" class="pagebody-header">
    方法1：agg函数传入字典，key是原列名，value是原列名和函数元组
  </h4>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 回忆：agg函数的两种形式，等号代表“把结果赋值给新列”，字典/元组代表“对这个列运用这些函数”</span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;MovieID&#34;</span>)<span style="color:#f92672">.</span>agg(
</span></span><span style="display:flex;"><span>        rating_mean<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;Rating&#34;</span>, <span style="color:#e6db74">&#34;mean&#34;</span>),
</span></span><span style="display:flex;"><span>        rating_min<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;Rating&#34;</span>, <span style="color:#e6db74">&#34;min&#34;</span>),
</span></span><span style="display:flex;"><span>        rating_max<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;Rating&#34;</span>, <span style="color:#e6db74">&#34;max&#34;</span>),
</span></span><span style="display:flex;"><span>        user_count<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;UserID&#34;</span>, <span style="color:#66d9ef">lambda</span> x : x<span style="color:#f92672">.</span>nunique())
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">rating_mean</th>
<th style="text-align:right">rating_min</th>
<th style="text-align:right">rating_max</th>
<th style="text-align:right">user_count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">2077</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">701</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">478</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">170</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">296</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="方法2agg函数传入字典key是原列名value是函数列表" class="pagebody-header">
    方法2：agg函数传入字典，key是原列名，value是函数列表
  </h4>
</div><p class="component-content component">统计后是二级索引，需要做索引处理</p>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>result <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;MovieID&#34;</span>)<span style="color:#f92672">.</span>agg(
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Rating&#34;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>, <span style="color:#e6db74">&#39;min&#39;</span>, <span style="color:#e6db74">&#39;max&#39;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;UserID&#34;</span>: <span style="color:#66d9ef">lambda</span> x :x<span style="color:#f92672">.</span>nunique()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">UserID</th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right">mean</td>
<td style="text-align:right">min</td>
<td style="text-align:right">max</td>
<td style="text-align:right"><!-- raw HTML omitted --></td>
</tr>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">2077</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">701</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">478</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">170</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">296</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>result[<span style="color:#e6db74">&#34;Rating&#34;</span>]<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">mean</th>
<th style="text-align:right">min</th>
<th style="text-align:right">max</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>result<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;rating_mean&#34;</span>, <span style="color:#e6db74">&#34;rating_min&#34;</span>,<span style="color:#e6db74">&#34;rating_max&#34;</span>,<span style="color:#e6db74">&#34;user_count&#34;</span>]
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">rating_mean</th>
<th style="text-align:right">rating_min</th>
<th style="text-align:right">rating_max</th>
<th style="text-align:right">user_count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">2077</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">701</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">478</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">170</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">296</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="方法3使用groupby之后apply对每个子df单独统计" class="pagebody-header">
    方法3：使用groupby之后apply对每个子df单独统计
  </h4>
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">agg_func</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;注意，这个x是子DF&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 这个Series会变成一行，字典KEY是列名</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> pd<span style="color:#f92672">.</span>Series({
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;rating_mean&#34;</span>: x[<span style="color:#e6db74">&#34;Rating&#34;</span>]<span style="color:#f92672">.</span>mean(),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;rating_min&#34;</span>: x[<span style="color:#e6db74">&#34;Rating&#34;</span>]<span style="color:#f92672">.</span>min(),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;rating_max&#34;</span>: x[<span style="color:#e6db74">&#34;Rating&#34;</span>]<span style="color:#f92672">.</span>max(),
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;user_count&#34;</span>: x[<span style="color:#e6db74">&#34;UserID&#34;</span>]<span style="color:#f92672">.</span>nunique()
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;MovieID&#34;</span>)<span style="color:#f92672">.</span>apply(agg_func)
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">rating_mean</th>
<th style="text-align:right">rating_min</th>
<th style="text-align:right">rating_max</th>
<th style="text-align:right">user_count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">2077.0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">701.0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">478.0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">170.0</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">296.0</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="36pandas读取excel将数据展示在网页上" class="pagebody-header">
    36、Pandas读取Excel将数据展示在网页上
  </h1>
</div><p class="component-content component">注意：</p>
<p class="component-content component">本节课程演示的代码，在当前目录下找。</p>
<p class="component-content component">子目录名字：&ldquo;Pandas读取Excel将数据展示在网页上&rdquo;</p>

          </div><div class="component">
            <div class="component-content">
              <div class="article-copyright">
                <p class="content">
                  Copyright: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</a>
                </p>
                <p class="content">Author:   </p>
                <p class="content">Posted on:  November 26, 2021</p>
              </div>
            </div>
          </div></article>
      </section>
  </main>

  <script>
    var script = document.createElement("script");script.src = "https://yuanshuai1122.github.io/js/initPost.js";
    document.head.appendChild(script);
  </script>

    
    <div class="footer-main ">
  <div class="content-body footer-wraper">
    <div class="footer-box">
      <div class="foot-nav">
        <div class="foot-nav-items">
          <div class="item">
            <div class="logo"></div>
            <div class="email">Email: <a href="mailto:floyd.li@outlook.com">floyd.li@outlook.com</a></div>
          </div>

          <div class="item community">
            <div class="item-title">Social Media</div>
            
              <a href="https://github.com/floyd-li" target="_blank">Github</a>
            
          </div>

          <div class="item resources">
            <div class="item-title">Related</div>
            
              <a href="https://yufengbiji.com/" target="_blank">驭风笔记</a>
            
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="item copyright">
          &copy; 2023
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://github.com/floyd-li/hugo-theme-itheme" target="_blank">iTheme</a>
        </div>
      </div>
    </div>
  </div>
</div>

  </body>
    
    

    
    
</html>
