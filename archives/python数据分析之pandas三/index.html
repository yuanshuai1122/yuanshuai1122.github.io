<!DOCTYPE html>
<html class="js no-touch  progressive-image  no-reduced-motion progressive" lang="en">
  <head>
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/img/favicon.ico">

    <meta name="keyword" content=""><meta property="og:title" content="Python数据分析之Pandas（三）" />
<meta property="og:description" content=": | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&ndash;: | &mdash;&mdash;&ndash;: | | 0 | 1 | 1193 | 5 | 978300760 | | 1 | 1 | 661 | 3 | 978302109 | | 2 | 1 | 914 | 3 | 978301968 | | 3 | 1 | 3408 | 4 | 978300275 | | 4 | 1 | 2355 | 5 | 978824291 | In [3]: # 实现" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuanshuai1122.github.io/archives/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%89/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-26T21:54:10+00:00" />
<meta property="article:modified_time" content="2021-11-26T21:54:10+00:00" />
<title>Python数据分析之Pandas（三）</title>

    <link rel="canonical" href="/archives/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%89/">

    <link rel="stylesheet" href="/css/global.css">

    <link rel="stylesheet" href="/css/custom.css">

    <link rel="stylesheet" href="/css/search.css" />

    
    

    
    

</head>
  </head>
  <body class=" page-article   ">
    <header>
      <nav class="nav">
  <div class="nav-wrapper">
    <div class="nav-content-wrapper">
      <div class="nav-content">
        <a href="/ " class="nav-title">iTheme</a>
        <div class="nav-menu">
          <div class="nav-item-wrapper">
            <a href="/posts " class="nav-item-content">Articles</a>
          </div><div class="nav-item-wrapper">
            <a href="/about" class="nav-item-content">About</a>
          </div><div class="nav-item-wrapper">
            <a href="/index.xml" class="nav-item-content" target="_blank">RSS</a>
          </div></div>
      </div>
    </div>
  </div>
</nav>

<script>
  function toggleSearchModal(){
    const template = `
    <div class="modal-body">
      <div id="autocomplete" onclick="event.stopPropagation();"></div>
    </div>
    `
    const modal = document.querySelector("#modal-wrapper")
    if(!modal){
      const div = document.createElement("div")
      document.body.setAttribute("style","overflow: hidden;")
      div.setAttribute("id", "modal-wrapper")
      div.setAttribute("onclick", "toggleSearchModal()")
      div.innerHTML = template
      const script = document.createElement("script");script.setAttribute("src", "https://yuanshuai1122.github.io/js/algolia.js")
      div.appendChild(script)
      document.body.append(div)
    } else {
      document.body.removeAttribute("style")
      document.body.removeChild(modal)
    }
  }
</script>
    </header>
    
  
  
  <main id="main" class="main">
      <section>
        <article class="article">
          
          <div class=" article-header ">
            <div class="category component">
              <div class="component-content">
                <div class="category-eyebrow">
                  <span class="category-eyebrow__category category_original">
                    
                      
                        Python
                      
                    
                  </span>
                  <span class="category-eyebrow__date">November 26, 2021</span>
                </div>
              </div>
            </div>
            <div class="pagetitle component">
              <div class="component-content">
                <h1 class="hero-headline">Python数据分析之Pandas（三）</h1>
              </div>
            </div>
            <div class="component  article-subhead ">
              <div class="component-content"></div>
            </div>

            <div class="tagssheet component">
              <div class="component-content">
                
                  
                  <a href="/tags/python" class="tag">
                    Python
                  </a>
                
                  
                  <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90" class="tag">
                    数据分析
                  </a>
                
              </div>
            </div>
          </div>
          
          <div class="pagebody">
            
            
            
            
            
            
            
            
            <p class="component-content component">: | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&ndash;: | &mdash;&mdash;&ndash;: |
|    0 |      1 |    1193 |      5 | 978300760 |
|    1 |      1 |     661 |      3 | 978302109 |
|    2 |      1 |     914 |      3 | 978301968 |
|    3 |      1 |    3408 |      4 | 978300275 |
|    4 |      1 |    2355 |      5 | 978824291 |</p>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 实现按照用户ID分组，然后对其中一列归一化</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ratings_norm</span>(df):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    @param df：每个用户分组的dataframe
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    min_value <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;Rating&#34;</span>]<span style="color:#f92672">.</span>min()
</span></span><span style="display:flex;"><span>    max_value <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;Rating&#34;</span>]<span style="color:#f92672">.</span>max()
</span></span><span style="display:flex;"><span>    df[<span style="color:#e6db74">&#34;Rating_norm&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;Rating&#34;</span>]<span style="color:#f92672">.</span>apply(
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">lambda</span> x: (x<span style="color:#f92672">-</span>min_value)<span style="color:#f92672">/</span>(max_value<span style="color:#f92672">-</span>min_value))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> df
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ratings <span style="color:#f92672">=</span> ratings<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;UserID&#34;</span>)<span style="color:#f92672">.</span>apply(ratings_norm)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ratings[ratings[<span style="color:#e6db74">&#34;UserID&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
<th style="text-align:right">Rating_norm</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
<td style="text-align:right">1.0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
<td style="text-align:right">0.0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
<td style="text-align:right">0.0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
<td style="text-align:right">0.5</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
<td style="text-align:right">1.0</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">可以看到UserID==1这个用户，Rating==3是他的最低分，是个乐观派，我们归一化到0分；</p>

<div class="component-content pagebody component">
  <h3 id="实例2怎样取每个分组的topn数据" class="pagebody-header">
    实例2：怎样取每个分组的TOPN数据？
  </h3>
</div><p class="component-content component">获取2018年每个月温度最高的2天数据</p>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fpath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(fpath)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 替换掉温度的后缀℃</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#34;bWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;℃&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#34;yWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;yWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;℃&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 新增一列为月份</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;month&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;ymd&#39;</span>]<span style="color:#f92672">.</span>str[:<span style="color:#ae81ff">7</span>]
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
<th style="text-align:right">month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">59</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">49</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">阴</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">50</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getWenduTopN</span>(df, topn):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    这里的df，是每个月份分组group的df
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> df<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bWendu&#34;</span>)[[<span style="color:#e6db74">&#34;ymd&#34;</span>, <span style="color:#e6db74">&#34;bWendu&#34;</span>]][<span style="color:#f92672">-</span>topn:]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;month&#34;</span>)<span style="color:#f92672">.</span>apply(getWenduTopN, topn<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">month</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01</td>
<td style="text-align:right">18</td>
<td style="text-align:right">2018-01-19</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2018-02</td>
<td style="text-align:right">56</td>
<td style="text-align:right">2018-02-26</td>
<td style="text-align:right">12</td>
</tr>
<tr>
<td style="text-align:right">2018-03</td>
<td style="text-align:right">85</td>
<td style="text-align:right">2018-03-27</td>
<td style="text-align:right">27</td>
</tr>
<tr>
<td style="text-align:right">2018-04</td>
<td style="text-align:right">118</td>
<td style="text-align:right">2018-04-29</td>
<td style="text-align:right">30</td>
</tr>
<tr>
<td style="text-align:right">2018-05</td>
<td style="text-align:right">150</td>
<td style="text-align:right">2018-05-31</td>
<td style="text-align:right">35</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">我们看到，grouby的apply函数返回的dataframe，其实和原来的dataframe其实可以完全不一样</p>

<div class="component-content pagebody component">
  <h1 id="20pandas的stack和pivot实现数据透视" class="pagebody-header">
    20、Pandas的stack和pivot实现数据透视
  </h1>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-32820bfb96d25e98a2f6f8f0d79fee36" id="lht32820bfb96d25e98a2f6f8f0d79fee36">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/12.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<div class="component-content component"><ol>
<li>经过统计得到多维度指标数据</li>
<li>使用unstack实现数据二维透视</li>
<li>使用pivot简化透视</li>
<li>stack、unstack、pivot的语法</li>
</ol></div>

<div class="component-content pagebody component">
  <h3 id="1-经过统计得到多维度指标数据" class="pagebody-header">
    1. 经过统计得到多维度指标数据
  </h3>
</div><p class="component-content component">非常常见的统计场景，指定多个维度，计算聚合后的指标</p>
<p class="component-content component">实例：统计得到“电影评分数据集”，每个月份的每个分数被评分多少次：（月份、分数1~5、次数）</p>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;./datas/movielens-1m/ratings.dat&#34;</span>,
</span></span><span style="display:flex;"><span>    header<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>,
</span></span><span style="display:flex;"><span>    names<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UserID::MovieID::Rating::Timestamp&#34;</span><span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;::&#34;</span>),
</span></span><span style="display:flex;"><span>    sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;::&#34;</span>,
</span></span><span style="display:flex;"><span>    engine<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;python&#34;</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;pdate&#34;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_datetime(df[<span style="color:#e6db74">&#34;Timestamp&#34;</span>], unit<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;s&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
<th style="text-align:right">pdate</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
<td style="text-align:right">2000-12-31 22:12:40</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
<td style="text-align:right">2000-12-31 22:35:09</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
<td style="text-align:right">2000-12-31 22:32:48</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
<td style="text-align:right">2000-12-31 22:04:35</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
<td style="text-align:right">2001-01-06 23:38:11</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>dtypes</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>UserID                int64
</span></span><span style="display:flex;"><span>MovieID               int64
</span></span><span style="display:flex;"><span>Rating                int64
</span></span><span style="display:flex;"><span>Timestamp             int64
</span></span><span style="display:flex;"><span>pdate        datetime64[ns]
</span></span><span style="display:flex;"><span>dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 实现数据统计</span>
</span></span><span style="display:flex;"><span>df_group <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby([df[<span style="color:#e6db74">&#34;pdate&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month, <span style="color:#e6db74">&#34;Rating&#34;</span>])[<span style="color:#e6db74">&#34;UserID&#34;</span>]<span style="color:#f92672">.</span>agg(pv<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>size)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_group<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">20</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right">Rating</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2608</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">6442</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">8400</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4495</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">629</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1464</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3297</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4403</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">2335</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">466</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1077</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2523</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">3032</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">1439</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1048</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2247</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">5501</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">6748</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3863</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">对这样格式的数据，我想查看按月份，不同评分的次数趋势，是没法实现的</p>
<p class="component-content component">需要将数据变换成每个评分是一列才可以实现</p>

<div class="component-content pagebody component">
  <h3 id="2-使用unstack实现数据二维透视" class="pagebody-header">
    2. 使用unstack实现数据二维透视
  </h3>
</div><p class="component-content component">目的：想要画图对比按照月份的不同评分的数量趋势</p>
<p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_stack <span style="color:#f92672">=</span> df_group<span style="color:#f92672">.</span>unstack()
</span></span><span style="display:flex;"><span>df_stack</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Rating</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
<td style="text-align:right">2608</td>
<td style="text-align:right">6442</td>
<td style="text-align:right">8400</td>
<td style="text-align:right">4495</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">629</td>
<td style="text-align:right">1464</td>
<td style="text-align:right">3297</td>
<td style="text-align:right">4403</td>
<td style="text-align:right">2335</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">466</td>
<td style="text-align:right">1077</td>
<td style="text-align:right">2523</td>
<td style="text-align:right">3032</td>
<td style="text-align:right">1439</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1048</td>
<td style="text-align:right">2247</td>
<td style="text-align:right">5501</td>
<td style="text-align:right">6748</td>
<td style="text-align:right">3863</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4557</td>
<td style="text-align:right">7631</td>
<td style="text-align:right">18481</td>
<td style="text-align:right">25769</td>
<td style="text-align:right">17840</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">3196</td>
<td style="text-align:right">6500</td>
<td style="text-align:right">15211</td>
<td style="text-align:right">21838</td>
<td style="text-align:right">14365</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">4891</td>
<td style="text-align:right">9566</td>
<td style="text-align:right">25421</td>
<td style="text-align:right">34957</td>
<td style="text-align:right">22169</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">10873</td>
<td style="text-align:right">20597</td>
<td style="text-align:right">50509</td>
<td style="text-align:right">64198</td>
<td style="text-align:right">42497</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">3107</td>
<td style="text-align:right">5873</td>
<td style="text-align:right">14702</td>
<td style="text-align:right">19927</td>
<td style="text-align:right">13182</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">2121</td>
<td style="text-align:right">4785</td>
<td style="text-align:right">12175</td>
<td style="text-align:right">16095</td>
<td style="text-align:right">10324</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">17701</td>
<td style="text-align:right">32202</td>
<td style="text-align:right">76069</td>
<td style="text-align:right">102448</td>
<td style="text-align:right">67041</td>
</tr>
<tr>
<td style="text-align:right">12</td>
<td style="text-align:right">6458</td>
<td style="text-align:right">13007</td>
<td style="text-align:right">30866</td>
<td style="text-align:right">41156</td>
<td style="text-align:right">26760</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_stack<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x1ba09b0ce48</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-67cfd55528a8feafe8607185418b0cd9" id="lht67cfd55528a8feafe8607185418b0cd9">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/13.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># unstack和stack是互逆操作</span>
</span></span><span style="display:flex;"><span>df_stack<span style="color:#f92672">.</span>stack()<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">20</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right">Rating</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2608</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">6442</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">8400</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4495</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">629</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1464</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3297</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4403</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">2335</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">466</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1077</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2523</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">3032</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">1439</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1048</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2247</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">5501</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">6748</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3863</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3-使用pivot简化透视" class="pagebody-header">
    3. 使用pivot简化透视
  </h3>
</div><p class="component-content component">In [24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_group<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">20</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[24]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right">Rating</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2608</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">6442</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">8400</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4495</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">629</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1464</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3297</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4403</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">2335</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">466</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1077</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2523</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">3032</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">1439</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1048</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2247</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">5501</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">6748</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3863</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [25]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_reset <span style="color:#f92672">=</span> df_group<span style="color:#f92672">.</span>reset_index()
</span></span><span style="display:flex;"><span>df_reset<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[25]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pdate</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">pv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2608</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">6442</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">8400</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">4495</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [26]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_pivot <span style="color:#f92672">=</span> df_reset<span style="color:#f92672">.</span>pivot(<span style="color:#e6db74">&#34;pdate&#34;</span>, <span style="color:#e6db74">&#34;Rating&#34;</span>, <span style="color:#e6db74">&#34;pv&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [27]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_pivot<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[27]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right">Rating</th>
<th style="text-align:right">1</th>
<th style="text-align:right">2</th>
<th style="text-align:right">3</th>
<th style="text-align:right">4</th>
<th style="text-align:right">5</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
<td style="text-align:right">2608</td>
<td style="text-align:right">6442</td>
<td style="text-align:right">8400</td>
<td style="text-align:right">4495</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">629</td>
<td style="text-align:right">1464</td>
<td style="text-align:right">3297</td>
<td style="text-align:right">4403</td>
<td style="text-align:right">2335</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">466</td>
<td style="text-align:right">1077</td>
<td style="text-align:right">2523</td>
<td style="text-align:right">3032</td>
<td style="text-align:right">1439</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1048</td>
<td style="text-align:right">2247</td>
<td style="text-align:right">5501</td>
<td style="text-align:right">6748</td>
<td style="text-align:right">3863</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4557</td>
<td style="text-align:right">7631</td>
<td style="text-align:right">18481</td>
<td style="text-align:right">25769</td>
<td style="text-align:right">17840</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [28]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_pivot<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[28]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x1ba09db6d48</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-0d71d12fd5dd031c55777b7d0644b8e7" id="lht0d71d12fd5dd031c55777b7d0644b8e7">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/14.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">*<strong>pivot方法相当于对df使用set_index创建分层索引，然后调用unstack*</strong></p>

<div class="component-content pagebody component">
  <h3 id="4-stackunstackpivot的语法" class="pagebody-header">
    4. stack、unstack、pivot的语法
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="stackdataframestacklevel-1-dropnatrue将column变成index类似把横放的书籍变成竖放" class="pagebody-header">
    stack：DataFrame.stack(level=-1, dropna=True)，将column变成index，类似把横放的书籍变成竖放
  </h4>
</div><p class="component-content component">level=-1代表多层索引的最内层，可以通过==0、1、2指定多层索引的对应层</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-78cb494314cca162e0481991cceb0d90" id="lht78cb494314cca162e0481991cceb0d90">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/15.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h4 id="unstackdataframeunstacklevel-1-fill_valuenone将index变成column类似把竖放的书籍变成横放" class="pagebody-header">
    unstack：DataFrame.unstack(level=-1, fill_value=None)，将index变成column，类似把竖放的书籍变成横放
  </h4>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-650fe06dfe2d742495399462829d4722" id="lht650fe06dfe2d742495399462829d4722">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/16.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h4 id="pivotdataframepivotindexnone-columnsnone-valuesnone指定indexcolumnsvalues实现二维透视" class="pagebody-header">
    pivot：DataFrame.pivot(index=None, columns=None, values=None)，指定index、columns、values实现二维透视
  </h4>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-11fc4827f1a6fcc8c652e77a26f01742" id="lht11fc4827f1a6fcc8c652e77a26f01742">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/17.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h1 id="21pandas怎样快捷方便的处理日期数据" class="pagebody-header">
    21、Pandas怎样快捷方便的处理日期数据
  </h1>
</div><p class="component-content component">Pandas日期处理的作用：将2018-01-01、1/1/2018等多种日期格式映射成统一的格式对象，在该对象上提供强大的功能支持</p>
<p class="component-content component">几个概念：</p>
<div class="component-content component"><ol>
<li>pd.to_datetime：pandas的一个函数，能将字符串、列表、series变成日期形式</li>
<li>Timestamp：pandas表示日期的对象形式</li>
<li>DatetimeIndex：pandas表示日期的对象列表形式</li>
</ol></div>
<p class="component-content component">其中：</p>
<div class="component-content component"><ul>
<li>DatetimeIndex是Timestamp的列表形式</li>
<li>pd.to_datetime对单个日期字符串处理会得到Timestamp</li>
<li>pd.to_datetime对日期字符串列表处理会得到DatetimeIndex</li>
</ul></div>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-0d0a31a24b3592e09ff533712c06d7d1" id="lht0d0a31a24b3592e09ff533712c06d7d1">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/18.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h3 id="问题怎样统计每周每月每季度的最高温度" class="pagebody-header">
    问题：怎样统计每周、每月、每季度的最高温度？
  </h3>
</div>
<div class="component-content pagebody component">
  <h3 id="1读取天气数据到dataframe" class="pagebody-header">
    1、读取天气数据到dataframe
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fpath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(fpath)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 替换掉温度的后缀℃</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#34;bWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;℃&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#34;yWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;yWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;℃&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">59</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">49</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">阴</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">50</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2将日期列转换成pandas的日期" class="pagebody-header">
    2、将日期列转换成pandas的日期
  </h3>
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>set_index(pd<span style="color:#f92672">.</span>to_datetime(df[<span style="color:#e6db74">&#34;ymd&#34;</span>]), inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">59</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">49</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">阴</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">50</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>DatetimeIndex([<span style="color:#e6db74">&#39;2018-01-01&#39;</span>, <span style="color:#e6db74">&#39;2018-01-02&#39;</span>, <span style="color:#e6db74">&#39;2018-01-03&#39;</span>, <span style="color:#e6db74">&#39;2018-01-04&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-01-05&#39;</span>, <span style="color:#e6db74">&#39;2018-01-06&#39;</span>, <span style="color:#e6db74">&#39;2018-01-07&#39;</span>, <span style="color:#e6db74">&#39;2018-01-08&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-01-09&#39;</span>, <span style="color:#e6db74">&#39;2018-01-10&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-12-22&#39;</span>, <span style="color:#e6db74">&#39;2018-12-23&#39;</span>, <span style="color:#e6db74">&#39;2018-12-24&#39;</span>, <span style="color:#e6db74">&#39;2018-12-25&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-12-26&#39;</span>, <span style="color:#e6db74">&#39;2018-12-27&#39;</span>, <span style="color:#e6db74">&#39;2018-12-28&#39;</span>, <span style="color:#e6db74">&#39;2018-12-29&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-12-30&#39;</span>, <span style="color:#e6db74">&#39;2018-12-31&#39;</span>],
</span></span><span style="display:flex;"><span>              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ymd&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">365</span>, freq<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># DatetimeIndex是Timestamp的列表形式</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index[<span style="color:#ae81ff">0</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Timestamp(<span style="color:#e6db74">&#39;2018-01-01 00:00:00&#39;</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="3-方便的对datetimeindex进行查询" class="pagebody-header">
    3、 方便的对DatetimeIndex进行查询
  </h3>
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 筛选固定的某一天</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#39;2018-01-05&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ymd          <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span>
</span></span><span style="display:flex;"><span>bWendu                <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>yWendu               <span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>tianqi             多云<span style="color:#f92672">~</span>晴
</span></span><span style="display:flex;"><span>fengxiang           西北风
</span></span><span style="display:flex;"><span>fengli             <span style="color:#ae81ff">1</span><span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>级
</span></span><span style="display:flex;"><span>aqi                  <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>aqiInfo               优
</span></span><span style="display:flex;"><span>aqiLevel              <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Name: <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 日期区间</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#39;2018-01-05&#39;</span>:<span style="color:#e6db74">&#39;2018-01-10&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">50</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-06</td>
<td style="text-align:right">2018-01-06</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">多云~阴</td>
<td style="text-align:right">西南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">32</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-07</td>
<td style="text-align:right">2018-01-07</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">西南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">59</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-01-08</td>
<td style="text-align:right">2018-01-08</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">4-5级</td>
<td style="text-align:right">50</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-09</td>
<td style="text-align:right">2018-01-09</td>
<td style="text-align:right">1</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">3-4级</td>
<td style="text-align:right">34</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-10</td>
<td style="text-align:right">2018-01-10</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">-10</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">26</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 按月份前缀筛选</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#39;2018-03&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-03-01</td>
<td style="text-align:right">2018-03-01</td>
<td style="text-align:right">8</td>
<td style="text-align:right">-3</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">西南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">46</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-03-02</td>
<td style="text-align:right">2018-03-02</td>
<td style="text-align:right">9</td>
<td style="text-align:right">-1</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">95</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-03</td>
<td style="text-align:right">2018-03-03</td>
<td style="text-align:right">13</td>
<td style="text-align:right">3</td>
<td style="text-align:right">多云~阴</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">214</td>
<td style="text-align:right">重度污染</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2018-03-04</td>
<td style="text-align:right">2018-03-04</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">东南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">144</td>
<td style="text-align:right">轻度污染</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-05</td>
<td style="text-align:right">2018-03-05</td>
<td style="text-align:right">8</td>
<td style="text-align:right">-3</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">94</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-06</td>
<td style="text-align:right">2018-03-06</td>
<td style="text-align:right">6</td>
<td style="text-align:right">-3</td>
<td style="text-align:right">多云~阴</td>
<td style="text-align:right">东南风</td>
<td style="text-align:right">3-4级</td>
<td style="text-align:right">67</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-07</td>
<td style="text-align:right">2018-03-07</td>
<td style="text-align:right">6</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">65</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-08</td>
<td style="text-align:right">2018-03-08</td>
<td style="text-align:right">8</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">62</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-09</td>
<td style="text-align:right">2018-03-09</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">西南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">132</td>
<td style="text-align:right">轻度污染</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-10</td>
<td style="text-align:right">2018-03-10</td>
<td style="text-align:right">14</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">东南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">171</td>
<td style="text-align:right">中度污染</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2018-03-11</td>
<td style="text-align:right">2018-03-11</td>
<td style="text-align:right">11</td>
<td style="text-align:right">0</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">81</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-12</td>
<td style="text-align:right">2018-03-12</td>
<td style="text-align:right">15</td>
<td style="text-align:right">3</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">174</td>
<td style="text-align:right">中度污染</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2018-03-13</td>
<td style="text-align:right">2018-03-13</td>
<td style="text-align:right">17</td>
<td style="text-align:right">5</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">287</td>
<td style="text-align:right">重度污染</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2018-03-14</td>
<td style="text-align:right">2018-03-14</td>
<td style="text-align:right">15</td>
<td style="text-align:right">6</td>
<td style="text-align:right">多云~阴</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">293</td>
<td style="text-align:right">重度污染</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2018-03-15</td>
<td style="text-align:right">2018-03-15</td>
<td style="text-align:right">12</td>
<td style="text-align:right">-1</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">3-4级</td>
<td style="text-align:right">70</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-16</td>
<td style="text-align:right">2018-03-16</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-1</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">58</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-17</td>
<td style="text-align:right">2018-03-17</td>
<td style="text-align:right">4</td>
<td style="text-align:right">0</td>
<td style="text-align:right">小雨~阴</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">81</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-18</td>
<td style="text-align:right">2018-03-18</td>
<td style="text-align:right">13</td>
<td style="text-align:right">1</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">西南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">134</td>
<td style="text-align:right">轻度污染</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-19</td>
<td style="text-align:right">2018-03-19</td>
<td style="text-align:right">13</td>
<td style="text-align:right">2</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">东风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">107</td>
<td style="text-align:right">轻度污染</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-20</td>
<td style="text-align:right">2018-03-20</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">41</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-03-21</td>
<td style="text-align:right">2018-03-21</td>
<td style="text-align:right">11</td>
<td style="text-align:right">1</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">西南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">76</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-22</td>
<td style="text-align:right">2018-03-22</td>
<td style="text-align:right">17</td>
<td style="text-align:right">4</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">西南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">112</td>
<td style="text-align:right">轻度污染</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-23</td>
<td style="text-align:right">2018-03-23</td>
<td style="text-align:right">18</td>
<td style="text-align:right">5</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">146</td>
<td style="text-align:right">轻度污染</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-24</td>
<td style="text-align:right">2018-03-24</td>
<td style="text-align:right">22</td>
<td style="text-align:right">5</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">西南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">119</td>
<td style="text-align:right">轻度污染</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-25</td>
<td style="text-align:right">2018-03-25</td>
<td style="text-align:right">24</td>
<td style="text-align:right">7</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">78</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-26</td>
<td style="text-align:right">2018-03-26</td>
<td style="text-align:right">25</td>
<td style="text-align:right">7</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">西南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">151</td>
<td style="text-align:right">中度污染</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2018-03-27</td>
<td style="text-align:right">2018-03-27</td>
<td style="text-align:right">27</td>
<td style="text-align:right">11</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">243</td>
<td style="text-align:right">重度污染</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2018-03-28</td>
<td style="text-align:right">2018-03-28</td>
<td style="text-align:right">25</td>
<td style="text-align:right">9</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">东风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">387</td>
<td style="text-align:right">严重污染</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">2018-03-29</td>
<td style="text-align:right">2018-03-29</td>
<td style="text-align:right">19</td>
<td style="text-align:right">7</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">119</td>
<td style="text-align:right">轻度污染</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-30</td>
<td style="text-align:right">2018-03-30</td>
<td style="text-align:right">18</td>
<td style="text-align:right">8</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">68</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">23</td>
<td style="text-align:right">9</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">125</td>
<td style="text-align:right">轻度污染</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 按月份前缀筛选</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#34;2018-07&#34;</span>:<span style="color:#e6db74">&#34;2018-09&#34;</span>]<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>DatetimeIndex([<span style="color:#e6db74">&#39;2018-07-01&#39;</span>, <span style="color:#e6db74">&#39;2018-07-02&#39;</span>, <span style="color:#e6db74">&#39;2018-07-03&#39;</span>, <span style="color:#e6db74">&#39;2018-07-04&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-07-05&#39;</span>, <span style="color:#e6db74">&#39;2018-07-06&#39;</span>, <span style="color:#e6db74">&#39;2018-07-07&#39;</span>, <span style="color:#e6db74">&#39;2018-07-08&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-07-09&#39;</span>, <span style="color:#e6db74">&#39;2018-07-10&#39;</span>, <span style="color:#e6db74">&#39;2018-07-11&#39;</span>, <span style="color:#e6db74">&#39;2018-07-12&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-07-13&#39;</span>, <span style="color:#e6db74">&#39;2018-07-14&#39;</span>, <span style="color:#e6db74">&#39;2018-07-15&#39;</span>, <span style="color:#e6db74">&#39;2018-07-16&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-07-17&#39;</span>, <span style="color:#e6db74">&#39;2018-07-18&#39;</span>, <span style="color:#e6db74">&#39;2018-07-19&#39;</span>, <span style="color:#e6db74">&#39;2018-07-20&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-07-21&#39;</span>, <span style="color:#e6db74">&#39;2018-07-22&#39;</span>, <span style="color:#e6db74">&#39;2018-07-23&#39;</span>, <span style="color:#e6db74">&#39;2018-07-24&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-07-25&#39;</span>, <span style="color:#e6db74">&#39;2018-07-26&#39;</span>, <span style="color:#e6db74">&#39;2018-07-27&#39;</span>, <span style="color:#e6db74">&#39;2018-07-28&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-07-29&#39;</span>, <span style="color:#e6db74">&#39;2018-07-30&#39;</span>, <span style="color:#e6db74">&#39;2018-07-31&#39;</span>, <span style="color:#e6db74">&#39;2018-08-01&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-08-02&#39;</span>, <span style="color:#e6db74">&#39;2018-08-03&#39;</span>, <span style="color:#e6db74">&#39;2018-08-04&#39;</span>, <span style="color:#e6db74">&#39;2018-08-05&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-08-06&#39;</span>, <span style="color:#e6db74">&#39;2018-08-07&#39;</span>, <span style="color:#e6db74">&#39;2018-08-08&#39;</span>, <span style="color:#e6db74">&#39;2018-08-09&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-08-10&#39;</span>, <span style="color:#e6db74">&#39;2018-08-11&#39;</span>, <span style="color:#e6db74">&#39;2018-08-12&#39;</span>, <span style="color:#e6db74">&#39;2018-08-13&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-08-14&#39;</span>, <span style="color:#e6db74">&#39;2018-08-15&#39;</span>, <span style="color:#e6db74">&#39;2018-08-16&#39;</span>, <span style="color:#e6db74">&#39;2018-08-17&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-08-18&#39;</span>, <span style="color:#e6db74">&#39;2018-08-19&#39;</span>, <span style="color:#e6db74">&#39;2018-08-20&#39;</span>, <span style="color:#e6db74">&#39;2018-08-21&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-08-22&#39;</span>, <span style="color:#e6db74">&#39;2018-08-23&#39;</span>, <span style="color:#e6db74">&#39;2018-08-24&#39;</span>, <span style="color:#e6db74">&#39;2018-08-25&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-08-26&#39;</span>, <span style="color:#e6db74">&#39;2018-08-27&#39;</span>, <span style="color:#e6db74">&#39;2018-08-28&#39;</span>, <span style="color:#e6db74">&#39;2018-08-29&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-08-30&#39;</span>, <span style="color:#e6db74">&#39;2018-08-31&#39;</span>, <span style="color:#e6db74">&#39;2018-09-01&#39;</span>, <span style="color:#e6db74">&#39;2018-09-02&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-09-03&#39;</span>, <span style="color:#e6db74">&#39;2018-09-04&#39;</span>, <span style="color:#e6db74">&#39;2018-09-05&#39;</span>, <span style="color:#e6db74">&#39;2018-09-06&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-09-07&#39;</span>, <span style="color:#e6db74">&#39;2018-09-08&#39;</span>, <span style="color:#e6db74">&#39;2018-09-09&#39;</span>, <span style="color:#e6db74">&#39;2018-09-10&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-09-11&#39;</span>, <span style="color:#e6db74">&#39;2018-09-12&#39;</span>, <span style="color:#e6db74">&#39;2018-09-13&#39;</span>, <span style="color:#e6db74">&#39;2018-09-14&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-09-15&#39;</span>, <span style="color:#e6db74">&#39;2018-09-16&#39;</span>, <span style="color:#e6db74">&#39;2018-09-17&#39;</span>, <span style="color:#e6db74">&#39;2018-09-18&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-09-19&#39;</span>, <span style="color:#e6db74">&#39;2018-09-20&#39;</span>, <span style="color:#e6db74">&#39;2018-09-21&#39;</span>, <span style="color:#e6db74">&#39;2018-09-22&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-09-23&#39;</span>, <span style="color:#e6db74">&#39;2018-09-24&#39;</span>, <span style="color:#e6db74">&#39;2018-09-25&#39;</span>, <span style="color:#e6db74">&#39;2018-09-26&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2018-09-27&#39;</span>, <span style="color:#e6db74">&#39;2018-09-28&#39;</span>, <span style="color:#e6db74">&#39;2018-09-29&#39;</span>, <span style="color:#e6db74">&#39;2018-09-30&#39;</span>],
</span></span><span style="display:flex;"><span>              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ymd&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 按年份前缀筛选</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#34;2018&#34;</span>]<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">59</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">49</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">阴</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">50</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="4方便的获取周月季度" class="pagebody-header">
    4、方便的获取周、月、季度
  </h3>
</div><p class="component-content component">Timestamp、DatetimeIndex支持大量的属性可以获取日期分量：
<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#time-date-components">https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#time-date-components</a></p>
<p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 周数字列表</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>week</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Int64Index([ <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">52</span>,  <span style="color:#ae81ff">1</span>],
</span></span><span style="display:flex;"><span>           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ymd&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">365</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 月数字列表</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Int64Index([ <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>],
</span></span><span style="display:flex;"><span>           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ymd&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">365</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 季度数字列表</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>quarter</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">Int64Index([1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            ...
            4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
           dtype=&#39;int64&#39;, name=&#39;ymd&#39;, length=365)</code></pre>
  
</div>
<div class="component-content pagebody component">
  <h3 id="5统计每周每月每个季度的最高温度" class="pagebody-header">
    5、统计每周、每月、每个季度的最高温度
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="统计每周的数据" class="pagebody-header">
    统计每周的数据
  </h4>
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>week)[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>max()<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ymd
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>    <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>Name: bWendu, dtype: int32</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>week)[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>max()<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x23300b75b88</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-5cd8c5838a7d1b4d23f5398e266a985b" id="lht5cd8c5838a7d1b4d23f5398e266a985b">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/19.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h4 id="统计每个月的数据" class="pagebody-header">
    统计每个月的数据
  </h4>
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month)[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>max()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ymd
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>     <span style="color:#ae81ff">27</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>     <span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>     <span style="color:#ae81ff">38</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>     <span style="color:#ae81ff">37</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>     <span style="color:#ae81ff">36</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>     <span style="color:#ae81ff">31</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>    <span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>    <span style="color:#ae81ff">18</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>    <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>Name: bWendu, dtype: int32</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month)[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>max()<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x23302dac4c8</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-efd38d28d72806bab9f73909d16e90de" id="lhtefd38d28d72806bab9f73909d16e90de">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/20.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h4 id="统计每个季度的数据" class="pagebody-header">
    统计每个季度的数据
  </h4>
</div><p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">df.groupby(df.index.quarter)[&#34;bWendu&#34;].max()</code></pre>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ymd
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">27</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    <span style="color:#ae81ff">38</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    <span style="color:#ae81ff">37</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    <span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span>Name: bWendu, dtype: int32</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>quarter)[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>max()<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x23302e338c8</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-eba0930b8f2739b6b05af9fb4eb71875" id="lhteba0930b8f2739b6b05af9fb4eb71875">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/21.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h1 id="22pandas怎么处理日期索引的缺失" class="pagebody-header">
    22、Pandas怎么处理日期索引的缺失？
  </h1>
</div><p class="component-content component">问题：按日期统计的数据，缺失了某天，导致数据不全该怎么补充日期？</p>
<p class="component-content component">可以用两种方法实现：
1、DataFrame.reindex，调整dataframe的索引以适应新的索引
2、DataFrame.resample，可以对时间序列重采样，支持补充缺失值</p>

<div class="component-content pagebody component">
  <h2 id="问题如果缺失了索引该怎么填充" class="pagebody-header">
    问题：如果缺失了索引该怎么填充？
  </h2>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;pdate&#34;</span>: [<span style="color:#e6db74">&#34;2019-12-01&#34;</span>, <span style="color:#e6db74">&#34;2019-12-02&#34;</span>, <span style="color:#e6db74">&#34;2019-12-04&#34;</span>, <span style="color:#e6db74">&#34;2019-12-05&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;pv&#34;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">400</span>, <span style="color:#ae81ff">500</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;uv&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">50</span>],
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pdate</th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#34;pdate&#34;</span>)<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x1a0d908bf48</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-966fd3fb2cb18c7e9e6d716051ee79e8" id="lht966fd3fb2cb18c7e9e6d716051ee79e8">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/22.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">*<strong>问题，这里缺失了2019-12-03的数据，导致数据不全该怎么补充？*</strong></p>

<div class="component-content pagebody component">
  <h2 id="方法1使用pandasreindex方法" class="pagebody-header">
    方法1：使用pandas.reindex方法
  </h2>
</div>
<div class="component-content pagebody component">
  <h3 id="1将df的索引变成日期索引" class="pagebody-header">
    1、将df的索引变成日期索引
  </h3>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_date <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#34;pdate&#34;</span>)
</span></span><span style="display:flex;"><span>df_date</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_date<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Index([<span style="color:#e6db74">&#39;2019-12-01&#39;</span>, <span style="color:#e6db74">&#39;2019-12-02&#39;</span>, <span style="color:#e6db74">&#39;2019-12-04&#39;</span>, <span style="color:#e6db74">&#39;2019-12-05&#39;</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;object&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pdate&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 将df的索引设置为日期索引</span>
</span></span><span style="display:flex;"><span>df_date <span style="color:#f92672">=</span> df_date<span style="color:#f92672">.</span>set_index(pd<span style="color:#f92672">.</span>to_datetime(df_date<span style="color:#f92672">.</span>index))
</span></span><span style="display:flex;"><span>df_date</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_date<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>DatetimeIndex([<span style="color:#e6db74">&#39;2019-12-01&#39;</span>, <span style="color:#e6db74">&#39;2019-12-02&#39;</span>, <span style="color:#e6db74">&#39;2019-12-04&#39;</span>, <span style="color:#e6db74">&#39;2019-12-05&#39;</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pdate&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2使用pandasreindex填充缺失的索引" class="pagebody-header">
    2、使用pandas.reindex填充缺失的索引
  </h3>
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 生成完整的日期序列</span>
</span></span><span style="display:flex;"><span>pdates <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(start<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2019-12-01&#34;</span>, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2019-12-05&#34;</span>)
</span></span><span style="display:flex;"><span>pdates</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>DatetimeIndex([<span style="color:#e6db74">&#39;2019-12-01&#39;</span>, <span style="color:#e6db74">&#39;2019-12-02&#39;</span>, <span style="color:#e6db74">&#39;2019-12-03&#39;</span>, <span style="color:#e6db74">&#39;2019-12-04&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2019-12-05&#39;</span>],
</span></span><span style="display:flex;"><span>              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;D&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_date_new <span style="color:#f92672">=</span> df_date<span style="color:#f92672">.</span>reindex(pdates, fill_value<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>df_date_new</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2019-12-03</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_date_new<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x1a0db1ab388</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-09a7dd81618b2973b45eb8e3ced639d2" id="lht09a7dd81618b2973b45eb8e3ced639d2">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/23.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h2 id="方法2使用pandasresample方法" class="pagebody-header">
    方法2：使用pandas.resample方法
  </h2>
</div>
<div class="component-content pagebody component">
  <h3 id="1先将索引变成日期索引" class="pagebody-header">
    1、先将索引变成日期索引
  </h3>
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pdate</th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_new2 <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>set_index(pd<span style="color:#f92672">.</span>to_datetime(df[<span style="color:#e6db74">&#34;pdate&#34;</span>]))<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#34;pdate&#34;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>df_new2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_new2<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>DatetimeIndex([<span style="color:#e6db74">&#39;2019-12-01&#39;</span>, <span style="color:#e6db74">&#39;2019-12-02&#39;</span>, <span style="color:#e6db74">&#39;2019-12-04&#39;</span>, <span style="color:#e6db74">&#39;2019-12-05&#39;</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pdate&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2使用dataframe的resample的方法按照天重采样" class="pagebody-header">
    2、使用dataframe的resample的方法按照天重采样
  </h3>
</div><p class="component-content component">resample的含义：
改变数据的时间频率，比如把天数据变成月份，或者把小时数据变成分钟级别</p>
<p class="component-content component">resample的语法：
(DataFrame or Series).resample(arguments).(aggregate function)</p>
<p class="component-content component">resample的采样规则参数：
<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases">https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases</a></p>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 由于采样会让区间变成一个值，所以需要指定mean等采样值的设定方法</span>
</span></span><span style="display:flex;"><span>df_new2 <span style="color:#f92672">=</span> df_new2<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#34;D&#34;</span>)<span style="color:#f92672">.</span>mean()<span style="color:#f92672">.</span>fillna(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>df_new2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100.0</td>
<td style="text-align:right">10.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200.0</td>
<td style="text-align:right">20.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-03</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">0.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400.0</td>
<td style="text-align:right">40.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500.0</td>
<td style="text-align:right">50.0</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># resample的使用方式</span>
</span></span><span style="display:flex;"><span>df_new2<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#34;2D&#34;</span>)<span style="color:#f92672">.</span>mean()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">150.0</td>
<td style="text-align:right">15.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-03</td>
<td style="text-align:right">200.0</td>
<td style="text-align:right">20.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500.0</td>
<td style="text-align:right">50.0</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="23pandas怎样实现excel的vlookup并且在指定列后面输出" class="pagebody-header">
    23、Pandas怎样实现Excel的vlookup并且在指定列后面输出？
  </h1>
</div><p class="component-content component">背景：</p>
<div class="component-content component"><ol>
<li>有两个excel，他们有相同的一个列；</li>
<li>按照这个列合并成一个大的excel，即vlookup功能，要求：
<div class="component-content component"><ul>
<li>只需要第二个excel的少量的列，比如从40个列中挑选2个列</li>
<li>新增的来自第二个excel的列需要放到第一个excel指定的列后面；</li>
</ul></div>
</li>
<li>将结果输出到一个新的excel;</li>
</ol></div>

<div class="component-content pagebody component">
  <h3 id="步骤1读取两个数据表" class="pagebody-header">
    步骤1：读取两个数据表
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 学生成绩表</span>
</span></span><span style="display:flex;"><span>df_grade <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#34;./course_datas/c23_excel_vlookup/学生成绩表.xlsx&#34;</span>) 
</span></span><span style="display:flex;"><span>df_grade<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">班级</th>
<th style="text-align:right">学号</th>
<th style="text-align:right">语文成绩</th>
<th style="text-align:right">数学成绩</th>
<th style="text-align:right">英语成绩</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">99</td>
<td style="text-align:right">84</td>
<td style="text-align:right">88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">66</td>
<td style="text-align:right">95</td>
<td style="text-align:right">77</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">68</td>
<td style="text-align:right">68</td>
<td style="text-align:right">61</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">63</td>
<td style="text-align:right">66</td>
<td style="text-align:right">82</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">72</td>
<td style="text-align:right">95</td>
<td style="text-align:right">94</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 学生信息表</span>
</span></span><span style="display:flex;"><span>df_sinfo <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#34;./course_datas/c23_excel_vlookup/学生信息表.xlsx&#34;</span>) 
</span></span><span style="display:flex;"><span>df_sinfo<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">学号</th>
<th style="text-align:right">姓名</th>
<th style="text-align:right">性别</th>
<th style="text-align:right">年龄</th>
<th style="text-align:right">籍贯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">怠涵</td>
<td style="text-align:right">女</td>
<td style="text-align:right">23</td>
<td style="text-align:right">山东</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">婉清</td>
<td style="text-align:right">女</td>
<td style="text-align:right">25</td>
<td style="text-align:right">河南</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">溪榕</td>
<td style="text-align:right">女</td>
<td style="text-align:right">23</td>
<td style="text-align:right">湖北</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">漠涓</td>
<td style="text-align:right">女</td>
<td style="text-align:right">19</td>
<td style="text-align:right">陕西</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">祈博</td>
<td style="text-align:right">女</td>
<td style="text-align:right">24</td>
<td style="text-align:right">山东</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>目标：怎样将第二个“学生信息表”的姓名、性别两列，添加到第一个表“学生成绩表”，并且放在第一个表的“学号”列后面？*</strong></p>

<div class="component-content pagebody component">
  <h3 id="步骤2实现两个表的关联" class="pagebody-header">
    步骤2：实现两个表的关联
  </h3>
</div><p class="component-content component">即excel的vloopup功能</p>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 只筛选第二个表的少量的列</span>
</span></span><span style="display:flex;"><span>df_sinfo <span style="color:#f92672">=</span> df_sinfo[[<span style="color:#e6db74">&#34;学号&#34;</span>, <span style="color:#e6db74">&#34;姓名&#34;</span>, <span style="color:#e6db74">&#34;性别&#34;</span>]]
</span></span><span style="display:flex;"><span>df_sinfo<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">学号</th>
<th style="text-align:right">姓名</th>
<th style="text-align:right">性别</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">怠涵</td>
<td style="text-align:right">女</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">婉清</td>
<td style="text-align:right">女</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">溪榕</td>
<td style="text-align:right">女</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">漠涓</td>
<td style="text-align:right">女</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">祈博</td>
<td style="text-align:right">女</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left<span style="color:#f92672">=</span>df_grade, right<span style="color:#f92672">=</span>df_sinfo, left_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;学号&#34;</span>, right_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;学号&#34;</span>)
</span></span><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">班级</th>
<th style="text-align:right">学号</th>
<th style="text-align:right">语文成绩</th>
<th style="text-align:right">数学成绩</th>
<th style="text-align:right">英语成绩</th>
<th style="text-align:right">姓名</th>
<th style="text-align:right">性别</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">99</td>
<td style="text-align:right">84</td>
<td style="text-align:right">88</td>
<td style="text-align:right">怠涵</td>
<td style="text-align:right">女</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">66</td>
<td style="text-align:right">95</td>
<td style="text-align:right">77</td>
<td style="text-align:right">婉清</td>
<td style="text-align:right">女</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">68</td>
<td style="text-align:right">68</td>
<td style="text-align:right">61</td>
<td style="text-align:right">溪榕</td>
<td style="text-align:right">女</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">63</td>
<td style="text-align:right">66</td>
<td style="text-align:right">82</td>
<td style="text-align:right">漠涓</td>
<td style="text-align:right">女</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">72</td>
<td style="text-align:right">95</td>
<td style="text-align:right">94</td>
<td style="text-align:right">祈博</td>
<td style="text-align:right">女</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="步骤3调整列的顺序" class="pagebody-header">
    步骤3：调整列的顺序
  </h3>
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>columns</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Index([<span style="color:#e6db74">&#39;班级&#39;</span>, <span style="color:#e6db74">&#39;学号&#39;</span>, <span style="color:#e6db74">&#39;语文成绩&#39;</span>, <span style="color:#e6db74">&#39;数学成绩&#39;</span>, <span style="color:#e6db74">&#39;英语成绩&#39;</span>, <span style="color:#e6db74">&#39;姓名&#39;</span>, <span style="color:#e6db74">&#39;性别&#39;</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;object&#39;</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="问题怎样将姓名-性别两列放到学号的后面" class="pagebody-header">
    问题：怎样将&rsquo;姓名&rsquo;, &lsquo;性别&rsquo;两列，放到&rsquo;学号&rsquo;的后面？
  </h4>
</div><p class="component-content component">接下来需要用Python的语法实现列表的处理</p>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 将columns变成python的列表形式</span>
</span></span><span style="display:flex;"><span>new_columns <span style="color:#f92672">=</span> df_merge<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>to_list()
</span></span><span style="display:flex;"><span>new_columns</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;班级&#39;</span>, <span style="color:#e6db74">&#39;学号&#39;</span>, <span style="color:#e6db74">&#39;语文成绩&#39;</span>, <span style="color:#e6db74">&#39;数学成绩&#39;</span>, <span style="color:#e6db74">&#39;英语成绩&#39;</span>, <span style="color:#e6db74">&#39;姓名&#39;</span>, <span style="color:#e6db74">&#39;性别&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class=""># 按逆序insert，会将&#34;姓名&#34;，&#34;性别&#34;放到&#34;学号&#34;的后面
for name in [&#34;姓名&#34;, &#34;性别&#34;][::-1]:
    new_columns.remove(name)
    new_columns.insert(new_columns.index(&#34;学号&#34;)&#43;1, name)</code></pre>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>new_columns</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;班级&#39;</span>, <span style="color:#e6db74">&#39;学号&#39;</span>, <span style="color:#e6db74">&#39;姓名&#39;</span>, <span style="color:#e6db74">&#39;性别&#39;</span>, <span style="color:#e6db74">&#39;语文成绩&#39;</span>, <span style="color:#e6db74">&#39;数学成绩&#39;</span>, <span style="color:#e6db74">&#39;英语成绩&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge <span style="color:#f92672">=</span> df_merge<span style="color:#f92672">.</span>reindex(columns<span style="color:#f92672">=</span>new_columns)
</span></span><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">班级</th>
<th style="text-align:right">学号</th>
<th style="text-align:right">姓名</th>
<th style="text-align:right">性别</th>
<th style="text-align:right">语文成绩</th>
<th style="text-align:right">数学成绩</th>
<th style="text-align:right">英语成绩</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">怠涵</td>
<td style="text-align:right">女</td>
<td style="text-align:right">99</td>
<td style="text-align:right">84</td>
<td style="text-align:right">88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">婉清</td>
<td style="text-align:right">女</td>
<td style="text-align:right">66</td>
<td style="text-align:right">95</td>
<td style="text-align:right">77</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">溪榕</td>
<td style="text-align:right">女</td>
<td style="text-align:right">68</td>
<td style="text-align:right">68</td>
<td style="text-align:right">61</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">漠涓</td>
<td style="text-align:right">女</td>
<td style="text-align:right">63</td>
<td style="text-align:right">66</td>
<td style="text-align:right">82</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">祈博</td>
<td style="text-align:right">女</td>
<td style="text-align:right">72</td>
<td style="text-align:right">95</td>
<td style="text-align:right">94</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="步骤4输出最终的excel文件" class="pagebody-header">
    步骤4：输出最终的Excel文件
  </h3>
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merge<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">&#34;./course_datas/c23_excel_vlookup/合并后的数据表.xlsx&#34;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="24pandas怎样结合pyecharts绘制交互性折线图" class="pagebody-header">
    24、Pandas怎样结合Pyecharts绘制交互性折线图？
  </h1>
</div><p class="component-content component">背景：</p>
<div class="component-content component"><ul>
<li>Pandas是Python用于数据分析领域的超级牛的库</li>
<li>Echarts是百度开源的非常好用强大的可视化图表库，Pyecharts是它的Python库版本</li>
</ul></div>

<div class="component-content pagebody component">
  <h2 id="1读取数据" class="pagebody-header">
    1、读取数据
  </h2>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>xlsx_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./datas/stocks/baidu_stocks.xlsx&#34;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(xlsx_path, index_col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;datetime&#34;</span>, parse_dates<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">code</th>
<th style="text-align:right">open</th>
<th style="text-align:right">close</th>
<th style="text-align:right">high</th>
<th style="text-align:right">low</th>
<th style="text-align:right">vol</th>
<th style="text-align:right">p_change</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">datetime</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">115.199997</td>
<td style="text-align:right">114.800003</td>
<td style="text-align:right">116.019997</td>
<td style="text-align:right">113.300003</td>
<td style="text-align:right">3493249</td>
<td style="text-align:right">-2.25</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">118.389999</td>
<td style="text-align:right">117.440002</td>
<td style="text-align:right">119.764999</td>
<td style="text-align:right">116.400002</td>
<td style="text-align:right">2203313</td>
<td style="text-align:right">-0.92</td>
</tr>
<tr>
<td style="text-align:right">2019-11-29</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">118.300003</td>
<td style="text-align:right">118.529999</td>
<td style="text-align:right">118.690002</td>
<td style="text-align:right">117.599998</td>
<td style="text-align:right">1917004</td>
<td style="text-align:right">-0.82</td>
</tr>
<tr>
<td style="text-align:right">2019-11-27</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">119.180000</td>
<td style="text-align:right">119.510002</td>
<td style="text-align:right">119.839996</td>
<td style="text-align:right">118.440002</td>
<td style="text-align:right">2341070</td>
<td style="text-align:right">0.77</td>
</tr>
<tr>
<td style="text-align:right">2019-11-26</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">120.010002</td>
<td style="text-align:right">118.599998</td>
<td style="text-align:right">120.440002</td>
<td style="text-align:right">118.099998</td>
<td style="text-align:right">3813176</td>
<td style="text-align:right">-1.43</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>DatetimeIndex([<span style="color:#e6db74">&#39;2019-12-03&#39;</span>, <span style="color:#e6db74">&#39;2019-12-02&#39;</span>, <span style="color:#e6db74">&#39;2019-11-29&#39;</span>, <span style="color:#e6db74">&#39;2019-11-27&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2019-11-26&#39;</span>, <span style="color:#e6db74">&#39;2019-11-25&#39;</span>, <span style="color:#e6db74">&#39;2019-11-22&#39;</span>, <span style="color:#e6db74">&#39;2019-11-21&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2019-11-20&#39;</span>, <span style="color:#e6db74">&#39;2019-11-19&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2019-01-15&#39;</span>, <span style="color:#e6db74">&#39;2019-01-14&#39;</span>, <span style="color:#e6db74">&#39;2019-01-11&#39;</span>, <span style="color:#e6db74">&#39;2019-01-10&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2019-01-09&#39;</span>, <span style="color:#e6db74">&#39;2019-01-08&#39;</span>, <span style="color:#e6db74">&#39;2019-01-07&#39;</span>, <span style="color:#e6db74">&#39;2019-01-04&#39;</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#39;2019-01-03&#39;</span>, <span style="color:#e6db74">&#39;2019-01-02&#39;</span>],
</span></span><span style="display:flex;"><span>              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">227</span>, freq<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">df.sort_index(inplace=True)
df.head()</code></pre>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">code</th>
<th style="text-align:right">open</th>
<th style="text-align:right">close</th>
<th style="text-align:right">high</th>
<th style="text-align:right">low</th>
<th style="text-align:right">vol</th>
<th style="text-align:right">p_change</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">datetime</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-01-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">156.179993</td>
<td style="text-align:right">162.250000</td>
<td style="text-align:right">164.330002</td>
<td style="text-align:right">155.490005</td>
<td style="text-align:right">2996952</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2019-01-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">158.750000</td>
<td style="text-align:right">154.710007</td>
<td style="text-align:right">159.880005</td>
<td style="text-align:right">153.779999</td>
<td style="text-align:right">3879180</td>
<td style="text-align:right">-4.65</td>
</tr>
<tr>
<td style="text-align:right">2019-01-04</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">157.600006</td>
<td style="text-align:right">160.949997</td>
<td style="text-align:right">162.429993</td>
<td style="text-align:right">157.250000</td>
<td style="text-align:right">3847497</td>
<td style="text-align:right">4.03</td>
</tr>
<tr>
<td style="text-align:right">2019-01-07</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">162.600006</td>
<td style="text-align:right">162.600006</td>
<td style="text-align:right">164.490005</td>
<td style="text-align:right">158.509995</td>
<td style="text-align:right">3266091</td>
<td style="text-align:right">1.03</td>
</tr>
<tr>
<td style="text-align:right">2019-01-08</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">162.190002</td>
<td style="text-align:right">163.399994</td>
<td style="text-align:right">163.889999</td>
<td style="text-align:right">158.160004</td>
<td style="text-align:right">3253361</td>
<td style="text-align:right">0.49</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h2 id="2使用pyecharts绘制折线图" class="pagebody-header">
    2、使用Pyecharts绘制折线图
  </h2>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 如果没有安装，使用pip install pyecharts安装</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pyecharts.charts <span style="color:#f92672">import</span> Line
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pyecharts <span style="color:#f92672">import</span> options <span style="color:#66d9ef">as</span> opts</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 折线图</span>
</span></span><span style="display:flex;"><span>line <span style="color:#f92672">=</span> Line()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># x轴</span>
</span></span><span style="display:flex;"><span>line<span style="color:#f92672">.</span>add_xaxis(df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>to_list())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 每个y轴</span>
</span></span><span style="display:flex;"><span>line<span style="color:#f92672">.</span>add_yaxis(<span style="color:#e6db74">&#34;开盘价&#34;</span>, df[<span style="color:#e6db74">&#34;open&#34;</span>]<span style="color:#f92672">.</span>round(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>to_list())
</span></span><span style="display:flex;"><span>line<span style="color:#f92672">.</span>add_yaxis(<span style="color:#e6db74">&#34;收盘价&#34;</span>, df[<span style="color:#e6db74">&#34;close&#34;</span>]<span style="color:#f92672">.</span>round(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>to_list())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 图表配置</span>
</span></span><span style="display:flex;"><span>line<span style="color:#f92672">.</span>set_global_opts(
</span></span><span style="display:flex;"><span>    title_opts<span style="color:#f92672">=</span>opts<span style="color:#f92672">.</span>TitleOpts(title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;百度股票2019年&#34;</span>),
</span></span><span style="display:flex;"><span>    tooltip_opts<span style="color:#f92672">=</span>opts<span style="color:#f92672">.</span>TooltipOpts(trigger<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;axis&#34;</span>, axis_pointer_type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cross&#34;</span>)
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>pyecharts<span style="color:#f92672">.</span>charts<span style="color:#f92672">.</span>basic_charts<span style="color:#f92672">.</span>line<span style="color:#f92672">.</span>Line at <span style="color:#ae81ff">0x201bd51d088</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 渲染数据</span>
</span></span><span style="display:flex;"><span>line<span style="color:#f92672">.</span>render_notebook()</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="25pandas结合sklearn实现泰坦尼克存活率预测" class="pagebody-header">
    25、Pandas结合Sklearn实现泰坦尼克存活率预测
  </h1>
</div>
<div class="component-content pagebody component">
  <h3 id="实例目标实现泰坦尼克存活预测" class="pagebody-header">
    实例目标：实现泰坦尼克存活预测
  </h3>
</div><p class="component-content component">处理步骤：
1、输入数据：使用Pandas读取训练数据(历史数据，特点是已经知道了这个人最后有没有活下来)
2、训练模型：使用Sklearn训练模型
3、使用模型：对于一个新的不知道存活的人，预估他存活的概率</p>

<div class="component-content pagebody component">
  <h3 id="步骤1读取训练数据" class="pagebody-header">
    步骤1：读取训练数据
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_train <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./datas/titanic/titanic_train.csv&#34;</span>)
</span></span><span style="display:flex;"><span>df_train<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cumings, Mrs. John Bradley (Florence Briggs Th&hellip;</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17599</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C85</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Heikkinen, Miss. Laina</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">STON/O2. 3101282</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113803</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">C123</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>其中，Survived==1代表这个人活下来了、==0代表没活下来；其他的都是这个人的信息和当时的仓位、票务情况*</strong></p>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 我们只挑选两列，作为预测需要的特征</span>
</span></span><span style="display:flex;"><span>feature_cols <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Pclass&#39;</span>, <span style="color:#e6db74">&#39;Parch&#39;</span>]
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> df_train<span style="color:#f92672">.</span>loc[:, feature_cols]
</span></span><span style="display:flex;"><span>X<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Parch</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 单独提取是否存活的列，作为预测的目标</span>
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> df_train<span style="color:#f92672">.</span>Survived
</span></span><span style="display:flex;"><span>y<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Name: Survived, dtype: int64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="步骤2训练模型" class="pagebody-header">
    步骤2：训练模型
  </h3>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 创建模型对象</span>
</span></span><span style="display:flex;"><span>logreg <span style="color:#f92672">=</span> LogisticRegression()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 实现模型训练</span>
</span></span><span style="display:flex;"><span>logreg<span style="color:#f92672">.</span>fit(X, y)
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span>anaconda3<span style="color:#f92672">/</span>lib<span style="color:#f92672">/</span>python3<span style="color:#ae81ff">.7</span><span style="color:#f92672">/</span>site<span style="color:#f92672">-</span>packages<span style="color:#f92672">/</span>sklearn<span style="color:#f92672">/</span>linear_model<span style="color:#f92672">/</span>logistic<span style="color:#f92672">.</span>py:<span style="color:#ae81ff">432</span>: <span style="color:#a6e22e">FutureWarning</span>: Default solver will be changed to <span style="color:#e6db74">&#39;lbfgs&#39;</span> <span style="color:#f92672">in</span> <span style="color:#ae81ff">0.22</span><span style="color:#f92672">.</span> Specify a solver to silence this warning<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">FutureWarning</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>LogisticRegression(C<span style="color:#f92672">=</span><span style="color:#ae81ff">1.0</span>, class_weight<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, dual<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, fit_intercept<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>                   intercept_scaling<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, l1_ratio<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, max_iter<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>                   multi_class<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;warn&#39;</span>, n_jobs<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, penalty<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;l2&#39;</span>,
</span></span><span style="display:flex;"><span>                   random_state<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, solver<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;warn&#39;</span>, tol<span style="color:#f92672">=</span><span style="color:#ae81ff">0.0001</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>                   warm_start<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>logreg<span style="color:#f92672">.</span>score(X, y)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0.6879910213243546</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="步骤3对于未知数据使用模型" class="pagebody-header">
    步骤3：对于未知数据使用模型
  </h3>
</div><p class="component-content component">机器学习的核心目标，是使用模型预测未知的事物</p>
<p class="component-content component">比如预测股票明天是涨还是跌、一套新的二手房成交价大概多少钱、用户打开APP最可能看那些视频等问题</p>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 找一个历史数据中不存在的数据</span>
</span></span><span style="display:flex;"><span>X<span style="color:#f92672">.</span>drop_duplicates()<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;Pclass&#34;</span>, <span style="color:#e6db74">&#34;Parch&#34;</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Parch</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">54</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">27</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">438</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">98</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">43</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">437</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">86</td>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">167</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">13</td>
<td style="text-align:right">3</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">678</td>
<td style="text-align:right">3</td>
<td style="text-align:right">6</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 预测这个数据存活的概率</span>
</span></span><span style="display:flex;"><span>logreg<span style="color:#f92672">.</span>predict([[<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>]])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([<span style="color:#ae81ff">1</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>logreg<span style="color:#f92672">.</span>predict_proba([[<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>]])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([[<span style="color:#ae81ff">0.35053893</span>, <span style="color:#ae81ff">0.64946107</span>]])</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="26pandas处理分析网站原始访问日志" class="pagebody-header">
    26、Pandas处理分析网站原始访问日志
  </h1>
</div><p class="component-content component">目标：真实项目的实战，探索Pandas的数据处理与分析</p>
<p class="component-content component">实例：
数据来源：某大佬的wordpress博客http://www.crazyant.net/ 的访问日志</p>
<p class="component-content component">实现步骤：
1、读取数据、清理、格式化
2、统计爬虫spider的访问比例，输出柱状图
3、统计http状态码的访问占比，输出饼图
4、统计按小时、按天的PV/UV流量趋势，输出折线图</p>

<div class="component-content pagebody component">
  <h3 id="1读取数据并清理格式化" class="pagebody-header">
    1、读取数据并清理格式化
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>set_option(<span style="color:#e6db74">&#39;display.max_colwidth&#39;</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pyecharts <span style="color:#f92672">import</span> options <span style="color:#66d9ef">as</span> opts
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pyecharts.charts <span style="color:#f92672">import</span> Bar,Pie,Line</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 读取整个目录，将所有的文件合并到一个dataframe</span>
</span></span><span style="display:flex;"><span>data_dir <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./datas/crazyant/blog_access_log&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df_list <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> fname <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>data_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>):
</span></span><span style="display:flex;"><span>    df_list<span style="color:#f92672">.</span>append(pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>data_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>fname<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>, sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34; &#34;</span>, header<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, error_bad_lines<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(df_list)
</span></span><span style="display:flex;"><span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Skipping line 2245: expected 10 fields, saw 16</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 2889: expected 10 fields, saw 14</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 2890: expected 10 fields, saw 14</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 2891: expected 10 fields, saw 13</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 2892: expected 10 fields, saw 13</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 2900: expected 10 fields, saw 11</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 2902: expected 10 fields, saw 11</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 3790: expected 10 fields, saw 14</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 3791: expected 10 fields, saw 14</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 3792: expected 10 fields, saw 13</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 3793: expected 10 fields, saw 13</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 3833: expected 10 fields, saw 11</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 3835: expected 10 fields, saw 11</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 9936: expected 10 fields, saw 16</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Skipping line 11748: expected 10 fields, saw 11</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Skipping line 11750: expected 10 fields, saw 11</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
<th style="text-align:right">2</th>
<th style="text-align:right">3</th>
<th style="text-align:right">4</th>
<th style="text-align:right">5</th>
<th style="text-align:right">6</th>
<th style="text-align:right">7</th>
<th style="text-align:right">8</th>
<th style="text-align:right">9</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">106.11.153.226</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">[02/Dec/2019:22:40:18</td>
<td style="text-align:right">+0800]</td>
<td style="text-align:right">GET /740.html?replytocom=1194 HTTP/1.0</td>
<td style="text-align:right">200</td>
<td style="text-align:right">13446</td>
<td style="text-align:right">-</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">42.156.254.60</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">[02/Dec/2019:22:40:23</td>
<td style="text-align:right">+0800]</td>
<td style="text-align:right">POST /wp-json/wordpress-popular-posts/v1/popular-posts HTTP/1.0</td>
<td style="text-align:right">201</td>
<td style="text-align:right">55</td>
<td style="text-align:right"><a href="http://www.crazyant.net/740.html?replytocom=1194">http://www.crazyant.net/740.html?replytocom=1194</a></td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">106.11.159.254</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">[02/Dec/2019:22:40:27</td>
<td style="text-align:right">+0800]</td>
<td style="text-align:right">GET /576.html HTTP/1.0</td>
<td style="text-align:right">200</td>
<td style="text-align:right">13461</td>
<td style="text-align:right">-</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">106.11.157.254</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">[02/Dec/2019:22:40:28</td>
<td style="text-align:right">+0800]</td>
<td style="text-align:right">GET /?lwfcdw=t9n2d3&amp;oqzohc=m5e7j1&amp;oubyvq=iab6a3&amp;oudmbg=6osqd3 HTTP/1.0</td>
<td style="text-align:right">200</td>
<td style="text-align:right">10485</td>
<td style="text-align:right">-</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">42.156.137.109</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">[02/Dec/2019:22:40:30</td>
<td style="text-align:right">+0800]</td>
<td style="text-align:right">POST /wp-json/wordpress-popular-posts/v1/popular-posts HTTP/1.0</td>
<td style="text-align:right">201</td>
<td style="text-align:right">55</td>
<td style="text-align:right"><a href="http://www.crazyant.net/576.html">http://www.crazyant.net/576.html</a></td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df[[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>]]<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">0</th>
<th style="text-align:right">3</th>
<th style="text-align:right">6</th>
<th style="text-align:right">9</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">106.11.153.226</td>
<td style="text-align:right">[02/Dec/2019:22:40:18</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">42.156.254.60</td>
<td style="text-align:right">[02/Dec/2019:22:40:23</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">106.11.159.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:27</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">106.11.157.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:28</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">42.156.137.109</td>
<td style="text-align:right">[02/Dec/2019:22:40:30</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;ip&#34;</span>, <span style="color:#e6db74">&#34;stime&#34;</span>, <span style="color:#e6db74">&#34;status&#34;</span>, <span style="color:#e6db74">&#34;client&#34;</span>]
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ip</th>
<th style="text-align:right">stime</th>
<th style="text-align:right">status</th>
<th style="text-align:right">client</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">106.11.153.226</td>
<td style="text-align:right">[02/Dec/2019:22:40:18</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">42.156.254.60</td>
<td style="text-align:right">[02/Dec/2019:22:40:23</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">106.11.159.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:27</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">106.11.157.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:28</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">42.156.137.109</td>
<td style="text-align:right">[02/Dec/2019:22:40:30</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>dtypes</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ip        object
</span></span><span style="display:flex;"><span>stime     object
</span></span><span style="display:flex;"><span>status    int64 
</span></span><span style="display:flex;"><span>client    object
</span></span><span style="display:flex;"><span>dtype: object</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2统计spider的比例" class="pagebody-header">
    2、统计spider的比例
  </h3>
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;is_spider&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;client&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>lower()<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>contains(<span style="color:#e6db74">&#34;spider&#34;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ip</th>
<th style="text-align:right">stime</th>
<th style="text-align:right">status</th>
<th style="text-align:right">client</th>
<th style="text-align:right">is_spider</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">106.11.153.226</td>
<td style="text-align:right">[02/Dec/2019:22:40:18</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
<td style="text-align:right">True</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">42.156.254.60</td>
<td style="text-align:right">[02/Dec/2019:22:40:23</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
<td style="text-align:right">True</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">106.11.159.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:27</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
<td style="text-align:right">True</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">106.11.157.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:28</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
<td style="text-align:right">True</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">42.156.137.109</td>
<td style="text-align:right">[02/Dec/2019:22:40:30</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
<td style="text-align:right">True</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_spider <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;is_spider&#34;</span>]<span style="color:#f92672">.</span>value_counts()
</span></span><span style="display:flex;"><span>df_spider</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">False</span>    <span style="color:#ae81ff">46641</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">True</span>     <span style="color:#ae81ff">3637</span> 
</span></span><span style="display:flex;"><span>Name: is_spider, dtype: int64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>bar <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        Bar()
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>add_xaxis([str(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> df_spider<span style="color:#f92672">.</span>index])
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>add_yaxis(<span style="color:#e6db74">&#34;是否Spider&#34;</span>, df_spider<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>tolist())
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>set_global_opts(title_opts<span style="color:#f92672">=</span>opts<span style="color:#f92672">.</span>TitleOpts(title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;爬虫访问量占比&#34;</span>))
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>bar<span style="color:#f92672">.</span>render_notebook()</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="27pandas怎样找出最影响结果的那些特征" class="pagebody-header">
    27、Pandas怎样找出最影响结果的那些特征？
  </h1>
</div><p class="component-content component">应用场景：</p>
<div class="component-content component"><ul>
<li>机器学习的特征选择，去除无用的特征，可以提升模型效果、降低训练时间等等</li>
<li>数据分析领域，找出收入波动的最大因素！！</li>
</ul></div>

<div class="component-content pagebody component">
  <h2 id="实例演示泰坦尼克沉船事件中最影响生死的因素有哪些" class="pagebody-header">
    实例演示：泰坦尼克沉船事件中，最影响生死的因素有哪些？
  </h2>
</div>
<div class="component-content pagebody component">
  <h3 id="1导入相关的包" class="pagebody-header">
    1、导入相关的包
  </h3>
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 特征最影响结果的K个特征</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.feature_selection <span style="color:#f92672">import</span> SelectKBest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 卡方检验，作为SelectKBest的参数</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.feature_selection <span style="color:#f92672">import</span> chi2</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2导入泰坦尼克号的数据" class="pagebody-header">
    2、导入泰坦尼克号的数据
  </h3>
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./datas/titanic/titanic_train.csv&#34;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cumings, Mrs. John Bradley (Florence Briggs Th&hellip;</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17599</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C85</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Heikkinen, Miss. Laina</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">STON/O2. 3101282</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113803</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">C123</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df[[<span style="color:#e6db74">&#34;PassengerId&#34;</span>, <span style="color:#e6db74">&#34;Survived&#34;</span>, <span style="color:#e6db74">&#34;Pclass&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>, <span style="color:#e6db74">&#34;Age&#34;</span>, <span style="color:#e6db74">&#34;SibSp&#34;</span>, <span style="color:#e6db74">&#34;Parch&#34;</span>, <span style="color:#e6db74">&#34;Fare&#34;</span>, <span style="color:#e6db74">&#34;Embarked&#34;</span>]]<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3数据清理和转换" class="pagebody-header">
    3、数据清理和转换
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="31-查看是否有空值列" class="pagebody-header">
    3.1 查看是否有空值列
  </h4>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>frame<span style="color:#f92672">.</span>DataFrame<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#ae81ff">891</span> entries, <span style="color:#ae81ff">0</span> to <span style="color:#ae81ff">890</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#ae81ff">9</span> columns):
</span></span><span style="display:flex;"><span>PassengerId    <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Survived       <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Pclass         <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Sex            <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>Age            <span style="color:#ae81ff">714</span> non<span style="color:#f92672">-</span>null float64
</span></span><span style="display:flex;"><span>SibSp          <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Parch          <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null int64
</span></span><span style="display:flex;"><span>Fare           <span style="color:#ae81ff">891</span> non<span style="color:#f92672">-</span>null float64
</span></span><span style="display:flex;"><span>Embarked       <span style="color:#ae81ff">889</span> non<span style="color:#f92672">-</span>null object
</span></span><span style="display:flex;"><span>dtypes: float64(<span style="color:#ae81ff">2</span>), int64(<span style="color:#ae81ff">5</span>), object(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#ae81ff">62.8</span><span style="color:#f92672">+</span> KB</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="32-给age列填充平均值" class="pagebody-header">
    3.2 给Age列填充平均值
  </h4>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;Age&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">.</span>fillna(df[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">.</span>median())</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="32-将性别列变成数字" class="pagebody-header">
    3.2 将性别列变成数字
  </h4>
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 性别</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>Sex<span style="color:#f92672">.</span>unique()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([<span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#e6db74">&#39;female&#39;</span>], dtype<span style="color:#f92672">=</span>object)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[df[<span style="color:#e6db74">&#34;Sex&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;male&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[df[<span style="color:#e6db74">&#34;Sex&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;female&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="33-给embarked列填充空值字符串转换成数字" class="pagebody-header">
    3.3 给Embarked列填充空值，字符串转换成数字
  </h4>
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Embarked</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>Embarked<span style="color:#f92672">.</span>unique()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([<span style="color:#e6db74">&#39;S&#39;</span>, <span style="color:#e6db74">&#39;C&#39;</span>, <span style="color:#e6db74">&#39;Q&#39;</span>, nan], dtype<span style="color:#f92672">=</span>object)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 填充空值</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;Embarked&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;Embarked&#34;</span>]<span style="color:#f92672">.</span>fillna(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 字符串变成数字</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[df[<span style="color:#e6db74">&#34;Embarked&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;S&#34;</span>, <span style="color:#e6db74">&#34;Embarked&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[df[<span style="color:#e6db74">&#34;Embarked&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;C&#34;</span>, <span style="color:#e6db74">&#34;Embarked&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[df[<span style="color:#e6db74">&#34;Embarked&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Q&#34;</span>, <span style="color:#e6db74">&#34;Embarked&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="4将特征列和结果列拆分开" class="pagebody-header">
    4、将特征列和结果列拆分开
  </h3>
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>pop(<span style="color:#e6db74">&#34;Survived&#34;</span>)
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> df</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Name: Survived, dtype: int64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="5使用卡方检验选择topk的特征" class="pagebody-header">
    5、使用卡方检验选择topK的特征
  </h3>
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 选择所有的特征，目的是看到特征重要性排序</span>
</span></span><span style="display:flex;"><span>bestfeatures <span style="color:#f92672">=</span> SelectKBest(score_func<span style="color:#f92672">=</span>chi2, k<span style="color:#f92672">=</span>len(X<span style="color:#f92672">.</span>columns))
</span></span><span style="display:flex;"><span>fit <span style="color:#f92672">=</span> bestfeatures<span style="color:#f92672">.</span>fit(X, y)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="6按照重要性顺序打印特征列表" class="pagebody-header">
    6、按照重要性顺序打印特征列表
  </h3>
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_scores <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(fit<span style="color:#f92672">.</span>scores_)
</span></span><span style="display:flex;"><span>df_scores</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">0</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">3.312934</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">30.873699</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">170.348127</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">21.649163</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.581865</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">10.097499</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">4518.319091</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">2.771019</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_columns <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X<span style="color:#f92672">.</span>columns)
</span></span><span style="display:flex;"><span>df_columns</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">0</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">PassengerId</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Pclass</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Sex</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Age</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">SibSp</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">Parch</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">Fare</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">Embarked</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 合并两个df</span>
</span></span><span style="display:flex;"><span>df_feature_scores <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df_columns,df_scores],axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 列名</span>
</span></span><span style="display:flex;"><span>df_feature_scores<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;feature_name&#39;</span>,<span style="color:#e6db74">&#39;Score&#39;</span>]  <span style="color:#75715e">#naming the dataframe columns</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看</span>
</span></span><span style="display:flex;"><span>df_feature_scores</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">feature_name</th>
<th style="text-align:right">Score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">PassengerId</td>
<td style="text-align:right">3.312934</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Pclass</td>
<td style="text-align:right">30.873699</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Sex</td>
<td style="text-align:right">170.348127</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Age</td>
<td style="text-align:right">21.649163</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">SibSp</td>
<td style="text-align:right">2.581865</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">Parch</td>
<td style="text-align:right">10.097499</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">Fare</td>
<td style="text-align:right">4518.319091</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">Embarked</td>
<td style="text-align:right">2.771019</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_feature_scores<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Score&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">feature_name</th>
<th style="text-align:right">Score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">Fare</td>
<td style="text-align:right">4518.319091</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Sex</td>
<td style="text-align:right">170.348127</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Pclass</td>
<td style="text-align:right">30.873699</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Age</td>
<td style="text-align:right">21.649163</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">Parch</td>
<td style="text-align:right">10.097499</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">PassengerId</td>
<td style="text-align:right">3.312934</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">Embarked</td>
<td style="text-align:right">2.771019</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">SibSp</td>
<td style="text-align:right">2.581865</td>
</tr>
</tbody>
</table></div>

          </div><div class="component">
            <div class="component-content">
              <div class="article-copyright">
                <p class="content">
                  Copyright: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</a>
                </p>
                <p class="content">Author:   </p>
                <p class="content">Posted on:  November 26, 2021</p>
              </div>
            </div>
          </div></article>
      </section>
  </main>

  <script>
    var script = document.createElement("script");script.src = "https://yuanshuai1122.github.io/js/initPost.js";
    document.head.appendChild(script);
  </script>

    
    <div class="footer-main ">
  <div class="content-body footer-wraper">
    <div class="footer-box">
      <div class="foot-nav">
        <div class="foot-nav-items">
          <div class="item">
            <div class="logo"></div>
            <div class="email">Email: <a href="mailto:floyd.li@outlook.com">floyd.li@outlook.com</a></div>
          </div>

          <div class="item community">
            <div class="item-title">Social Media</div>
            
              <a href="https://github.com/floyd-li" target="_blank">Github</a>
            
          </div>

          <div class="item resources">
            <div class="item-title">Related</div>
            
              <a href="https://yufengbiji.com/" target="_blank">驭风笔记</a>
            
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="item copyright">
          &copy; 2023
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://github.com/floyd-li/hugo-theme-itheme" target="_blank">iTheme</a>
        </div>
      </div>
    </div>
  </div>
</div>

  </body>
    
    

    
    
</html>
