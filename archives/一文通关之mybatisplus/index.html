<!DOCTYPE html>
<html class="js no-touch  progressive-image  no-reduced-motion progressive" lang="en">
  <head>
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/img/favicon.ico">

    <meta name="keyword" content=""><meta property="og:title" content="一文通关之MybatisPlus" />
<meta property="og:description" content="MyBatisPlus 1、MyBatisPlus概述 需要的基础:把我的MyBatis、Spring、SpringMVC就可以学习这个了! 为什么要学习它呢?MyB" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuanshuai1122.github.io/archives/%E4%B8%80%E6%96%87%E9%80%9A%E5%85%B3%E4%B9%8Bmybatisplus/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-24T08:53:06+00:00" />
<meta property="article:modified_time" content="2021-11-24T08:53:06+00:00" />
<title>一文通关之MybatisPlus</title>

    <link rel="canonical" href="/archives/%E4%B8%80%E6%96%87%E9%80%9A%E5%85%B3%E4%B9%8Bmybatisplus/">

    <link rel="stylesheet" href="/css/global.css">

    <link rel="stylesheet" href="/css/custom.css">

    <link rel="stylesheet" href="/css/search.css" />

    
    

    
    

</head>
  </head>
  <body class=" page-article   ">
    <header>
      <nav class="nav">
  <div class="nav-wrapper">
    <div class="nav-content-wrapper">
      <div class="nav-content">
        <a href="/ " class="nav-title">iTheme</a>
        <div class="nav-menu">
          <div class="nav-item-wrapper">
            <a href="/posts " class="nav-item-content">Articles</a>
          </div><div class="nav-item-wrapper">
            <a href="/about" class="nav-item-content">About</a>
          </div><div class="nav-item-wrapper">
            <a href="/index.xml" class="nav-item-content" target="_blank">RSS</a>
          </div></div>
      </div>
    </div>
  </div>
</nav>

<script>
  function toggleSearchModal(){
    const template = `
    <div class="modal-body">
      <div id="autocomplete" onclick="event.stopPropagation();"></div>
    </div>
    `
    const modal = document.querySelector("#modal-wrapper")
    if(!modal){
      const div = document.createElement("div")
      document.body.setAttribute("style","overflow: hidden;")
      div.setAttribute("id", "modal-wrapper")
      div.setAttribute("onclick", "toggleSearchModal()")
      div.innerHTML = template
      const script = document.createElement("script");script.setAttribute("src", "https://yuanshuai1122.github.io/js/algolia.js")
      div.appendChild(script)
      document.body.append(div)
    } else {
      document.body.removeAttribute("style")
      document.body.removeChild(modal)
    }
  }
</script>
    </header>
    
  
  
  <main id="main" class="main">
      <section>
        <article class="article">
          
          <div class=" article-header ">
            <div class="category component">
              <div class="component-content">
                <div class="category-eyebrow">
                  <span class="category-eyebrow__category category_original">
                    
                      
                        mybatisplus
                      
                    
                  </span>
                  <span class="category-eyebrow__date">November 24, 2021</span>
                </div>
              </div>
            </div>
            <div class="pagetitle component">
              <div class="component-content">
                <h1 class="hero-headline">一文通关之MybatisPlus</h1>
              </div>
            </div>
            <div class="component  article-subhead ">
              <div class="component-content"></div>
            </div>

            <div class="tagssheet component">
              <div class="component-content">
                
                  
                  <a href="/tags/mybatisplus" class="tag">
                    mybatisplus
                  </a>
                
              </div>
            </div>
          </div>
          
          <div class="pagebody">
            
            
            
            
            
            
            
            
            
<div class="component-content pagebody component">
  <h1 id="mybatisplus" class="pagebody-header">
    <strong>MyBatisPlus</strong>
  </h1>
</div>
<div class="component-content pagebody component">
  <h2 id="1mybatisplus概述" class="pagebody-header">
    <strong>1、MyBatisPlus</strong>概述
  </h2>
</div><p class="component-content component">需要的基础:把我的MyBatis、Spring、SpringMVC就可以学习这个了! 为什么要学习它呢?MyBatisPlus可以节省我们大量工作时间，所有的CRUD代码它都可以自动化完成! JPA 、 tk-mapper、MyBatisPlus
偷懒的!</p>
<blockquote>
<p class="component-content component">简介</p>
</blockquote>
<p class="component-content component">是什么? MyBatis 本来就是简化 JDBC 操作的!</p>
<p class="component-content component">官网:https://mp.baomidou.com/ MyBatis Plus，简化 MyBatis !</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-9b175012ba0aea5e3db0fbf617dd2116" id="lht9b175012ba0aea5e3db0fbf617dd2116">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/1.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-e71fd06b7cd9bbb42aa6114847ad227f" id="lhte71fd06b7cd9bbb42aa6114847ad227f">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/2.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<blockquote>
<p class="component-content component">特性</p>
</blockquote>
<p class="component-content component"><strong>无侵入</strong>:只做增强不做改变，引入它不会对现有工程产生影响，如丝般顺滑</p>
<p class="component-content component"><strong>损耗小</strong>:启动即会自动注入基本 CURD，性能基本无损耗，直接面向对象操作， BaseMapper</p>
<p class="component-content component"><strong>强大的</strong> <strong>CRUD</strong> <strong>操作</strong>:内置通用 Mapper、通用 Service，仅仅通过少量配置即可实现单表大部分 CRUD 操作，更有强大的条件构造器，满足各类使用需求, 以后简单的CRUD操作，它不用自己编写了!</p>
<p class="component-content component"><strong>支持</strong> <strong>Lambda</strong> <strong>形式调用</strong>:通过 Lambda 表达式，方便的编写各类查询条件，无需再担心字段写错</p>
<p class="component-content component"><strong>支持主键自动生成</strong>:支持多达 4 种主键策略(内含分布式唯一 ID 生成器 - Sequence)，可自由配置，完美解决主键问题</p>
<p class="component-content component"><strong>支持</strong> <strong>ActiveRecord</strong> <strong>模式</strong>:支持 ActiveRecord 形式调用，实体类只需继承 Model 类即可进行强大 的 CRUD 操作</p>
<p class="component-content component"><strong>支持自定义全局通用操作</strong>:支持全局通用方法注入( Write once, use anywhere )</p>
<p class="component-content component"><strong>内置代码生成器</strong>:采用代码或者 Maven 插件可快速生成 Mapper 、 Model 、 Service 、 Controller 层代码，支持模板引擎，更有超多自定义配置等您来使用(自动帮你生成代码)</p>
<p class="component-content component"><strong>内置分页插件</strong>:基于 MyBatis 物理分页，开发者无需关心具体操作，配置好插件之后，写分页等同 于普通 List 查询</p>
<p class="component-content component"><strong>分页插件支持多种数据库</strong>:支持 MySQL、MariaDB、Oracle、DB2、H2、HSQL、SQLite、 Postgre、SQLServer 等多种数据库</p>
<p class="component-content component"><strong>内置性能分析插件</strong>:可输出 Sql 语句以及其执行时间，建议开发测试时启用该功能，能快速揪出慢 查询</p>
<p class="component-content component"><strong>内置全局拦截插件</strong>:提供全表 delete 、 update 操作智能分析阻断，也可自定义拦截规则，预防误 操作</p>

<div class="component-content pagebody component">
  <h2 id="2快速入门" class="pagebody-header">
    2、<strong>快速入门</strong>
  </h2>
</div><p class="component-content component">地址:https://mp.baomidou.com/guide/quick-start.html#初始化工程</p>
<p class="component-content component">使用第三方组件:</p>
<p class="component-content component">1、导入对应的依赖</p>
<p class="component-content component">2、研究依赖如何配置</p>
<p class="component-content component">3、代码如何编写</p>
<p class="component-content component">4、提高扩展技术能力!</p>
<blockquote>
<p class="component-content component">步骤</p>
</blockquote>
<p class="component-content component">1、创建数据库 <code>mybatis_plus</code></p>
<p class="component-content component">2、创建user表</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#66d9ef">IF</span> <span style="color:#66d9ef">EXISTS</span> <span style="color:#66d9ef">user</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#66d9ef">user</span>
</span></span><span style="display:flex;"><span>(
</span></span><span style="display:flex;"><span>id BIGINT(<span style="color:#ae81ff">20</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;主键ID&#39;</span>,
</span></span><span style="display:flex;"><span>name VARCHAR(<span style="color:#ae81ff">30</span>) <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;姓名&#39;</span>, age INT(<span style="color:#ae81ff">11</span>) <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;年龄&#39;</span>,
</span></span><span style="display:flex;"><span>email VARCHAR(<span style="color:#ae81ff">50</span>) <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;邮箱&#39;</span>, <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> (id)
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> <span style="color:#66d9ef">user</span> (id, name, age, email) <span style="color:#66d9ef">VALUES</span>
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;Jone&#39;</span>, <span style="color:#ae81ff">18</span>, <span style="color:#e6db74">&#39;test1@baomidou.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;Jack&#39;</span>, <span style="color:#ae81ff">20</span>, <span style="color:#e6db74">&#39;test2@baomidou.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;Tom&#39;</span>, <span style="color:#ae81ff">28</span>, <span style="color:#e6db74">&#39;test3@baomidou.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;Sandy&#39;</span>, <span style="color:#ae81ff">21</span>, <span style="color:#e6db74">&#39;test4@baomidou.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">5</span>, <span style="color:#e6db74">&#39;Billie&#39;</span>, <span style="color:#ae81ff">24</span>, <span style="color:#e6db74">&#39;test5@baomidou.com&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- 真实开发中，version(乐观锁)、deleted(逻辑删除)、gmt_create、gmt_modified</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">3、编写项目，初始化项目!使用SpringBoot初始化!</p>
<p class="component-content component">4、导入依赖</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- 数据库驱动 --&gt;</span> <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>mysql<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>mysql-connector-java<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- lombok --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>org.projectlombok<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>lombok<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- mybatis-plus --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- mybatis-plus 是自己开发，并非官方的! --&gt;</span> <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>com.baomidou<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>mybatis-plus-boot-starter<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;version&gt;</span>3.0.5<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">说明:我们使用 mybatis-plus 可以节省我们大量的代码，尽量不要同时导入 mybatis 和 mybatis- plus!版本的差异!</p>
<p class="component-content component">5、连接数据库!这一步和 mybatis 相同!</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span># mysql 5 驱动不同 com.mysql.jdbc.Driver
</span></span><span style="display:flex;"><span># mysql 8 驱动不同com.mysql.cj.jdbc.Driver、需要增加时区的配置 serverTimezone=GMT%2B8
</span></span><span style="display:flex;"><span>spring.datasource.username=root
</span></span><span style="display:flex;"><span>spring.datasource.password=123456 spring.datasource.url=jdbc:mysql://localhost:3306/mybatis_plus? useSSL=false<span style="color:#960050;background-color:#1e0010">&amp;</span>useUnicode=true<span style="color:#960050;background-color:#1e0010">&amp;</span>characterEncoding=utf-8<span style="color:#960050;background-color:#1e0010">&amp;</span>serverTimezone=GMT%2B8 spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span></span></code></pre></div></div>
  
</div><p class="component-content component">传统方式pojo-dao(连接mybatis，配置mapper.xml文件)-service-controller</p>
<p class="component-content component">6、使用了mybatis-plus 之后</p>
<div class="component-content component"><ul>
<li>pojo</li>
</ul></div>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Data</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@AllArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@NoArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Long id<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String name<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Integer age<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String email<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><div class="component-content component"><ul>
<li>mapper接口</li>
</ul></div>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> com.kuang.mapper<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.kuang.pojo.User<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.springframework.stereotype.Repository<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 在对应的Mapper上面继承基本的类 BaseMapper
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Repository</span> <span style="color:#75715e">// 代表持久层
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserMapper</span> <span style="color:#66d9ef">extends</span> BaseMapper<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 所有的CRUD操作都已经编写完成了
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 你不需要像以前的配置一大堆文件了! }
</span></span></span></code></pre></div></div>
  
</div><div class="component-content component"><ul>
<li>
<p class="component-content component">注意点，我们需要在主启动类上去扫描我们的mapper包下的所有接口</p>
<p class="component-content component"><code>@MapperScan(&quot;com.kuang.mapper&quot;)</code></p>
</li>
<li>
<p class="component-content component">测试类中测试</p>
</li>
</ul></div>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@SpringBootTest</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MybatisPlusApplicationTests</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 继承了BaseMapper，所有的方法都来自己父类 // 我们也可以编写自己的扩展方法! @Autowired
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> UserMapper userMapper<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">contextLoads</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 参数是一个 Wrapper ，条件构造器，这里我们先不用 null // 查询全部用户
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> users <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectList</span><span style="color:#f92672">(</span><span style="color:#66d9ef">null</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  users<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">::</span>println<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><div class="component-content component"><ul>
<li>结果</li>
</ul></div>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-2061c61eb919c506ba64255a1ae98ecd" id="lht2061c61eb919c506ba64255a1ae98ecd">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/3.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<blockquote>
<p class="component-content component">思考问题?</p>
</blockquote>
<p class="component-content component">1、SQL谁帮我们写的 ? MyBatis-Plus 都写好了</p>
<p class="component-content component">2、方法哪里来的? MyBatis-Plus 都写好了</p>

<div class="component-content pagebody component">
  <h2 id="3配置日志" class="pagebody-header">
    3、<strong>配置日志</strong>
  </h2>
</div><p class="component-content component">我们所有的sql现在是不可见的，我们希望知道它是怎么执行的，所以我们必须要看日志!</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#75715e"># 配置日志 </span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mybatis-plus.configuration.log-impl</span><span style="color:#f92672">=</span><span style="color:#e6db74">org.apache.ibatis.logging.stdout.StdOutImpl</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-45e0c4702b8b1b8d785ae5e7a4d1a2f1" id="lht45e0c4702b8b1b8d785ae5e7a4d1a2f1">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/4.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">配置完毕日志之后，后面的学习就需要注意这个自动生成的SQL.</p>

<div class="component-content pagebody component">
  <h2 id="4crud扩展" class="pagebody-header">
    4、<strong>CRUD</strong>扩展
  </h2>
</div>
<div class="component-content pagebody component">
  <h3 id="41插入操作" class="pagebody-header">
    4.1、<strong>插入操作</strong>
  </h3>
</div><blockquote>
<p class="component-content component">Insert 插入</p>
</blockquote>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 测试插入
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testInsert</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>  User user <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> User<span style="color:#f92672">();</span> 
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span><span style="color:#a6e22e">setName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Tomcatist&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span><span style="color:#a6e22e">setAge</span><span style="color:#f92672">(</span><span style="color:#ae81ff">3</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span><span style="color:#a6e22e">setEmail</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;321672102@qq.com&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> result <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">insert</span><span style="color:#f92672">(</span>user<span style="color:#f92672">);</span> <span style="color:#75715e">// 帮我们自动生成id 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>result<span style="color:#f92672">);</span> <span style="color:#75715e">// 受影响的行数 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>user<span style="color:#f92672">);</span> <span style="color:#75715e">// 发现，id会自动回填
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-6c90684289c3c5df36cd34e9628b5e61" id="lht6c90684289c3c5df36cd34e9628b5e61">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/5.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<blockquote>
<p class="component-content component">数据库插入的id的默认值为:全局的唯一id</p>
</blockquote>

<div class="component-content pagebody component">
  <h3 id="42主键生成策略" class="pagebody-header">
    4.2、<strong>主键生成策略</strong>
  </h3>
</div><blockquote>
<p class="component-content component">默认 ID_WORKER 全局唯一id</p>
</blockquote>
<p class="component-content component">分布式系统唯一id生成:https://www.cnblogs.com/haoxinyue/p/5208136.html</p>
<p class="component-content component"><strong>雪花算法:</strong></p>
<p class="component-content component">snowflake是Twitter开源的分布式ID生成算法，结果是一个long型的ID。其核心思想是:使用41bit作为 毫秒数，10bit作为机器的ID(5个bit是数据中心，5个bit的机器ID)，12bit作为毫秒内的流水号(意味 着每个节点在每毫秒可以产生 4096 个 ID)，最后还有一个符号位，永远是0。可以保证几乎全球唯 一!</p>
<blockquote>
<p class="component-content component">主键自增</p>
</blockquote>
<p class="component-content component">我们需要配置主键自增:</p>
<p class="component-content component">1、实体类字段上 <code>@TableId(type = IdType.AUTO)</code></p>
<p class="component-content component">2、数据库字段一定要是自增!</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-4961104d3bb06e6fff0d0e99976e92d6" id="lht4961104d3bb06e6fff0d0e99976e92d6">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/6.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">3、再次测试插入即可!</p>
<blockquote>
<p class="component-content component">其与的源码解释</p>
</blockquote>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">enum</span> IdType <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>AUTO<span style="color:#f92672">(</span><span style="color:#ae81ff">0</span><span style="color:#f92672">),</span> <span style="color:#75715e">// 数据库id自增
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>NONE<span style="color:#f92672">(</span><span style="color:#ae81ff">1</span><span style="color:#f92672">),</span> <span style="color:#75715e">// 未设置主键
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>INPUT<span style="color:#f92672">(</span><span style="color:#ae81ff">2</span><span style="color:#f92672">),</span> <span style="color:#75715e">// 手动输入
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ID_WORKER<span style="color:#f92672">(</span><span style="color:#ae81ff">3</span><span style="color:#f92672">),</span> <span style="color:#75715e">// 默认的全局唯一id
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>UUID<span style="color:#f92672">(</span><span style="color:#ae81ff">4</span><span style="color:#f92672">),</span> <span style="color:#75715e">// 全局唯一id uuid ID_WORKER_STR(5); //ID_WORKER 字符串表示法
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="43更新操作" class="pagebody-header">
    4.3、<strong>更新操作</strong>
  </h3>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 测试更新
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testUpdate</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>	User user <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> User<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 通过条件自动拼接动态
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  sql user<span style="color:#f92672">.</span><span style="color:#a6e22e">setId</span><span style="color:#f92672">(</span><span style="color:#ae81ff">6L</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span><span style="color:#a6e22e">setName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Tomcatist&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span><span style="color:#a6e22e">setAge</span><span style="color:#f92672">(</span><span style="color:#ae81ff">18</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 注意:updateById 但是参数是一个对象! 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">updateById</span><span style="color:#f92672">(</span>user<span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>i<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">所有的sql都是自动帮你动态配置的!</p>

<div class="component-content pagebody component">
  <h3 id="44自动填充" class="pagebody-header">
    4.4、<strong>自动填充</strong>
  </h3>
</div><p class="component-content component">创建时间、修改时间!这些个操作一遍都是自动化完成的，我们不希望手动更新!</p>
<p class="component-content component">阿里巴巴开发手册:所有的数据库表:gmt_create、gmt_modified几乎所有的表都要配置上!而且需 要自动化!</p>
<blockquote>
<p class="component-content component">方式一:数据库级别(工作中不允许你修改数据库)</p>
</blockquote>
<p class="component-content component">1、在表中新增字段 create_time, update_time</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-507e237bfed561ed3d10ef1c56d9fe28" id="lht507e237bfed561ed3d10ef1c56d9fe28">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/7.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">2、再次测试插入方法，我们需要先把实体类同步!</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> <span style="color:#66d9ef">private</span> Date createTime<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">private</span> Date updateTime<span style="color:#f92672">;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">3、再次更新查看结果即可</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-6f9e45622c0dc9f8ec29f009614bcff7" id="lht6f9e45622c0dc9f8ec29f009614bcff7">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/8.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<blockquote>
<p class="component-content component">方式二:代码级别</p>
</blockquote>
<p class="component-content component">1、删除数据库的默认值、更新操作!</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-732b246827826834b6ae7d5da280df6c" id="lht732b246827826834b6ae7d5da280df6c">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/9.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">2、实体类字段属性上需要增加注解</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 字段添加填充内容
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@TableField</span><span style="color:#f92672">(</span>fill <span style="color:#f92672">=</span> FieldFill<span style="color:#f92672">.</span><span style="color:#a6e22e">INSERT</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Date createTime<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@TableField</span><span style="color:#f92672">(</span>fill <span style="color:#f92672">=</span> FieldFill<span style="color:#f92672">.</span><span style="color:#a6e22e">INSERT_UPDATE</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Date updateTime<span style="color:#f92672">;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">3、编写处理器来处理这个注解即可!</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> com.kuang.handler<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.core.handlers.MetaObjectHandler<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> lombok.extern.slf4j.Slf4j<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.ibatis.reflection.MetaObject<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.springframework.stereotype.Component<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.Date<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Slf4j</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Component</span> <span style="color:#75715e">// 一定不要忘记把处理器加到IOC容器中!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyMetaObjectHandler</span> <span style="color:#66d9ef">implements</span> MetaObjectHandler <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 插入时的填充策略
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">insertFill</span><span style="color:#f92672">(</span>MetaObject metaObject<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        log<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;start insert fill.....&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// setFieldValByName(String fieldName, Object fieldVal, MetaObject
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>metaObject
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">setFieldValByName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;createTime&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">(),</span>metaObject<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">setFieldValByName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;updateTime&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">(),</span>metaObject<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 更新时的填充策略
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">updateFill</span><span style="color:#f92672">(</span>MetaObject metaObject<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        log<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;start update fill.....&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">setFieldValByName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;updateTime&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">(),</span>metaObject<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">4、测试插入</p>
<p class="component-content component">5、测试更新、观察时间即可!</p>

<div class="component-content pagebody component">
  <h3 id="45乐观锁" class="pagebody-header">
    4.5、<strong>乐观锁</strong>
  </h3>
</div><blockquote>
<p class="component-content component">乐观锁 : 故名思意十分乐观，它总是认为不会出现问题，无论干什么不去上锁!如果出现了问题， 再次更新值测试</p>
<p class="component-content component">悲观锁:故名思意十分悲观，它总是认为总是出现问题，无论干什么都会上锁!再去操作!</p>
</blockquote>
<p class="component-content component">我们这里主要讲解 乐观锁机制! 乐观锁实现方式:</p>
<div class="component-content component"><ul>
<li>
<p class="component-content component">取出记录时，获取当前 version</p>
</li>
<li>
<p class="component-content component">更新时，带上这个version</p>
</li>
<li>
<p class="component-content component">执行更新时， set version = newVersion where version = oldVersion</p>
</li>
<li>
<p class="component-content component">如果version不对，就更新失败</p>
</li>
</ul></div>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>乐观锁:<span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">、</span>先查询<span style="color:#960050;background-color:#1e0010">，</span>获得版本号 version <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">--</span> A
</span></span><span style="display:flex;"><span>update user set name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tomcatist&#34;</span><span style="color:#f92672">,</span> version <span style="color:#f92672">=</span> version <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> where id <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> and version <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">--</span> B 线程抢先完成<span style="color:#960050;background-color:#1e0010">，</span>这个时候 version <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">，</span>会导致 A 修改失败<span style="color:#f92672">!</span> update user set name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tomcatist&#34;</span><span style="color:#f92672">,</span> version <span style="color:#f92672">=</span> version <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> where id <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> and version <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span></span></span></code></pre></div></div>
  
</div><blockquote>
<p class="component-content component">测试一下MP的乐观锁插件</p>
</blockquote>
<p class="component-content component">1、给数据库中增加version字段!</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-8d725823d1aa20ba690cb6131b1a6f2e" id="lht8d725823d1aa20ba690cb6131b1a6f2e">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/10.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">2、我们实体类加对应的字段</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> <span style="color:#a6e22e">@Version</span> <span style="color:#75715e">//乐观锁Version注解 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#66d9ef">private</span> Integer version<span style="color:#f92672">;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">3、注册组件</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 扫描我们的 mapper 文件夹 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@MapperScan</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;com.kuang.mapper&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@EnableTransactionManagement</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Configuration</span> <span style="color:#75715e">// 配置类
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyBatisPlusConfig</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 注册乐观锁插件
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> OptimisticLockerInterceptor <span style="color:#a6e22e">optimisticLockerInterceptor</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> OptimisticLockerInterceptor<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">4、测试一下!</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 测试乐观锁成功!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testOptimisticLocker</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// 1、查询用户信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  User user <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectById</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1L</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 2、修改用户信息 user.setName(&#34;kuangshen&#34;); 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  user<span style="color:#f92672">.</span><span style="color:#a6e22e">setEmail</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;24736743@qq.com&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 3、执行更新操作 userMapper.updateById(user);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 测试乐观锁失败!多线程下
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testOptimisticLocker2</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 线程 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  User user <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectById</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1L</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span><span style="color:#a6e22e">setName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;kuangshen111&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">.</span><span style="color:#a6e22e">setEmail</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;24736743@qq.com&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 模拟另外一个线程执行了插队操作
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	User user2 <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectById</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1L</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  user2<span style="color:#f92672">.</span><span style="color:#a6e22e">setName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;kuangshen222&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  user2<span style="color:#f92672">.</span><span style="color:#a6e22e">setEmail</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;24736743@qq.com&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">updateById</span><span style="color:#f92672">(</span>user2<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 自旋锁来多次尝试提交!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">updateById</span><span style="color:#f92672">(</span>user<span style="color:#f92672">);</span> <span style="color:#75715e">// 如果没有乐观锁就会覆盖插队线程的值! }
</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-7aa388064e6fcaf4400dda15cb32852b" id="lht7aa388064e6fcaf4400dda15cb32852b">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/11.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h3 id="46查询操作" class="pagebody-header">
    4.6、<strong>查询操作</strong>
  </h3>
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 测试查询
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSelectById</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>    User user <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectById</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1L</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>user<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 测试批量查询!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSelectByBatchId</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>    List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> users <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectBatchIds</span><span style="color:#f92672">(</span>Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">asList</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>    users<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">::</span>println<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 按条件查询之一使用map操作
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSelectByBatchIds</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>HashMap<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;</span> map <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;();</span> <span style="color:#75715e">// 自定义要查询
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>map<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;狂神说Java&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>map<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">,</span><span style="color:#ae81ff">3</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> users <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectByMap</span><span style="color:#f92672">(</span>map<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    users<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">::</span>println<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="47分页查询" class="pagebody-header">
    4.7、<strong>分页查询</strong>
  </h3>
</div><p class="component-content component">1、原始的 limit 进行分页</p>
<p class="component-content component">2、pageHelper 第三方插件</p>
<p class="component-content component">3、MP 其实也内置了分页插件!</p>
<blockquote>
<p class="component-content component">如何使用!</p>
</blockquote>
<p class="component-content component">1、配置拦截器组件即可</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 分页插件
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> PaginationInterceptor <span style="color:#a6e22e">paginationInterceptor</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>  <span style="color:#66d9ef">new</span> PaginationInterceptor<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">2、直接使用Page对象即可!</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 测试分页查询
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testPage</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 参数一:当前页
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 参数二:页面大小
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 使用了分页插件之后，所有的分页操作也变得简单的! 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Page<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> page <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Page<span style="color:#f92672">&lt;&gt;(</span><span style="color:#ae81ff">2</span><span style="color:#f92672">,</span><span style="color:#ae81ff">5</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>    userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectPage</span><span style="color:#f92672">(</span>page<span style="color:#f92672">,</span><span style="color:#66d9ef">null</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    page<span style="color:#f92672">.</span><span style="color:#a6e22e">getRecords</span><span style="color:#f92672">().</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">::</span>println<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>page<span style="color:#f92672">.</span><span style="color:#a6e22e">getTotal</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="48删除操作" class="pagebody-header">
    4.8、<strong>删除操作</strong>
  </h3>
</div><p class="component-content component">1、根据 id 删除记录</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 测试删除
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testDeleteById</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>    userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">deleteById</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1240620674645544965L</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 通过id批量删除
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testDeleteBatchId</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span> 		userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">deleteBatchIds</span><span style="color:#f92672">(</span>Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">asList</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1240620674645544961L</span><span style="color:#f92672">,</span><span style="color:#ae81ff">124062067464554496</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2L</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 通过map删除
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testDeleteMap</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>	HashMap<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;</span> map <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;();</span> 
</span></span><span style="display:flex;"><span>  map<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;狂神说Java&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">deleteByMap</span><span style="color:#f92672">(</span>map<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">我们在工组中会遇到一些问题:逻辑删除!</p>

<div class="component-content pagebody component">
  <h3 id="49逻辑删除" class="pagebody-header">
    4.9、<strong>逻辑删除</strong>
  </h3>
</div><blockquote>
<p class="component-content component">物理删除 :从数据库中直接移除
逻辑删除 :再数据库中没有被移除，而是通过一个变量来让他失效! deleted = 0 =&gt; deleted = 1s</p>
</blockquote>
<p class="component-content component">管理员可以查看被删除的记录!防止数据的丢失，类似于回收站!</p>
<p class="component-content component">测试一下:</p>
<p class="component-content component">1、在数据表中增加一个 deleted 字段</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-9e300cdc65670997b6983742aaed120e" id="lht9e300cdc65670997b6983742aaed120e">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/12.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">2、实体类中增加属性</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> <span style="color:#a6e22e">@TableLogic</span> <span style="color:#75715e">//逻辑删除 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#66d9ef">private</span> Integer deleted<span style="color:#f92672">;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">3、配置!</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 逻辑删除组件!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> ISqlInjector <span style="color:#a6e22e">sqlInjector</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> LogicSqlInjector<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#75715e"># 配置逻辑删除 </span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mybatis-plus.global-config.db-config.logic-delete-value</span><span style="color:#f92672">=</span><span style="color:#e6db74">1 </span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mybatis-plus.global-config.db-config.logic-not-delete-value</span><span style="color:#f92672">=</span><span style="color:#e6db74">0</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">4、测试一下删除!</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-f5de2d59fea2dcbe46a1f7bd4402de5c" id="lhtf5de2d59fea2dcbe46a1f7bd4402de5c">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/13.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">记录依旧在数据库，但是值确已经变化了!</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-f68823c5ce7abd21f6a81f48d42e7411" id="lhtf68823c5ce7abd21f6a81f48d42e7411">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/14.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">以上的所有CRUD操作及其扩展操作，我们都必须精通掌握!会大大提高你的工作和写项目的效率!</p>

<div class="component-content pagebody component">
  <h3 id="410性能分析插件" class="pagebody-header">
    4.10、<strong>性能分析插件</strong>
  </h3>
</div><p class="component-content component">我们在平时的开发中，会遇到一些慢sql。测试! druid,,,,,</p>
<p class="component-content component">作用:性能分析拦截器，用于输出每条 SQL 语句及其执行时间 MP也提供性能分析插件，如果超过这个时间就停止运行!</p>
<p class="component-content component">1、导入插件</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">* SQL执行效率插件
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Profile</span><span style="color:#f92672">({</span><span style="color:#e6db74">&#34;dev&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;test&#34;</span><span style="color:#f92672">})</span><span style="color:#75715e">// 设置 dev test 环境开启，保证我们的效率 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> PerformanceInterceptor <span style="color:#a6e22e">performanceInterceptor</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    PerformanceInterceptor performanceInterceptor <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span>
</span></span><span style="display:flex;"><span>PerformanceInterceptor<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		performanceInterceptor<span style="color:#f92672">.</span><span style="color:#a6e22e">setMaxTime</span><span style="color:#f92672">(</span><span style="color:#ae81ff">100</span><span style="color:#f92672">);</span> <span style="color:#75715e">// ms设置sql执行的最大时间，如果超过了则不 执行
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		performanceInterceptor<span style="color:#f92672">.</span><span style="color:#a6e22e">setFormat</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span> <span style="color:#75715e">// 是否格式化代码
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	<span style="color:#66d9ef">return</span> performanceInterceptor<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">记住，要在SpringBoot中配置环境为dev或者 test 环境!</p>
<p class="component-content component">2、测试使用!</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">contextLoads</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 参数是一个 Wrapper ，条件构造器，这里我们先不用 null 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// 查询全部用户
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> users <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectList</span><span style="color:#f92672">(</span><span style="color:#66d9ef">null</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>  users<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">::</span>println<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-6675256a35730bb4927fbeb546d85f0a" id="lht6675256a35730bb4927fbeb546d85f0a">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/15.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">使用性能分析插件，可以帮助我们提高效率!</p>

<div class="component-content pagebody component">
  <h3 id="411条件构造器" class="pagebody-header">
    4.11、<strong>条件构造器</strong>
  </h3>
</div><p class="component-content component">十分重要:Wrapper</p>
<p class="component-content component">我们写一些复杂的sql就可以使用它来替代!</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-c011e50f7d51375cfea955c656567fdc" id="lhtc011e50f7d51375cfea955c656567fdc">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/16.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">1、测试一，记住查看输出的SQL进行分析</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">contextLoads</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 查询name不为空的用户，并且邮箱不为空的用户，年龄大于等于12 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  	QueryWrapper<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> wrapper <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> QueryWrapper<span style="color:#f92672">&lt;&gt;();</span> 
</span></span><span style="display:flex;"><span>    wrapper
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span><span style="color:#a6e22e">isNotNull</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span><span style="color:#a6e22e">isNotNull</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;email&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span><span style="color:#a6e22e">ge</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">,</span><span style="color:#ae81ff">12</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectList</span><span style="color:#f92672">(</span>wrapper<span style="color:#f92672">).</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">::</span>println<span style="color:#f92672">);</span> <span style="color:#75715e">// 和我们刚才学习 的map对比一下
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">2、测试二，记住查看输出的SQL进行分析</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test2</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 查询名字tom
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  QueryWrapper<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> wrapper <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> QueryWrapper<span style="color:#f92672">&lt;&gt;();</span> 
</span></span><span style="display:flex;"><span>  wrapper<span style="color:#f92672">.</span><span style="color:#a6e22e">eq</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;tom&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  User user <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectOne</span><span style="color:#f92672">(</span>wrapper<span style="color:#f92672">);</span> <span style="color:#75715e">// 查询一个数据，出现多个结果使用List或者 Map 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>user<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">3、测试三，记住查看输出的SQL进行分析</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test3</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 查询年龄在 20 ~ 30 岁之间的用户
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  QueryWrapper<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> wrapper <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> QueryWrapper<span style="color:#f92672">&lt;&gt;();</span> 
</span></span><span style="display:flex;"><span>  wrapper<span style="color:#f92672">.</span><span style="color:#a6e22e">between</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">,</span><span style="color:#ae81ff">20</span><span style="color:#f92672">,</span><span style="color:#ae81ff">30</span><span style="color:#f92672">);</span> <span style="color:#75715e">// 区间
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  Integer count <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectCount</span><span style="color:#f92672">(</span>wrapper<span style="color:#f92672">);</span><span style="color:#75715e">// 查询结果数 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>count<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">4、测试四，记住查看输出的SQL进行分析</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 模糊查询 @Test
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test4</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 查询年龄在 20 ~ 30 岁之间的用户
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  QueryWrapper<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> wrapper <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> QueryWrapper<span style="color:#f92672">&lt;&gt;();</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 左和右 t%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  wrapper
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span><span style="color:#a6e22e">notLike</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;e&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span><span style="color:#a6e22e">likeRight</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;email&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;t&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>      List<span style="color:#f92672">&lt;</span>Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;&gt;</span> maps <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectMaps</span><span style="color:#f92672">(</span>wrapper<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>      maps<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">::</span>println<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">5、测试五,记住查看输出的SQL进行分析</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 模糊查询 @Test
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test5</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>  QueryWrapper<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> wrapper <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> QueryWrapper<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// id 在子查询中查出来
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  wrapper<span style="color:#f92672">.</span><span style="color:#a6e22e">inSql</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;select id from user where id&lt;3&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  List<span style="color:#f92672">&lt;</span>Object<span style="color:#f92672">&gt;</span> objects <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectObjs</span><span style="color:#f92672">(</span>wrapper<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  objects<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">::</span>println<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">6、测试六，记住查看输出的SQL进行分析</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">//测试六
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test6</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>  QueryWrapper<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> wrapper <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> QueryWrapper<span style="color:#f92672">&lt;&gt;();</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 通过id进行排序
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  wrapper<span style="color:#f92672">.</span><span style="color:#a6e22e">orderByAsc</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> users <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectList</span><span style="color:#f92672">(</span>wrapper<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  users<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">::</span>println<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">等等测试都类似！~</p>

<div class="component-content pagebody component">
  <h3 id="412代码自动生成器" class="pagebody-header">
    <strong>4.12</strong>、代码自动生成器
  </h3>
</div><p class="component-content component">dao、pojo、service、controller都给我自己去编写完成!</p>
<p class="component-content component">AutoGenerator 是 MyBatis-Plus 的代码生成器，通过 AutoGenerator 可以快速生成 Entity、Mapper、Mapper XML、Service、Controller 等各个模块的代码，极大的提升了开发效率。</p>
<p class="component-content component">测试:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> com.tom<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.annotation.DbType<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.annotation.FieldFill<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.annotation.IdType<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.annotation.TableField<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.generator.AutoGenerator<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.generator.config.DataSourceConfig<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.generator.config.GlobalConfig<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.generator.config.PackageConfig<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.generator.config.StrategyConfig<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.generator.config.po.TableFill<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.generator.config.rules.DateType<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.baomidou.mybatisplus.generator.config.rules.NamingStrategy<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.ArrayList<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 代码自动生成器
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TomCode</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// 需要构建一个 代码自动生成器 对象 AutoGenerator mpg = new AutoGenerator(); 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#75715e">// 配置策略
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// 1、全局配置
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		GlobalConfig gc <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> GlobalConfig<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		String projectPath <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">getProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;user.dir&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		gc<span style="color:#f92672">.</span><span style="color:#a6e22e">setOutputDir</span><span style="color:#f92672">(</span>projectPath<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/src/main/java&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		gc<span style="color:#f92672">.</span><span style="color:#a6e22e">setAuthor</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;狂神说&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		gc<span style="color:#f92672">.</span><span style="color:#a6e22e">setOpen</span><span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		gc<span style="color:#f92672">.</span><span style="color:#a6e22e">setFileOverride</span><span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">);</span> <span style="color:#75715e">// 是否覆盖 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		gc<span style="color:#f92672">.</span><span style="color:#a6e22e">setServiceName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;%sService&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">// 去Service的I前缀 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		gc<span style="color:#f92672">.</span><span style="color:#a6e22e">setIdType</span><span style="color:#f92672">(</span>IdType<span style="color:#f92672">.</span><span style="color:#a6e22e">ID_WORKER</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		gc<span style="color:#f92672">.</span><span style="color:#a6e22e">setDateType</span><span style="color:#f92672">(</span>DateType<span style="color:#f92672">.</span><span style="color:#a6e22e">ONLY_DATE</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		gc<span style="color:#f92672">.</span><span style="color:#a6e22e">setSwagger2</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		mpg<span style="color:#f92672">.</span><span style="color:#a6e22e">setGlobalConfig</span><span style="color:#f92672">(</span>gc<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">//2、设置数据源
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		DataSourceConfig dsc <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DataSourceConfig<span style="color:#f92672">();</span> 
</span></span><span style="display:flex;"><span>		dsc<span style="color:#f92672">.</span><span style="color:#a6e22e">setUrl</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;jdbc:mysql://localhost:3306/kuang_community?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT%2B8&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        dsc<span style="color:#f92672">.</span><span style="color:#a6e22e">setDriverName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        dsc<span style="color:#f92672">.</span><span style="color:#a6e22e">setUsername</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;root&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        dsc<span style="color:#f92672">.</span><span style="color:#a6e22e">setPassword</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;123456&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        dsc<span style="color:#f92672">.</span><span style="color:#a6e22e">setDbType</span><span style="color:#f92672">(</span>DbType<span style="color:#f92672">.</span><span style="color:#a6e22e">MYSQL</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        mpg<span style="color:#f92672">.</span><span style="color:#a6e22e">setDataSource</span><span style="color:#f92672">(</span>dsc<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">//3、包的配置
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		PackageConfig pc <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PackageConfig<span style="color:#f92672">();</span> 
</span></span><span style="display:flex;"><span>		pc<span style="color:#f92672">.</span><span style="color:#a6e22e">setModuleName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;blog&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		pc<span style="color:#f92672">.</span><span style="color:#a6e22e">setParent</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;com.kuang&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		pc<span style="color:#f92672">.</span><span style="color:#a6e22e">setEntity</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;entity&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		pc<span style="color:#f92672">.</span><span style="color:#a6e22e">setMapper</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;mapper&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		pc<span style="color:#f92672">.</span><span style="color:#a6e22e">setService</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;service&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		pc<span style="color:#f92672">.</span><span style="color:#a6e22e">setController</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;controller&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		mpg<span style="color:#f92672">.</span><span style="color:#a6e22e">setPackageInfo</span><span style="color:#f92672">(</span>pc<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">//4、策略配置
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		StrategyConfig strategy <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StrategyConfig<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		strategy<span style="color:#f92672">.</span><span style="color:#a6e22e">setInclude</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;blog_tags&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;course&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;links&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;sys_settings&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;user_record&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34; user_say&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">// 设置要映射的表名
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		strategy<span style="color:#f92672">.</span><span style="color:#a6e22e">setNaming</span><span style="color:#f92672">(</span>NamingStrategy<span style="color:#f92672">.</span><span style="color:#a6e22e">underline_to_camel</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		strategy<span style="color:#f92672">.</span><span style="color:#a6e22e">setColumnNaming</span><span style="color:#f92672">(</span>NamingStrategy<span style="color:#f92672">.</span><span style="color:#a6e22e">underline_to_camel</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		strategy<span style="color:#f92672">.</span><span style="color:#a6e22e">setEntityLombokModel</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span> <span style="color:#75715e">// 自动lombok;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		strategy<span style="color:#f92672">.</span><span style="color:#a6e22e">setLogicDeleteFieldName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;deleted&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// 自动填充配置
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		TableFill gmtCreate <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TableFill<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;gmt_create&#34;</span><span style="color:#f92672">,</span> FieldFill<span style="color:#f92672">.</span><span style="color:#a6e22e">INSERT</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		TableFill gmtModified <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TableFill<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;gmt_modified&#34;</span><span style="color:#f92672">,</span>FieldFill<span style="color:#f92672">.</span><span style="color:#a6e22e">INSERT_UPDATE</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		ArrayList<span style="color:#f92672">&lt;</span>TableFill<span style="color:#f92672">&gt;</span> tableFills <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span> 
</span></span><span style="display:flex;"><span>		tableFills<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>gmtCreate<span style="color:#f92672">);</span> tableFills<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>gmtModified<span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		strategy<span style="color:#f92672">.</span><span style="color:#a6e22e">setTableFillList</span><span style="color:#f92672">(</span>tableFills<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// 乐观锁
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		strategy<span style="color:#f92672">.</span><span style="color:#a6e22e">setVersionFieldName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;version&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		strategy<span style="color:#f92672">.</span><span style="color:#a6e22e">setRestControllerStyle</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		strategy<span style="color:#f92672">.</span><span style="color:#a6e22e">setControllerMappingHyphenStyle</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span> <span style="color:#75715e">//localhost:8080/hello_id_2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>		mpg<span style="color:#f92672">.</span><span style="color:#a6e22e">setStrategy</span><span style="color:#f92672">(</span>strategy<span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>		mpg<span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span> <span style="color:#75715e">//执行
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-8fdfb76ad8016b386836aaa9ff012e80" id="lht8fdfb76ad8016b386836aaa9ff012e80">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/mybatis_plus/17.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">这样全部都一键生成了 ！</p>

          </div><div class="component">
            <div class="component-content">
              <div class="article-copyright">
                <p class="content">
                  Copyright: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</a>
                </p>
                <p class="content">Author:   </p>
                <p class="content">Posted on:  November 24, 2021</p>
              </div>
            </div>
          </div></article>
      </section>
  </main>

  <script>
    var script = document.createElement("script");script.src = "https://yuanshuai1122.github.io/js/initPost.js";
    document.head.appendChild(script);
  </script>

    
    <div class="footer-main ">
  <div class="content-body footer-wraper">
    <div class="footer-box">
      <div class="foot-nav">
        <div class="foot-nav-items">
          <div class="item">
            <div class="logo"></div>
            <div class="email">Email: <a href="mailto:floyd.li@outlook.com">floyd.li@outlook.com</a></div>
          </div>

          <div class="item community">
            <div class="item-title">Social Media</div>
            
              <a href="https://github.com/floyd-li" target="_blank">Github</a>
            
          </div>

          <div class="item resources">
            <div class="item-title">Related</div>
            
              <a href="https://yufengbiji.com/" target="_blank">驭风笔记</a>
            
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="item copyright">
          &copy; 2023
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://github.com/floyd-li/hugo-theme-itheme" target="_blank">iTheme</a>
        </div>
      </div>
    </div>
  </div>
</div>

  </body>
    
    

    
    
</html>
