<!DOCTYPE html>
<html class="js no-touch  progressive-image  no-reduced-motion progressive" lang="en">
  <head>
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/img/favicon.ico">

    <meta name="keyword" content=""><meta property="og:title" content="Python数据分析之Pandas（二）" />
<meta property="og:description" content=": | &mdash;&mdash;&mdash;: | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;: | &mdash;&mdash;-: | | 0 | 2018-01-01 | 3℃ | -6℃ | 晴~多云 | 东北风 | 1-2级 | 59 | 良 | 2 | | 1 | 2018-01-02 | 2℃ | -5℃ | 阴~多云 | 东" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuanshuai1122.github.io/archives/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-26T21:53:10+00:00" />
<meta property="article:modified_time" content="2021-11-26T21:53:10+00:00" />
<title>Python数据分析之Pandas（二）</title>

    <link rel="canonical" href="/archives/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C/">

    <link rel="stylesheet" href="/css/global.css">

    <link rel="stylesheet" href="/css/custom.css">

    <link rel="stylesheet" href="/css/search.css" />

    
    

    
    

</head>
  </head>
  <body class=" page-article   ">
    <header>
      <nav class="nav">
  <div class="nav-wrapper">
    <div class="nav-content-wrapper">
      <div class="nav-content">
        <a href="/ " class="nav-title">iTheme</a>
        <div class="nav-menu">
          <div class="nav-item-wrapper">
            <a href="/posts " class="nav-item-content">Articles</a>
          </div><div class="nav-item-wrapper">
            <a href="/about" class="nav-item-content">About</a>
          </div><div class="nav-item-wrapper">
            <a href="/index.xml" class="nav-item-content" target="_blank">RSS</a>
          </div></div>
      </div>
    </div>
  </div>
</nav>

<script>
  function toggleSearchModal(){
    const template = `
    <div class="modal-body">
      <div id="autocomplete" onclick="event.stopPropagation();"></div>
    </div>
    `
    const modal = document.querySelector("#modal-wrapper")
    if(!modal){
      const div = document.createElement("div")
      document.body.setAttribute("style","overflow: hidden;")
      div.setAttribute("id", "modal-wrapper")
      div.setAttribute("onclick", "toggleSearchModal()")
      div.innerHTML = template
      const script = document.createElement("script");script.setAttribute("src", "https://yuanshuai1122.github.io/js/algolia.js")
      div.appendChild(script)
      document.body.append(div)
    } else {
      document.body.removeAttribute("style")
      document.body.removeChild(modal)
    }
  }
</script>
    </header>
    
  
  
  <main id="main" class="main">
      <section>
        <article class="article">
          
          <div class=" article-header ">
            <div class="category component">
              <div class="component-content">
                <div class="category-eyebrow">
                  <span class="category-eyebrow__category category_original">
                    
                      
                        Python
                      
                    
                  </span>
                  <span class="category-eyebrow__date">November 26, 2021</span>
                </div>
              </div>
            </div>
            <div class="pagetitle component">
              <div class="component-content">
                <h1 class="hero-headline">Python数据分析之Pandas（二）</h1>
              </div>
            </div>
            <div class="component  article-subhead ">
              <div class="component-content"></div>
            </div>

            <div class="tagssheet component">
              <div class="component-content">
                
                  
                  <a href="/tags/python" class="tag">
                    Python
                  </a>
                
                  
                  <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90" class="tag">
                    数据分析
                  </a>
                
              </div>
            </div>
          </div>
          
          <div class="pagebody">
            
            
            
            
            
            
            
            
            <p class="component-content component">: | &mdash;&mdash;&mdash;: | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;: | &mdash;&mdash;-: |
|    0 | 2018-01-01 |     3℃ |    -6℃ | 晴~多云 |    东北风 |  1-2级 |   59 |      良 |        2 |
|    1 | 2018-01-02 |     2℃ |    -5℃ | 阴~多云 |    东北风 |  1-2级 |   49 |      优 |        1 |
|    2 | 2018-01-03 |     2℃ |    -5℃ |    多云 |      北风 |  1-2级 |   28 |      优 |        1 |
|    3 | 2018-01-04 |     0℃ |    -8℃ |      阴 |    东北风 |  1-2级 |   28 |      优 |        1 |
|    4 | 2018-01-05 |     3℃ |    -6℃ | 多云~晴 |    西北风 |  1-2级 |   50 |      优 |        1 |</p>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>dtypes</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ymd          object
</span></span><span style="display:flex;"><span>bWendu       object
</span></span><span style="display:flex;"><span>yWendu       object
</span></span><span style="display:flex;"><span>tianqi       object
</span></span><span style="display:flex;"><span>fengxiang    object
</span></span><span style="display:flex;"><span>fengli       object
</span></span><span style="display:flex;"><span>aqi           int64
</span></span><span style="display:flex;"><span>aqiInfo      object
</span></span><span style="display:flex;"><span>aqiLevel      int64
</span></span><span style="display:flex;"><span>dtype: object</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="1获取series的str属性使用各种字符串处理函数" class="pagebody-header">
    1、获取Series的str属性，使用各种字符串处理函数
  </h3>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>pandas<span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>strings<span style="color:#f92672">.</span>StringMethods at <span style="color:#ae81ff">0x1af21871808</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 字符串替换函数</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;℃&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>       <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>       <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">..</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Name: bWendu, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 判断是不是数字</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>isnumeric()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">...</span>  
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>Name: bWendu, Length: <span style="color:#ae81ff">365</span>, dtype: bool</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;aqi&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>len()
</span></span><span style="display:flex;"><span><span style="color:#f92672">---------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AttributeError</span>                            Traceback (most recent call last)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>ipython<span style="color:#f92672">-</span>input<span style="color:#f92672">-</span><span style="color:#ae81ff">8</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>cdcbdb6f81<span style="color:#f92672">&gt;</span> <span style="color:#f92672">in</span> <span style="color:#f92672">&lt;</span>module<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">----&gt;</span> <span style="color:#ae81ff">1</span> df[<span style="color:#e6db74">&#34;aqi&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>len()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d:\appdata\python37\lib\site<span style="color:#f92672">-</span>packages\pandas\core\generic<span style="color:#f92672">.</span>py <span style="color:#f92672">in</span> __getattr__(self, name)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5173</span>             <span style="color:#f92672">or</span> name <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_accessors
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5174</span>         ):
</span></span><span style="display:flex;"><span><span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">5175</span>             <span style="color:#66d9ef">return</span> object<span style="color:#f92672">.</span>__getattribute__(self, name)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5176</span>         <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5177</span>             <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>_info_axis<span style="color:#f92672">.</span>_can_hold_identifiers_and_holds_name(name):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d:\appdata\python37\lib\site<span style="color:#f92672">-</span>packages\pandas\core\accessor<span style="color:#f92672">.</span>py <span style="color:#f92672">in</span> __get__(self, obj, cls)
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">173</span>             <span style="color:#75715e"># we&#39;re accessing the attribute of the class, i.e., Dataset.geo</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">174</span>             <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_accessor
</span></span><span style="display:flex;"><span><span style="color:#f92672">--&gt;</span> <span style="color:#ae81ff">175</span>         accessor_obj <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_accessor(obj)
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">176</span>         <span style="color:#75715e"># Replace the property with the accessor object. Inspired by:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">177</span>         <span style="color:#75715e"># http://www.pydanny.com/cached-property.html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d:\appdata\python37\lib\site<span style="color:#f92672">-</span>packages\pandas\core\strings<span style="color:#f92672">.</span>py <span style="color:#f92672">in</span> __init__(self, data)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1915</span> 
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1916</span>     <span style="color:#66d9ef">def</span> __init__(self, data):
</span></span><span style="display:flex;"><span><span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">1917</span>         self<span style="color:#f92672">.</span>_inferred_dtype <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_validate(data)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1918</span>         self<span style="color:#f92672">.</span>_is_categorical <span style="color:#f92672">=</span> is_categorical_dtype(data)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1919</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d:\appdata\python37\lib\site<span style="color:#f92672">-</span>packages\pandas\core\strings<span style="color:#f92672">.</span>py <span style="color:#f92672">in</span> _validate(data)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1965</span> 
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1966</span>         <span style="color:#66d9ef">if</span> inferred_dtype <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> allowed_types:
</span></span><span style="display:flex;"><span><span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">1967</span>             <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">AttributeError</span>(<span style="color:#e6db74">&#34;Can only use .str accessor with string &#34;</span> <span style="color:#e6db74">&#34;values!&#34;</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1968</span>         <span style="color:#66d9ef">return</span> inferred_dtype
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1969</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AttributeError</span>: Can only use <span style="color:#f92672">.</span>str accessor <span style="color:#66d9ef">with</span> string values<span style="color:#960050;background-color:#1e0010">!</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="2使用str的startswithcontains等得到bool的series可以做条件查询" class="pagebody-header">
    2、使用str的startswith、contains等得到bool的Series可以做条件查询
  </h3>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>condition <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#34;2018-03&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>condition</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">...</span>  
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>Name: ymd, Length: <span style="color:#ae81ff">365</span>, dtype: bool</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[condition]<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">59</td>
<td style="text-align:right">2018-03-01</td>
<td style="text-align:right">8℃</td>
<td style="text-align:right">-3℃</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">西南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">46</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">60</td>
<td style="text-align:right">2018-03-02</td>
<td style="text-align:right">9℃</td>
<td style="text-align:right">-1℃</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">95</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">61</td>
<td style="text-align:right">2018-03-03</td>
<td style="text-align:right">13℃</td>
<td style="text-align:right">3℃</td>
<td style="text-align:right">多云~阴</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">214</td>
<td style="text-align:right">重度污染</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">62</td>
<td style="text-align:right">2018-03-04</td>
<td style="text-align:right">7℃</td>
<td style="text-align:right">-2℃</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">东南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">144</td>
<td style="text-align:right">轻度污染</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">63</td>
<td style="text-align:right">2018-03-05</td>
<td style="text-align:right">8℃</td>
<td style="text-align:right">-3℃</td>
<td style="text-align:right">晴</td>
<td style="text-align:right">南风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">94</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3需要多次str处理的链式操作" class="pagebody-header">
    3、需要多次str处理的链式操作
  </h3>
</div><p class="component-content component">怎样提取201803这样的数字月份？
1、先将日期2018-03-31替换成20180331的形式
2、提取月份字符串201803</p>
<p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">20180101</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">20180102</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">20180103</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">20180104</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">20180105</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">...</span>   
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">20181227</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">20181228</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">20181229</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">20181230</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">20181231</span>
</span></span><span style="display:flex;"><span>Name: ymd, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 每次调用函数，都返回一个新Series</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>slice(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">---------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AttributeError</span>                            Traceback (most recent call last)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>ipython<span style="color:#f92672">-</span>input<span style="color:#f92672">-</span><span style="color:#ae81ff">13</span><span style="color:#f92672">-</span>ae278fb12255<span style="color:#f92672">&gt;</span> <span style="color:#f92672">in</span> <span style="color:#f92672">&lt;</span>module<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">1</span> <span style="color:#75715e"># 每次调用函数，都返回一个新Series</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">----&gt;</span> <span style="color:#ae81ff">2</span> df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>slice(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d:\appdata\python37\lib\site<span style="color:#f92672">-</span>packages\pandas\core\generic<span style="color:#f92672">.</span>py <span style="color:#f92672">in</span> __getattr__(self, name)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5177</span>             <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>_info_axis<span style="color:#f92672">.</span>_can_hold_identifiers_and_holds_name(name):
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5178</span>                 <span style="color:#66d9ef">return</span> self[name]
</span></span><span style="display:flex;"><span><span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">5179</span>             <span style="color:#66d9ef">return</span> object<span style="color:#f92672">.</span>__getattribute__(self, name)
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5180</span> 
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5181</span>     <span style="color:#66d9ef">def</span> __setattr__(self, name, value):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AttributeError</span>: <span style="color:#e6db74">&#39;Series&#39;</span> object has no attribute <span style="color:#e6db74">&#39;slice&#39;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>slice(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>  
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span>Name: ymd, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># slice就是切片语法，可以直接用</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>str[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">6</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">201801</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>  
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">201812</span>
</span></span><span style="display:flex;"><span>Name: ymd, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="4-使用正则表达式的处理" class="pagebody-header">
    4. 使用正则表达式的处理
  </h3>
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 添加新列</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_nianyueri</span>(x):
</span></span><span style="display:flex;"><span>    year,month,day <span style="color:#f92672">=</span> x[<span style="color:#e6db74">&#34;ymd&#34;</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>year<span style="color:#e6db74">}</span><span style="color:#e6db74">年</span><span style="color:#e6db74">{</span>month<span style="color:#e6db74">}</span><span style="color:#e6db74">月</span><span style="color:#e6db74">{</span>day<span style="color:#e6db74">}</span><span style="color:#e6db74">日&#34;</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;中文日期&#34;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>apply(get_nianyueri, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;中文日期&#34;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">2018</span>年01月01日
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">2018</span>年01月02日
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">2018</span>年01月03日
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">2018</span>年01月04日
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">2018</span>年01月05日
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">...</span>     
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">2018</span>年12月27日
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">2018</span>年12月28日
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">2018</span>年12月29日
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">2018</span>年12月30日
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">2018</span>年12月31日
</span></span><span style="display:flex;"><span>Name: 中文日期, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">问题：怎样将“2018年12月31日”中的年、月、日三个中文字符去除？</p>
<p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 方法1：链式replace</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;中文日期&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;年&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;月&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;日&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">20180101</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">20180102</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">20180103</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">20180104</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">20180105</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">...</span>   
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">20181227</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">20181228</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">20181229</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">20181230</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">20181231</span>
</span></span><span style="display:flex;"><span>Name: 中文日期, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">*<strong>Series.str默认就开启了正则表达式模式*</strong></p>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 方法2：正则表达式替换</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;中文日期&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;[年月日]&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">20180101</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">20180102</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">20180103</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">20180104</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>      <span style="color:#ae81ff">20180105</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">...</span>   
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">360</span>    <span style="color:#ae81ff">20181227</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">361</span>    <span style="color:#ae81ff">20181228</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">362</span>    <span style="color:#ae81ff">20181229</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span>    <span style="color:#ae81ff">20181230</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">364</span>    <span style="color:#ae81ff">20181231</span>
</span></span><span style="display:flex;"><span>Name: 中文日期, Length: <span style="color:#ae81ff">365</span>, dtype: object</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="11pandas的axis参数怎么理解" class="pagebody-header">
    11、Pandas的axis参数怎么理解？
  </h2>
</div><div class="component-content component"><ul>
<li>
<p class="component-content component">axis=0或者&quot;index&quot;：</p>
<div class="component-content component"><ul>
<li>如果是单行操作，就指的是某一行</li>
<li>如果是聚合操作，指的是跨行cross rows</li>
</ul></div>
</li>
<li>
<p class="component-content component">axis=1或者&quot;columns&quot;：</p>
<div class="component-content component"><ul>
<li>
<p class="component-content component">如果是单列操作，就指的是某一列</p>
</li>
<li>
<p class="component-content component">如果是聚合操作，指的是跨列cross columns</p>
<p class="component-content component">*<strong>按哪个axis，就是这个axis要动起来(类似被for遍历)，其它的axis保持不动*</strong></p>
</li>
</ul></div>
</li>
</ul></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(
</span></span><span style="display:flex;"><span>    np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">12</span>)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>),
</span></span><span style="display:flex;"><span>    columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#e6db74">&#39;C&#39;</span>, <span style="color:#e6db74">&#39;D&#39;</span>]
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">df</code></pre>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="1单列drop就是删除某一列" class="pagebody-header">
    1、单列drop，就是删除某一列
  </h3>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 代表的就是删除某列</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#34;A&#34;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2单行drop就是删除某一行" class="pagebody-header">
    2、单行drop，就是删除某一行
  </h3>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 代表的就是删除某行</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>drop(<span style="color:#ae81ff">1</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3按axis0index执行mean聚合操作" class="pagebody-header">
    3、按axis=0/index执行mean聚合操作
  </h3>
</div><p class="component-content component">反直觉：输出的不是每行的结果，而是每列的结果</p>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># axis=0 or axis=index</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>mean(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>A    <span style="color:#ae81ff">4.0</span>
</span></span><span style="display:flex;"><span>B    <span style="color:#ae81ff">5.0</span>
</span></span><span style="display:flex;"><span>C    <span style="color:#ae81ff">6.0</span>
</span></span><span style="display:flex;"><span>D    <span style="color:#ae81ff">7.0</span>
</span></span><span style="display:flex;"><span>dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-0d3748140e02aa43fef144f522b8e753" id="lht0d3748140e02aa43fef144f522b8e753">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/1.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">*<strong>指定了按哪个axis，就是这个axis要动起来(类似被for遍历)，其它的axis保持不动*</strong></p>

<div class="component-content pagebody component">
  <h3 id="4按axis1columns执行mean聚合操作" class="pagebody-header">
    4、按axis=1/columns执行mean聚合操作
  </h3>
</div><p class="component-content component">反直觉：输出的不是每行的结果，而是每列的结果</p>
<p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># axis=1 or axis=columns</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>mean(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">5.5</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    <span style="color:#ae81ff">9.5</span>
</span></span><span style="display:flex;"><span>dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-b83d0af3985d1aca5b3ff0677fbd7803" id="lhtb83d0af3985d1aca5b3ff0677fbd7803">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/2.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">*<strong>指定了按哪个axis，就是这个axis要动起来(类似被for遍历)，其它的axis保持不动*</strong></p>

<div class="component-content pagebody component">
  <h3 id="5再次举例加深理解" class="pagebody-header">
    5、再次举例，加深理解
  </h3>
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_sum_value</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x[<span style="color:#e6db74">&#34;A&#34;</span>] <span style="color:#f92672">+</span> x[<span style="color:#e6db74">&#34;B&#34;</span>] <span style="color:#f92672">+</span> x[<span style="color:#e6db74">&#34;C&#34;</span>] <span style="color:#f92672">+</span> x[<span style="color:#e6db74">&#34;D&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;sum_value&#34;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>apply(get_sum_value, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">df</code></pre>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">sum_value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
<td style="text-align:right">38</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>指定了按哪个axis，就是这个axis要动起来(类似被for遍历)，其它的axis保持不动*</strong></p>

<div class="component-content pagebody component">
  <h2 id="12pandas的索引index的用途" class="pagebody-header">
    12、Pandas的索引index的用途
  </h2>
</div><p class="component-content component">把数据存储于普通的column列也能用于数据查询，那使用index有什么好处？</p>
<p class="component-content component">index的用途总结：</p>
<div class="component-content component"><ol>
<li>更方便的数据查询；</li>
<li>使用index可以获得性能提升；</li>
<li>自动的数据对齐功能；</li>
<li>更多更强大的数据结构支持；</li>
</ol></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./datas/ml-latest-small/ratings.csv&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982703</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964981247</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">47</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964983815</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">50</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964982931</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>count()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>userId       <span style="color:#ae81ff">100836</span>
</span></span><span style="display:flex;"><span>movieId      <span style="color:#ae81ff">100836</span>
</span></span><span style="display:flex;"><span>rating       <span style="color:#ae81ff">100836</span>
</span></span><span style="display:flex;"><span>timestamp    <span style="color:#ae81ff">100836</span>
</span></span><span style="display:flex;"><span>dtype: int64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="1使用index查询数据" class="pagebody-header">
    1、使用index查询数据
  </h2>
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># drop==False，让索引列还保持在column</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#34;userId&#34;</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, drop<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982703</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964981247</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">47</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964983815</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">50</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964982931</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Int64Index([  <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,   <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>, <span style="color:#ae81ff">610</span>],
</span></span><span style="display:flex;"><span>           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;userId&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">100836</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 使用index的查询方法</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[<span style="color:#ae81ff">500</span>]<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">5</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005527755</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">11</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005528017</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">39</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527926</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527980</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">104</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005528065</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 使用column的condition查询方法</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[df[<span style="color:#e6db74">&#34;userId&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">500</span>]<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005527755</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">11</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005528017</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">39</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527926</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527980</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">104</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005528065</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h2 id="2-使用index会提升查询性能" class="pagebody-header">
    2. 使用index会提升查询性能
  </h2>
</div><div class="component-content component"><ul>
<li>如果index是唯一的，Pandas会使用哈希表优化，查询性能为O(1);</li>
<li>如果index不是唯一的，但是有序，Pandas会使用二分查找算法，查询性能为O(logN);</li>
<li>如果index是完全随机的，那么每次查询都要扫描全表，查询性能为O(N);</li>
</ul></div>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-96fbc4fecfce54532675614bd8760186" id="lht96fbc4fecfce54532675614bd8760186">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/3.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h3 id="实验1完全随机的顺序查询" class="pagebody-header">
    实验1：完全随机的顺序查询
  </h3>
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 将数据随机打散</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.utils <span style="color:#f92672">import</span> shuffle
</span></span><span style="display:flex;"><span>df_shuffle <span style="color:#f92672">=</span> shuffle(df)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_shuffle<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">160</td>
<td style="text-align:right">160</td>
<td style="text-align:right">2340</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">985383314</td>
</tr>
<tr>
<td style="text-align:right">129</td>
<td style="text-align:right">129</td>
<td style="text-align:right">1136</td>
<td style="text-align:right">3.5</td>
<td style="text-align:right">1167375403</td>
</tr>
<tr>
<td style="text-align:right">167</td>
<td style="text-align:right">167</td>
<td style="text-align:right">44191</td>
<td style="text-align:right">4.5</td>
<td style="text-align:right">1154718915</td>
</tr>
<tr>
<td style="text-align:right">536</td>
<td style="text-align:right">536</td>
<td style="text-align:right">276</td>
<td style="text-align:right">3.0</td>
<td style="text-align:right">832839990</td>
</tr>
<tr>
<td style="text-align:right">67</td>
<td style="text-align:right">67</td>
<td style="text-align:right">5952</td>
<td style="text-align:right">2.0</td>
<td style="text-align:right">1501274082</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 索引是否是递增的</span>
</span></span><span style="display:flex;"><span>df_shuffle<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>is_monotonic_increasing</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">False</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_shuffle<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>is_unique</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">False</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 计时，查询id==500数据性能</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>timeit df_shuffle<span style="color:#f92672">.</span>loc[<span style="color:#ae81ff">500</span>]
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">376</span> µs <span style="color:#960050;background-color:#1e0010">±</span> <span style="color:#ae81ff">52.4</span> µs per loop (mean <span style="color:#960050;background-color:#1e0010">±</span> std<span style="color:#f92672">.</span> dev<span style="color:#f92672">.</span> of <span style="color:#ae81ff">7</span> runs, <span style="color:#ae81ff">1000</span> loops each)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="实验2将index排序后的查询" class="pagebody-header">
    实验2：将index排序后的查询
  </h3>
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_sorted <span style="color:#f92672">=</span> df_shuffle<span style="color:#f92672">.</span>sort_index()</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_sorted<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2985</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964983034</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2617</td>
<td style="text-align:right">2.0</td>
<td style="text-align:right">964982588</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3639</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982271</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">733</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982400</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 索引是否是递增的</span>
</span></span><span style="display:flex;"><span>df_sorted<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>is_monotonic_increasing</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">True</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_sorted<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>is_unique</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">False</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">%</span>timeit df_sorted<span style="color:#f92672">.</span>loc[<span style="color:#ae81ff">500</span>]
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">203</span> µs <span style="color:#960050;background-color:#1e0010">±</span> <span style="color:#ae81ff">20.8</span> µs per loop (mean <span style="color:#960050;background-color:#1e0010">±</span> std<span style="color:#f92672">.</span> dev<span style="color:#f92672">.</span> of <span style="color:#ae81ff">7</span> runs, <span style="color:#ae81ff">1000</span> loops each)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="3-使用index能自动对齐数据" class="pagebody-header">
    3. 使用index能自动对齐数据
  </h2>
</div><p class="component-content component">包括series和dataframe</p>
<p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>], index<span style="color:#f92672">=</span>list(<span style="color:#e6db74">&#34;abc&#34;</span>))</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s1</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>b    <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>c    <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>dtype: int64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>], index<span style="color:#f92672">=</span>list(<span style="color:#e6db74">&#34;bcd&#34;</span>))</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>b    <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>c    <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>d    <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>dtype: int64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s1<span style="color:#f92672">+</span>s2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a    NaN
</span></span><span style="display:flex;"><span>b    <span style="color:#ae81ff">4.0</span>
</span></span><span style="display:flex;"><span>c    <span style="color:#ae81ff">6.0</span>
</span></span><span style="display:flex;"><span>d    NaN
</span></span><span style="display:flex;"><span>dtype: float64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h2 id="4-使用index更多更强大的数据结构支持" class="pagebody-header">
    4. 使用index更多更强大的数据结构支持
  </h2>
</div><p class="component-content component">*<strong>很多强大的索引数据结构*</strong></p>
<div class="component-content component"><ul>
<li>CategoricalIndex，基于分类数据的Index，提升性能；</li>
<li>MultiIndex，多维索引，用于groupby多维聚合后结果等；</li>
<li>DatetimeIndex，时间类型索引，强大的日期和时间的方法支持；</li>
</ul></div>

<div class="component-content pagebody component">
  <h1 id="13pandas怎样实现dataframe的merge" class="pagebody-header">
    13、Pandas怎样实现DataFrame的Merge
  </h1>
</div><p class="component-content component">Pandas的Merge，相当于Sql的Join，将不同的表按key关联到一个表</p>

<div class="component-content pagebody component">
  <h3 id="merge的语法" class="pagebody-header">
    merge的语法：
  </h3>
</div><p class="component-content component">pd.merge(left, right, how=&lsquo;inner&rsquo;, on=None, left_on=None, right_on=None, left_index=False, right_index=False, sort=True, suffixes=(&rsquo;_x&rsquo;, &lsquo;_y&rsquo;), copy=True, indicator=False, validate=None)</p>
<div class="component-content component"><ul>
<li>left，right：要merge的dataframe或者有name的Series</li>
<li>how：join类型，&rsquo;left&rsquo;, &lsquo;right&rsquo;, &lsquo;outer&rsquo;, &lsquo;inner&rsquo;</li>
<li>on：join的key，left和right都需要有这个key</li>
<li>left_on：left的df或者series的key</li>
<li>right_on：right的df或者seires的key</li>
<li>left_index，right_index：使用index而不是普通的column做join</li>
<li>suffixes：两个元素的后缀，如果列有重名，自动添加后缀，默认是(&rsquo;_x&rsquo;, &lsquo;_y&rsquo;)</li>
</ul></div>
<p class="component-content component">文档地址：https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html</p>
<p class="component-content component">本次讲解提纲：</p>
<div class="component-content component"><ol>
<li>电影数据集的join实例</li>
<li>理解merge时一对一、一对多、多对多的数量对齐关系</li>
<li>理解left join、right join、inner join、outer join的区别</li>
<li>如果出现非Key的字段重名怎么办</li>
</ol></div>

<div class="component-content pagebody component">
  <h3 id="1电影数据集的join实例" class="pagebody-header">
    1、电影数据集的join实例
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="电影评分数据集" class="pagebody-header">
    电影评分数据集
  </h4>
</div><p class="component-content component">是推荐系统研究的很好的数据集
位于本代码目录：./datas/movielens-1m</p>
<p class="component-content component">包含三个文件：</p>
<div class="component-content component"><ol>
<li>用户对电影的评分数据 ratings.dat</li>
<li>用户本身的信息数据 users.dat</li>
<li>电影本身的数据 movies.dat</li>
</ol></div>
<p class="component-content component">可以关联三个表，得到一个完整的大表</p>
<p class="component-content component">数据集官方地址：https://grouplens.org/datasets/movielens/</p>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;./datas/movielens-1m/ratings.dat&#34;</span>, 
</span></span><span style="display:flex;"><span>    sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;::&#34;</span>,
</span></span><span style="display:flex;"><span>    engine<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;python&#39;</span>, 
</span></span><span style="display:flex;"><span>    names<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UserID::MovieID::Rating::Timestamp&#34;</span><span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;::&#34;</span>)
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_users <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;./datas/movielens-1m/users.dat&#34;</span>, 
</span></span><span style="display:flex;"><span>    sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;::&#34;</span>,
</span></span><span style="display:flex;"><span>    engine<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;python&#39;</span>, 
</span></span><span style="display:flex;"><span>    names<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UserID::Gender::Age::Occupation::Zip-code&#34;</span><span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;::&#34;</span>)
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_users<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">M</td>
<td style="text-align:right">56</td>
<td style="text-align:right">16</td>
<td style="text-align:right">70072</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">15</td>
<td style="text-align:right">55117</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">M</td>
<td style="text-align:right">45</td>
<td style="text-align:right">7</td>
<td style="text-align:right">02460</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">20</td>
<td style="text-align:right">55455</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_movies <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;./datas/movielens-1m/movies.dat&#34;</span>, 
</span></span><span style="display:flex;"><span>    sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;::&#34;</span>,
</span></span><span style="display:flex;"><span>    engine<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;python&#39;</span>, 
</span></span><span style="display:flex;"><span>    names<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;MovieID::Title::Genres&#34;</span><span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;::&#34;</span>)
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_movies<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">Father of the Bride Part II (1995)</td>
<td style="text-align:right">Comedy</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings_users <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(
</span></span><span style="display:flex;"><span>   df_ratings, df_users, left_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UserID&#34;</span>, right_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UserID&#34;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;inner&#34;</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings_users<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings_users_movies <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(
</span></span><span style="display:flex;"><span>    df_ratings_users, df_movies, left_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;MovieID&#34;</span>, right_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;MovieID&#34;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;inner&#34;</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_ratings_users_movies<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">10</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978298413</td>
<td style="text-align:right">M</td>
<td style="text-align:right">56</td>
<td style="text-align:right">16</td>
<td style="text-align:right">70072</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978220179</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">12</td>
<td style="text-align:right">32793</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">15</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978199279</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">7</td>
<td style="text-align:right">22903</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">17</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978158471</td>
<td style="text-align:right">M</td>
<td style="text-align:right">50</td>
<td style="text-align:right">1</td>
<td style="text-align:right">95350</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">18</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978156168</td>
<td style="text-align:right">F</td>
<td style="text-align:right">18</td>
<td style="text-align:right">3</td>
<td style="text-align:right">95825</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">19</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">982730936</td>
<td style="text-align:right">M</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48073</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">24</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978136709</td>
<td style="text-align:right">F</td>
<td style="text-align:right">25</td>
<td style="text-align:right">7</td>
<td style="text-align:right">10023</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">28</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978125194</td>
<td style="text-align:right">F</td>
<td style="text-align:right">25</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14607</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">33</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978557765</td>
<td style="text-align:right">M</td>
<td style="text-align:right">45</td>
<td style="text-align:right">3</td>
<td style="text-align:right">55421</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2理解merge时数量的对齐关系" class="pagebody-header">
    2、理解merge时数量的对齐关系
  </h3>
</div><p class="component-content component">以下关系要正确理解：</p>
<div class="component-content component"><ul>
<li>one-to-one：一对一关系，关联的key都是唯一的
<div class="component-content component"><ul>
<li>比如(学号，姓名) merge (学号，年龄)</li>
<li>结果条数为：1*1</li>
</ul></div>
</li>
<li>one-to-many：一对多关系，左边唯一key，右边不唯一key
<div class="component-content component"><ul>
<li>比如(学号，姓名) merge (学号，[语文成绩、数学成绩、英语成绩])</li>
<li>结果条数为：1*N</li>
</ul></div>
</li>
<li>many-to-many：多对多关系，左边右边都不是唯一的
<div class="component-content component"><ul>
<li>比如（学号，[语文成绩、数学成绩、英语成绩]） merge (学号，[篮球、足球、乒乓球])</li>
<li>结果条数为：M*N</li>
</ul></div>
</li>
</ul></div>

<div class="component-content pagebody component">
  <h4 id="21-one-to-one-一对一关系的merge" class="pagebody-header">
    2.1 one-to-one 一对一关系的merge
  </h4>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-a07d663338c59fd41d088338ea2f991e" id="lhta07d663338c59fd41d088338ea2f991e">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/4.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">In[12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;name&#39;</span>: [<span style="color:#e6db74">&#39;name_a&#39;</span>, <span style="color:#e6db74">&#39;name_b&#39;</span>, <span style="color:#e6db74">&#39;name_c&#39;</span>, <span style="color:#e6db74">&#39;name_d&#39;</span>]
</span></span><span style="display:flex;"><span>                    })
</span></span><span style="display:flex;"><span>left</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">name_d</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;age&#39;</span>: [<span style="color:#e6db74">&#39;21&#39;</span>, <span style="color:#e6db74">&#39;22&#39;</span>, <span style="color:#e6db74">&#39;23&#39;</span>, <span style="color:#e6db74">&#39;24&#39;</span>]
</span></span><span style="display:flex;"><span>                    })
</span></span><span style="display:flex;"><span>right</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">age</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">21</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">23</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">24</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 一对一关系，结果中有4条</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sno&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
<th style="text-align:right">age</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">21</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
<td style="text-align:right">23</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">name_d</td>
<td style="text-align:right">24</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="22-one-to-many-一对多关系的merge" class="pagebody-header">
    2.2 one-to-many 一对多关系的merge
  </h4>
</div><p class="component-content component">注意：数据会被复制</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-3473a938d8a9db1b40648e0b1434fc22" id="lht3473a938d8a9db1b40648e0b1434fc22">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/5.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">In[15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;name&#39;</span>: [<span style="color:#e6db74">&#39;name_a&#39;</span>, <span style="color:#e6db74">&#39;name_b&#39;</span>, <span style="color:#e6db74">&#39;name_c&#39;</span>, <span style="color:#e6db74">&#39;name_d&#39;</span>]
</span></span><span style="display:flex;"><span>                    })
</span></span><span style="display:flex;"><span>left</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">name_d</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>],
</span></span><span style="display:flex;"><span>                       <span style="color:#e6db74">&#39;grade&#39;</span>: [<span style="color:#e6db74">&#39;语文88&#39;</span>, <span style="color:#e6db74">&#39;数学90&#39;</span>, <span style="color:#e6db74">&#39;英语75&#39;</span>,<span style="color:#e6db74">&#39;语文66&#39;</span>, <span style="color:#e6db74">&#39;数学55&#39;</span>, <span style="color:#e6db74">&#39;英语29&#39;</span>]
</span></span><span style="display:flex;"><span>                     })
</span></span><span style="display:flex;"><span>right</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">语文88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">数学90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">英语75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">语文66</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">数学55</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">13</td>
<td style="text-align:right">英语29</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 数目以多的一边为准</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sno&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">语文88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">数学90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">英语75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
<td style="text-align:right">语文66</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
<td style="text-align:right">数学55</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
<td style="text-align:right">英语29</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="23-many-to-many-多对多关系的merge" class="pagebody-header">
    2.3 many-to-many 多对多关系的merge
  </h4>
</div><p class="component-content component">注意：结果数量会出现乘法</p>
<p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-533fb4ee5f8cf7384ccd8cff2ef53113" id="lht533fb4ee5f8cf7384ccd8cff2ef53113">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/6.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">12</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;爱好&#39;</span>: [<span style="color:#e6db74">&#39;篮球&#39;</span>, <span style="color:#e6db74">&#39;羽毛球&#39;</span>, <span style="color:#e6db74">&#39;乒乓球&#39;</span>, <span style="color:#e6db74">&#39;篮球&#39;</span>, <span style="color:#e6db74">&#34;足球&#34;</span>]
</span></span><span style="display:flex;"><span>                    })
</span></span><span style="display:flex;"><span>left</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">爱好</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">篮球</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">羽毛球</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">乒乓球</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">篮球</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">足球</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;sno&#39;</span>: [<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>],
</span></span><span style="display:flex;"><span>                       <span style="color:#e6db74">&#39;grade&#39;</span>: [<span style="color:#e6db74">&#39;语文88&#39;</span>, <span style="color:#e6db74">&#39;数学90&#39;</span>, <span style="color:#e6db74">&#39;英语75&#39;</span>,<span style="color:#e6db74">&#39;语文66&#39;</span>, <span style="color:#e6db74">&#39;数学55&#39;</span>, <span style="color:#e6db74">&#39;英语29&#39;</span>]
</span></span><span style="display:flex;"><span>                     })
</span></span><span style="display:flex;"><span>right</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">语文88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">数学90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">英语75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">语文66</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">数学55</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">13</td>
<td style="text-align:right">英语29</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sno&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">爱好</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">篮球</td>
<td style="text-align:right">语文88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">篮球</td>
<td style="text-align:right">数学90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">篮球</td>
<td style="text-align:right">英语75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">11</td>
<td style="text-align:right">羽毛球</td>
<td style="text-align:right">语文88</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">11</td>
<td style="text-align:right">羽毛球</td>
<td style="text-align:right">数学90</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">11</td>
<td style="text-align:right">羽毛球</td>
<td style="text-align:right">英语75</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">12</td>
<td style="text-align:right">乒乓球</td>
<td style="text-align:right">语文66</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">12</td>
<td style="text-align:right">乒乓球</td>
<td style="text-align:right">数学55</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">12</td>
<td style="text-align:right">篮球</td>
<td style="text-align:right">语文66</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">12</td>
<td style="text-align:right">篮球</td>
<td style="text-align:right">数学55</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">12</td>
<td style="text-align:right">足球</td>
<td style="text-align:right">语文66</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">12</td>
<td style="text-align:right">足球</td>
<td style="text-align:right">数学55</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3理解left-joinright-joininner-joinouter-join的区别" class="pagebody-header">
    3、理解left join、right join、inner join、outer join的区别
  </h3>
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-453a770c447b6b88aa9a2d2c4de0b8f7" id="lht453a770c447b6b88aa9a2d2c4de0b8f7">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/7.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>
<p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>, <span style="color:#e6db74">&#39;K1&#39;</span>, <span style="color:#e6db74">&#39;K2&#39;</span>, <span style="color:#e6db74">&#39;K3&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>, <span style="color:#e6db74">&#39;A1&#39;</span>, <span style="color:#e6db74">&#39;A2&#39;</span>, <span style="color:#e6db74">&#39;A3&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>, <span style="color:#e6db74">&#39;B1&#39;</span>, <span style="color:#e6db74">&#39;B2&#39;</span>, <span style="color:#e6db74">&#39;B3&#39;</span>]})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>, <span style="color:#e6db74">&#39;K1&#39;</span>, <span style="color:#e6db74">&#39;K4&#39;</span>, <span style="color:#e6db74">&#39;K5&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>, <span style="color:#e6db74">&#39;C1&#39;</span>, <span style="color:#e6db74">&#39;C4&#39;</span>, <span style="color:#e6db74">&#39;C5&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>, <span style="color:#e6db74">&#39;D1&#39;</span>, <span style="color:#e6db74">&#39;D4&#39;</span>, <span style="color:#e6db74">&#39;D5&#39;</span>]})</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">left</code></pre>
  
</div><p class="component-content component">Out[22]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>right</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="31-inner-join默认" class="pagebody-header">
    3.1 inner join，默认
  </h4>
</div><p class="component-content component">左边和右边的key都有，才会出现在结果里</p>
<p class="component-content component">In [24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[24]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="32-left-join" class="pagebody-header">
    3.2 left join
  </h4>
</div><p class="component-content component">左边的都会出现在结果里，右边的如果无法匹配则为Null</p>
<p class="component-content component">In [25]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[25]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="33-right-join" class="pagebody-header">
    3.3 right join
  </h4>
</div><p class="component-content component">右边的都会出现在结果里，左边的如果无法匹配则为Null</p>
<p class="component-content component">In [26]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;right&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[26]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="34-outer-join" class="pagebody-header">
    3.4 outer join
  </h4>
</div><p class="component-content component">左边、右边的都会出现在结果里，如果无法匹配则为Null</p>
<p class="component-content component">In [27]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[27]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="4如果出现非key的字段重名怎么办" class="pagebody-header">
    4、如果出现非Key的字段重名怎么办
  </h3>
</div><p class="component-content component">In [28]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>, <span style="color:#e6db74">&#39;K1&#39;</span>, <span style="color:#e6db74">&#39;K2&#39;</span>, <span style="color:#e6db74">&#39;K3&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>, <span style="color:#e6db74">&#39;A1&#39;</span>, <span style="color:#e6db74">&#39;A2&#39;</span>, <span style="color:#e6db74">&#39;A3&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>, <span style="color:#e6db74">&#39;B1&#39;</span>, <span style="color:#e6db74">&#39;B2&#39;</span>, <span style="color:#e6db74">&#39;B3&#39;</span>]})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>, <span style="color:#e6db74">&#39;K1&#39;</span>, <span style="color:#e6db74">&#39;K4&#39;</span>, <span style="color:#e6db74">&#39;K5&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A10&#39;</span>, <span style="color:#e6db74">&#39;A11&#39;</span>, <span style="color:#e6db74">&#39;A12&#39;</span>, <span style="color:#e6db74">&#39;A13&#39;</span>],
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>, <span style="color:#e6db74">&#39;D1&#39;</span>, <span style="color:#e6db74">&#39;D4&#39;</span>, <span style="color:#e6db74">&#39;D5&#39;</span>]})</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [29]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>left</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[29]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [30]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>right</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[30]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A10</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A11</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">A12</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">A13</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [31]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[31]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A_x</th>
<th style="text-align:right">B</th>
<th style="text-align:right">A_y</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">A10</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">A11</td>
<td style="text-align:right">D1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [32]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key&#39;</span>, suffixes<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#39;_left&#39;</span>, <span style="color:#e6db74">&#39;_right&#39;</span>))</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[32]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A_left</th>
<th style="text-align:right">B</th>
<th style="text-align:right">A_right</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">A10</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">A11</td>
<td style="text-align:right">D1</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="14pandas实现数据的合并concat" class="pagebody-header">
    14、Pandas实现数据的合并concat
  </h1>
</div>
<div class="component-content pagebody component">
  <h4 id="使用场景" class="pagebody-header">
    使用场景：
  </h4>
</div><p class="component-content component">批量合并相同格式的Excel、给DataFrame添加行、给DataFrame添加列</p>

<div class="component-content pagebody component">
  <h4 id="一句话说明concat语法" class="pagebody-header">
    一句话说明concat语法：
  </h4>
</div><div class="component-content component"><ul>
<li>使用某种合并方式(inner/outer)</li>
<li>沿着某个轴向(axis=0/1)</li>
<li>把多个Pandas对象(DataFrame/Series)合并成一个。</li>
</ul></div>

<div class="component-content pagebody component">
  <h4 id="concat语法pandasconcatobjs-axis0-joinouter-ignore_indexfalse" class="pagebody-header">
    concat语法：pandas.concat(objs, axis=0, join=&lsquo;outer&rsquo;, ignore_index=False)
  </h4>
</div><div class="component-content component"><ul>
<li>objs：一个列表，内容可以是DataFrame或者Series，可以混合</li>
<li>axis：默认是0代表按行合并，如果等于1代表按列合并</li>
<li>join：合并的时候索引的对齐方式，默认是outer join，也可以是inner join</li>
<li>ignore_index：是否忽略掉原来的数据索引</li>
</ul></div>

<div class="component-content pagebody component">
  <h4 id="append语法dataframeappendother-ignore_indexfalse" class="pagebody-header">
    append语法：DataFrame.append(other, ignore_index=False)
  </h4>
</div><p class="component-content component">append只有按行合并，没有按列合并，相当于concat按行的简写形式</p>
<div class="component-content component"><ul>
<li>other：单个dataframe、series、dict，或者列表</li>
<li>ignore_index：是否忽略掉原来的数据索引</li>
</ul></div>

<div class="component-content pagebody component">
  <h4 id="参考文档" class="pagebody-header">
    参考文档：
  </h4>
</div><div class="component-content component"><ul>
<li>pandas.concat的api文档：https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html</li>
<li>pandas.concat的教程：https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html</li>
<li>pandas.append的api文档：https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html</li>
</ul></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> warnings
</span></span><span style="display:flex;"><span>warnings<span style="color:#f92672">.</span>filterwarnings(<span style="color:#e6db74">&#39;ignore&#39;</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="一使用pandasconcat合并数据" class="pagebody-header">
    一、使用pandas.concat合并数据
  </h3>
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>, <span style="color:#e6db74">&#39;A1&#39;</span>, <span style="color:#e6db74">&#39;A2&#39;</span>, <span style="color:#e6db74">&#39;A3&#39;</span>],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>, <span style="color:#e6db74">&#39;B1&#39;</span>, <span style="color:#e6db74">&#39;B2&#39;</span>, <span style="color:#e6db74">&#39;B3&#39;</span>],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>, <span style="color:#e6db74">&#39;C1&#39;</span>, <span style="color:#e6db74">&#39;C2&#39;</span>, <span style="color:#e6db74">&#39;C3&#39;</span>],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>, <span style="color:#e6db74">&#39;D1&#39;</span>, <span style="color:#e6db74">&#39;D2&#39;</span>, <span style="color:#e6db74">&#39;D3&#39;</span>],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;E&#39;</span>: [<span style="color:#e6db74">&#39;E0&#39;</span>, <span style="color:#e6db74">&#39;E1&#39;</span>, <span style="color:#e6db74">&#39;E2&#39;</span>, <span style="color:#e6db74">&#39;E3&#39;</span>]
</span></span><span style="display:flex;"><span>                   })
</span></span><span style="display:flex;"><span>df1</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({ <span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A4&#39;</span>, <span style="color:#e6db74">&#39;A5&#39;</span>, <span style="color:#e6db74">&#39;A6&#39;</span>, <span style="color:#e6db74">&#39;A7&#39;</span>],
</span></span><span style="display:flex;"><span>                     <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B4&#39;</span>, <span style="color:#e6db74">&#39;B5&#39;</span>, <span style="color:#e6db74">&#39;B6&#39;</span>, <span style="color:#e6db74">&#39;B7&#39;</span>],
</span></span><span style="display:flex;"><span>                     <span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C4&#39;</span>, <span style="color:#e6db74">&#39;C5&#39;</span>, <span style="color:#e6db74">&#39;C6&#39;</span>, <span style="color:#e6db74">&#39;C7&#39;</span>],
</span></span><span style="display:flex;"><span>                     <span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D4&#39;</span>, <span style="color:#e6db74">&#39;D5&#39;</span>, <span style="color:#e6db74">&#39;D6&#39;</span>, <span style="color:#e6db74">&#39;D7&#39;</span>],
</span></span><span style="display:flex;"><span>                     <span style="color:#e6db74">&#39;F&#39;</span>: [<span style="color:#e6db74">&#39;F4&#39;</span>, <span style="color:#e6db74">&#39;F5&#39;</span>, <span style="color:#e6db74">&#39;F6&#39;</span>, <span style="color:#e6db74">&#39;F7&#39;</span>]
</span></span><span style="display:flex;"><span>                   })
</span></span><span style="display:flex;"><span>df2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
<td style="text-align:right">F4</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
<td style="text-align:right">F5</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
<td style="text-align:right">F6</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">F7</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>1、默认的concat，参数为axis=0、join=outer、ignore_index=False*</strong></p>
<p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1,df2])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F4</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F5</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F6</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F7</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>2、使用ignore_index=True可以忽略原来的索引*</strong></p>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1,df2], ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F5</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F6</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F7</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>3、使用join=inner过滤掉不匹配的列*</strong></p>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1,df2], ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, join<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;inner&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>4、使用axis=1相当于添加新列*</strong></p>
<p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>A：添加一列Series*</strong></p>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(list(range(<span style="color:#ae81ff">4</span>)), name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;F&#34;</span>)
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1,s1], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>B：添加多列Series*</strong></p>
<p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s2 <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x:x[<span style="color:#e6db74">&#34;A&#34;</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;_GG&#34;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0</span>    A0_GG
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    A1_GG
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    A2_GG
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    A3_GG
</span></span><span style="display:flex;"><span>dtype: object</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s2<span style="color:#f92672">.</span>name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;G&#34;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([df1,s1,s2], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
<th style="text-align:right">G</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A0_GG</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">A1_GG</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">A2_GG</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">A3_GG</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 列表可以只有Series</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([s1,s2], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">F</th>
<th style="text-align:right">G</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A0_GG</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">A1_GG</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">A2_GG</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">A3_GG</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 列表是可以混合顺序的</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat([s1,df1,s2], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">F</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">G</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">A0_GG</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">A1_GG</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">A2_GG</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">A3_GG</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="二使用dataframeappend按行合并数据" class="pagebody-header">
    二、使用DataFrame.append按行合并数据
  </h3>
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>]], columns<span style="color:#f92672">=</span>list(<span style="color:#e6db74">&#39;AB&#39;</span>))
</span></span><span style="display:flex;"><span>df1</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([[<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>], [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>]], columns<span style="color:#f92672">=</span>list(<span style="color:#e6db74">&#39;AB&#39;</span>))
</span></span><span style="display:flex;"><span>df2</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>1、给1个dataframe添加另一个dataframe*</strong></p>
<p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1<span style="color:#f92672">.</span>append(df2)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>2、忽略原来的索引ignore_index=True*</strong></p>
<p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1<span style="color:#f92672">.</span>append(df2, ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>3、可以一行一行的给DataFrame添加数据*</strong></p>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 一个空的df</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;A&#39;</span>])
</span></span><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>A：低性能版本*</strong></p>
<p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 注意这里每次都在复制</span>
</span></span><span style="display:flex;"><span>    df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>append({<span style="color:#e6db74">&#39;A&#39;</span>: i}, ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>B：性能好的版本*</strong></p>
<p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 第一个入参是一个列表，避免了多次复制</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>concat(
</span></span><span style="display:flex;"><span>    [pd<span style="color:#f92672">.</span>DataFrame([i], columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;A&#39;</span>]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>)],
</span></span><span style="display:flex;"><span>    ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="15pandas批量拆分excel与合并excel" class="pagebody-header">
    15、Pandas批量拆分Excel与合并Excel
  </h1>
</div><p class="component-content component">实例演示：</p>
<div class="component-content component"><ol>
<li>将一个大Excel等份拆成多个Excel</li>
<li>将多个小Excel合并成一个大Excel并标记来源</li>
</ol></div>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>work_dir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;./course_datas/c15_excel_split_merge&#34;</span>
</span></span><span style="display:flex;"><span>splits_dir<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>work_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/splits&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>exists(splits_dir):
</span></span><span style="display:flex;"><span>    os<span style="color:#f92672">.</span>mkdir(splits_dir)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="0读取源excel到pandas" class="pagebody-header">
    0、读取源Excel到Pandas
  </h3>
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_source <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>work_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/crazyant_blog_articles_source.xlsx&#34;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_source<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">id</th>
<th style="text-align:right">title</th>
<th style="text-align:right">tags</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2585</td>
<td style="text-align:right">Tensorflow怎样接收变长列表特征</td>
<td style="text-align:right">python,tensorflow,特征工程</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2583</td>
<td style="text-align:right">Pandas实现数据的合并concat</td>
<td style="text-align:right">pandas,python,数据分析</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2574</td>
<td style="text-align:right">Pandas的Index索引有什么用途？</td>
<td style="text-align:right">pandas,python,数据分析</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2564</td>
<td style="text-align:right">机器学习常用数据集大全</td>
<td style="text-align:right">python,机器学习</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2561</td>
<td style="text-align:right">一个数据科学家的修炼路径</td>
<td style="text-align:right">数据分析</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_source<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RangeIndex(start<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, stop<span style="color:#f92672">=</span><span style="color:#ae81ff">258</span>, step<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_source<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">258</span>, <span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>total_row_count <span style="color:#f92672">=</span> df_source<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>total_row_count</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">258</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="一将一个大excel等份拆成多个excel" class="pagebody-header">
    一、将一个大Excel等份拆成多个Excel
  </h3>
</div><div class="component-content component"><ol>
<li>使用df.iloc方法，将一个大的dataframe，拆分成多个小dataframe</li>
<li>将使用dataframe.to_excel保存每个小Excel</li>
</ol></div>

<div class="component-content pagebody component">
  <h4 id="1计算拆分后的每个excel的行数" class="pagebody-header">
    1、计算拆分后的每个excel的行数
  </h4>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 这个大excel，会拆分给这几个人</span>
</span></span><span style="display:flex;"><span>user_names <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;xiao_shuai&#34;</span>, <span style="color:#e6db74">&#34;xiao_wang&#34;</span>, <span style="color:#e6db74">&#34;xiao_ming&#34;</span>, <span style="color:#e6db74">&#34;xiao_lei&#34;</span>, <span style="color:#e6db74">&#34;xiao_bo&#34;</span>, <span style="color:#e6db74">&#34;xiao_hong&#34;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 每个人的任务数目</span>
</span></span><span style="display:flex;"><span>split_size <span style="color:#f92672">=</span> total_row_count <span style="color:#f92672">//</span> len(user_names)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> total_row_count <span style="color:#f92672">%</span> len(user_names) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    split_size <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>split_size</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">43</span></span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="2拆分成多个dataframe" class="pagebody-header">
    2、拆分成多个dataframe
  </h4>
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_subs <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> idx, user_name <span style="color:#f92672">in</span> enumerate(user_names):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># iloc的开始索引</span>
</span></span><span style="display:flex;"><span>    begin <span style="color:#f92672">=</span> idx<span style="color:#f92672">*</span>split_size
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># iloc的结束索引</span>
</span></span><span style="display:flex;"><span>    end <span style="color:#f92672">=</span> begin<span style="color:#f92672">+</span>split_size
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 实现df按照iloc拆分</span>
</span></span><span style="display:flex;"><span>    df_sub <span style="color:#f92672">=</span> df_source<span style="color:#f92672">.</span>iloc[begin:end]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 将每个子df存入列表</span>
</span></span><span style="display:flex;"><span>    df_subs<span style="color:#f92672">.</span>append((idx, user_name, df_sub))</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="3将每个datafame存入excel" class="pagebody-header">
    3、将每个datafame存入excel
  </h4>
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> idx, user_name, df_sub <span style="color:#f92672">in</span> df_subs:
</span></span><span style="display:flex;"><span>    file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>splits_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/crazyant_blog_articles_</span><span style="color:#e6db74">{</span>idx<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">{</span>user_name<span style="color:#e6db74">}</span><span style="color:#e6db74">.xlsx&#34;</span>
</span></span><span style="display:flex;"><span>    df_sub<span style="color:#f92672">.</span>to_excel(file_name, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="二合并多个小excel到一个大excel" class="pagebody-header">
    二、合并多个小Excel到一个大Excel
  </h3>
</div><div class="component-content component"><ol>
<li>遍历文件夹，得到要合并的Excel文件列表</li>
<li>分别读取到dataframe，给每个df添加一列用于标记来源</li>
<li>使用pd.concat进行df批量合并</li>
<li>将合并后的dataframe输出到excel</li>
</ol></div>

<div class="component-content pagebody component">
  <h4 id="1-遍历文件夹得到要合并的excel名称列表" class="pagebody-header">
    1. 遍历文件夹，得到要合并的Excel名称列表
  </h4>
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>excel_names <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> excel_name <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(splits_dir):
</span></span><span style="display:flex;"><span>    excel_names<span style="color:#f92672">.</span>append(excel_name)
</span></span><span style="display:flex;"><span>excel_names</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;crazyant_blog_articles_0_xiao_shuai.xlsx&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;crazyant_blog_articles_1_xiao_wang.xlsx&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;crazyant_blog_articles_2_xiao_ming.xlsx&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;crazyant_blog_articles_3_xiao_lei.xlsx&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;crazyant_blog_articles_4_xiao_bo.xlsx&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;crazyant_blog_articles_5_xiao_hong.xlsx&#39;</span>]</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="2-分别读取到dataframe" class="pagebody-header">
    2. 分别读取到dataframe
  </h4>
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_list <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> excel_name <span style="color:#f92672">in</span> excel_names:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 读取每个excel到df</span>
</span></span><span style="display:flex;"><span>    excel_path <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>splits_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>excel_name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    df_split <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(excel_path)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 得到username</span>
</span></span><span style="display:flex;"><span>    username <span style="color:#f92672">=</span> excel_name<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;crazyant_blog_articles_&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;.xlsx&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)[<span style="color:#ae81ff">2</span>:]
</span></span><span style="display:flex;"><span>    print(excel_name, username)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 给每个df添加1列，即用户名字</span>
</span></span><span style="display:flex;"><span>    df_split[<span style="color:#e6db74">&#34;username&#34;</span>] <span style="color:#f92672">=</span> username
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    df_list<span style="color:#f92672">.</span>append(df_split)
</span></span><span style="display:flex;"><span>crazyant_blog_articles_0_xiao_shuai<span style="color:#f92672">.</span>xlsx xiao_shuai
</span></span><span style="display:flex;"><span>crazyant_blog_articles_1_xiao_wang<span style="color:#f92672">.</span>xlsx xiao_wang
</span></span><span style="display:flex;"><span>crazyant_blog_articles_2_xiao_ming<span style="color:#f92672">.</span>xlsx xiao_ming
</span></span><span style="display:flex;"><span>crazyant_blog_articles_3_xiao_lei<span style="color:#f92672">.</span>xlsx xiao_lei
</span></span><span style="display:flex;"><span>crazyant_blog_articles_4_xiao_bo<span style="color:#f92672">.</span>xlsx xiao_bo
</span></span><span style="display:flex;"><span>crazyant_blog_articles_5_xiao_hong<span style="color:#f92672">.</span>xlsx xiao_hong</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="3-使用pdconcat进行合并" class="pagebody-header">
    3. 使用pd.concat进行合并
  </h4>
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(df_list)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">258</span>, <span style="color:#ae81ff">4</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">id</th>
<th style="text-align:right">title</th>
<th style="text-align:right">tags</th>
<th style="text-align:right">username</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2585</td>
<td style="text-align:right">Tensorflow怎样接收变长列表特征</td>
<td style="text-align:right">python,tensorflow,特征工程</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2583</td>
<td style="text-align:right">Pandas实现数据的合并concat</td>
<td style="text-align:right">pandas,python,数据分析</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2574</td>
<td style="text-align:right">Pandas的Index索引有什么用途？</td>
<td style="text-align:right">pandas,python,数据分析</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2564</td>
<td style="text-align:right">机器学习常用数据集大全</td>
<td style="text-align:right">python,机器学习</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2561</td>
<td style="text-align:right">一个数据科学家的修炼路径</td>
<td style="text-align:right">数据分析</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged[<span style="color:#e6db74">&#34;username&#34;</span>]<span style="color:#f92672">.</span>value_counts()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>xiao_hong     <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>xiao_bo       <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>xiao_shuai    <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>xiao_lei      <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>xiao_wang     <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>xiao_ming     <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>Name: username, dtype: int64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="4-将合并后的dataframe输出到excel" class="pagebody-header">
    4. 将合并后的dataframe输出到excel
  </h4>
</div><p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_merged<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>work_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">/crazyant_blog_articles_merged.xlsx&#34;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h1 id="16pandas怎样实现groupby分组统计" class="pagebody-header">
    16、Pandas怎样实现groupby分组统计
  </h1>
</div><p class="component-content component">类似SQL：
select city,max(temperature) from city_weather group by city;</p>
<p class="component-content component">groupby：先对数据分组，然后在每个分组上应用聚合函数、转换函数</p>
<p class="component-content component">本次演示：
一、分组使用聚合函数做数据统计
二、遍历groupby的结果理解执行流程
三、实例分组探索天气数据</p>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 加上这一句，能在jupyter notebook展示matplot图表</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;foo&#39;</span>],
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;one&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>, <span style="color:#e6db74">&#39;three&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>, <span style="color:#e6db74">&#39;three&#39;</span>],
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;C&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">8</span>),
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;D&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">8</span>)})
</span></span><span style="display:flex;"><span>df</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">0.542903</td>
<td style="text-align:right">0.788896</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.903407</td>
<td style="text-align:right">0.428031</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-1.093602</td>
<td style="text-align:right">0.837348</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.665189</td>
<td style="text-align:right">-1.505290</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-0.498339</td>
<td style="text-align:right">0.534438</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="一分组使用聚合函数做数据统计" class="pagebody-header">
    一、分组使用聚合函数做数据统计
  </h3>
</div>
<div class="component-content pagebody component">
  <h4 id="1单个列groupby查询所有数据列的统计" class="pagebody-header">
    1、单个列groupby，查询所有数据列的统计
  </h4>
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)<span style="color:#f92672">.</span>sum()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">0.436595</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">1.083423</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">我们看到：</p>
<div class="component-content component"><ol>
<li>groupby中的&rsquo;A&rsquo;变成了数据的索引列</li>
<li>因为要统计sum，但B列不是数字，所以被自动忽略掉</li>
</ol></div>

<div class="component-content pagebody component">
  <h4 id="2多个列groupby查询所有数据列的统计" class="pagebody-header">
    2、多个列groupby，查询所有数据列的统计
  </h4>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>])<span style="color:#f92672">.</span>mean()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right">B</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.061143</td>
<td style="text-align:right">-0.358197</td>
</tr>
<tr>
<td style="text-align:right">three</td>
<td style="text-align:right">-0.498339</td>
<td style="text-align:right">0.534438</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.998504</td>
<td style="text-align:right">0.632690</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">我们看到：(&lsquo;A&rsquo;,&lsquo;B&rsquo;)成对变成了二级索引</p>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>], as_index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>mean()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.061143</td>
<td style="text-align:right">-0.358197</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-0.498339</td>
<td style="text-align:right">0.534438</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.998504</td>
<td style="text-align:right">0.632690</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="3同时查看多种数据统计" class="pagebody-header">
    3、同时查看多种数据统计
  </h4>
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)<span style="color:#f92672">.</span>agg([np<span style="color:#f92672">.</span>sum, np<span style="color:#f92672">.</span>mean, np<span style="color:#f92672">.</span>std])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right">sum</td>
<td style="text-align:right">mean</td>
<td style="text-align:right">std</td>
<td style="text-align:right">sum</td>
<td style="text-align:right">mean</td>
<td style="text-align:right">std</td>
</tr>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">-0.714313</td>
<td style="text-align:right">0.741583</td>
<td style="text-align:right">0.436595</td>
<td style="text-align:right">0.145532</td>
<td style="text-align:right">0.526544</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">-0.523527</td>
<td style="text-align:right">0.637822</td>
<td style="text-align:right">1.083423</td>
<td style="text-align:right">0.216685</td>
<td style="text-align:right">0.977686</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">我们看到：列变成了多级索引</p>

<div class="component-content pagebody component">
  <h4 id="4查看单列的结果数据统计" class="pagebody-header">
    4、查看单列的结果数据统计
  </h4>
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 方法1：预过滤，性能更好</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)[<span style="color:#e6db74">&#39;C&#39;</span>]<span style="color:#f92672">.</span>agg([np<span style="color:#f92672">.</span>sum, np<span style="color:#f92672">.</span>mean, np<span style="color:#f92672">.</span>std])</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sum</th>
<th style="text-align:right">mean</th>
<th style="text-align:right">std</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">-0.714313</td>
<td style="text-align:right">0.741583</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">-0.523527</td>
<td style="text-align:right">0.637822</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 方法2</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)<span style="color:#f92672">.</span>agg([np<span style="color:#f92672">.</span>sum, np<span style="color:#f92672">.</span>mean, np<span style="color:#f92672">.</span>std])[<span style="color:#e6db74">&#39;C&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sum</th>
<th style="text-align:right">mean</th>
<th style="text-align:right">std</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">-0.714313</td>
<td style="text-align:right">0.741583</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">-0.523527</td>
<td style="text-align:right">0.637822</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="5不同列使用不同的聚合函数" class="pagebody-header">
    5、不同列使用不同的聚合函数
  </h4>
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#34;C&#34;</span>:np<span style="color:#f92672">.</span>sum, <span style="color:#e6db74">&#34;D&#34;</span>:np<span style="color:#f92672">.</span>mean})</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">0.145532</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">0.216685</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="二遍历groupby的结果理解执行流程" class="pagebody-header">
    二、遍历groupby的结果理解执行流程
  </h3>
</div><p class="component-content component">for循环可以直接遍历每个group</p>

<div class="component-content pagebody component">
  <h5 id="1遍历单个列聚合的分组" class="pagebody-header">
    1、遍历单个列聚合的分组
  </h5>
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)
</span></span><span style="display:flex;"><span>g</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>pandas<span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>groupby<span style="color:#f92672">.</span>generic<span style="color:#f92672">.</span>DataFrameGroupBy object at <span style="color:#ae81ff">0x00000123B250E548</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> name,group <span style="color:#f92672">in</span> g:
</span></span><span style="display:flex;"><span>    print(name)
</span></span><span style="display:flex;"><span>    print(group)
</span></span><span style="display:flex;"><span>    print()
</span></span><span style="display:flex;"><span>bar
</span></span><span style="display:flex;"><span>     A      B         C         D
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>  bar    one <span style="color:#f92672">-</span><span style="color:#ae81ff">0.375789</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.345869</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>  bar  three <span style="color:#f92672">-</span><span style="color:#ae81ff">1.564748</span>  <span style="color:#ae81ff">0.081163</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>  bar    two <span style="color:#f92672">-</span><span style="color:#ae81ff">0.202403</span>  <span style="color:#ae81ff">0.701301</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>foo
</span></span><span style="display:flex;"><span>     A      B         C         D
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span>  foo    one  <span style="color:#ae81ff">0.542903</span>  <span style="color:#ae81ff">0.788896</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>  foo    two <span style="color:#f92672">-</span><span style="color:#ae81ff">0.903407</span>  <span style="color:#ae81ff">0.428031</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>  foo    two <span style="color:#f92672">-</span><span style="color:#ae81ff">1.093602</span>  <span style="color:#ae81ff">0.837348</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  foo    one <span style="color:#f92672">-</span><span style="color:#ae81ff">0.665189</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.505290</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>  foo  three <span style="color:#f92672">-</span><span style="color:#ae81ff">0.498339</span>  <span style="color:#ae81ff">0.534438</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">*<strong>可以获取单个分组的数据*</strong></p>
<p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g<span style="color:#f92672">.</span>get_group(<span style="color:#e6db74">&#39;bar&#39;</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h5 id="2遍历多个列聚合的分组" class="pagebody-header">
    2、遍历多个列聚合的分组
  </h5>
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;B&#39;</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">for name,group in g:
    print(name)
    print(group)
    print()
(&#39;bar&#39;, &#39;one&#39;)
     A    B         C         D
1  bar  one -0.375789 -0.345869

(&#39;bar&#39;, &#39;three&#39;)
     A      B         C         D
3  bar  three -1.564748  0.081163

(&#39;bar&#39;, &#39;two&#39;)
     A    B         C         D
5  bar  two -0.202403  0.701301

(&#39;foo&#39;, &#39;one&#39;)
     A    B         C         D
0  foo  one  0.542903  0.788896
6  foo  one -0.665189 -1.505290

(&#39;foo&#39;, &#39;three&#39;)
     A      B         C         D
7  foo  three -0.498339  0.534438

(&#39;foo&#39;, &#39;two&#39;)
     A    B         C         D
2  foo  two -0.903407  0.428031
4  foo  two -1.093602  0.837348</code></pre>
  
</div><p class="component-content component">可以看到，name是一个2个元素的tuple，代表不同的列</p>
<p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g<span style="color:#f92672">.</span>get_group((<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>))</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">0.542903</td>
<td style="text-align:right">0.788896</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.665189</td>
<td style="text-align:right">-1.505290</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">*<strong>可以直接查询group后的某几列，生成Series或者子DataFrame*</strong></p>
<p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g[<span style="color:#e6db74">&#39;C&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>pandas<span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>groupby<span style="color:#f92672">.</span>generic<span style="color:#f92672">.</span>SeriesGroupBy object at <span style="color:#ae81ff">0x00000123C33F64C8</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> name, group <span style="color:#f92672">in</span> g[<span style="color:#e6db74">&#39;C&#39;</span>]:
</span></span><span style="display:flex;"><span>    print(name)
</span></span><span style="display:flex;"><span>    print(group)
</span></span><span style="display:flex;"><span>    print(type(group))
</span></span><span style="display:flex;"><span>    print()
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">0.375789</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;three&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">1.564748</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">0.202403</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0.542903</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">0.665189</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;three&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">0.498339</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">0.903407</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">1.093602</span>
</span></span><span style="display:flex;"><span>Name: C, dtype: float64
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pandas</span><span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series<span style="color:#e6db74">&#39;&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">其实所有的聚合统计，都是在dataframe和series上进行的；</p>

<div class="component-content pagebody component">
  <h3 id="三实例分组探索天气数据" class="pagebody-header">
    三、实例分组探索天气数据
  </h3>
</div><p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fpath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(fpath)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 替换掉温度的后缀℃</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#34;bWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;bWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;℃&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#34;yWendu&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;yWendu&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;℃&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int32&#39;</span>)
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">59</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">49</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">阴</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">50</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 新增一列为月份</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;month&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;ymd&#39;</span>]<span style="color:#f92672">.</span>str[:<span style="color:#ae81ff">7</span>]
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
<th style="text-align:right">month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">59</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">49</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">阴</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">50</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="1查看每个月的最高温度" class="pagebody-header">
    1、查看每个月的最高温度
  </h4>
</div><p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;month&#39;</span>)[<span style="color:#e6db74">&#39;bWendu&#39;</span>]<span style="color:#f92672">.</span>max()
</span></span><span style="display:flex;"><span>data</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>month
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">27</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>    <span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span>    <span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>    <span style="color:#ae81ff">38</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span>    <span style="color:#ae81ff">37</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span>    <span style="color:#ae81ff">36</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span>    <span style="color:#ae81ff">31</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>    <span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span>    <span style="color:#ae81ff">18</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>    <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>Name: bWendu, dtype: int32</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>type(data)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pandas<span style="color:#f92672">.</span>core<span style="color:#f92672">.</span>series<span style="color:#f92672">.</span>Series</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x123c344b308</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-acc2a49cb410a6b3e8bd444620cea607" id="lhtacc2a49cb410a6b3e8bd444620cea607">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/8.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h4 id="2查看每个月的最高温度最低温度平均空气质量指数" class="pagebody-header">
    2、查看每个月的最高温度、最低温度、平均空气质量指数
  </h4>
</div><p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
<th style="text-align:right">month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">晴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">59</td>
<td style="text-align:right">良</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">阴~多云</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">49</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">多云</td>
<td style="text-align:right">北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">阴</td>
<td style="text-align:right">东北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">28</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">多云~晴</td>
<td style="text-align:right">西北风</td>
<td style="text-align:right">1-2级</td>
<td style="text-align:right">50</td>
<td style="text-align:right">优</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>group_data <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;month&#39;</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#34;bWendu&#34;</span>:np<span style="color:#f92672">.</span>max, <span style="color:#e6db74">&#34;yWendu&#34;</span>:np<span style="color:#f92672">.</span>min, <span style="color:#e6db74">&#34;aqi&#34;</span>:np<span style="color:#f92672">.</span>mean})
</span></span><span style="display:flex;"><span>group_data</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[24]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">aqi</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">month</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">60.677419</td>
</tr>
<tr>
<td style="text-align:right">2018-02</td>
<td style="text-align:right">12</td>
<td style="text-align:right">-10</td>
<td style="text-align:right">78.857143</td>
</tr>
<tr>
<td style="text-align:right">2018-03</td>
<td style="text-align:right">27</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">130.322581</td>
</tr>
<tr>
<td style="text-align:right">2018-04</td>
<td style="text-align:right">30</td>
<td style="text-align:right">1</td>
<td style="text-align:right">102.866667</td>
</tr>
<tr>
<td style="text-align:right">2018-05</td>
<td style="text-align:right">35</td>
<td style="text-align:right">10</td>
<td style="text-align:right">99.064516</td>
</tr>
<tr>
<td style="text-align:right">2018-06</td>
<td style="text-align:right">38</td>
<td style="text-align:right">17</td>
<td style="text-align:right">82.300000</td>
</tr>
<tr>
<td style="text-align:right">2018-07</td>
<td style="text-align:right">37</td>
<td style="text-align:right">22</td>
<td style="text-align:right">72.677419</td>
</tr>
<tr>
<td style="text-align:right">2018-08</td>
<td style="text-align:right">36</td>
<td style="text-align:right">20</td>
<td style="text-align:right">59.516129</td>
</tr>
<tr>
<td style="text-align:right">2018-09</td>
<td style="text-align:right">31</td>
<td style="text-align:right">11</td>
<td style="text-align:right">50.433333</td>
</tr>
<tr>
<td style="text-align:right">2018-10</td>
<td style="text-align:right">25</td>
<td style="text-align:right">1</td>
<td style="text-align:right">67.096774</td>
</tr>
<tr>
<td style="text-align:right">2018-11</td>
<td style="text-align:right">18</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">105.100000</td>
</tr>
<tr>
<td style="text-align:right">2018-12</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">77.354839</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [25]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>group_data<span style="color:#f92672">.</span>plot()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[25]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x123c5502d48</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-938d640977ccbea0c3ac2e7ea6c39a27" id="lht938d640977ccbea0c3ac2e7ea6c39a27">
        <picture  class="picture">
          <img class="picture-image" data-src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/9.png" alt=""  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        
      </div>
    </div>
  </div>
</figure>
</p>

<div class="component-content pagebody component">
  <h1 id="17pandas的分层索引multiindex" class="pagebody-header">
    17、Pandas的分层索引MultiIndex
  </h1>
</div><p class="component-content component">为什么要学习分层索引MultiIndex？</p>
<div class="component-content component"><ul>
<li>分层索引：在一个轴向上拥有多个索引层级，可以表达更高维度数据的形式；</li>
<li>可以更方便的进行数据筛选，如果有序则性能更好；</li>
<li>groupby等操作的结果，如果是多KEY，结果是分层索引，需要会使用</li>
<li>一般不需要自己创建分层索引(MultiIndex有构造函数但一般不用)</li>
</ul></div>
<p class="component-content component">演示数据：百度、阿里巴巴、爱奇艺、京东四家公司的10天股票数据
数据来自：英为财经
<a href="https://cn.investing.com/">https://cn.investing.com/</a></p>
<p class="component-content component">本次演示提纲：
一、Series的分层索引MultiIndex
二、Series有多层索引怎样筛选数据？
三、DataFrame的多层索引MultiIndex
四、DataFrame有多层索引怎样筛选数据？</p>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#39;./datas/stocks/互联网公司股票.xlsx&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">---------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NameError</span>                                 Traceback (most recent call last)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>ipython<span style="color:#f92672">-</span>input<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span><span style="color:#ae81ff">574</span>feeeb8bb0<span style="color:#f92672">&gt;</span> <span style="color:#f92672">in</span> <span style="color:#f92672">&lt;</span>module<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">----&gt;</span> <span style="color:#ae81ff">1</span> stocks <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#39;./datas/stocks/互联网公司股票.xlsx&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NameError</span>: name <span style="color:#e6db74">&#39;pd&#39;</span> <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> defined</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>shape</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[4]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">日期</th>
<th style="text-align:right">公司</th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks[<span style="color:#e6db74">&#34;公司&#34;</span>]<span style="color:#f92672">.</span>unique()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;JD&#39;</span>], dtype<span style="color:#f92672">=</span>object)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RangeIndex(start<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, stop<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>, step<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;公司&#39;</span>)[<span style="color:#e6db74">&#34;收盘&#34;</span>]<span style="color:#f92672">.</span>mean()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>公司
</span></span><span style="display:flex;"><span>BABA    <span style="color:#ae81ff">166.80</span>
</span></span><span style="display:flex;"><span>BIDU    <span style="color:#ae81ff">102.98</span>
</span></span><span style="display:flex;"><span>IQ       <span style="color:#ae81ff">15.90</span>
</span></span><span style="display:flex;"><span>JD       <span style="color:#ae81ff">28.35</span>
</span></span><span style="display:flex;"><span>Name: 收盘, dtype: float64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="一series的分层索引multiindex" class="pagebody-header">
    一、Series的分层索引MultiIndex
  </h3>
</div><p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser <span style="color:#f92672">=</span> stocks<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;公司&#39;</span>, <span style="color:#e6db74">&#39;日期&#39;</span>])[<span style="color:#e6db74">&#39;收盘&#39;</span>]<span style="color:#f92672">.</span>mean()
</span></span><span style="display:flex;"><span>ser</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>公司    日期        
</span></span><span style="display:flex;"><span>BABA  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">165.15</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">165.77</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">169.48</span>
</span></span><span style="display:flex;"><span>BIDU  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">102.00</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">104.32</span>
</span></span><span style="display:flex;"><span>IQ    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">15.92</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">15.72</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">16.06</span>
</span></span><span style="display:flex;"><span>JD    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">28.19</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">28.06</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">28.80</span>
</span></span><span style="display:flex;"><span>Name: 收盘, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">多维索引中，空白的意思是：使用上面的值</p>
<p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>MultiIndex([(<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>)],
</span></span><span style="display:flex;"><span>           names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;公司&#39;</span>, <span style="color:#e6db74">&#39;日期&#39;</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># unstack把二级索引变成列</span>
</span></span><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>unstack()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[10]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right">日期</th>
<th style="text-align:right">2019-10-01</th>
<th style="text-align:right">2019-10-02</th>
<th style="text-align:right">2019-10-03</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">公司</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">169.48</td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">104.32</td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">16.06</td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.80</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>公司    日期        
</span></span><span style="display:flex;"><span>BABA  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">165.15</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">165.77</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">169.48</span>
</span></span><span style="display:flex;"><span>BIDU  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">102.00</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">104.32</span>
</span></span><span style="display:flex;"><span>IQ    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">15.92</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">15.72</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">16.06</span>
</span></span><span style="display:flex;"><span>JD    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">28.19</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">28.06</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">28.80</span>
</span></span><span style="display:flex;"><span>Name: 收盘, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>reset_index()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[12]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">公司</th>
<th style="text-align:right">日期</th>
<th style="text-align:right">收盘</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="二series有多层索引multiindex怎样筛选数据" class="pagebody-header">
    二、Series有多层索引MultiIndex怎样筛选数据？
  </h3>
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>公司    日期        
</span></span><span style="display:flex;"><span>BABA  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">165.15</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">165.77</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">169.48</span>
</span></span><span style="display:flex;"><span>BIDU  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">102.00</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">104.32</span>
</span></span><span style="display:flex;"><span>IQ    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">15.92</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">15.72</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">16.06</span>
</span></span><span style="display:flex;"><span>JD    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>     <span style="color:#ae81ff">28.19</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>     <span style="color:#ae81ff">28.06</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">28.80</span>
</span></span><span style="display:flex;"><span>Name: 收盘, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#39;BIDU&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>日期
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>    <span style="color:#ae81ff">102.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>    <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">104.32</span>
</span></span><span style="display:flex;"><span>Name: 收盘, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 多层索引，可以用元组的形式筛选</span>
</span></span><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>loc[(<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>)]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">102.62</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>公司
</span></span><span style="display:flex;"><span>BABA    <span style="color:#ae81ff">165.77</span>
</span></span><span style="display:flex;"><span>BIDU    <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span>IQ       <span style="color:#ae81ff">15.72</span>
</span></span><span style="display:flex;"><span>JD       <span style="color:#ae81ff">28.06</span>
</span></span><span style="display:flex;"><span>Name: 收盘, dtype: float64</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h3 id="三dataframe的多层索引multiindex" class="pagebody-header">
    三、DataFrame的多层索引MultiIndex
  </h3>
</div><p class="component-content component">In [17]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[17]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">日期</th>
<th style="text-align:right">公司</th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [18]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>set_index([<span style="color:#e6db74">&#39;公司&#39;</span>, <span style="color:#e6db74">&#39;日期&#39;</span>], inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>stocks</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[18]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">公司</td>
<td style="text-align:right">日期</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">168.01</td>
<td style="text-align:right">168.23</td>
<td style="text-align:right">163.64</td>
<td style="text-align:right">14.19</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">16.14</td>
<td style="text-align:right">16.22</td>
<td style="text-align:right">15.50</td>
<td style="text-align:right">11.65</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>index</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[19]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>MultiIndex([(<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>),
</span></span><span style="display:flex;"><span>            (  <span style="color:#e6db74">&#39;JD&#39;</span>, <span style="color:#e6db74">&#39;2019-10-01&#39;</span>)],
</span></span><span style="display:flex;"><span>           names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;公司&#39;</span>, <span style="color:#e6db74">&#39;日期&#39;</span>])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [20]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>sort_index(inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>stocks</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[20]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">公司</td>
<td style="text-align:right">日期</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">168.01</td>
<td style="text-align:right">168.23</td>
<td style="text-align:right">163.64</td>
<td style="text-align:right">14.19</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">16.14</td>
<td style="text-align:right">16.22</td>
<td style="text-align:right">15.50</td>
<td style="text-align:right">11.65</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="四dataframe有多层索引multiindex怎样筛选数据" class="pagebody-header">
    四、DataFrame有多层索引MultiIndex怎样筛选数据？
  </h3>
</div><p class="component-content component">【*<strong>重要知识*</strong>】在选择数据时：</p>
<div class="component-content component"><ul>
<li>元组(key1,key2)代表筛选多层索引，其中key1是索引第一级，key2是第二级，比如key1=JD, key2=2019-10-02</li>
<li>列表[key1,key2]代表同一层的多个KEY，其中key1和key2是并列的同级索引，比如key1=JD, key2=BIDU</li>
</ul></div>
<p class="component-content component">In [21]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#39;BIDU&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[21]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">日期</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[(<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>), :]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[22]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>收盘     <span style="color:#ae81ff">102.62</span>
</span></span><span style="display:flex;"><span>开盘     <span style="color:#ae81ff">100.85</span>
</span></span><span style="display:flex;"><span>高      <span style="color:#ae81ff">103.24</span>
</span></span><span style="display:flex;"><span>低       <span style="color:#ae81ff">99.50</span>
</span></span><span style="display:flex;"><span>交易量      <span style="color:#ae81ff">2.69</span>
</span></span><span style="display:flex;"><span>涨跌幅      <span style="color:#ae81ff">0.01</span>
</span></span><span style="display:flex;"><span>Name: (BIDU, <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>), dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[(<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;2019-10-02&#39;</span>), <span style="color:#e6db74">&#39;开盘&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[23]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">100.85</span></span></span></code></pre></div></div>
  
</div><p class="component-content component">In [24]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[[<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;JD&#39;</span>], :]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[24]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">公司</td>
<td style="text-align:right">日期</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [25]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[([<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;JD&#39;</span>], <span style="color:#e6db74">&#39;2019-10-03&#39;</span>), :]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[25]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">公司</td>
<td style="text-align:right">日期</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [26]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[([<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;JD&#39;</span>], <span style="color:#e6db74">&#39;2019-10-03&#39;</span>), <span style="color:#e6db74">&#39;收盘&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[26]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>公司    日期        
</span></span><span style="display:flex;"><span>BIDU  <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>    <span style="color:#ae81ff">104.32</span>
</span></span><span style="display:flex;"><span>JD    <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>     <span style="color:#ae81ff">28.80</span>
</span></span><span style="display:flex;"><span>Name: 收盘, dtype: float64</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [27]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[(<span style="color:#e6db74">&#39;BIDU&#39;</span>, [<span style="color:#e6db74">&#39;2019-10-02&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>]), <span style="color:#e6db74">&#39;收盘&#39;</span>]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[27]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">公司    日期        
BIDU  2019-10-02    102.62
      2019-10-03    104.32
Name: 收盘, dtype: float64</code></pre>
  
</div><p class="component-content component">In [28]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># slice(None)代表筛选这一索引的所有内容</span>
</span></span><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[(slice(<span style="color:#66d9ef">None</span>), [<span style="color:#e6db74">&#39;2019-10-02&#39;</span>, <span style="color:#e6db74">&#39;2019-10-03&#39;</span>]), :]</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[28]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">公司</td>
<td style="text-align:right">日期</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [29]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">stocks.reset_index()</code></pre>
  
</div><p class="component-content component">Out[29]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">公司</th>
<th style="text-align:right">日期</th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">168.01</td>
<td style="text-align:right">168.23</td>
<td style="text-align:right">163.64</td>
<td style="text-align:right">14.19</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">16.14</td>
<td style="text-align:right">16.22</td>
<td style="text-align:right">15.50</td>
<td style="text-align:right">11.65</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h1 id="18pandas的数据转换函数mapapplyapplymap" class="pagebody-header">
    18、Pandas的数据转换函数map、apply、applymap
  </h1>
</div><p class="component-content component">数据转换函数对比：map、apply、applymap：</p>
<div class="component-content component"><ol>
<li>map：只用于Series，实现每个值-&gt;值的映射；</li>
<li>apply：用于Series实现每个值的处理，用于Dataframe实现某个轴的Series的处理；</li>
<li>applymap：只能用于DataFrame，用于处理该DataFrame的每个元素；</li>
</ol></div>

<div class="component-content pagebody component">
  <h3 id="1-map用于series值的转换" class="pagebody-header">
    1. map用于Series值的转换
  </h3>
</div><p class="component-content component">实例：将股票代码英文转换成中文名字</p>
<p class="component-content component">Series.map(dict) or Series.map(function)均可</p>
<p class="component-content component">In [1]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>stocks <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#39;./datas/stocks/互联网公司股票.xlsx&#39;</span>)
</span></span><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[1]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">日期</th>
<th style="text-align:right">公司</th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks[<span style="color:#e6db74">&#34;公司&#34;</span>]<span style="color:#f92672">.</span>unique()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[2]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array([<span style="color:#e6db74">&#39;BIDU&#39;</span>, <span style="color:#e6db74">&#39;BABA&#39;</span>, <span style="color:#e6db74">&#39;IQ&#39;</span>, <span style="color:#e6db74">&#39;JD&#39;</span>], dtype<span style="color:#f92672">=</span>object)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [3]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 公司股票代码到中文的映射，注意这里是小写</span>
</span></span><span style="display:flex;"><span>dict_company_names <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;bidu&#34;</span>: <span style="color:#e6db74">&#34;百度&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;baba&#34;</span>: <span style="color:#e6db74">&#34;阿里巴巴&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;iq&#34;</span>: <span style="color:#e6db74">&#34;爱奇艺&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;jd&#34;</span>: <span style="color:#e6db74">&#34;京东&#34;</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
  
</div>
<div class="component-content pagebody component">
  <h4 id="方法1seriesmapdict" class="pagebody-header">
    方法1：Series.map(dict)
  </h4>
</div><p class="component-content component">In [4]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks[<span style="color:#e6db74">&#34;公司中文1&#34;</span>] <span style="color:#f92672">=</span> stocks[<span style="color:#e6db74">&#34;公司&#34;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>lower()<span style="color:#f92672">.</span>map(dict_company_names)</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [5]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[5]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">日期</th>
<th style="text-align:right">公司</th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
<th style="text-align:right">公司中文1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">阿里巴巴</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">阿里巴巴</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="方法2seriesmapfunction" class="pagebody-header">
    方法2：Series.map(function)
  </h4>
</div><p class="component-content component">function的参数是Series的每个元素的值</p>
<p class="component-content component">In [6]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">stocks[&#34;公司中文2&#34;] = stocks[&#34;公司&#34;].map(lambda x : dict_company_names[x.lower()])</code></pre>
  
</div><p class="component-content component">In [7]:</p>
<div class="component-content pagebody component code">
  
  
  
  <pre><code class="">stocks.head()</code></pre>
  
</div><p class="component-content component">Out[7]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">日期</th>
<th style="text-align:right">公司</th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
<th style="text-align:right">公司中文1</th>
<th style="text-align:right">公司中文2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="2-apply用于series和dataframe的转换" class="pagebody-header">
    2. apply用于Series和DataFrame的转换
  </h3>
</div><div class="component-content component"><ul>
<li>Series.apply(function), 函数的参数是每个值</li>
<li>DataFrame.apply(function), 函数的参数是Series</li>
</ul></div>

<div class="component-content pagebody component">
  <h4 id="seriesapplyfunction" class="pagebody-header">
    Series.apply(function)
  </h4>
</div><p class="component-content component">function的参数是Series的每个值</p>
<p class="component-content component">In [8]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks[<span style="color:#e6db74">&#34;公司中文3&#34;</span>] <span style="color:#f92672">=</span> stocks[<span style="color:#e6db74">&#34;公司&#34;</span>]<span style="color:#f92672">.</span>apply(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">lambda</span> x : dict_company_names[x<span style="color:#f92672">.</span>lower()])</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [9]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[9]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">日期</th>
<th style="text-align:right">公司</th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
<th style="text-align:right">公司中文1</th>
<th style="text-align:right">公司中文2</th>
<th style="text-align:right">公司中文3</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h4 id="dataframeapplyfunction" class="pagebody-header">
    DataFrame.apply(function)
  </h4>
</div><p class="component-content component">function的参数是对应轴的Series</p>
<p class="component-content component">In [10]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks[<span style="color:#e6db74">&#34;公司中文4&#34;</span>] <span style="color:#f92672">=</span> stocks<span style="color:#f92672">.</span>apply(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">lambda</span> x : dict_company_names[x[<span style="color:#e6db74">&#34;公司&#34;</span>]<span style="color:#f92672">.</span>lower()], 
</span></span><span style="display:flex;"><span>    axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div></div>
  
</div><p class="component-content component">注意这个代码：
1、apply是在stocks这个DataFrame上调用；
2、lambda x的x是一个Series，因为指定了axis=1所以Seires的key是列名，可以用x[&lsquo;公司&rsquo;]获取</p>
<p class="component-content component">In [11]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[11]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">日期</th>
<th style="text-align:right">公司</th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
<th style="text-align:right">公司中文1</th>
<th style="text-align:right">公司中文2</th>
<th style="text-align:right">公司中文3</th>
<th style="text-align:right">公司中文4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
</tr>
</tbody>
</table></div>

<div class="component-content pagebody component">
  <h3 id="3-applymap用于dataframe所有值的转换" class="pagebody-header">
    3. applymap用于DataFrame所有值的转换
  </h3>
</div><p class="component-content component">In [12]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sub_df <span style="color:#f92672">=</span> stocks[[<span style="color:#e6db74">&#39;收盘&#39;</span>, <span style="color:#e6db74">&#39;开盘&#39;</span>, <span style="color:#e6db74">&#39;高&#39;</span>, <span style="color:#e6db74">&#39;低&#39;</span>, <span style="color:#e6db74">&#39;交易量&#39;</span>]]</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [13]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sub_df<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[13]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [14]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 将这些数字取整数，应用于所有元素</span>
</span></span><span style="display:flex;"><span>sub_df<span style="color:#f92672">.</span>applymap(<span style="color:#66d9ef">lambda</span> x : int(x))</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[14]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">104</td>
<td style="text-align:right">102</td>
<td style="text-align:right">104</td>
<td style="text-align:right">101</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">102</td>
<td style="text-align:right">100</td>
<td style="text-align:right">103</td>
<td style="text-align:right">99</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">102</td>
<td style="text-align:right">102</td>
<td style="text-align:right">103</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">169</td>
<td style="text-align:right">166</td>
<td style="text-align:right">170</td>
<td style="text-align:right">165</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">165</td>
<td style="text-align:right">162</td>
<td style="text-align:right">166</td>
<td style="text-align:right">161</td>
<td style="text-align:right">11</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">165</td>
<td style="text-align:right">168</td>
<td style="text-align:right">168</td>
<td style="text-align:right">163</td>
<td style="text-align:right">14</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">15</td>
<td style="text-align:right">16</td>
<td style="text-align:right">15</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">15</td>
<td style="text-align:right">15</td>
<td style="text-align:right">15</td>
<td style="text-align:right">15</td>
<td style="text-align:right">8</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">15</td>
<td style="text-align:right">16</td>
<td style="text-align:right">16</td>
<td style="text-align:right">15</td>
<td style="text-align:right">11</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">27</td>
<td style="text-align:right">8</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">27</td>
<td style="text-align:right">9</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">27</td>
<td style="text-align:right">10</td>
</tr>
</tbody>
</table></div>
<p class="component-content component">In [15]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 直接修改原df的这几列</span>
</span></span><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>loc[:, [<span style="color:#e6db74">&#39;收盘&#39;</span>, <span style="color:#e6db74">&#39;开盘&#39;</span>, <span style="color:#e6db74">&#39;高&#39;</span>, <span style="color:#e6db74">&#39;低&#39;</span>, <span style="color:#e6db74">&#39;交易量&#39;</span>]] <span style="color:#f92672">=</span> sub_df<span style="color:#f92672">.</span>applymap(<span style="color:#66d9ef">lambda</span> x : int(x))</span></span></code></pre></div></div>
  
</div><p class="component-content component">In [16]:</p>
<div class="component-content pagebody component code">
  
  
  
  <div class=""><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stocks<span style="color:#f92672">.</span>head()</span></span></code></pre></div></div>
  
</div><p class="component-content component">Out[16]:</p>
<div class="component-content component"><table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">日期</th>
<th style="text-align:right">公司</th>
<th style="text-align:right">收盘</th>
<th style="text-align:right">开盘</th>
<th style="text-align:right">高</th>
<th style="text-align:right">低</th>
<th style="text-align:right">交易量</th>
<th style="text-align:right">涨跌幅</th>
<th style="text-align:right">公司中文1</th>
<th style="text-align:right">公司中文2</th>
<th style="text-align:right">公司中文3</th>
<th style="text-align:right">公司中文4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104</td>
<td style="text-align:right">102</td>
<td style="text-align:right">104</td>
<td style="text-align:right">101</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102</td>
<td style="text-align:right">100</td>
<td style="text-align:right">103</td>
<td style="text-align:right">99</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102</td>
<td style="text-align:right">102</td>
<td style="text-align:right">103</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
<td style="text-align:right">百度</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169</td>
<td style="text-align:right">166</td>
<td style="text-align:right">170</td>
<td style="text-align:right">165</td>
<td style="text-align:right">10</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165</td>
<td style="text-align:right">162</td>
<td style="text-align:right">166</td>
<td style="text-align:right">161</td>
<td style="text-align:right">11</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
<td style="text-align:right">阿里巴巴</td>
</tr>
</tbody>
</table></div>

          </div><div class="component">
            <div class="component-content">
              <div class="article-copyright">
                <p class="content">
                  Copyright: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</a>
                </p>
                <p class="content">Author:   </p>
                <p class="content">Posted on:  November 26, 2021</p>
              </div>
            </div>
          </div></article>
      </section>
  </main>

  <script>
    var script = document.createElement("script");script.src = "https://yuanshuai1122.github.io/js/initPost.js";
    document.head.appendChild(script);
  </script>

    
    <div class="footer-main ">
  <div class="content-body footer-wraper">
    <div class="footer-box">
      <div class="foot-nav">
        <div class="foot-nav-items">
          <div class="item">
            <div class="logo"></div>
            <div class="email">Email: <a href="mailto:floyd.li@outlook.com">floyd.li@outlook.com</a></div>
          </div>

          <div class="item community">
            <div class="item-title">Social Media</div>
            
              <a href="https://github.com/floyd-li" target="_blank">Github</a>
            
          </div>

          <div class="item resources">
            <div class="item-title">Related</div>
            
              <a href="https://yufengbiji.com/" target="_blank">驭风笔记</a>
            
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="item copyright">
          &copy; 2023
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://github.com/floyd-li/hugo-theme-itheme" target="_blank">iTheme</a>
        </div>
      </div>
    </div>
  </div>
</div>

  </body>
    
    

    
    
</html>
