<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆå››ï¼‰ - ğŸ§€ - ä½ å¥½</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="yuanshuai" /><meta name="description" content=": | &amp;mdash;&amp;ndash;: | &amp;mdash;&amp;ndash;: | &amp;mdash;: | &amp;mdash;&amp;mdash;&amp;mdash;: | &amp;mdash;&amp;mdash;-: | | 0 | 1 | F | 1 | 10 | 48067 | | 1 | 2 | M | 56 | 16 | 70072 | | 2 | 3 | M | 25 | 15 | 55117 | | 3 | 4 | M | 45 | 7 | 02460 | | 4 | 5 | M" /><meta name="keywords" content="blog, yuanshuai, yyss" />






<meta name="generator" content="Hugo 0.119.0 with theme even" />


<link rel="canonical" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E5%9B%9B-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E5%9B%9B/" />
<link rel="apple-touch-icon" sizes="180x180" href="/yuanshuai1122.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/yuanshuai1122.github.io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/yuanshuai1122.github.io/favicon-16x16.png">
<link rel="manifest" href="/yuanshuai1122.github.io/manifest.json">
<link rel="mask-icon" href="/yuanshuai1122.github.io/safari-pinned-tab.svg" color="#5bbad5">



<link href="/yuanshuai1122.github.io/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆå››ï¼‰" />
<meta property="og:description" content=": | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;&mdash;: | &mdash;&mdash;-: | | 0 | 1 | F | 1 | 10 | 48067 | | 1 | 2 | M | 56 | 16 | 70072 | | 2 | 3 | M | 25 | 15 | 55117 | | 3 | 4 | M | 45 | 7 | 02460 | | 4 | 5 | M" />
<meta property="og:type" content="article" />
<meta property="og:url" content="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E5%9B%9B-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E5%9B%9B/" /><meta property="article:section" content="post" />


<meta itemprop="name" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆå››ï¼‰">
<meta itemprop="description" content=": | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;&mdash;: | &mdash;&mdash;-: | | 0 | 1 | F | 1 | 10 | 48067 | | 1 | 2 | M | 56 | 16 | 70072 | | 2 | 3 | M | 25 | 15 | 55117 | | 3 | 4 | M | 45 | 7 | 02460 | | 4 | 5 | M">

<meta itemprop="wordCount" content="17590">
<meta itemprop="keywords" content="Python,æ•°æ®åˆ†æ," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆå››ï¼‰"/>
<meta name="twitter:description" content=": | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;&mdash;: | &mdash;&mdash;-: | | 0 | 1 | F | 1 | 10 | 48067 | | 1 | 2 | M | 56 | 16 | 70072 | | 2 | 3 | M | 25 | 15 | 55117 | | 3 | 4 | M | 45 | 7 | 02460 | | 4 | 5 | M"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">CNshuaiyuan</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="yuanshuai1122.github.io/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="yuanshuai1122.github.io/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="yuanshuai1122.github.io/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="yuanshuai1122.github.io/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">CNshuaiyuan</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆå››ï¼‰</h1>

      <div class="post-meta">
        <span class="post-time"> 0001-01-01 </span>
        
          <span class="more-meta"> çº¦ 17590 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 36 åˆ†é’Ÿ </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#2ä½¿ç”¨categoricalç±»å‹é™ä½å­˜å‚¨é‡">2ã€ä½¿ç”¨categoricalç±»å‹é™ä½å­˜å‚¨é‡</a></li>
            <li><a href="#3æå‡è¿ç®—é€Ÿåº¦">3ã€æå‡è¿ç®—é€Ÿåº¦</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#29pandaså’Œflaské…åˆå®ç°å¿«é€Ÿåœ¨ç½‘é¡µä¸Šå±•ç¤ºè¡¨æ ¼æ•°æ®">29ã€Pandaså’ŒFlaské…åˆå®ç°å¿«é€Ÿåœ¨ç½‘é¡µä¸Šå±•ç¤ºè¡¨æ ¼æ•°æ®</a></li>
    <li><a href="#30pandasçš„get_dummiesç”¨äºæœºå™¨å­¦ä¹ çš„ç‰¹å¾å¤„ç†">30ã€Pandasçš„get_dummiesç”¨äºæœºå™¨å­¦ä¹ çš„ç‰¹å¾å¤„ç†</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1è¯»å–æ³°å¦å°¼å…‹æ•°æ®é›†">1ã€è¯»å–æ³°å¦å°¼å…‹æ•°æ®é›†</a></li>
            <li><a href="#2åˆ†ç±»æœ‰åºç‰¹å¾å¯ä»¥ç”¨æ•°å­—çš„æ–¹æ³•å¤„ç†">2ã€åˆ†ç±»æœ‰åºç‰¹å¾å¯ä»¥ç”¨æ•°å­—çš„æ–¹æ³•å¤„ç†</a></li>
            <li><a href="#3æ™®é€šæ— åºåˆ†ç±»ç‰¹å¾å¯ä»¥ç”¨get_dummiesç¼–ç ">3ã€æ™®é€šæ— åºåˆ†ç±»ç‰¹å¾å¯ä»¥ç”¨get_dummiesç¼–ç </a></li>
            <li><a href="#4æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒ">4ã€æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒ</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#31pandasä½¿ç”¨explodeå®ç°ä¸€è¡Œå˜å¤šè¡Œç»Ÿè®¡">31ã€Pandasä½¿ç”¨explodeå®ç°ä¸€è¡Œå˜å¤šè¡Œç»Ÿè®¡</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1è¯»å–æ•°æ®">1ã€è¯»å–æ•°æ®</a></li>
            <li><a href="#2å°†genreså­—æ®µæ‹†åˆ†æˆåˆ—è¡¨">2ã€å°†Genreså­—æ®µæ‹†åˆ†æˆåˆ—è¡¨</a></li>
            <li><a href="#3ä½¿ç”¨explodeå°†ä¸€è¡Œæ‹†åˆ†æˆå¤šè¡Œ">3ã€ä½¿ç”¨explodeå°†ä¸€è¡Œæ‹†åˆ†æˆå¤šè¡Œ</a></li>
            <li><a href="#4å®ç°æ‹†åˆ†åçš„é¢˜æçš„ç»Ÿè®¡">4ã€å®ç°æ‹†åˆ†åçš„é¢˜æçš„ç»Ÿè®¡</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#32pandaså€ŸåŠ©pythonçˆ¬è™«è¯»å–htmlç½‘é¡µè¡¨æ ¼å­˜å‚¨åˆ°excelæ–‡ä»¶">32ã€Pandaså€ŸåŠ©Pythonçˆ¬è™«è¯»å–HTMLç½‘é¡µè¡¨æ ¼å­˜å‚¨åˆ°Excelæ–‡ä»¶</a>
      <ul>
        <li>
          <ul>
            <li><a href="#0-å¤„ç†æµç¨‹">0. å¤„ç†æµç¨‹</a></li>
            <li><a href="#1-ç™»å½•ç½‘æ˜“æœ‰é“è¯å…¸çš„pcç‰ˆå¾®ä¿¡æ‰«ç ç™»å½•å¤åˆ¶cookiesåˆ°æ–‡ä»¶">1. ç™»å½•ç½‘æ˜“æœ‰é“è¯å…¸çš„PCç‰ˆï¼Œå¾®ä¿¡æ‰«ç ç™»å½•ï¼Œå¤åˆ¶cookiesåˆ°æ–‡ä»¶</a></li>
            <li><a href="#2-å°†htmléƒ½ä¸‹è½½ä¸‹æ¥å­˜å…¥åˆ—è¡¨">2. å°†htmléƒ½ä¸‹è½½ä¸‹æ¥å­˜å…¥åˆ—è¡¨</a></li>
            <li><a href="#3-ä½¿ç”¨pandasè§£æç½‘é¡µä¸­çš„è¡¨æ ¼">3. ä½¿ç”¨Pandasè§£æç½‘é¡µä¸­çš„è¡¨æ ¼</a></li>
            <li><a href="#4-å°†ç»“æœæ•°æ®è¾“å‡ºåˆ°excelæ–‡ä»¶">4. å°†ç»“æœæ•°æ®è¾“å‡ºåˆ°Excelæ–‡ä»¶</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#33pandasè®¡ç®—åŒæ¯”ç¯æ¯”æŒ‡æ ‡çš„3ç§æ–¹æ³•">33ã€Pandasè®¡ç®—åŒæ¯”ç¯æ¯”æŒ‡æ ‡çš„3ç§æ–¹æ³•</a>
      <ul>
        <li>
          <ul>
            <li></li>
            <li><a href="#0-è¯»å–è¿ç»­3å¹´çš„å¤©æ°”æ•°æ®">0. è¯»å–è¿ç»­3å¹´çš„å¤©æ°”æ•°æ®</a></li>
            <li><a href="#æ–¹æ³•1pandasseriespct_change">æ–¹æ³•1ï¼špandas.Series.pct_change</a></li>
            <li><a href="#æ–¹æ³•2pandasseriesshift">æ–¹æ³•2ï¼špandas.Series.shift</a></li>
            <li><a href="#æ–¹æ³•3-pandasseriesdiff">æ–¹æ³•3. pandas.Series.diff</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#34pandaså’Œæ•°æ®åº“æŸ¥è¯¢è¯­è¨€sqlçš„å¯¹æ¯”">34ã€Pandaså’Œæ•°æ®åº“æŸ¥è¯¢è¯­è¨€SQLçš„å¯¹æ¯”</a>
      <ul>
        <li>
          <ul>
            <li><a href="#0-è¯»å–æ³°å¦å°¼å…‹æ•°æ®é›†">0. è¯»å–æ³°å¦å°¼å…‹æ•°æ®é›†</a></li>
            <li><a href="#1-selectæ•°æ®æŸ¥è¯¢">1. SELECTæ•°æ®æŸ¥è¯¢</a></li>
            <li><a href="#2-whereæŒ‰æ¡ä»¶æŸ¥è¯¢">2. WHEREæŒ‰æ¡ä»¶æŸ¥è¯¢</a></li>
            <li><a href="#3-inå’Œnot-inçš„æ¡ä»¶æŸ¥è¯¢">3. inå’Œnot inçš„æ¡ä»¶æŸ¥è¯¢</a></li>
            <li><a href="#4-groupbyåˆ†ç»„ç»Ÿè®¡">4. groupbyåˆ†ç»„ç»Ÿè®¡</a></li>
            <li><a href="#5-joinæ•°æ®å…³è”">5. JOINæ•°æ®å…³è”</a></li>
            <li><a href="#6-unionæ•°æ®åˆå¹¶">6. UNIONæ•°æ®åˆå¹¶</a></li>
            <li><a href="#7-order-limitå…ˆæ’åºååˆ†é¡µ">7. Order Limitå…ˆæ’åºååˆ†é¡µ</a></li>
            <li><a href="#8-å–æ¯ä¸ªåˆ†ç»„groupçš„top-n">8. å–æ¯ä¸ªåˆ†ç»„groupçš„top n</a></li>
            <li><a href="#9-updateæ•°æ®æ›´æ–°">9. UPDATEæ•°æ®æ›´æ–°</a></li>
            <li><a href="#10-deleteåˆ é™¤æ•°æ®">10. DELETEåˆ é™¤æ•°æ®</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#35pandaså®ç°groupbyèšåˆåä¸åŒåˆ—æ•°æ®ç»Ÿè®¡">35ã€Pandaså®ç°groupbyèšåˆåä¸åŒåˆ—æ•°æ®ç»Ÿè®¡</a>
      <ul>
        <li>
          <ul>
            <li><a href="#è¯»å–æ•°æ®">è¯»å–æ•°æ®</a></li>
            <li><a href="#èšåˆåå•åˆ—-å•æŒ‡æ ‡ç»Ÿè®¡">èšåˆåå•åˆ—-å•æŒ‡æ ‡ç»Ÿè®¡</a></li>
            <li><a href="#èšåˆåå•åˆ—-å¤šæŒ‡æ ‡ç»Ÿè®¡">èšåˆåå•åˆ—-å¤šæŒ‡æ ‡ç»Ÿè®¡</a></li>
            <li><a href="#èšåˆåå¤šåˆ—-å¤šæŒ‡æ ‡ç»Ÿè®¡">èšåˆåå¤šåˆ—-å¤šæŒ‡æ ‡ç»Ÿè®¡</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#36pandasè¯»å–excelå°†æ•°æ®å±•ç¤ºåœ¨ç½‘é¡µä¸Š">36ã€Pandasè¯»å–Excelå°†æ•°æ®å±•ç¤ºåœ¨ç½‘é¡µä¸Š</a></li>
  </ul>
</nav>
  </div>
</div>
  <div class="post-outdated">
    <div class="warn">
      <p>ã€æ³¨æ„ã€‘æœ€åæ›´æ–°äº <span class="timeago" datetime="0001-01-01T00:00:00" title="January 1, 0001">January 1, 0001</span>ï¼Œæ–‡ä¸­å†…å®¹å¯èƒ½å·²è¿‡æ—¶ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p>
    </div>
  </div>
    <div class="post-content">
      <p>: | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;&mdash;: | &mdash;&mdash;-: |
|    0 |      1 |      F |    1 |         10 |    48067 |
|    1 |      2 |      M |   56 |         16 |    70072 |
|    2 |      3 |      M |   25 |         15 |    55117 |
|    3 |      4 |      M |   45 |          7 |    02460 |
|    4 |      5 |      M |   25 |         20 |    55455 |</p>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">6040</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">6039</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">5</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">UserID</span>        <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Gender</span>        <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Age</span>           <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Occupation</span>    <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Zip</span><span class="o">-</span><span class="n">code</span>      <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">int64</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">object</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">236.1</span><span class="o">+</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="s2">&#34;deep&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">6040</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">6039</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">5</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">UserID</span>        <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Gender</span>        <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Age</span>           <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Occupation</span>    <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Zip</span><span class="o">-</span><span class="n">code</span>      <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">int64</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">object</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">873.4</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_cat</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">df_cat</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">M</td>
<td style="text-align:right">56</td>
<td style="text-align:right">16</td>
<td style="text-align:right">70072</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">15</td>
<td style="text-align:right">55117</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">M</td>
<td style="text-align:right">45</td>
<td style="text-align:right">7</td>
<td style="text-align:right">02460</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">20</td>
<td style="text-align:right">55455</td>
</tr>
</tbody>
</table>
<h3 id="2ä½¿ç”¨categoricalç±»å‹é™ä½å­˜å‚¨é‡">2ã€ä½¿ç”¨categoricalç±»å‹é™ä½å­˜å‚¨é‡</h3>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_cat</span><span class="p">[</span><span class="s2">&#34;Gender&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cat</span><span class="p">[</span><span class="s2">&#34;Gender&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&#34;category&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_cat</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="s2">&#34;deep&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">6040</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">6039</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">5</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">UserID</span>        <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Gender</span>        <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">category</span>
</span></span><span class="line"><span class="cl"><span class="n">Age</span>           <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Occupation</span>    <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Zip</span><span class="o">-</span><span class="n">code</span>      <span class="mi">6040</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">category</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">object</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">513.8</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">df_cat.head()
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">M</td>
<td style="text-align:right">56</td>
<td style="text-align:right">16</td>
<td style="text-align:right">70072</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">15</td>
<td style="text-align:right">55117</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">M</td>
<td style="text-align:right">45</td>
<td style="text-align:right">7</td>
<td style="text-align:right">02460</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">20</td>
<td style="text-align:right">55455</td>
</tr>
</tbody>
</table>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_cat</span><span class="p">[</span><span class="s2">&#34;Gender&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">M</span>    <span class="mi">4331</span>
</span></span><span class="line"><span class="cl"><span class="n">F</span>    <span class="mi">1709</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">Gender</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3æå‡è¿ç®—é€Ÿåº¦">3ã€æå‡è¿ç®—é€Ÿåº¦</h3>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">%</span><span class="n">timeit</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Gender&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="mi">564</span> <span class="n">Âµs</span> <span class="err">Â±</span> <span class="mf">10.8</span> <span class="n">Âµs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">Â±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">%</span><span class="n">timeit</span> <span class="n">df_cat</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Gender&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="mi">324</span> <span class="n">Âµs</span> <span class="err">Â±</span> <span class="mi">5</span> <span class="n">Âµs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">Â±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="29pandaså’Œflaské…åˆå®ç°å¿«é€Ÿåœ¨ç½‘é¡µä¸Šå±•ç¤ºè¡¨æ ¼æ•°æ®">29ã€Pandaså’ŒFlaské…åˆå®ç°å¿«é€Ÿåœ¨ç½‘é¡µä¸Šå±•ç¤ºè¡¨æ ¼æ•°æ®</h1>
<p>æœ¬æ¬¡æ¼”ç¤ºæ˜¯ä½¿ç”¨PyCharmå®ç°çš„</p>
<p>åœ¨å½“å‰ç›®å½•ä¸‹æœ‰ä¸€ä¸ªå­ç›®å½•å°±æ˜¯ä»£ç ï¼špandas-flask</p>
<p>æ‰“å¼€Pycharmï¼Œç„¶åæ‰“å¼€pandas-flaskè¿™ä¸ªç›®å½•ï¼Œç„¶åè¿è¡Œapp.pyå°±å¯ä»¥å¯åŠ¨webæœåŠ¡å™¨</p>
<h1 id="30pandasçš„get_dummiesç”¨äºæœºå™¨å­¦ä¹ çš„ç‰¹å¾å¤„ç†">30ã€Pandasçš„get_dummiesç”¨äºæœºå™¨å­¦ä¹ çš„ç‰¹å¾å¤„ç†</h1>
<p>åˆ†ç±»ç‰¹å¾æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>æ™®é€šåˆ†ç±»ï¼šæ€§åˆ«ã€é¢œè‰²</li>
<li>é¡ºåºåˆ†ç±»ï¼šè¯„åˆ†ã€çº§åˆ«</li>
</ul>
<p>å¯¹äºè¯„åˆ†ï¼Œå¯ä»¥æŠŠè¿™ä¸ªåˆ†ç±»ç›´æ¥è½¬æ¢æˆ1ã€2ã€3ã€4ã€5è¡¨ç¤ºï¼Œå› ä¸ºå®ƒä»¬ä¹‹é—´æœ‰é¡ºåºã€å¤§å°å…³ç³»</p>
<p>ä½†æ˜¯å¯¹äºé¢œè‰²è¿™ç§åˆ†ç±»ï¼Œç›´æ¥ç”¨1/2/3/4/5/6/7è¡¨è¾¾ï¼Œæ˜¯ä¸åˆé€‚çš„ï¼Œå› ä¸ºæœºå™¨å­¦ä¹ ä¼šè¯¯ä»¥ä¸ºè¿™äº›æ•°å­—ä¹‹é—´æœ‰å¤§å°å…³ç³»</p>
<p>get_dummieså°±æ˜¯ç”¨äºé¢œè‰²ã€æ€§åˆ«è¿™ç§ç‰¹å¾çš„å¤„ç†ï¼Œä¹Ÿå«ä½œone-hot-encodingå¤„ç†</p>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>ç”·æ€§ï¼š1 0</li>
<li>å¥³æ€§ï¼š0 1</li>
</ul>
<p>è¿™å°±å«åšone-hot-encodingï¼Œæ˜¯æœºå™¨å­¦ä¹ å¯¹ç±»åˆ«çš„ç‰¹å¾å¤„ç†</p>
<h3 id="1è¯»å–æ³°å¦å°¼å…‹æ•°æ®é›†">1ã€è¯»å–æ³°å¦å°¼å…‹æ•°æ®é›†</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;./datas/titanic/titanic_train.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cumings, Mrs. John Bradley (Florence Briggs Th&hellip;</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17599</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C85</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Heikkinen, Miss. Laina</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">STON/O2. 3101282</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113803</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">C123</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;Name&#34;</span><span class="p">,</span> <span class="s2">&#34;Ticket&#34;</span><span class="p">,</span> <span class="s2">&#34;Cabin&#34;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_train</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">891</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">890</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">9</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">PassengerId</span>    <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Survived</span>       <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Pclass</span>         <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Sex</span>            <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Age</span>            <span class="mi">714</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="n">SibSp</span>          <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Parch</span>          <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Fare</span>           <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="n">Embarked</span>       <span class="mi">889</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">object</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">62.8</span><span class="o">+</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ç‰¹å¾è¯´æ˜">ç‰¹å¾è¯´æ˜ï¼š</h4>
<ul>
<li>æ•°å€¼ç‰¹å¾ï¼šFare</li>
<li>åˆ†ç±»-æœ‰åºç‰¹å¾ï¼šAge</li>
<li>åˆ†ç±»-æ™®é€šç‰¹å¾ï¼šPassengerIdã€Pclassã€Sexã€SibSpã€Parchã€Embarked</li>
</ul>
<p>Survivedä¸ºè¦é¢„æµ‹çš„Label</p>
<h3 id="2åˆ†ç±»æœ‰åºç‰¹å¾å¯ä»¥ç”¨æ•°å­—çš„æ–¹æ³•å¤„ç†">2ã€åˆ†ç±»æœ‰åºç‰¹å¾å¯ä»¥ç”¨æ•°å­—çš„æ–¹æ³•å¤„ç†</h3>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨å¹´é¾„çš„å¹³å‡å€¼ï¼Œå¡«å……ç©ºå€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">df_train</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_train</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">891</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">890</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">9</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">PassengerId</span>    <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Survived</span>       <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Pclass</span>         <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Sex</span>            <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Age</span>            <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="n">SibSp</span>          <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Parch</span>          <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Fare</span>           <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="n">Embarked</span>       <span class="mi">889</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">object</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">62.8</span><span class="o">+</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3æ™®é€šæ— åºåˆ†ç±»ç‰¹å¾å¯ä»¥ç”¨get_dummiesç¼–ç ">3ã€æ™®é€šæ— åºåˆ†ç±»ç‰¹å¾å¯ä»¥ç”¨get_dummiesç¼–ç </h3>
<p>å…¶å®å°±æ˜¯one-hotç¼–ç </p>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># series</span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s2">&#34;Sex&#34;</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">female</th>
<th style="text-align:right">male</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>***æ³¨æ„ï¼ŒOne-hot-Encodingä¸€èˆ¬è¦å»æ‰ä¸€åˆ—ï¼Œä¸ç„¶ä¼šå‡ºç°dummy variable trapï¼Œå› ä¸ºä¸€ä¸ªäººä¸æ˜¯maleå°±æ˜¯femalï¼Œå®ƒä¿©æœ‰æ¨å¯¼å…³ç³»***<a href="https://www.geeksforgeeks.org/ml-dummy-variable-trap-in-regression-models/">https://www.geeksforgeeks.org/ml-dummy-variable-trap-in-regression-models/</a></p>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä¾¿æ·æ–¹æ³•ï¼Œç”¨dfå…¨éƒ¨æ›¿æ¢</span>
</span></span><span class="line"><span class="cl"><span class="n">needcode_cat_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Pclass&#34;</span><span class="p">,</span><span class="s2">&#34;Sex&#34;</span><span class="p">,</span><span class="s2">&#34;SibSp&#34;</span><span class="p">,</span><span class="s2">&#34;Parch&#34;</span><span class="p">,</span><span class="s2">&#34;Embarked&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">df_coded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_train</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è¦è½¬ç çš„åˆ—</span>
</span></span><span class="line"><span class="cl">    <span class="n">columns</span><span class="o">=</span><span class="n">needcode_cat_columns</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç”Ÿæˆçš„åˆ—åçš„å‰ç¼€</span>
</span></span><span class="line"><span class="cl">    <span class="n">prefix</span><span class="o">=</span><span class="n">needcode_cat_columns</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æŠŠç©ºå€¼ä¹Ÿåšç¼–ç </span>
</span></span><span class="line"><span class="cl">    <span class="n">dummy_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æŠŠ1 of kç§»é™¤ï¼ˆdummy variable trapï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">df_coded.head()
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Pclass_2.0</th>
<th style="text-align:right">Pclass_3.0</th>
<th style="text-align:right">Pclass_nan</th>
<th style="text-align:right">Sex_male</th>
<th style="text-align:right">Sex_nan</th>
<th style="text-align:right">SibSp_1.0</th>
<th style="text-align:right">&hellip;</th>
<th style="text-align:right">Parch_1.0</th>
<th style="text-align:right">Parch_2.0</th>
<th style="text-align:right">Parch_3.0</th>
<th style="text-align:right">Parch_4.0</th>
<th style="text-align:right">Parch_5.0</th>
<th style="text-align:right">Parch_6.0</th>
<th style="text-align:right">Parch_nan</th>
<th style="text-align:right">Embarked_Q</th>
<th style="text-align:right">Embarked_S</th>
<th style="text-align:right">Embarked_nan</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
</tbody>
</table>
<p>5 rows Ã— 26 columns</p>
<h3 id="4æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒ">4ã€æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒ</h3>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="n">df_coded</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&#34;Survived&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>    <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>    <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>    <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">Survived</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">X = df_coded
</span></span><span class="line"><span class="cl">X.head()
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Pclass_2.0</th>
<th style="text-align:right">Pclass_3.0</th>
<th style="text-align:right">Pclass_nan</th>
<th style="text-align:right">Sex_male</th>
<th style="text-align:right">Sex_nan</th>
<th style="text-align:right">SibSp_1.0</th>
<th style="text-align:right">SibSp_2.0</th>
<th style="text-align:right">&hellip;</th>
<th style="text-align:right">Parch_1.0</th>
<th style="text-align:right">Parch_2.0</th>
<th style="text-align:right">Parch_3.0</th>
<th style="text-align:right">Parch_4.0</th>
<th style="text-align:right">Parch_5.0</th>
<th style="text-align:right">Parch_6.0</th>
<th style="text-align:right">Parch_nan</th>
<th style="text-align:right">Embarked_Q</th>
<th style="text-align:right">Embarked_S</th>
<th style="text-align:right">Embarked_nan</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
</tbody>
</table>
<p>5 rows Ã— 25 columns</p>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºæ¨¡å‹å¯¹è±¡</span>
</span></span><span class="line"><span class="cl"><span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®ç°æ¨¡å‹è®­ç»ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">logreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">intercept_scaling</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">l1_ratio</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">multi_class</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">logreg</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mf">0.8148148148148148</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="31pandasä½¿ç”¨explodeå®ç°ä¸€è¡Œå˜å¤šè¡Œç»Ÿè®¡">31ã€Pandasä½¿ç”¨explodeå®ç°ä¸€è¡Œå˜å¤šè¡Œç»Ÿè®¡</h1>
<p>è§£å†³å®é™…é—®é¢˜ï¼šä¸€ä¸ªå­—æ®µåŒ…å«å¤šä¸ªå€¼ï¼Œæ€æ ·å°†è¿™ä¸ªå€¼æ‹†åˆ†æˆå¤šè¡Œï¼Œç„¶åå®ç°ç»Ÿè®¡</p>
<p>æ¯”å¦‚ï¼šä¸€ä¸ªç”µå½±æœ‰å¤šä¸ªåˆ†ç±»ã€ä¸€ä¸ªäººæœ‰å¤šä¸ªå–œå¥½ï¼Œéœ€è¦æŒ‰åˆ†ç±»ã€å–œå¥½åšç»Ÿè®¡</p>
<h3 id="1è¯»å–æ•°æ®">1ã€è¯»å–æ•°æ®</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;./datas/movielens-1m/movies.dat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">names</span><span class="o">=</span><span class="s2">&#34;MovieID::Title::Genres&#34;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;::&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;::&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">engine</span><span class="o">=</span><span class="s2">&#34;python&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">Father of the Bride Part II (1995)</td>
<td style="text-align:right">Comedy</td>
</tr>
</tbody>
</table>
<p>*<strong>é—®é¢˜ï¼šæ€æ ·å®ç°è¿™æ ·çš„ç»Ÿè®¡ï¼Œæ¯ä¸ªé¢˜ææœ‰å¤šå°‘éƒ¨ç”µå½±ï¼Ÿ*</strong></p>
<p>è§£å†³æ€è·¯ï¼š</p>
<ul>
<li>å°†GenresæŒ‰ç…§åˆ†éš”ç¬¦|æ‹†åˆ†</li>
<li>æŒ‰Genresæ‹†åˆ†æˆå¤šè¡Œ</li>
<li>ç»Ÿè®¡æ¯ä¸ªGenresä¸‹çš„ç”µå½±æ•°ç›®</li>
</ul>
<h3 id="2å°†genreså­—æ®µæ‹†åˆ†æˆåˆ—è¡¨">2ã€å°†Genreså­—æ®µæ‹†åˆ†æˆåˆ—è¡¨</h3>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">3883</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">3882</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">3</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">MovieID</span>    <span class="mi">3883</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Title</span>      <span class="mi">3883</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Genres</span>     <span class="mi">3883</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">int64</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">object</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">91.1</span><span class="o">+</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å½“å‰çš„Genreså­—æ®µæ˜¯å­—ç¬¦ä¸²ç±»å‹</span>
</span></span><span class="line"><span class="cl"><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&#34;Genres&#34;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">str</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ–°å¢ä¸€åˆ—</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Genre&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;Genres&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;|&#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
<th style="text-align:right">Genre</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
<td style="text-align:right">[Animation, Children&rsquo;s, Comedy]</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
<td style="text-align:right">[Adventure, Children&rsquo;s, Fantasy]</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
<td style="text-align:right">[Comedy, Romance]</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
<td style="text-align:right">[Comedy, Drama]</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">Father of the Bride Part II (1995)</td>
<td style="text-align:right">Comedy</td>
<td style="text-align:right">[Comedy]</td>
</tr>
</tbody>
</table>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Genreçš„ç±»å‹æ˜¯åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Genre&#34;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Genre&#34;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;Animation&#39;</span><span class="p">,</span> <span class="s2">&#34;Children&#39;s&#34;</span><span class="p">,</span> <span class="s1">&#39;Comedy&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">list</span><span class="s1">&#39;&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">3883</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">3882</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">4</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">MovieID</span>    <span class="mi">3883</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Title</span>      <span class="mi">3883</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Genres</span>     <span class="mi">3883</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Genre</span>      <span class="mi">3883</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">int64</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">object</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">121.5</span><span class="o">+</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3ä½¿ç”¨explodeå°†ä¸€è¡Œæ‹†åˆ†æˆå¤šè¡Œ">3ã€ä½¿ç”¨explodeå°†ä¸€è¡Œæ‹†åˆ†æˆå¤šè¡Œ</h3>
<p>è¯­æ³•ï¼špandas.DataFrame.explode(column)
å°†dataframeçš„ä¸€ä¸ªlist-likeçš„å…ƒç´ æŒ‰è¡Œå¤åˆ¶ï¼Œindexç´¢å¼•éšä¹‹å¤åˆ¶</p>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&#34;Genre&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
<th style="text-align:right">Genre</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
<td style="text-align:right">Animation</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
<td style="text-align:right">Children&rsquo;s</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
<td style="text-align:right">Comedy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
<td style="text-align:right">Adventure</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
<td style="text-align:right">Children&rsquo;s</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
<td style="text-align:right">Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
<td style="text-align:right">Comedy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
<td style="text-align:right">Romance</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
<td style="text-align:right">Comedy</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
<td style="text-align:right">Drama</td>
</tr>
</tbody>
</table>
<h3 id="4å®ç°æ‹†åˆ†åçš„é¢˜æçš„ç»Ÿè®¡">4ã€å®ç°æ‹†åˆ†åçš„é¢˜æçš„ç»Ÿè®¡</h3>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span><span class="line"><span class="cl"><span class="n">df_new</span><span class="p">[</span><span class="s2">&#34;Genre&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x23d73917cc8</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/25.png" alt=""></p>
<h1 id="32pandaså€ŸåŠ©pythonçˆ¬è™«è¯»å–htmlç½‘é¡µè¡¨æ ¼å­˜å‚¨åˆ°excelæ–‡ä»¶">32ã€Pandaså€ŸåŠ©Pythonçˆ¬è™«è¯»å–HTMLç½‘é¡µè¡¨æ ¼å­˜å‚¨åˆ°Excelæ–‡ä»¶</h1>
<p>å®ç°ç›®æ ‡ï¼š</p>
<ul>
<li>ç½‘æ˜“æœ‰é“è¯å…¸å¯ä»¥ç”¨äºè‹±è¯­å•è¯æŸ¥è¯¢ï¼Œå¯ä»¥å°†æŸ¥è¯¢çš„å•è¯åŠ å…¥åˆ°å•è¯æœ¬;</li>
<li>å½“å‰æ²¡æœ‰å¯¼å‡ºå…¨éƒ¨å•è¯åˆ—è¡¨çš„åŠŸèƒ½ã€‚ä¸ºäº†å¤ä¹ æ–¹ä¾¿ï¼Œå¯ä»¥çˆ¬å–æ‰€æœ‰çš„å•è¯åˆ—è¡¨ï¼Œå­˜å…¥Excelæ–¹ä¾¿å¤ä¹ </li>
</ul>
<p>æ¶‰åŠæŠ€æœ¯ï¼š</p>
<ul>
<li>Pandasï¼šPythonè¯­è¨€æœ€å¼ºå¤§çš„æ•°æ®å¤„ç†å’Œæ•°æ®åˆ†æåº“</li>
<li>Pythonçˆ¬è™«ï¼šå¯ä»¥å°†ç½‘é¡µä¸‹è½½ä¸‹æ¥ç„¶åè§£æï¼Œä½¿ç”¨requestsåº“å®ç°ï¼Œéœ€è¦ç»•è¿‡ç™»å½•éªŒè¯</li>
</ul>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests.cookies</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="0-å¤„ç†æµç¨‹">0. å¤„ç†æµç¨‹</h3>
<h4 id="è¾“å…¥ç½‘é¡µæœ‰é“è¯å…¸-å•è¯æœ¬">è¾“å…¥ç½‘é¡µï¼šæœ‰é“è¯å…¸-å•è¯æœ¬</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/26.png" alt=""></p>
<h4 id="å¤„ç†æµç¨‹">å¤„ç†æµç¨‹</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/27.png" alt=""></p>
<h4 id="æ•°æ®ç»“æœåˆ°excelæ–‡ä»¶æ–¹ä¾¿æ‰“å°å¤ä¹ ">æ•°æ®ç»“æœåˆ°Excelæ–‡ä»¶ï¼ˆæ–¹ä¾¿æ‰“å°å¤ä¹ ï¼‰ï¼š</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/28.png" alt=""></p>
<h3 id="1-ç™»å½•ç½‘æ˜“æœ‰é“è¯å…¸çš„pcç‰ˆå¾®ä¿¡æ‰«ç ç™»å½•å¤åˆ¶cookiesåˆ°æ–‡ä»¶">1. ç™»å½•ç½‘æ˜“æœ‰é“è¯å…¸çš„PCç‰ˆï¼Œå¾®ä¿¡æ‰«ç ç™»å½•ï¼Œå¤åˆ¶cookiesåˆ°æ–‡ä»¶</h3>
<ul>
<li>PCç‰ˆåœ°å€ï¼šhttp://dict.youdao.com/</li>
<li>Chromeæ’ä»¶å¯ä»¥å¤åˆ¶Cookiesä¸ºJsonæ ¼å¼ï¼šhttp://www.editthiscookie.com/</li>
</ul>
<p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">cookie_jar</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">RequestsCookieJar</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;./course_datas/c32_read_html/cookie.txt&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookiejson</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">cookie</span> <span class="ow">in</span> <span class="n">cookiejson</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cookie_jar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">name</span><span class="o">=</span><span class="n">cookie</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">value</span><span class="o">=</span><span class="n">cookie</span><span class="p">[</span><span class="s2">&#34;value&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">domain</span><span class="o">=</span><span class="n">cookie</span><span class="p">[</span><span class="s2">&#34;domain&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">path</span><span class="o">=</span><span class="n">cookie</span><span class="p">[</span><span class="s2">&#34;path&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">cookie_jar</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;RequestsCookieJar[Cookie(version=0, name=&#39;DICT_LOGIN&#39;, value=&#39;3||1578922508302&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;DICT_PERS&#39;, value=&#39;v2|weixin||DICT||web||2592000000||1578922508299||114.244.161.198||wxoXQUDj_FtHSw23tfJWsboPkq38ok||gFnMeLRLQLRpBOMYMhf6LRUf0Mz5P4TLRqSOM6uhfY5RzW0L6ZhHTB0kGRHeukLg40QZOMOMkMwu0gBkfJF0LTL0&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;DICT_SESS&#39;, value=&#39;v2|odmTRIUgTmgz6MlEOMqB0TBnfk5h4pZ0Py0MeBP4Q40qynHeuPMOWRpLPMY5RHJuRQykfJBOLQBRPKO4YYOLquR6zhLwBnMYMR&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;DICT_UGC&#39;, value=&#39;be3af0da19b5c5e6aa4e17bd8d90b28a|&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;JSESSIONID&#39;, value=&#39;abc46uQPL03Au_P0ghF_w&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;OUTFOX_SEARCH_USER_ID&#39;, value=&#39;&#34;1678365514@10.108.160.18&#34;&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;OUTFOX_SEARCH_USER_ID_NCOO&#39;, value=&#39;1349541628.6994112&#39;, port=None, port_specified=False, domain=&#39;.youdao.com&#39;, domain_specified=True, domain_initial_dot=True, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;ACCSESSIONID&#39;, value=&#39;8F00E30693F3BD052C9A4F293394BE0A&#39;, port=None, port_specified=False, domain=&#39;dict.youdao.com&#39;, domain_specified=True, domain_initial_dot=False, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False), Cookie(version=0, name=&#39;___rl__test__cookies&#39;, value=&#39;1578922438675&#39;, port=None, port_specified=False, domain=&#39;dict.youdao.com&#39;, domain_specified=True, domain_initial_dot=False, path=&#39;/&#39;, path_specified=True, secure=False, expires=None, discard=True, comment=None, comment_url=None, rest={&#39;HttpOnly&#39;: None}, rfc2109=False)]&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-å°†htmléƒ½ä¸‹è½½ä¸‹æ¥å­˜å…¥åˆ—è¡¨">2. å°†htmléƒ½ä¸‹è½½ä¸‹æ¥å­˜å…¥åˆ—è¡¨</h3>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">htmls</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://dict.youdao.com/wordbook/wordlist?p=</span><span class="si">{idx}</span><span class="s2">&amp;tags=&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;**çˆ¬æ•°æ®ï¼šç¬¬</span><span class="si">%d</span><span class="s2">é¡µ&#34;</span> <span class="o">%</span> <span class="n">idx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">idx</span><span class="p">),</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookie_jar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">htmls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">**</span><span class="n">çˆ¬æ•°æ®</span><span class="err">ï¼š</span><span class="n">ç¬¬0é¡µ</span>
</span></span><span class="line"><span class="cl"><span class="o">**</span><span class="n">çˆ¬æ•°æ®</span><span class="err">ï¼š</span><span class="n">ç¬¬1é¡µ</span>
</span></span><span class="line"><span class="cl"><span class="o">**</span><span class="n">çˆ¬æ•°æ®</span><span class="err">ï¼š</span><span class="n">ç¬¬2é¡µ</span>
</span></span><span class="line"><span class="cl"><span class="o">**</span><span class="n">çˆ¬æ•°æ®</span><span class="err">ï¼š</span><span class="n">ç¬¬3é¡µ</span>
</span></span><span class="line"><span class="cl"><span class="o">**</span><span class="n">çˆ¬æ•°æ®</span><span class="err">ï¼š</span><span class="n">ç¬¬4é¡µ</span>
</span></span><span class="line"><span class="cl"><span class="o">**</span><span class="n">çˆ¬æ•°æ®</span><span class="err">ï¼š</span><span class="n">ç¬¬5é¡µ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">htmls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=UTF-8&#34;/&gt;\n&lt;title&gt;æœ‰é“å•è¯æœ¬&lt;/title&gt;\n\n&lt;link rel=&#34;canonical&#34; href=&#34;http://dict.youdao.com/wordbook/&#34;/&gt; \n&lt;meta name=&#34;Keywords&#34; content=&#34;å•è¯æœ¬,webå•è¯æœ¬,æœ‰é“,è¯å…¸,youdao&#34; /&gt;\n&lt;meta name=&#34;Description&#34; content=&#34;æœ‰é“è¯å…¸å•è¯æœ¬&#34; /&gt;\n&lt;link rel=&#34;shortcut icon&#34; href=&#34;http://shared.ydstatic.com/images/favicon.ico?213&#34; type=&#34;image/x-icon&#34;/&gt;\n&lt;link href=&#34;http://shared.ydstatic.com/r/1.0/s/g3.css?20110428&#34; rel=&#34;stylesheet&#34; type=&#34;text/css&#34;/&gt;\n&lt;link type=&#34;text/css&#34; href=&#34;resources/styles/main.css&#34; rel=&#34;stylesheet&#34;&gt;\n\n&lt;style type=&#34;text/css&#34;&gt;\n\n#f{background-image:url(http://shared.ydstatic.com/images/skins/default/skin-x.jpg)}\n#fbl{background:url(http://shared.ydstatic.com/images/skins/default/skin_.jpg) left top}\n#fbr{background:url(http://shared.ydstatic.com/images/skins/default/skin_.jpg) right -200px}\n\n&lt;/style&gt;\n&lt;script type=&#34;text/javascript&#34;&gt;\nvar VARIABLES={ \n                tags:&#34;&#34;,\n                page:&#34;0&#34;,\n                sort:&#34;&#34;,\n                querystring:&#34;&#34;\n        };\n&lt;/script&gt;\n\n\n&lt;/head&gt;\n\n&lt;body&gt;\n\n&lt;div id=&#34;t&#34;&gt;\n    &lt;div id=&#34;u&#34;&gt;\n                    &lt;span id=&#34;un&#34;&gt;\n        &lt;span class=&#34;un_n&#34;&gt;æ™šä¸Šå¥½ï¼Œ&lt;/span&gt;\n        &lt;span id=&#34;mun&#34; class=&#34;un_box&#34;&gt;&lt;b class=&#34;un_l&#34;&gt;&lt;q&gt;&lt;/q&gt;&lt;/b&gt;&lt;b class=&#34;un_r&#34;&gt;&lt;q&gt;&lt;/q&gt;&lt;/b&gt;\n                 &lt;span class=&#34;un_btn&#34;&gt;&lt;b class=&#34;un_m&#34;&gt;&amp;nbsp;&lt;q&gt;&lt;/q&gt;&lt;/b&gt;\n               &lt;span class=&#34;un_ml&#34;&gt;\n                    wxoXQUDj_FtHSw23tfJWsboPkq38ok\n                                  &lt;/span&gt;\n                                    &lt;/span&gt;\n            &lt;/span&gt;\n       &lt;/span&gt;\n                       &lt;span class=&#34;sl&#34;&gt;|&lt;/span&gt;\n                            &lt;a href=&#34;http://account.youdao.com/logout?service=dict&amp;back_url=http%3A%2F%2Fdict.youdao.com%2Fwordbook%2Fwordlist&#34;&gt;ç™»å‡º&lt;/a&gt;\n            &lt;/div&gt;\n    &lt;div id=&#34;n&#34;&gt;\n        &lt;a href=&#34;http://www.163.com/&#34; id=&#34;mn&#34; class=&#34;mn&#34; target=&#34;_blank&#34;&gt;&lt;u&gt;ç½‘æ˜“&lt;/u&gt;&lt;s&gt;â–¼&lt;/s&gt;&lt;/a&gt;\n        &lt;span class=&#34;sl&#34;&gt;|&lt;/span&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;www\&#39; href=&#34;http://www.youdao.com&#34;&gt;ç½‘é¡µ&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;image\&#39; href=&#34;http://image.youdao.com&#34;&gt;å›¾ç‰‡&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;news\&#39; href=&#34;http://news.youdao.com&#34;&gt;çƒ­é—»&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;gouwu\&#39; href=&#34;http://gouwu.youdao.com&#34;&gt;è´­ç‰©&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;dict\&#39; href=&#34;http://dict.youdao.com&#34;&gt;è¯å…¸&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;fanyi\&#39; data-trans=\&#39;translate?i=\&#39; href=&#34;http://fanyi.youdao.com/&#34;&gt;ç¿»è¯‘&lt;/a&gt;\n        &lt;a class=&#34;search-js&#34; data-product=\&#39;note\&#39; href=&#34;http://note.youdao.com&#34;&gt;ç¬”è®°&lt;/a&gt;\n        &lt;strong&gt;å•è¯æœ¬&lt;/strong&gt;\n\t&lt;a class=&#34;mn&#34; target=&#34;_blank&#34; href=&#34;http://www.youdao.com/about/productlist.html&#34;&gt;&lt;u&gt;æ›´å¤šÂ»&lt;/u&gt;&lt;/a&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;\n\n\n&lt;div id=&#34;ym&#34; class=&#34;pm&#34;&gt;\n    &lt;ul&gt;\n        &lt;li&gt;&lt;a href=&#34;http://video.youdao.com&#34; class=&#34;search-js&#34; data-product=\&#39;video\&#39;&gt;è§†é¢‘&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://blog.youdao.com/&#34; class=&#34;search-js&#34; data-product=\&#39;blog\&#39;&gt;åšå®¢&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://tie.youdao.com/&#34; class=&#34;search-js&#34; data-product=\&#39;tie\&#39;&gt;å¿«è´´&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://ditu.youdao.com/&#34; class=&#34;search-js&#34; data-product=\&#39;ditu\&#39;&gt;åœ°å›¾&lt;/a&gt;&lt;/li&gt;\n\n        &lt;li class=&#34;sl&#34;&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://reader.youdao.com&#34;&gt;é˜…è¯»&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://m.youdao.com/help&#34;&gt;æ‰‹æœº&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://shuqian.youdao.com&#34;&gt;ä¹¦ç­¾&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://cidian.youdao.com&#34; class=&#34;search-js&#34; data-product=\&#39;cidian\&#39;&gt;æ¡Œé¢è¯å…¸&lt;/a&gt;&lt;/li&gt;\n        &lt;li class=&#34;sl&#34;&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://www.youdao.com/about/productlist.html&#34;&gt;å…¨éƒ¨äº§å“&lt;/a&gt;&lt;/li&gt;\n\n    &lt;/ul&gt;\n&lt;/div&gt;\n&lt;div id=&#34;nm&#34; class=&#34;pm&#34;&gt;\n    &lt;ul&gt;\n        &lt;li&gt;&lt;a href=&#34;http://www.163.com/&#34; target=&#34;_blank&#34;&gt;é¦–é¡µ&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://news.163.com/&#34; target=&#34;_blank&#34;&gt;æ–°é—»&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://email.163.com/&#34; target=&#34;_blank&#34;&gt;é‚®ç®±&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://blog.163.com/&#34; target=&#34;_blank&#34;&gt;åšå®¢&lt;/a&gt;&lt;/li&gt;\n\n        &lt;li&gt;&lt;a href=&#34;http://photo.163.com/&#34; target=&#34;_blank&#34;&gt;ç›¸å†Œ&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://nie.163.com/&#34; target=&#34;_blank&#34;&gt;æ¸¸æˆ&lt;/a&gt;&lt;/li&gt;\n        &lt;li class=&#34;sl&#34;&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=&#34;http://sitemap.163.com/&#34; target=&#34;_blank&#34;&gt;å…¨éƒ¨äº§å“&lt;/a&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n&lt;/div&gt;\n\n\n&lt;!-- å›¾æ ‡ä¸æœç´¢æ¡† --&gt;\n&lt;form id=&#34;f&#34; method=&#34;get&#34; action=&#34;#&#34; name=&#34;sb&#34;&gt;\n  &lt;h1 id=&#34;yd&#34;&gt;&lt;a href=&#34;/wordbook/wordlist&#34;&gt;æœ‰é“å•è¯æœ¬&lt;/a&gt;&lt;/h1&gt;\n   &lt;!--&lt;div id=&#34;ts&#34; class=&#34;fc&#34;&gt;\n \n    &lt;div class=&#34;qc no-suggest&#34; id=&#34;qc&#34;&gt;\n      &lt;input name=&#34;tab&#34; value=&#34;chn&#34; type=&#34;hidden&#34;&gt;\n      &lt;input name=&#34;keyfrom&#34; value=&#34;shuqian.top&#34; type=&#34;hidden&#34;&gt;\n      &lt;input type=&#34;text&#34; class=&#34;q&#34; name=&#34;q&#34; id=&#34;query&#34; autocomplete=&#34;off&#34;  value=&#34;&#34;/&gt;\n    &lt;/div&gt;\n    &lt;input type=&#34;submit&#34; value=&#34;æœ ç´¢&#34; class=&#34;qb&#34; name=&#34;btnSearchTag&#34;/&gt;\n    \n  &lt;/div&gt;--&gt;\n  &lt;div class=&#34;ao&#34;&gt;&lt;/div&gt;\n  &lt;div id=&#34;fbl&#34;&gt; &lt;/div&gt;\n  &lt;div id=&#34;fbr&#34;&gt; &lt;/div&gt;\n&lt;/form&gt; \n \n\n&lt;div id=&#34;wrapper&#34;&gt;\n\n\n    &lt;div id=&#34;top&#34; &gt;\n        \n\n                &lt;a href=&#34;#&#34; id=&#34;addword&#34;&gt;&lt;/a&gt;\n\n                \n              \n            &lt;div style=&#34;width:500px;float:right;text-align:right;&#34;&gt;    \n                &lt;label for=&#34;select_category&#34;&gt;åˆ†ç±»&lt;/label&gt;\n                &lt;select id=&#34;select_category&#34;&gt;\n                    &lt;option value=&#34;&#34;&gt;å…¨éƒ¨åˆ†ç±»&lt;/option&gt;\n                                            &lt;option value=&#34;æ— æ ‡ç­¾&#34; &gt;æ— æ ‡ç­¾ &lt;/option&gt;\n                                    &lt;/select&gt;  \n                        \n        &lt;a href=&#34;#&#34; id=&#34;toggle_listmode&#34; class=&#34;active&#34;&gt;&lt;/a&gt;&lt;a href=&#34;#&#34; id=&#34;toggle_cardmode&#34; &gt;&lt;/a&gt;\n        &lt;/div&gt;\n        &lt;div class=&#34;clear&#34;&gt;&lt;/div&gt;\n\n    &lt;/div&gt;   \n    \n    &lt;div id=&#34;listmode&#34;&gt;\n               &lt;div id=&#34;wordhead&#34;&gt;\n            &lt;table  width=&#34;100%&#34; style=&#34;table-layout:fixed;background:#fff;&#34;&gt;\n                    &lt;tr&gt;\n                        &lt;th width=&#34;50px&#34;&gt;åºå·&lt;/th&gt;\n                        &lt;th width=&#34;80px&#34;&gt;å•è¯&lt;/th&gt;\n                        &lt;th width=&#34;80px&#34;&gt;éŸ³æ ‡&lt;/th&gt;\n                        &lt;th width=&#34;320px&#34;&gt;è§£é‡Š&lt;/th&gt;\n                       &lt;!--  &lt;th width=&#34;50px&#34;&gt;éš¾åº¦&lt;/th&gt; --&gt;\n                        &lt;th width=&#34;85px&#34;&gt;æ—¶é—´&lt;/th&gt;\n                        &lt;th&gt;åˆ†ç±»&lt;/th&gt;\n                        &lt;th width=&#34;65px&#34;&gt;æ“ä½œ&lt;/th&gt;\n                    &lt;/tr&gt;\n            &lt;/table&gt;\n        &lt;/div&gt; \n        \n        &lt;div id=&#34;wordlist&#34; &gt;\n            &lt;table  width=&#34;100%&#34; style=&#34;table-layout:fixed&#34;&gt;\n\n                &lt;tbody&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 1&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;agglomerative&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=agglomerative&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;agglomerative&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;&#34;&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;adj. ä¼šå‡èšçš„ï¼›[å†¶] çƒ§ç»“çš„ï¼Œå‡ç»“çš„&#34;&gt;adj. ä¼šå‡èšçš„ï¼›[å†¶] çƒ§ç»“çš„ï¼Œå‡ç»“çš„&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2020-1-13&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘agglomerative&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=agglomerative&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤agglomerative&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ agglomerative å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 2&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;anatomy&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=anatomy&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;anatomy&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[É™&amp;#39;nÃ¦tÉ™mÉª]&#34;&gt;[É™&amp;#39;nÃ¦tÉ™mÉª]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. è§£å‰–ï¼›è§£å‰–å­¦ï¼›å‰–æï¼›éª¨éª¼&#34;&gt;n. è§£å‰–ï¼›è§£å‰–å­¦ï¼›å‰–æï¼›éª¨éª¼&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2017-7-17&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘anatomy&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=anatomy&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤anatomy&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ anatomy å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 3&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;backbone&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=backbone&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;backbone&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[&amp;#39;bÃ¦kbÉ™ÊŠn]&#34;&gt;[&amp;#39;bÃ¦kbÉ™ÊŠn]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. æ”¯æŸ±;ä¸»å¹²ç½‘;å†³å¿ƒ,æ¯…åŠ›;è„Šæ¤&#34;&gt;n. æ”¯æŸ±;ä¸»å¹²ç½‘;å†³å¿ƒ,æ¯…åŠ›;è„Šæ¤&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2017-7-13&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘backbone&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=backbone&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤backbone&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ backbone å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 4&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;ballpark&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=ballpark&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;ballpark&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[&amp;#39;bÉ”ËlpÉ‘Ëk]&#34;&gt;[&amp;#39;bÉ”ËlpÉ‘Ëk]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. (ç¾)æ£’çƒåœº;æ´»åŠ¨é¢†åŸŸ;å¯å˜é€šèŒƒå›´\nadj. å¤§çº¦çš„&#34;&gt;n. (ç¾)æ£’çƒåœº;æ´»åŠ¨é¢†åŸŸ;å¯å˜é€šèŒƒå›´\nadj. å¤§çº¦çš„&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-16&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘ballpark&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=ballpark&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤ballpark&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ ballpark å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 5&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;bilingual&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=bilingual&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;bilingual&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[baÉª&amp;#39;lÉªÅ‹gw(É™)l]&#34;&gt;[baÉª&amp;#39;lÉªÅ‹gw(É™)l]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;adj. åŒè¯­çš„\nn. é€šä¸¤ç§è¯­è¨€çš„äºº&#34;&gt;adj. åŒè¯­çš„\nn. é€šä¸¤ç§è¯­è¨€çš„äºº&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-15&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘bilingual&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=bilingual&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤bilingual&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ bilingual å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 6&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;canonical&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=canonical&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;canonical&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[kÉ™&amp;#39;nÉ’nÉªk(É™)l]&#34;&gt;[kÉ™&amp;#39;nÉ’nÉªk(É™)l]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;adj. ä¾æ•™è§„çš„;æƒå¨çš„;ç‰§å¸ˆçš„\nn. ç‰§å¸ˆç¤¼æœ&#34;&gt;adj. ä¾æ•™è§„çš„;æƒå¨çš„;ç‰§å¸ˆçš„\nn. ç‰§å¸ˆç¤¼æœ&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-14&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘canonical&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=canonical&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤canonical&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ canonical å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 7&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;cater&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=cater&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;cater&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[&amp;#39;keÉªtÉ™]&#34;&gt;[&amp;#39;keÉªtÉ™]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;vt. æŠ•åˆï¼Œè¿åˆï¼›æ»¡è¶³éœ€è¦ï¼›æä¾›é¥®é£ŸåŠæœåŠ¡\nn. (Cater)äººåï¼›(è‹±)å‡¯ç‰¹&#34;&gt;vt. æŠ•åˆï¼Œè¿åˆï¼›æ»¡è¶³éœ€è¦ï¼›æä¾›é¥®é£ŸåŠæœåŠ¡\nn. (Cater)äººåï¼›(è‹±)å‡¯ç‰¹&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2017-7-17&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘cater&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=cater&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤cater&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ cater å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 8&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;clarity&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=clarity&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;clarity&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[&amp;#39;klÃ¦rÉªtÉª]&#34;&gt;[&amp;#39;klÃ¦rÉªtÉª]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. æ¸…æ¥š,æ˜æ™°;é€æ˜\nn. (Clarity)äººå;(è‹±)å…‹æ‹‰é‡Œè’‚&#34;&gt;n. æ¸…æ¥š,æ˜æ™°;é€æ˜\nn. (Clarity)äººå;(è‹±)å…‹æ‹‰é‡Œè’‚&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-16&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘clarity&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=clarity&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤clarity&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ clarity å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 9&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;compression&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=compression&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;compression&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[kÉ™m&amp;#39;preÊƒ(É™)n]&#34;&gt;[kÉ™m&amp;#39;preÊƒ(É™)n]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. å‹ç¼©,æµ“ç¼©;å‹æ¦¨,å‹è¿«&#34;&gt;n. å‹ç¼©,æµ“ç¼©;å‹æ¦¨,å‹è¿«&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-15&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘compression&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=compression&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤compression&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ compression å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 10&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;contaminated&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=contaminated&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;contaminated&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;&#34;&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;adj. å—æ±¡æŸ“çš„ï¼Œå¼„è„çš„ v. æ±¡æŸ“ï¼›ç·æ±¡ï¼Œæ¯’å®³ï¼ˆcontaminate çš„è¿‡å»å¼å’Œè¿‡å»åˆ†è¯ï¼‰&#34;&gt;adj. å—æ±¡æŸ“çš„ï¼Œå¼„è„çš„ v. æ±¡æŸ“ï¼›ç·æ±¡ï¼Œæ¯’å®³ï¼ˆcontaminate çš„è¿‡å»å¼å’Œè¿‡å»åˆ†è¯ï¼‰&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2020-1-13&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘contaminated&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=contaminated&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤contaminated&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ contaminated å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 11&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;counterparts&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=counterparts&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;counterparts&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[]&#34;&gt;[]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. ï¼ˆå¥‘çº¦ï¼‰å‰¯æœ¬ï¼ˆcounterpartçš„å¤æ•°ï¼‰ï¼›ç›¸å¯¹ç‰©ï¼›ç›¸å¯¹åº”çš„äºº&#34;&gt;n. ï¼ˆå¥‘çº¦ï¼‰å‰¯æœ¬ï¼ˆcounterpartçš„å¤æ•°ï¼‰ï¼›ç›¸å¯¹ç‰©ï¼›ç›¸å¯¹åº”çš„äºº&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2017-7-16&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘counterparts&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=counterparts&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤counterparts&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ counterparts å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 12&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;criteria&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=criteria&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;criteria&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[kraÉª&amp;#39;tÉªÉ™rÉªÉ™]&#34;&gt;[kraÉª&amp;#39;tÉªÉ™rÉªÉ™]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. æ ‡å‡†ï¼Œæ¡ä»¶ï¼ˆcriterionçš„å¤æ•°ï¼‰&#34;&gt;n. æ ‡å‡†ï¼Œæ¡ä»¶ï¼ˆcriterionçš„å¤æ•°ï¼‰&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2017-7-6&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘criteria&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=criteria&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤criteria&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ criteria å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 13&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;crunch&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=crunch&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;crunch&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[krÊŒntÊƒ]&#34;&gt;[krÊŒntÊƒ]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n.å’¬ç¢ï¼Œå’¬ç¢å£°ï¼›æ‰æ‰åœ°è¸\nvt.å‹ç¢ï¼›å˜æ‰å˜æ‰çš„å’¬åš¼ï¼›æ‰æ‰åœ°è¸è¿‡\nvi.å˜å±ä½œå“åœ°å’€åš¼ï¼›å˜å±å˜å±åœ°è¸è¿‡&#34;&gt;n.å’¬ç¢ï¼Œå’¬ç¢å£°ï¼›æ‰æ‰åœ°è¸\nvt.å‹ç¢ï¼›å˜æ‰å˜æ‰çš„å’¬åš¼ï¼›æ‰æ‰åœ°è¸è¿‡\nvi.å˜å±ä½œå“åœ°å’€åš¼ï¼›å˜å±å˜å±åœ°è¸è¿‡&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-8&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘crunch&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=crunch&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤crunch&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ crunch å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 14&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;delighted&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=delighted&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;delighted&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;[dÉª&amp;#39;laÉªtÉªd]&#34;&gt;[dÉª&amp;#39;laÉªtÉªd]&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;adj. é«˜å…´çš„;æ¬£å–œçš„\nv. ä½¿â€¦å…´é«˜é‡‡çƒˆ;æ„Ÿåˆ°å¿«ä¹(delightçš„è¿‡å»åˆ†è¯)&#34;&gt;adj. é«˜å…´çš„;æ¬£å–œçš„\nv. ä½¿â€¦å…´é«˜é‡‡çƒˆ;æ„Ÿåˆ°å¿«ä¹(delightçš„è¿‡å»åˆ†è¯)&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2019-10-16&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘delighted&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=delighted&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤delighted&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ delighted å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                        &lt;tr&gt;\n                        &lt;td width=&#34;50px&#34;&gt; 15&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;word&#34;  title=&#34;denominator&#34;&gt;&lt;a href=&#34;/search?keyfrom=webwordbook&amp;q=denominator&#34;  target=&#34;_blank&#34;&gt;&lt;strong&gt;denominator&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;80px&#34;&gt;&lt;div class=&#34;phonetic&#34;  title=&#34;&#34;&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;td width=&#34;320px&#34;&gt;\n                            &lt;div  class=&#34;desc&#34;  title=&#34;n. [æ•°] åˆ†æ¯ï¼›å‘½åè€…ï¼›å…±åŒç‰¹å¾æˆ–å…±åŒæ€§è´¨ï¼›å¹³å‡æ°´å¹³æˆ–æ ‡å‡†&#34;&gt;n. [æ•°] åˆ†æ¯ï¼›å‘½åè€…ï¼›å…±åŒç‰¹å¾æˆ–å…±åŒæ€§è´¨ï¼›å¹³å‡æ°´å¹³æˆ–æ ‡å‡†&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;!-- &lt;td width=&#34;50px&#34;&gt;\n                            &lt;span class=&#34;flag&#34; style=&#34;display:none;&#34;&gt;0&lt;/span&gt;\n                            &lt;span class=&#34;level&#34;&gt;\n                                                        &lt;/span&gt;\n                        &lt;/td&gt; --&gt;\n\n                        &lt;td width=&#34;85px&#34;&gt;2020-1-13&lt;/td&gt;\n                        &lt;td &gt;\n                            &lt;div  class=&#34;tags&#34; title=&#34;&#34;&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td width=&#34;65px&#34; style=&#34;vertical-align:middle;&#34;&gt;\n                            &lt;a href=&#34;#&#34; class=&#34;editword&#34;  title=&#34;ç¼–è¾‘denominator&#34; &gt;&lt;/a&gt;\n                            \n                           \n                            &lt;a href=\n                                                        &#34;wordlist?action=delete&amp;word=denominator&amp;p=0&#34; \n                                                        class=&#34;deleteword&#34; title=&#34;åˆ é™¤denominator&#34; onclick=\&#39;if(!confirm(&#34;æ‚¨ç¡®å®šåˆ é™¤å•è¯ denominator å—ï¼Ÿ&#34;)){ return false;}else return true;\&#39;&gt;&lt;/a&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                                    &lt;/tbody&gt;\n            &lt;/table&gt;\n        &lt;/div&gt;\n      \n  \n        &lt;div id=&#34;wordfoot&#34; &gt;\n            \n                                &lt;div id=&#34;pagination&#34;&gt;\n                                                             &lt;span class=&#34;current-page&#34;&gt;1 &lt;/span&gt;\n                    \n                    \n                                                                                                                                                                                                                                                    &lt;a href=&#34;wordlist?p=1&amp;tags=&#34;&gt;2&lt;/a&gt; \n                                                                                                                                                                                                                                                                                                                                                                                            &lt;a href=&#34;wordlist?p=2&amp;tags=&#34;&gt;3&lt;/a&gt; \n                                                                                                                                                                                                                                                                                                        &lt;span style=&#34;border:none;&#34;&gt;...&lt;/span&gt;\n                                \n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \n                                        &lt;a href=&#34;wordlist?p=1&amp;tags=&#34; class=&#34;next-page&#34;&gt;ä¸‹ä¸€é¡µ&lt;/a&gt;\n                                        &lt;a href=&#34;wordlist?p=7&amp;tags=&#34; class=&#34;next-page&#34;&gt;æœ€åä¸€é¡µ&lt;/a&gt;\n                &lt;/div&gt;\n               &lt;form id=&#34;pagejumpform&#34; action=&#34;#&#34;&gt;\n               è·³è‡³ç¬¬&lt;input type=&#34;text&#34; value=&#34;&#34;/&gt;é¡µ&lt;button type=&#34;submit&#34;&gt;ç¡®å®š&lt;/button&gt;\n               &lt;/form&gt;                \n                              \n\n               \n             \n             \n             &lt;div class=&#34;right&#34; &gt;å½“å‰åˆ†ç±»ï¼š&lt;strong&gt; å…¨éƒ¨åˆ†ç±» &lt;/strong&gt; &amp;nbsp;&amp;nbsp;å…±è®¡ &lt;strong&gt;86&lt;/strong&gt; ä¸ªå•è¯ &lt;/div&gt;\n             &lt;div class=&#34;clear&#34;&gt;&lt;/div&gt;\n        &lt;/div&gt;\n            &lt;/div&gt;\n    \n\n    \n    &lt;div id=&#34;cardmode&#34;&gt;\n          &lt;div id=&#34;cardmode-wrap&#34;&gt;\n        &lt;div id=&#34;card&#34;&gt;\n                                            &lt;h1 &gt;&lt;span id=&#34;card_word&#34;&gt;agglomerative&lt;/span&gt;&lt;a href=&#34;#&#34; id=&#34;phonetic-voice&#34;&gt;&lt;/a&gt;&lt;/h1&gt; \n                &lt;div id=&#34;card_pronounce&#34;&gt;\n                    \n                &lt;/div&gt;\n\n                &lt;div id=&#34;description&#34; style=&#34;display:none;&#34;&gt;\n                    adj. ä¼šå‡èšçš„ï¼›[å†¶] çƒ§ç»“çš„ï¼Œå‡ç»“çš„\n                &lt;/div&gt;\n\n                &lt;div id=&#34;mask&#34; &gt;\n                    &lt;span id=&#34;toggle-description&#34; &gt;&lt;img src=&#34;http://shared.ydstatic.com/dict/wordbook-v1/images/mask.png&#34;&gt;&lt;/span&gt;\n                &lt;/div&gt;\n            \n                &lt;div id=&#34;action&#34;&gt;\n                    &lt;a id=&#34;pre&#34; href=&#34;#&#34;&gt;&lt;/a&gt;\n                    &lt;a id=&#34;next&#34; href=&#34;#&#34;&gt;&lt;/a&gt;\n                    &lt;div style=&#34;clear:both;&#34;&gt;&lt;/div&gt;\n                &lt;/div&gt;\n                \n                                                                                                                                                                                                                                                                                                                                                                                                                                            &lt;/div&gt;\n      &lt;/div&gt;\n        &lt;div style=&#34;line-height:28px;text-align:right;&#34;&gt;\n            å½“å‰åˆ†ç±»ï¼š&lt;strong&gt; å…¨éƒ¨åˆ†ç±» &lt;/strong&gt; &amp;nbsp;&amp;nbsp;å…±è®¡ \n            &lt;strong id=&#34;card_max_id&#34;&gt;86&lt;/strong&gt; ä¸ªå•è¯ ç°åœ¨æ˜¯ç¬¬&lt;span id=&#34;card_id&#34;&gt; 1&lt;/span&gt;ä¸ª\n        &lt;/div&gt;\n              \n    &lt;/div&gt;\n    \n\n\n\n\n\n&lt;div id=&#34;footarea&#34; &gt;\n    &lt;div style=&#34; line-height:2; margin:10px 0 20px;&#34;&gt;æ›´å¥½çš„è¿›è¡Œç”Ÿè¯çš„æ•´ç†/è®°å¿†ï¼Œè¯·ä½¿ç”¨æ¡Œé¢ç‰ˆå’Œæ‰‹æœºç‰ˆæœ‰é“è¯å…¸ä¸­çš„å•è¯æœ¬&lt;/div&gt;\n    &lt;div id=&#34;foot-ad&#34;&gt;\n    \n        &lt;a href=&#34;http://cidian.youdao.com/?keyform=webwordbook&#34; class=&#34;go-to-desktop&#34; target=&#34;_blank&#34;&gt;&lt;/a&gt;\n        &lt;a href=&#34;http://cidian.youdao.com/android.html?keyform=webwordbook&#34; class=&#34;go-to-mobile&#34; target=&#34;_blank&#34;&gt;&lt;/a&gt;\n\n    &lt;/div&gt;\n&lt;/div&gt;   \n\n&lt;/div&gt;\n\n&lt;div id=&#34;bottom&#34;&gt;\n  &lt;p&gt;&lt;a href=&#34;http://youdao.com/&#34;&gt;æœ‰é“é¦–é¡µ&lt;/a&gt; - &lt;a href=&#34;http://www.youdao.com/help/dict/description/001/&#34;&gt;å¸®åŠ©&lt;/a&gt; - &lt;a href=&#34;http://www.youdao.com/about/&#34;&gt;å…³äºæœ‰é“&lt;/a&gt; - &lt;a href=&#34;http://i.youdao.com/&#34;&gt;å®˜æ–¹åšå®¢&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;copy; 2020 ç½‘æ˜“å…¬å¸ äº¬ICPè¯080268å·&lt;/p&gt;\n  \n&lt;/div&gt;\n\n\n\n    &lt;div id=&#34;editwordform&#34;&gt;\n        &lt;h1&gt;danci&lt;/h1&gt;\n        &lt;a href=&#34;#&#34; id=&#34;close-editwordform&#34;&gt;&lt;/a&gt;\n        &lt;form method=&#34;post&#34; action=&#34;wordlist?action=modify&#34;&gt;\n        \n        &lt;label for=&#34;word&#34;&gt;å•è¯&lt;span id=&#34;waittext&#34;&gt;&lt;/span&gt;&lt;/label&gt;\n        &lt;input id=&#34;word&#34; type=&#34;text&#34; value=&#34;&#34; name=&#34;word&#34; autocomplete=&#34;off&#34; /&gt;\n        &lt;label for=&#34;phonetic&#34;&gt;éŸ³æ ‡&lt;/label&gt;\n        &lt;input id=&#34;phonetic&#34; type=&#34;text&#34; value=&#34;&#34; name=&#34;phonetic&#34; /&gt;\n        &lt;label for=&#34;desc&#34;&gt;è§£é‡Š&lt;/label&gt;\n        &lt;textarea id=&#34;desc&#34; name=&#34;desc&#34; &gt;&lt;/textarea&gt;\n        \n        &lt;label style=&#34;color:blue;&#34;&gt;æ›´å¤šï¼ˆå¯ä¸å¡«ï¼‰&lt;/label&gt;\n\n        &lt;label for=&#34;tags&#34;&gt;åˆ†ç±»&lt;/label&gt;&lt;input id=&#34;tags&#34; type=&#34;text&#34; value=&#34;&#34; name=&#34;tags&#34; autocomplete=&#34;off&#34; /&gt;\n        &lt;ul id=&#34;tag-select-list&#34;&gt;\n                                            &lt;li&gt;æ— æ ‡ç­¾&lt;/li&gt;\n                                    &lt;/ul&gt;\n            \n        &lt;div class=&#34;center-content&#34;&gt;&lt;button type=&#34;submit&#34;&gt;&lt;/button&gt;&lt;/div&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;        \n\n&lt;div id=&#34;leftbar&#34;&gt;\n&lt;a href=&#34;/?keyfrom=webwordbook&#34;&gt;è¿”å›è¯å…¸é¦–é¡µ&lt;/a&gt;\n&lt;br/&gt;&lt;br/&gt;\n&lt;a href=&#34;http://xue.youdao.com/&#34;&gt;è¿”å›æœ‰é“å­¦å ‚&lt;/a&gt;\n&lt;/div&gt;    \n    &lt;object width=&#34;1&#34; height=&#34;1&#34; type=&#34;application/x-shockwave-flash&#34; id=&#34;dictVoice&#34; data=&#34;/dictVoice.swf&#34;&gt;\n        &lt;param name=&#34;movie&#34; value=&#34;/dictVoice.swf&#34;/&gt;\n        &lt;param name=&#34;menu&#34; value=&#34;false&#34;/&gt;\n        &lt;param name=&#34;allowScriptAccess&#34; value=&#34;always&#34;/&gt;\n        &lt;param name=&#34;wmode&#34; value=&#34;transparent&#34;/&gt;\n    &lt;/object&gt;\n    \n&lt;script type=&#34;text/javascript&#34; src=&#34;http://shared.ydstatic.com/dict/wordbook-v1/scripts/jquery-1.5.2.min.js&#34;&gt;&lt;/script&gt;\n&lt;script type=&#34;text/javascript&#34; src=&#34;http://shared.ydstatic.com/dict/wordbook-v1/scripts/jquery.extention.dict4.js&#34;&gt;&lt;/script&gt;\n&lt;script type=&#34;text/javascript&#34; src=&#34;http://shared.ydstatic.com/dict/wordbook-v1/scripts/navigatorBar.js&#34;&gt;&lt;/script&gt;\n&lt;script type=&#34;text/javascript&#34; src=&#34;resources/scripts/main.js&#34;&gt;&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-ä½¿ç”¨pandasè§£æç½‘é¡µä¸­çš„è¡¨æ ¼">3. ä½¿ç”¨Pandasè§£æç½‘é¡µä¸­çš„è¡¨æ ¼</h3>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">htmls</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">list</span><span class="s1">&#39;&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">åºå·</th>
<th style="text-align:right">å•è¯</th>
<th style="text-align:right">éŸ³æ ‡</th>
<th style="text-align:right">è§£é‡Š</th>
<th style="text-align:right">æ—¶é—´</th>
<th style="text-align:right">åˆ†ç±»</th>
<th style="text-align:right">æ“ä½œ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
<th style="text-align:right">2</th>
<th style="text-align:right">3</th>
<th style="text-align:right">4</th>
<th style="text-align:right">5</th>
<th style="text-align:right">6</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">agglomerative</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">adj. ä¼šå‡èšçš„ï¼›[å†¶] çƒ§ç»“çš„ï¼Œå‡ç»“çš„</td>
<td style="text-align:right">2020-1-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">anatomy</td>
<td style="text-align:right">[É™&rsquo;nÃ¦tÉ™mÉª]</td>
<td style="text-align:right">n. è§£å‰–ï¼›è§£å‰–å­¦ï¼›å‰–æï¼›éª¨éª¼</td>
<td style="text-align:right">2017-7-17</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">backbone</td>
<td style="text-align:right">[&lsquo;bÃ¦kbÉ™ÊŠn]</td>
<td style="text-align:right">n. æ”¯æŸ±;ä¸»å¹²ç½‘;å†³å¿ƒ,æ¯…åŠ›;è„Šæ¤</td>
<td style="text-align:right">2017-7-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_cont</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_cont</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_cont</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">åºå·</th>
<th style="text-align:right">å•è¯</th>
<th style="text-align:right">éŸ³æ ‡</th>
<th style="text-align:right">è§£é‡Š</th>
<th style="text-align:right">æ—¶é—´</th>
<th style="text-align:right">åˆ†ç±»</th>
<th style="text-align:right">æ“ä½œ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">agglomerative</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">adj. ä¼šå‡èšçš„ï¼›[å†¶] çƒ§ç»“çš„ï¼Œå‡ç»“çš„</td>
<td style="text-align:right">2020-1-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">anatomy</td>
<td style="text-align:right">[É™&rsquo;nÃ¦tÉ™mÉª]</td>
<td style="text-align:right">n. è§£å‰–ï¼›è§£å‰–å­¦ï¼›å‰–æï¼›éª¨éª¼</td>
<td style="text-align:right">2017-7-17</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">backbone</td>
<td style="text-align:right">[&lsquo;bÃ¦kbÉ™ÊŠn]</td>
<td style="text-align:right">n. æ”¯æŸ±;ä¸»å¹²ç½‘;å†³å¿ƒ,æ¯…åŠ›;è„Šæ¤</td>
<td style="text-align:right">2017-7-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table>
<p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ”¶é›†6ä¸ªç½‘é¡µçš„è¡¨æ ¼</span>
</span></span><span class="line"><span class="cl"><span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">html</span> <span class="ow">in</span> <span class="n">htmls</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_cont</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_cont</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_cont</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># åˆå¹¶å¤šä¸ªè¡¨æ ¼</span>
</span></span><span class="line"><span class="cl"><span class="n">df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_all</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">åºå·</th>
<th style="text-align:right">å•è¯</th>
<th style="text-align:right">éŸ³æ ‡</th>
<th style="text-align:right">è§£é‡Š</th>
<th style="text-align:right">æ—¶é—´</th>
<th style="text-align:right">åˆ†ç±»</th>
<th style="text-align:right">æ“ä½œ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">agglomerative</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">adj. ä¼šå‡èšçš„ï¼›[å†¶] çƒ§ç»“çš„ï¼Œå‡ç»“çš„</td>
<td style="text-align:right">2020-1-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">anatomy</td>
<td style="text-align:right">[É™&rsquo;nÃ¦tÉ™mÉª]</td>
<td style="text-align:right">n. è§£å‰–ï¼›è§£å‰–å­¦ï¼›å‰–æï¼›éª¨éª¼</td>
<td style="text-align:right">2017-7-17</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">backbone</td>
<td style="text-align:right">[&lsquo;bÃ¦kbÉ™ÊŠn]</td>
<td style="text-align:right">n. æ”¯æŸ±;ä¸»å¹²ç½‘;å†³å¿ƒ,æ¯…åŠ›;è„Šæ¤</td>
<td style="text-align:right">2017-7-13</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table>
<p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_all</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">(86, 7)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-å°†ç»“æœæ•°æ®è¾“å‡ºåˆ°excelæ–‡ä»¶">4. å°†ç»“æœæ•°æ®è¾“å‡ºåˆ°Excelæ–‡ä»¶</h3>
<p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_all</span><span class="p">[[</span><span class="s2">&#34;å•è¯&#34;</span><span class="p">,</span> <span class="s2">&#34;éŸ³æ ‡&#34;</span><span class="p">,</span> <span class="s2">&#34;è§£é‡Š&#34;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&#34;./course_datas/c32_read_html/ç½‘æ˜“æœ‰é“å•è¯æœ¬åˆ—è¡¨.xlsx&#34;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="33pandasè®¡ç®—åŒæ¯”ç¯æ¯”æŒ‡æ ‡çš„3ç§æ–¹æ³•">33ã€Pandasè®¡ç®—åŒæ¯”ç¯æ¯”æŒ‡æ ‡çš„3ç§æ–¹æ³•</h1>
<h4 id="åŒæ¯”å’Œç¯æ¯”ç¯æ¯”å’ŒåŒæ¯”ç”¨äºæè¿°ç»Ÿè®¡æ•°æ®çš„å˜åŒ–æƒ…å†µ">åŒæ¯”å’Œç¯æ¯”ï¼šç¯æ¯”å’ŒåŒæ¯”ç”¨äºæè¿°ç»Ÿè®¡æ•°æ®çš„å˜åŒ–æƒ…å†µ</h4>
<ul>
<li>ç¯æ¯”ï¼šè¡¨ç¤ºæœ¬æ¬¡ç»Ÿè®¡æ®µä¸ç›¸è¿çš„ä¸Šæ¬¡ç»Ÿè®¡æ®µä¹‹é—´çš„æ¯”è¾ƒã€‚
<ul>
<li>æ¯”å¦‚2010å¹´ä¸­å›½ç¬¬ä¸€å­£åº¦GDPä¸ºG2010Q1äº¿å…ƒï¼Œç¬¬äºŒå­£åº¦GDPä¸ºG2010Q2äº¿å…ƒï¼Œåˆ™ç¬¬äºŒå­£åº¦GDPç¯æ¯”å¢é•¿ï¼ˆG2010Q2-G2010Q1)/G2010Q1ï¼›</li>
</ul>
</li>
<li>åŒæ¯”ï¼šå³åŒæœŸç›¸æ¯”ï¼Œè¡¨ç¤ºæŸä¸ªç‰¹å®šç»Ÿè®¡æ®µä»Šå¹´ä¸å»å¹´ä¹‹é—´çš„æ¯”è¾ƒã€‚
<ul>
<li>æ¯”å¦‚2009å¹´ä¸­å›½ç¬¬ä¸€å­£åº¦GDPä¸ºG2009Q1äº¿å…ƒï¼Œåˆ™2010å¹´ç¬¬ä¸€å­£åº¦çš„GDPåŒæ¯”å¢é•¿ä¸ºï¼ˆG2010Q1-G2009Q1)/G2009Q1ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/29.jpg" alt=""></p>
<p>æ¼”ç¤ºæ­¥éª¤ï¼š</p>
<ol>
<li>è¯»å–è¿ç»­3å¹´çš„å¤©æ°”æ•°æ®</li>
<li>æ–¹æ³•1ï¼špandas.Series.pct_change</li>
<li>æ–¹æ³•2ï¼špandas.Series.shift</li>
<li>æ–¹æ³•3ï¼špandas.Series.diff</li>
</ol>
<p>pct_changeã€shiftã€diffï¼Œéƒ½å®ç°äº†è·¨è¶Šå¤šè¡Œçš„æ•°æ®è®¡ç®—</p>
<h3 id="0-è¯»å–è¿ç»­3å¹´çš„å¤©æ°”æ•°æ®">0. è¯»å–è¿ç»­3å¹´çš„å¤©æ°”æ•°æ®</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fpath</span> <span class="o">=</span> <span class="s2">&#34;./datas/beijing_tianqi/beijing_tianqi_2017-2019.csv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&#34;ymd&#34;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-01</td>
<td style="text-align:right">5â„ƒ</td>
<td style="text-align:right">-3â„ƒ</td>
<td style="text-align:right">éœ¾~æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">450</td>
<td style="text-align:right">ä¸¥é‡æ±¡æŸ“</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">2017-01-02</td>
<td style="text-align:right">7â„ƒ</td>
<td style="text-align:right">-6â„ƒ</td>
<td style="text-align:right">æ™´~éœ¾</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">246</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2017-01-03</td>
<td style="text-align:right">5â„ƒ</td>
<td style="text-align:right">-5â„ƒ</td>
<td style="text-align:right">éœ¾</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">320</td>
<td style="text-align:right">ä¸¥é‡æ±¡æŸ“</td>
<td style="text-align:right">6</td>
</tr>
</tbody>
</table>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ›¿æ¢æ‰æ¸©åº¦çš„åç¼€â„ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-01</td>
<td style="text-align:right">5</td>
<td style="text-align:right">-3â„ƒ</td>
<td style="text-align:right">éœ¾~æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">450</td>
<td style="text-align:right">ä¸¥é‡æ±¡æŸ“</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">2017-01-02</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-6â„ƒ</td>
<td style="text-align:right">æ™´~éœ¾</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">246</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2017-01-03</td>
<td style="text-align:right">5</td>
<td style="text-align:right">-5â„ƒ</td>
<td style="text-align:right">éœ¾</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">320</td>
<td style="text-align:right">ä¸¥é‡æ±¡æŸ“</td>
<td style="text-align:right">6</td>
</tr>
</tbody>
</table>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ–°çš„dfï¼Œä¸ºæ¯ä¸ªæœˆçš„å¹³å‡æœ€é«˜æ¸©</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&#34;M&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å°†ç´¢å¼•æŒ‰ç…§æ—¥æœŸå‡åºæ’åˆ—</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
</tr>
</tbody>
</table>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2017-01-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-02-28&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-04-30&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2017-05-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-06-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-07-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-08-31&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2017-09-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-10-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-11-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-12-31&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-01-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-02-28&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-04-30&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-05-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-06-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-31&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-09-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-10-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-11-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-12-31&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2019-01-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-02-28&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-04-30&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2019-05-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-06-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-07-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-08-31&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2019-09-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-11-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-31&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ymd&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x13d8d77dc48</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/30.png" alt=""></p>
<h3 id="æ–¹æ³•1pandasseriespct_change">æ–¹æ³•1ï¼špandas.Series.pct_change</h3>
<p>pct_changeæ–¹æ³•ç›´æ¥ç®—å¥½äº†&quot;(æ–°-æ—§)/æ—§&quot;çš„ç™¾åˆ†æ¯”</p>
<p>å®˜æ–¹æ–‡æ¡£åœ°å€ï¼šhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.pct_change.html</p>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu_way1_huanbi&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu_way1_tongbi&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu_way1_huanbi</th>
<th style="text-align:right">bWendu_way1_tongbi</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-06-30</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-07-31</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-08-31</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-09-30</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-10-31</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-11-30</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-12-31</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2018-01-31</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
</tr>
<tr>
<td style="text-align:right">2018-02-28</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
</tr>
</tbody>
</table>
<h3 id="æ–¹æ³•2pandasseriesshift">æ–¹æ³•2ï¼špandas.Series.shift</h3>
<p>shiftç”¨äºç§»åŠ¨æ•°æ®ï¼Œä½†æ˜¯ä¿æŒç´¢å¼•ä¸å˜</p>
<p>å®˜æ–¹æ–‡æ¡£åœ°å€ï¼šhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.shift.html</p>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># è§è¯†ä¸€ä¸‹shiftåšäº†ä»€ä¹ˆäº‹æƒ…</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨pd.concatåˆå¹¶Seriesåˆ—è¡¨å˜æˆä¸€ä¸ªå¤§çš„df</span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">],</span> 
</span></span><span class="line"><span class="cl">     <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">     <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-06-30</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-07-31</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-08-31</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-09-30</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-10-31</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-11-30</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-12-31</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2018-01-31</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">3.322581</td>
</tr>
<tr>
<td style="text-align:right">2018-02-28</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">7.642857</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">14.129032</td>
</tr>
</tbody>
</table>
<p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç¯æ¯”</span>
</span></span><span class="line"><span class="cl"><span class="n">series_shift1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu_way2_huanbi&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">-</span><span class="n">series_shift1</span><span class="p">)</span><span class="o">/</span><span class="n">series_shift1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŒæ¯”</span>
</span></span><span class="line"><span class="cl"><span class="n">series_shift2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu_way2_tongbi&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">-</span><span class="n">series_shift2</span><span class="p">)</span><span class="o">/</span><span class="n">series_shift2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu_way1_huanbi</th>
<th style="text-align:right">bWendu_way1_tongbi</th>
<th style="text-align:right">bWendu_way2_huanbi</th>
<th style="text-align:right">bWendu_way2_tongbi</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-06-30</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-07-31</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-08-31</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-09-30</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-10-31</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-11-30</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-12-31</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2018-01-31</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
</tr>
<tr>
<td style="text-align:right">2018-02-28</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
</tr>
</tbody>
</table>
<h3 id="æ–¹æ³•3-pandasseriesdiff">æ–¹æ³•3. pandas.Series.diff</h3>
<p>pandas.Series.diffç”¨äºæ–°å€¼å‡å»æ—§å€¼</p>
<p>å®˜æ–¹æ–‡æ¡£ï¼šhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.diff.html</p>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pd.concat(
</span></span><span class="line"><span class="cl">    [df[&#34;bWendu&#34;], 
</span></span><span class="line"><span class="cl">     df[&#34;bWendu&#34;].diff(periods=1), 
</span></span><span class="line"><span class="cl">     df[&#34;bWendu&#34;].diff(periods=12)],
</span></span><span class="line"><span class="cl">    axis=1
</span></span><span class="line"><span class="cl">).head(15)
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">4.320276</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">6.486175</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">9.570968</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">6.074194</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-06-30</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">1.192473</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-07-31</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">0.646237</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-08-31</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">-1.483871</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-09-30</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">-2.262366</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-10-31</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">-10.640860</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-11-30</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">-7.659140</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-12-31</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">-5.082796</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2018-01-31</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">-3.161290</td>
<td style="text-align:right">-2.00</td>
</tr>
<tr>
<td style="text-align:right">2018-02-28</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">3.570276</td>
<td style="text-align:right">-2.75</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">9.236175</td>
<td style="text-align:right">0.00</td>
</tr>
</tbody>
</table>
<p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç¯æ¯”</span>
</span></span><span class="line"><span class="cl"><span class="n">series_diff1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu_way3_huanbi&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_diff1</span><span class="o">/</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">-</span><span class="n">series_diff1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŒæ¯”</span>
</span></span><span class="line"><span class="cl"><span class="n">series_diff2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu_way3_tongbi&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_diff2</span><span class="o">/</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">-</span><span class="n">series_diff2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[18]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">bWendu_way1_huanbi</th>
<th style="text-align:right">bWendu_way1_tongbi</th>
<th style="text-align:right">bWendu_way2_huanbi</th>
<th style="text-align:right">bWendu_way2_tongbi</th>
<th style="text-align:right">bWendu_way3_huanbi</th>
<th style="text-align:right">bWendu_way3_tongbi</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2017-01-31</td>
<td style="text-align:right">3.322581</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-02-28</td>
<td style="text-align:right">7.642857</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">1.300277</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.848658</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-04-30</td>
<td style="text-align:right">23.700000</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.677397</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-05-31</td>
<td style="text-align:right">29.774194</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.256295</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-06-30</td>
<td style="text-align:right">30.966667</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.040051</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-07-31</td>
<td style="text-align:right">31.612903</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.020869</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-08-31</td>
<td style="text-align:right">30.129032</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.046939</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-09-30</td>
<td style="text-align:right">27.866667</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.075089</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-10-31</td>
<td style="text-align:right">17.225806</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.381849</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-11-30</td>
<td style="text-align:right">9.566667</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.444632</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2017-12-31</td>
<td style="text-align:right">4.483871</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">-0.531303</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2018-01-31</td>
<td style="text-align:right">1.322581</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
<td style="text-align:right">-0.705036</td>
<td style="text-align:right">-0.601942</td>
</tr>
<tr>
<td style="text-align:right">2018-02-28</td>
<td style="text-align:right">4.892857</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
<td style="text-align:right">2.699477</td>
<td style="text-align:right">-0.359813</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">14.129032</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
<td style="text-align:right">1.887685</td>
<td style="text-align:right">0.000000</td>
</tr>
</tbody>
</table>
<h1 id="34pandaså’Œæ•°æ®åº“æŸ¥è¯¢è¯­è¨€sqlçš„å¯¹æ¯”">34ã€Pandaså’Œæ•°æ®åº“æŸ¥è¯¢è¯­è¨€SQLçš„å¯¹æ¯”</h1>
<ul>
<li>Pandasï¼šPythonæœ€æµè¡Œçš„æ•°æ®å¤„ç†ä¸æ•°æ®åˆ†æçš„ç±»åº“</li>
<li>SQLï¼šç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼Œç”¨äºå¯¹MySQLã€Oracleç­‰å…³ç³»å‹æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥</li>
</ul>
<p>ä¸¤è€…éƒ½æ˜¯å¯¹â€œè¡¨æ ¼å‹â€æ•°æ®çš„æ“ä½œå’ŒæŸ¥è¯¢ï¼Œæ‰€ä»¥å¾ˆå¤šè¯­æ³•éƒ½èƒ½å¯¹åº”èµ·æ¥</p>
<p>å¯¹æ¯”åˆ—è¡¨ï¼š</p>
<ol>
<li>SELECTæ•°æ®æŸ¥è¯¢</li>
<li>WHEREæŒ‰æ¡ä»¶æŸ¥è¯¢</li>
<li>inå’Œnot inçš„æ¡ä»¶æŸ¥è¯¢</li>
<li>groupbyåˆ†ç»„ç»Ÿè®¡</li>
<li>JOINæ•°æ®å…³è”</li>
<li>UNIONæ•°æ®åˆå¹¶</li>
<li>Order Limitå…ˆæ’åºååˆ†é¡µ</li>
<li>å–æ¯ä¸ªåˆ†ç»„groupçš„top n</li>
<li>UPDATEæ•°æ®æ›´æ–°</li>
<li>DELETEåˆ é™¤æ•°æ®</li>
</ol>
<h3 id="0-è¯»å–æ³°å¦å°¼å…‹æ•°æ®é›†">0. è¯»å–æ³°å¦å°¼å…‹æ•°æ®é›†</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;./datas/titanic/titanic_train.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cumings, Mrs. John Bradley (Florence Briggs Th&hellip;</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17599</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C85</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Heikkinen, Miss. Laina</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">STON/O2. 3101282</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113803</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">C123</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<h3 id="1-selectæ•°æ®æŸ¥è¯¢">1. SELECTæ•°æ®æŸ¥è¯¢</h3>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># SQLï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT PassengerId, Sex, Age, Survived
</span></span></span><span class="line"><span class="cl"><span class="s2">    FROM titanic
</span></span></span><span class="line"><span class="cl"><span class="s2">    LIMIT 5;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Pandas</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[[</span><span class="s2">&#34;PassengerId&#34;</span><span class="p">,</span> <span class="s2">&#34;Sex&#34;</span><span class="p">,</span> <span class="s2">&#34;Age&#34;</span><span class="p">,</span> <span class="s2">&#34;Survived&#34;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Survived</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
</tr>
</tbody>
</table>
<p>df.head(5)ç±»ä¼¼select * from table limit 5ï¼ŒæŸ¥è¯¢æ‰€æœ‰çš„å­—æ®µ</p>
<h3 id="2-whereæŒ‰æ¡ä»¶æŸ¥è¯¢">2. WHEREæŒ‰æ¡ä»¶æŸ¥è¯¢</h3>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># SQLï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT *
</span></span></span><span class="line"><span class="cl"><span class="s2">    FROM titanic
</span></span></span><span class="line"><span class="cl"><span class="s2">    where Sex=&#39;male&#39; and Age&gt;=20.0 and Age&lt;=40.0
</span></span></span><span class="line"><span class="cl"><span class="s2">    LIMIT 5;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨æ‹¬å·çš„æ–¹å¼ï¼Œçº§è”å¤šä¸ªæ¡ä»¶|</span>
</span></span><span class="line"><span class="cl"><span class="n">condition</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Sex&#34;</span><span class="p">]</span><span class="o">==</span><span class="s2">&#34;male&#34;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mf">20.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mf">40.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">condition</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kc">False</span>    <span class="mi">629</span>
</span></span><span class="line"><span class="cl"><span class="kc">True</span>     <span class="mi">262</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.050</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">12</td>
<td style="text-align:right">13</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Saundercock, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">20.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5. 2151</td>
<td style="text-align:right">8.050</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">13</td>
<td style="text-align:right">14</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Andersson, Mr. Anders Johan</td>
<td style="text-align:right">male</td>
<td style="text-align:right">39.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">347082</td>
<td style="text-align:right">31.275</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">20</td>
<td style="text-align:right">21</td>
<td style="text-align:right">0</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Fynney, Mr. Joseph J</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">239865</td>
<td style="text-align:right">26.000</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<h3 id="3-inå’Œnot-inçš„æ¡ä»¶æŸ¥è¯¢">3. inå’Œnot inçš„æ¡ä»¶æŸ¥è¯¢</h3>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Pclass&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># SQLï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT *
</span></span></span><span class="line"><span class="cl"><span class="s2">    FROM titanic
</span></span></span><span class="line"><span class="cl"><span class="s2">    where Pclass in (1,2)
</span></span></span><span class="line"><span class="cl"><span class="s2">    LIMIT 5;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># in </span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Pclass&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cumings, Mrs. John Bradley (Florence Briggs Th&hellip;</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17599</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C85</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113803</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">C123</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">McCarthy, Mr. Timothy J</td>
<td style="text-align:right">male</td>
<td style="text-align:right">54.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">17463</td>
<td style="text-align:right">51.8625</td>
<td style="text-align:right">E46</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Nasser, Mrs. Nicholas (Adele Achem)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">14.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">237736</td>
<td style="text-align:right">30.0708</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">12</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Bonnell, Miss. Elizabeth</td>
<td style="text-align:right">female</td>
<td style="text-align:right">58.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113783</td>
<td style="text-align:right">26.5500</td>
<td style="text-align:right">C103</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># not in </span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Pclass&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Heikkinen, Miss. Laina</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">STON/O2. 3101282</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Moran, Mr. James</td>
<td style="text-align:right">male</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">330877</td>
<td style="text-align:right">8.4583</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">Q</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Palsson, Master. Gosta Leonard</td>
<td style="text-align:right">male</td>
<td style="text-align:right">2.0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">349909</td>
<td style="text-align:right">21.0750</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<h3 id="4-groupbyåˆ†ç»„ç»Ÿè®¡">4. groupbyåˆ†ç»„ç»Ÿè®¡</h3>
<h4 id="41-å•ä¸ªåˆ—çš„èšåˆ">4.1 å•ä¸ªåˆ—çš„èšåˆ</h4>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># SQLï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT 
</span></span></span><span class="line"><span class="cl"><span class="s2">        -- åˆ†æ€§åˆ«çš„å­˜æ´»äººæ•°
</span></span></span><span class="line"><span class="cl"><span class="s2">        sum(Survived),
</span></span></span><span class="line"><span class="cl"><span class="s2">        -- åˆ†æ€§åˆ«çš„å¹³å‡å¹´é¾„
</span></span></span><span class="line"><span class="cl"><span class="s2">        mean(Age)
</span></span></span><span class="line"><span class="cl"><span class="s2">        -- åˆ†æ€§åˆ«çš„å¹³å‡ç¥¨ä»·
</span></span></span><span class="line"><span class="cl"><span class="s2">        mean(Fare)
</span></span></span><span class="line"><span class="cl"><span class="s2">    FROM titanic
</span></span></span><span class="line"><span class="cl"><span class="s2">    group by Sex
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Sex&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&#34;Survived&#34;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="s2">&#34;Age&#34;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="s2">&#34;Fare&#34;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Fare</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Sex</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">female</td>
<td style="text-align:right">233</td>
<td style="text-align:right">27.915709</td>
<td style="text-align:right">44.479818</td>
</tr>
<tr>
<td style="text-align:right">male</td>
<td style="text-align:right">109</td>
<td style="text-align:right">30.726645</td>
<td style="text-align:right">25.523893</td>
</tr>
</tbody>
</table>
<h4 id="42-å¤šä¸ªåˆ—çš„èšåˆ">4.2 å¤šä¸ªåˆ—çš„èšåˆ</h4>
<p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># SQLï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT 
</span></span></span><span class="line"><span class="cl"><span class="s2">        -- ä¸åŒå­˜æ´»å’Œæ€§åˆ«åˆ†ç»„çš„ï¼Œå¹³å‡å¹´é¾„
</span></span></span><span class="line"><span class="cl"><span class="s2">        mean(Age)
</span></span></span><span class="line"><span class="cl"><span class="s2">        -- ä¸åŒå­˜æ´»å’Œæ€§åˆ«åˆ†ç»„çš„ï¼Œå¹³å‡ç¥¨ä»·
</span></span></span><span class="line"><span class="cl"><span class="s2">        mean(Fare)
</span></span></span><span class="line"><span class="cl"><span class="s2">    FROM titanic
</span></span></span><span class="line"><span class="cl"><span class="s2">    group by Survived, Sex
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&#34;Survived&#34;</span><span class="p">,</span> <span class="s2">&#34;Sex&#34;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&#34;Age&#34;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="s2">&#34;Fare&#34;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Fare</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Survived</td>
<td style="text-align:right">Sex</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">female</td>
<td style="text-align:right">25.046875</td>
<td style="text-align:right">23.024385</td>
</tr>
<tr>
<td style="text-align:right">male</td>
<td style="text-align:right">31.618056</td>
<td style="text-align:right">21.960993</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">28.847716</td>
<td style="text-align:right">51.938573</td>
</tr>
<tr>
<td style="text-align:right">male</td>
<td style="text-align:right">27.276022</td>
<td style="text-align:right">40.821484</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h3 id="5-joinæ•°æ®å…³è”">5. JOINæ•°æ®å…³è”</h3>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç”µå½±è¯„åˆ†æ•°æ®é›†ï¼Œè¯„åˆ†è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="n">df_rating</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;./datas/ml-latest-small/ratings.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_rating</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982703</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964981247</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">47</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964983815</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">50</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964982931</td>
</tr>
</tbody>
</table>
<p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç”µå½±è¯„åˆ†æ•°æ®é›†ï¼Œç”µå½±ä¿¡æ¯è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="n">df_movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;./datas/ml-latest-small/movies.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_movies</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">title</th>
<th style="text-align:right">genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama|Romance</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">Father of the Bride Part II (1995)</td>
<td style="text-align:right">Comedy</td>
</tr>
</tbody>
</table>
<p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># SQLï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT *
</span></span></span><span class="line"><span class="cl"><span class="s2">    FROM 
</span></span></span><span class="line"><span class="cl"><span class="s2">        rating join movies 
</span></span></span><span class="line"><span class="cl"><span class="s2">        on(rating.movieId=movies.movieId)
</span></span></span><span class="line"><span class="cl"><span class="s2">    limit 5
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df_rating</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">df_movies</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&#34;movieId&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_merged</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
<th style="text-align:right">title</th>
<th style="text-align:right">genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982703</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">847434962</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">7</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.5</td>
<td style="text-align:right">1106635946</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">15</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2.5</td>
<td style="text-align:right">1510577970</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">17</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.5</td>
<td style="text-align:right">1305696483</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Adventure|Animation|Children|Comedy|Fantasy</td>
</tr>
</tbody>
</table>
<h3 id="6-unionæ•°æ®åˆå¹¶">6. UNIONæ•°æ®åˆå¹¶</h3>
<p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Chicago&#39;</span><span class="p">,</span> <span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span> <span class="s1">&#39;New York City&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;rank&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)})</span> 
</span></span><span class="line"><span class="cl"><span class="n">df1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[20]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">city</th>
<th style="text-align:right">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Chicago</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">San Francisco</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">New York City</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table>
<p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Chicago&#39;</span><span class="p">,</span> <span class="s1">&#39;Boston&#39;</span><span class="p">,</span> <span class="s1">&#39;Los Angeles&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;rank&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
</span></span><span class="line"><span class="cl"><span class="n">df2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[21]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">city</th>
<th style="text-align:right">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Chicago</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Boston</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Los Angeles</td>
<td style="text-align:right">5</td>
</tr>
</tbody>
</table>
<p>In [22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># SQLï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT city, rank
</span></span></span><span class="line"><span class="cl"><span class="s2">    FROM df1
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    UNION ALL
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT city, rank
</span></span></span><span class="line"><span class="cl"><span class="s2">    FROM df2;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [23]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># pandas</span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[23]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">city</th>
<th style="text-align:right">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Chicago</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">San Francisco</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">New York City</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Chicago</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Boston</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Los Angeles</td>
<td style="text-align:right">5</td>
</tr>
</tbody>
</table>
<h3 id="7-order-limitå…ˆæ’åºååˆ†é¡µ">7. Order Limitå…ˆæ’åºååˆ†é¡µ</h3>
<p>In [24]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># SQLï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT *
</span></span></span><span class="line"><span class="cl"><span class="s2">    from titanic
</span></span></span><span class="line"><span class="cl"><span class="s2">    order by Fare
</span></span></span><span class="line"><span class="cl"><span class="s2">    limit 5
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [25]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&#34;Fare&#34;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[25]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">258</td>
<td style="text-align:right">259</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Ward, Miss. Anna</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17755</td>
<td style="text-align:right">512.3292</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">737</td>
<td style="text-align:right">738</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Lesurer, Mr. Gustave J</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17755</td>
<td style="text-align:right">512.3292</td>
<td style="text-align:right">B101</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">679</td>
<td style="text-align:right">680</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cardeza, Mr. Thomas Drake Martinez</td>
<td style="text-align:right">male</td>
<td style="text-align:right">36.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">PC 17755</td>
<td style="text-align:right">512.3292</td>
<td style="text-align:right">B51 B53 B55</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">88</td>
<td style="text-align:right">89</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Fortune, Miss. Mabel Helen</td>
<td style="text-align:right">female</td>
<td style="text-align:right">23.0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
<td style="text-align:right">19950</td>
<td style="text-align:right">263.0000</td>
<td style="text-align:right">C23 C25 C27</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">27</td>
<td style="text-align:right">28</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Fortune, Mr. Charles Alexander</td>
<td style="text-align:right">male</td>
<td style="text-align:right">19.0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
<td style="text-align:right">19950</td>
<td style="text-align:right">263.0000</td>
<td style="text-align:right">C23 C25 C27</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<h3 id="8-å–æ¯ä¸ªåˆ†ç»„groupçš„top-n">8. å–æ¯ä¸ªåˆ†ç»„groupçš„top n</h3>
<p>In [26]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># MYSQLä¸æ”¯æŒ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Oracleæœ‰ROW_NUMBERè¯­æ³•</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [27]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æŒ‰ï¼ˆSurvivedï¼ŒSexï¼‰åˆ†ç»„ï¼Œå–Ageçš„TOP 2</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&#34;Survived&#34;</span><span class="p">,</span> <span class="s2">&#34;Sex&#34;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&#34;Age&#34;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[27]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Survived</td>
<td style="text-align:right">Sex</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">female</td>
<td style="text-align:right">772</td>
<td style="text-align:right">773</td>
<td style="text-align:right">0</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Mack, Mrs. (Mary)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">57.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">S.O./P.P. 3</td>
<td style="text-align:right">10.5000</td>
<td style="text-align:right">E77</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">177</td>
<td style="text-align:right">178</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Isham, Miss. Ann Elizabeth</td>
<td style="text-align:right">female</td>
<td style="text-align:right">50.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17595</td>
<td style="text-align:right">28.7125</td>
<td style="text-align:right">C49</td>
<td style="text-align:right">C</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">male</td>
<td style="text-align:right">851</td>
<td style="text-align:right">852</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Svensson, Mr. Johan</td>
<td style="text-align:right">male</td>
<td style="text-align:right">74.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">347060</td>
<td style="text-align:right">7.7750</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">493</td>
<td style="text-align:right">494</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Artagaveytia, Mr. Ramon</td>
<td style="text-align:right">male</td>
<td style="text-align:right">71.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17609</td>
<td style="text-align:right">49.5042</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">483</td>
<td style="text-align:right">484</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Turkula, Mrs. (Hedwig)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">63.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">4134</td>
<td style="text-align:right">9.5875</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">275</td>
<td style="text-align:right">276</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Andrews, Miss. Kornelia Theodosia</td>
<td style="text-align:right">female</td>
<td style="text-align:right">63.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">13502</td>
<td style="text-align:right">77.9583</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">S</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">male</td>
<td style="text-align:right">630</td>
<td style="text-align:right">631</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Barkworth, Mr. Algernon Henry Wilson</td>
<td style="text-align:right">male</td>
<td style="text-align:right">80.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">27042</td>
<td style="text-align:right">30.0000</td>
<td style="text-align:right">A23</td>
<td style="text-align:right">S</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">570</td>
<td style="text-align:right">571</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Harris, Mr. George</td>
<td style="text-align:right">male</td>
<td style="text-align:right">62.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">S.W./PP 752</td>
<td style="text-align:right">10.5000</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h3 id="9-updateæ•°æ®æ›´æ–°">9. UPDATEæ•°æ®æ›´æ–°</h3>
<p>In [28]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">891</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">890</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">12</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">PassengerId</span>    <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Survived</span>       <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Pclass</span>         <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span>           <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Sex</span>            <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Age</span>            <span class="mi">714</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="n">SibSp</span>          <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Parch</span>          <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Ticket</span>         <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Fare</span>           <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="n">Cabin</span>          <span class="mi">204</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Embarked</span>       <span class="mi">889</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">object</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">83.7</span><span class="o">+</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [29]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># SQLï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    UPDATE titanic
</span></span></span><span class="line"><span class="cl"><span class="s2">    set Age=0
</span></span></span><span class="line"><span class="cl"><span class="s2">    where Age is null
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [30]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">condition</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">condition</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[30]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kc">False</span>    <span class="mi">714</span>
</span></span><span class="line"><span class="cl"><span class="kc">True</span>     <span class="mi">177</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">Age</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [31]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [32]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[32]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kc">False</span>    <span class="mi">891</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">Age</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="10-deleteåˆ é™¤æ•°æ®">10. DELETEåˆ é™¤æ•°æ®</h3>
<p>In [33]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># SQLï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    DELETE FROM titanic
</span></span></span><span class="line"><span class="cl"><span class="s2">    where Age=0
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [34]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [35]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_new</span><span class="p">[</span><span class="n">df_new</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[35]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h1 id="35pandaså®ç°groupbyèšåˆåä¸åŒåˆ—æ•°æ®ç»Ÿè®¡">35ã€Pandaså®ç°groupbyèšåˆåä¸åŒåˆ—æ•°æ®ç»Ÿè®¡</h1>
<p>ç”µå½±è¯„åˆ†æ•°æ®é›†ï¼ˆUserIDï¼ŒMovieIDï¼ŒRatingï¼ŒTimestampï¼‰</p>
<p><strong>èšåˆåå•åˆ—-å•æŒ‡æ ‡ç»Ÿè®¡ï¼šæ¯ä¸ªMovieIDçš„å¹³å‡è¯„åˆ†</strong>
df.groupby(&ldquo;MovieID&rdquo;)[&ldquo;Rating&rdquo;].mean()</p>
<p><strong>èšåˆåå•åˆ—-å¤šæŒ‡æ ‡ç»Ÿè®¡ï¼šæ¯ä¸ªMoiveIDçš„æœ€é«˜è¯„åˆ†ã€æœ€ä½è¯„åˆ†ã€å¹³å‡è¯„åˆ†</strong>
df.groupby(&ldquo;MovieID&rdquo;)[&ldquo;Rating&rdquo;].agg(mean=&ldquo;mean&rdquo;, max=&ldquo;max&rdquo;, min=np.min)
df.groupby(&ldquo;MovieID&rdquo;).agg({&ldquo;Rating&rdquo;:[&lsquo;mean&rsquo;, &lsquo;max&rsquo;, np.min]})</p>
<p><strong>èšåˆåå¤šåˆ—-å¤šæŒ‡æ ‡ç»Ÿè®¡ï¼šæ¯ä¸ªMoiveIDçš„è¯„åˆ†äººæ•°ï¼Œæœ€é«˜è¯„åˆ†ã€æœ€ä½è¯„åˆ†ã€å¹³å‡è¯„åˆ†</strong>
df.groupby(&ldquo;MovieID&rdquo;).agg( rating_mean=(&ldquo;Rating&rdquo;, &ldquo;mean&rdquo;), user_count=(&ldquo;UserID&rdquo;, lambda x : x.nunique())
df.groupby(&ldquo;MovieID&rdquo;).agg( {&ldquo;Rating&rdquo;: [&lsquo;mean&rsquo;, &lsquo;min&rsquo;, &lsquo;max&rsquo;], &ldquo;UserID&rdquo;: lambda x :x.nunique()})
df.groupby(&ldquo;MovieID&rdquo;).apply( lambda x: pd.Series( {&ldquo;min&rdquo;: x[&ldquo;Rating&rdquo;].min(), &ldquo;mean&rdquo;: x[&ldquo;Rating&rdquo;].mean()}))</p>
<p>**è®°å¿†ï¼š**agg(æ–°åˆ—å=å‡½æ•°)ã€agg(æ–°åˆ—å=(åŸåˆ—åï¼Œå‡½æ•°))ã€agg({&ldquo;åŸåˆ—å&rdquo;ï¼šå‡½æ•°/åˆ—è¡¨})
aggå‡½æ•°çš„ä¸¤ç§å½¢å¼ï¼Œç­‰å·ä»£è¡¨â€œæŠŠç»“æœèµ‹å€¼ç»™æ–°åˆ—â€ï¼Œå­—å…¸/å…ƒç»„ä»£è¡¨â€œå¯¹è¿™ä¸ªåˆ—è¿ç”¨è¿™äº›å‡½æ•°â€</p>
<p>å®˜ç½‘æ–‡æ¡£ï¼šhttps://pandas.pydata.org/pandas-docs/version/0.23.4/generated/pandas.core.groupby.DataFrameGroupBy.agg.html</p>
<h3 id="è¯»å–æ•°æ®">è¯»å–æ•°æ®</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;./datas/movielens-1m/ratings.dat&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;::&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">names</span><span class="o">=</span><span class="s2">&#34;UserID::MovieID::Rating::Timestamp&#34;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;::&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
</tr>
</tbody>
</table>
<h3 id="èšåˆåå•åˆ—-å•æŒ‡æ ‡ç»Ÿè®¡">èšåˆåå•åˆ—-å•æŒ‡æ ‡ç»Ÿè®¡</h3>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ¯ä¸ªMovieIDçš„å¹³å‡è¯„åˆ†</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;MovieID&#34;</span><span class="p">)[</span><span class="s2">&#34;Rating&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">MovieID</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>    <span class="mf">4.146846</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>    <span class="mf">3.201141</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>    <span class="mf">3.016736</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>    <span class="mf">2.729412</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span>    <span class="mf">3.006757</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">Rating</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="èšåˆåå•åˆ—-å¤šæŒ‡æ ‡ç»Ÿè®¡">èšåˆåå•åˆ—-å¤šæŒ‡æ ‡ç»Ÿè®¡</h3>
<p>æ¯ä¸ªMoiveIDçš„æœ€é«˜è¯„åˆ†ã€æœ€ä½è¯„åˆ†ã€å¹³å‡è¯„åˆ†</p>
<h4 id="æ–¹æ³•1aggå‡½æ•°ä¼ å…¥å¤šä¸ªç»“æœåˆ—åå‡½æ•°åå½¢å¼">æ–¹æ³•1ï¼šaggå‡½æ•°ä¼ å…¥å¤šä¸ªç»“æœåˆ—å=å‡½æ•°åå½¢å¼</h4>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;MovieID&#34;</span><span class="p">)[</span><span class="s2">&#34;Rating&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">mean</span><span class="o">=</span><span class="s2">&#34;mean&#34;</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="s2">&#34;max&#34;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">mean</th>
<th style="text-align:right">max</th>
<th style="text-align:right">min</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h4 id="æ–¹æ³•2aggå‡½æ•°ä¼ å…¥å­—å…¸keyæ˜¯columnåvalueæ˜¯å‡½æ•°åˆ—è¡¨">æ–¹æ³•2ï¼šaggå‡½æ•°ä¼ å…¥å­—å…¸ï¼Œkeyæ˜¯columnåï¼Œvalueæ˜¯å‡½æ•°åˆ—è¡¨</h4>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ¯ä¸ªMoiveIDçš„æœ€é«˜è¯„åˆ†ã€æœ€ä½è¯„åˆ†ã€å¹³å‡è¯„åˆ†</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;MovieID&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="s2">&#34;Rating&#34;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">]}</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Rating</th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right">mean</td>
<td style="text-align:right">max</td>
<td style="text-align:right">amin</td>
</tr>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;age_min&#39;</span><span class="p">,</span> <span class="s1">&#39;age_max&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">age_mean</th>
<th style="text-align:right">age_min</th>
<th style="text-align:right">age_max</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h3 id="èšåˆåå¤šåˆ—-å¤šæŒ‡æ ‡ç»Ÿè®¡">èšåˆåå¤šåˆ—-å¤šæŒ‡æ ‡ç»Ÿè®¡</h3>
<p>æ¯ä¸ªMoiveIDçš„è¯„åˆ†äººæ•°ï¼Œæœ€é«˜è¯„åˆ†ã€æœ€ä½è¯„åˆ†ã€å¹³å‡è¯„åˆ†</p>
<h4 id="æ–¹æ³•1aggå‡½æ•°ä¼ å…¥å­—å…¸keyæ˜¯åŸåˆ—åvalueæ˜¯åŸåˆ—åå’Œå‡½æ•°å…ƒç»„">æ–¹æ³•1ï¼šaggå‡½æ•°ä¼ å…¥å­—å…¸ï¼Œkeyæ˜¯åŸåˆ—åï¼Œvalueæ˜¯åŸåˆ—åå’Œå‡½æ•°å…ƒç»„</h4>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å›å¿†ï¼šaggå‡½æ•°çš„ä¸¤ç§å½¢å¼ï¼Œç­‰å·ä»£è¡¨â€œæŠŠç»“æœèµ‹å€¼ç»™æ–°åˆ—â€ï¼Œå­—å…¸/å…ƒç»„ä»£è¡¨â€œå¯¹è¿™ä¸ªåˆ—è¿ç”¨è¿™äº›å‡½æ•°â€</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;MovieID&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">rating_mean</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;Rating&#34;</span><span class="p">,</span> <span class="s2">&#34;mean&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">rating_min</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;Rating&#34;</span><span class="p">,</span> <span class="s2">&#34;min&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">rating_max</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;Rating&#34;</span><span class="p">,</span> <span class="s2">&#34;max&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">user_count</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;UserID&#34;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">rating_mean</th>
<th style="text-align:right">rating_min</th>
<th style="text-align:right">rating_max</th>
<th style="text-align:right">user_count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">2077</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">701</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">478</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">170</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">296</td>
</tr>
</tbody>
</table>
<h4 id="æ–¹æ³•2aggå‡½æ•°ä¼ å…¥å­—å…¸keyæ˜¯åŸåˆ—åvalueæ˜¯å‡½æ•°åˆ—è¡¨">æ–¹æ³•2ï¼šaggå‡½æ•°ä¼ å…¥å­—å…¸ï¼Œkeyæ˜¯åŸåˆ—åï¼Œvalueæ˜¯å‡½æ•°åˆ—è¡¨</h4>
<p>ç»Ÿè®¡åæ˜¯äºŒçº§ç´¢å¼•ï¼Œéœ€è¦åšç´¢å¼•å¤„ç†</p>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;MovieID&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Rating&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;UserID&#34;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">UserID</th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right">mean</td>
<td style="text-align:right">min</td>
<td style="text-align:right">max</td>
<td style="text-align:right"><lambda></td>
</tr>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">2077</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">701</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">478</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">170</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">296</td>
</tr>
</tbody>
</table>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span><span class="p">[</span><span class="s2">&#34;Rating&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">mean</th>
<th style="text-align:right">min</th>
<th style="text-align:right">max</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
</tr>
</tbody>
</table>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;rating_mean&#34;</span><span class="p">,</span> <span class="s2">&#34;rating_min&#34;</span><span class="p">,</span><span class="s2">&#34;rating_max&#34;</span><span class="p">,</span><span class="s2">&#34;user_count&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">rating_mean</th>
<th style="text-align:right">rating_min</th>
<th style="text-align:right">rating_max</th>
<th style="text-align:right">user_count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">2077</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">701</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">478</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">170</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">296</td>
</tr>
</tbody>
</table>
<h4 id="æ–¹æ³•3ä½¿ç”¨groupbyä¹‹åapplyå¯¹æ¯ä¸ªå­dfå•ç‹¬ç»Ÿè®¡">æ–¹æ³•3ï¼šä½¿ç”¨groupbyä¹‹åapplyå¯¹æ¯ä¸ªå­dfå•ç‹¬ç»Ÿè®¡</h4>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">agg_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ³¨æ„ï¼Œè¿™ä¸ªxæ˜¯å­DF&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># è¿™ä¸ªSeriesä¼šå˜æˆä¸€è¡Œï¼Œå­—å…¸KEYæ˜¯åˆ—å</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;rating_mean&#34;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;Rating&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;rating_min&#34;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;Rating&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;rating_max&#34;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;Rating&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;user_count&#34;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;UserID&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;MovieID&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">agg_func</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">rating_mean</th>
<th style="text-align:right">rating_min</th>
<th style="text-align:right">rating_max</th>
<th style="text-align:right">user_count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">MovieID</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.146846</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">2077.0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.201141</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">701.0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.016736</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">478.0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.729412</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">170.0</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3.006757</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">296.0</td>
</tr>
</tbody>
</table>
<h1 id="36pandasè¯»å–excelå°†æ•°æ®å±•ç¤ºåœ¨ç½‘é¡µä¸Š">36ã€Pandasè¯»å–Excelå°†æ•°æ®å±•ç¤ºåœ¨ç½‘é¡µä¸Š</h1>
<p>æ³¨æ„ï¼š</p>
<p>æœ¬èŠ‚è¯¾ç¨‹æ¼”ç¤ºçš„ä»£ç ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹æ‰¾ã€‚</p>
<p>å­ç›®å½•åå­—ï¼š&ldquo;Pandasè¯»å–Excelå°†æ•°æ®å±•ç¤ºåœ¨ç½‘é¡µä¸Š&rdquo;</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">æ–‡ç« ä½œè€…</span>
    <span class="item-content">yuanshuai</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">ä¸Šæ¬¡æ›´æ–°</span>
    <span class="item-content">
        0001-01-01
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/yuanshuai1122.github.io/tags/python/">Python</a>
          <a href="/yuanshuai1122.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">æ•°æ®åˆ†æ</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%89-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%89/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆä¸‰ï¼‰</span>
            <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
          </a>
        <a class="next" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%94-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%94/">
            <span class="next-text nav-default">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäº”ï¼‰</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="http://localhost:1313" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="http://localhost:1313" class="iconfont icon-twitter" title="twitter"></a>
      <a href="http://localhost:1313" class="iconfont icon-facebook" title="facebook"></a>
      <a href="http://localhost:1313" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="http://localhost:1313" class="iconfont icon-google" title="google"></a>
      <a href="http://localhost:1313" class="iconfont icon-github" title="github"></a>
      <a href="http://localhost:1313" class="iconfont icon-weibo" title="weibo"></a>
      <a href="http://localhost:1313" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="http://localhost:1313" class="iconfont icon-douban" title="douban"></a>
      <a href="http://localhost:1313" class="iconfont icon-pocket" title="pocket"></a>
      <a href="http://localhost:1313" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="http://localhost:1313" class="iconfont icon-instagram" title="instagram"></a>
      <a href="http://localhost:1313" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="http://localhost:1313" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="yuanshuai1122.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://gohugo.io">Hugo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>yuanshuai</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js" integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js" integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin="anonymous"></script>
  <script>
    var languageCode = "zh-cn".replace(/-/g, '_').replace(/_(.*)/, function ($0, $1) {return $0.replace($1, $1.toUpperCase());});
    timeago().render(document.querySelectorAll('.timeago'), languageCode);
    timeago.cancel();  
  </script>



<script type="text/javascript" src="/yuanshuai1122.github.io/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
