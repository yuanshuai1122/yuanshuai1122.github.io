<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆä¸‰ï¼‰ - ğŸ§€ - ä½ å¥½</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="yuanshuai" /><meta name="description" content=": | &amp;mdash;&amp;ndash;: | &amp;mdash;&amp;mdash;: | &amp;mdash;&amp;ndash;: | &amp;mdash;&amp;mdash;&amp;ndash;: | | 0 | 1 | 1193 | 5 | 978300760 | | 1 | 1 | 661 | 3 | 978302109 | | 2 | 1 | 914 | 3 | 978301968 | | 3 | 1 | 3408 | 4 | 978300275 | | 4 | 1 | 2355 | 5 | 978824291 | In [3]: 1 2 3" /><meta name="keywords" content="blog, yuanshuai, yyss" />






<meta name="generator" content="Hugo 0.119.0 with theme even" />


<link rel="canonical" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%89-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%89/" />
<link rel="apple-touch-icon" sizes="180x180" href="/yuanshuai1122.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/yuanshuai1122.github.io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/yuanshuai1122.github.io/favicon-16x16.png">
<link rel="manifest" href="/yuanshuai1122.github.io/manifest.json">
<link rel="mask-icon" href="/yuanshuai1122.github.io/safari-pinned-tab.svg" color="#5bbad5">



<link href="/yuanshuai1122.github.io/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆä¸‰ï¼‰" />
<meta property="og:description" content=": | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&ndash;: | &mdash;&mdash;&ndash;: | | 0 | 1 | 1193 | 5 | 978300760 | | 1 | 1 | 661 | 3 | 978302109 | | 2 | 1 | 914 | 3 | 978301968 | | 3 | 1 | 3408 | 4 | 978300275 | | 4 | 1 | 2355 | 5 | 978824291 | In [3]: 1 2 3" />
<meta property="og:type" content="article" />
<meta property="og:url" content="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%89-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%89/" /><meta property="article:section" content="post" />


<meta itemprop="name" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆä¸‰ï¼‰">
<meta itemprop="description" content=": | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&ndash;: | &mdash;&mdash;&ndash;: | | 0 | 1 | 1193 | 5 | 978300760 | | 1 | 1 | 661 | 3 | 978302109 | | 2 | 1 | 914 | 3 | 978301968 | | 3 | 1 | 3408 | 4 | 978300275 | | 4 | 1 | 2355 | 5 | 978824291 | In [3]: 1 2 3">

<meta itemprop="wordCount" content="9391">
<meta itemprop="keywords" content="Python,æ•°æ®åˆ†æ," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆä¸‰ï¼‰"/>
<meta name="twitter:description" content=": | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&ndash;: | &mdash;&mdash;&ndash;: | | 0 | 1 | 1193 | 5 | 978300760 | | 1 | 1 | 661 | 3 | 978302109 | | 2 | 1 | 914 | 3 | 978301968 | | 3 | 1 | 3408 | 4 | 978300275 | | 4 | 1 | 2355 | 5 | 978824291 | In [3]: 1 2 3"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">CNshuaiyuan</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="yuanshuai1122.github.io/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="yuanshuai1122.github.io/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="yuanshuai1122.github.io/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="yuanshuai1122.github.io/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">CNshuaiyuan</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆä¸‰ï¼‰</h1>

      <div class="post-meta">
        <span class="post-time"> 0001-01-01 </span>
        
          <span class="more-meta"> çº¦ 9391 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 19 åˆ†é’Ÿ </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#å®ä¾‹2æ€æ ·å–æ¯ä¸ªåˆ†ç»„çš„topnæ•°æ®">å®ä¾‹2ï¼šæ€æ ·å–æ¯ä¸ªåˆ†ç»„çš„TOPNæ•°æ®ï¼Ÿ</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#20pandasçš„stackå’Œpivotå®ç°æ•°æ®é€è§†">20ã€Pandasçš„stackå’Œpivotå®ç°æ•°æ®é€è§†</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1-ç»è¿‡ç»Ÿè®¡å¾—åˆ°å¤šç»´åº¦æŒ‡æ ‡æ•°æ®">1. ç»è¿‡ç»Ÿè®¡å¾—åˆ°å¤šç»´åº¦æŒ‡æ ‡æ•°æ®</a></li>
            <li><a href="#2-ä½¿ç”¨unstackå®ç°æ•°æ®äºŒç»´é€è§†">2. ä½¿ç”¨unstackå®ç°æ•°æ®äºŒç»´é€è§†</a></li>
            <li><a href="#3-ä½¿ç”¨pivotç®€åŒ–é€è§†">3. ä½¿ç”¨pivotç®€åŒ–é€è§†</a></li>
            <li><a href="#4-stackunstackpivotçš„è¯­æ³•">4. stackã€unstackã€pivotçš„è¯­æ³•</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#21pandasæ€æ ·å¿«æ·æ–¹ä¾¿çš„å¤„ç†æ—¥æœŸæ•°æ®">21ã€Pandasæ€æ ·å¿«æ·æ–¹ä¾¿çš„å¤„ç†æ—¥æœŸæ•°æ®</a>
      <ul>
        <li>
          <ul>
            <li><a href="#é—®é¢˜æ€æ ·ç»Ÿè®¡æ¯å‘¨æ¯æœˆæ¯å­£åº¦çš„æœ€é«˜æ¸©åº¦">é—®é¢˜ï¼šæ€æ ·ç»Ÿè®¡æ¯å‘¨ã€æ¯æœˆã€æ¯å­£åº¦çš„æœ€é«˜æ¸©åº¦ï¼Ÿ</a></li>
            <li><a href="#1è¯»å–å¤©æ°”æ•°æ®åˆ°dataframe">1ã€è¯»å–å¤©æ°”æ•°æ®åˆ°dataframe</a></li>
            <li><a href="#2å°†æ—¥æœŸåˆ—è½¬æ¢æˆpandasçš„æ—¥æœŸ">2ã€å°†æ—¥æœŸåˆ—è½¬æ¢æˆpandasçš„æ—¥æœŸ</a></li>
            <li><a href="#3-æ–¹ä¾¿çš„å¯¹datetimeindexè¿›è¡ŒæŸ¥è¯¢">3ã€ æ–¹ä¾¿çš„å¯¹DatetimeIndexè¿›è¡ŒæŸ¥è¯¢</a></li>
            <li><a href="#4æ–¹ä¾¿çš„è·å–å‘¨æœˆå­£åº¦">4ã€æ–¹ä¾¿çš„è·å–å‘¨ã€æœˆã€å­£åº¦</a></li>
            <li><a href="#5ç»Ÿè®¡æ¯å‘¨æ¯æœˆæ¯ä¸ªå­£åº¦çš„æœ€é«˜æ¸©åº¦">5ã€ç»Ÿè®¡æ¯å‘¨ã€æ¯æœˆã€æ¯ä¸ªå­£åº¦çš„æœ€é«˜æ¸©åº¦</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#22pandasæ€ä¹ˆå¤„ç†æ—¥æœŸç´¢å¼•çš„ç¼ºå¤±">22ã€Pandasæ€ä¹ˆå¤„ç†æ—¥æœŸç´¢å¼•çš„ç¼ºå¤±ï¼Ÿ</a>
      <ul>
        <li><a href="#é—®é¢˜å¦‚æœç¼ºå¤±äº†ç´¢å¼•è¯¥æ€ä¹ˆå¡«å……">é—®é¢˜ï¼šå¦‚æœç¼ºå¤±äº†ç´¢å¼•è¯¥æ€ä¹ˆå¡«å……ï¼Ÿ</a></li>
        <li><a href="#æ–¹æ³•1ä½¿ç”¨pandasreindexæ–¹æ³•">æ–¹æ³•1ï¼šä½¿ç”¨pandas.reindexæ–¹æ³•</a>
          <ul>
            <li><a href="#1å°†dfçš„ç´¢å¼•å˜æˆæ—¥æœŸç´¢å¼•">1ã€å°†dfçš„ç´¢å¼•å˜æˆæ—¥æœŸç´¢å¼•</a></li>
            <li><a href="#2ä½¿ç”¨pandasreindexå¡«å……ç¼ºå¤±çš„ç´¢å¼•">2ã€ä½¿ç”¨pandas.reindexå¡«å……ç¼ºå¤±çš„ç´¢å¼•</a></li>
          </ul>
        </li>
        <li><a href="#æ–¹æ³•2ä½¿ç”¨pandasresampleæ–¹æ³•">æ–¹æ³•2ï¼šä½¿ç”¨pandas.resampleæ–¹æ³•</a>
          <ul>
            <li><a href="#1å…ˆå°†ç´¢å¼•å˜æˆæ—¥æœŸç´¢å¼•">1ã€å…ˆå°†ç´¢å¼•å˜æˆæ—¥æœŸç´¢å¼•</a></li>
            <li><a href="#2ä½¿ç”¨dataframeçš„resampleçš„æ–¹æ³•æŒ‰ç…§å¤©é‡é‡‡æ ·">2ã€ä½¿ç”¨dataframeçš„resampleçš„æ–¹æ³•æŒ‰ç…§å¤©é‡é‡‡æ ·</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#23pandasæ€æ ·å®ç°excelçš„vlookupå¹¶ä¸”åœ¨æŒ‡å®šåˆ—åé¢è¾“å‡º">23ã€Pandasæ€æ ·å®ç°Excelçš„vlookupå¹¶ä¸”åœ¨æŒ‡å®šåˆ—åé¢è¾“å‡ºï¼Ÿ</a>
      <ul>
        <li>
          <ul>
            <li><a href="#æ­¥éª¤1è¯»å–ä¸¤ä¸ªæ•°æ®è¡¨">æ­¥éª¤1ï¼šè¯»å–ä¸¤ä¸ªæ•°æ®è¡¨</a></li>
            <li><a href="#æ­¥éª¤2å®ç°ä¸¤ä¸ªè¡¨çš„å…³è”">æ­¥éª¤2ï¼šå®ç°ä¸¤ä¸ªè¡¨çš„å…³è”</a></li>
            <li><a href="#æ­¥éª¤3è°ƒæ•´åˆ—çš„é¡ºåº">æ­¥éª¤3ï¼šè°ƒæ•´åˆ—çš„é¡ºåº</a></li>
            <li><a href="#æ­¥éª¤4è¾“å‡ºæœ€ç»ˆçš„excelæ–‡ä»¶">æ­¥éª¤4ï¼šè¾“å‡ºæœ€ç»ˆçš„Excelæ–‡ä»¶</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#24pandasæ€æ ·ç»“åˆpyechartsç»˜åˆ¶äº¤äº’æ€§æŠ˜çº¿å›¾">24ã€Pandasæ€æ ·ç»“åˆPyechartsç»˜åˆ¶äº¤äº’æ€§æŠ˜çº¿å›¾ï¼Ÿ</a>
      <ul>
        <li><a href="#1è¯»å–æ•°æ®">1ã€è¯»å–æ•°æ®</a></li>
        <li><a href="#2ä½¿ç”¨pyechartsç»˜åˆ¶æŠ˜çº¿å›¾">2ã€ä½¿ç”¨Pyechartsç»˜åˆ¶æŠ˜çº¿å›¾</a></li>
      </ul>
    </li>
    <li><a href="#25pandasç»“åˆsklearnå®ç°æ³°å¦å°¼å…‹å­˜æ´»ç‡é¢„æµ‹">25ã€Pandasç»“åˆSklearnå®ç°æ³°å¦å°¼å…‹å­˜æ´»ç‡é¢„æµ‹</a>
      <ul>
        <li>
          <ul>
            <li><a href="#å®ä¾‹ç›®æ ‡å®ç°æ³°å¦å°¼å…‹å­˜æ´»é¢„æµ‹">å®ä¾‹ç›®æ ‡ï¼šå®ç°æ³°å¦å°¼å…‹å­˜æ´»é¢„æµ‹</a></li>
            <li><a href="#æ­¥éª¤1è¯»å–è®­ç»ƒæ•°æ®">æ­¥éª¤1ï¼šè¯»å–è®­ç»ƒæ•°æ®</a></li>
            <li><a href="#æ­¥éª¤2è®­ç»ƒæ¨¡å‹">æ­¥éª¤2ï¼šè®­ç»ƒæ¨¡å‹</a></li>
            <li><a href="#æ­¥éª¤3å¯¹äºæœªçŸ¥æ•°æ®ä½¿ç”¨æ¨¡å‹">æ­¥éª¤3ï¼šå¯¹äºæœªçŸ¥æ•°æ®ä½¿ç”¨æ¨¡å‹</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#26pandaså¤„ç†åˆ†æç½‘ç«™åŸå§‹è®¿é—®æ—¥å¿—">26ã€Pandaså¤„ç†åˆ†æç½‘ç«™åŸå§‹è®¿é—®æ—¥å¿—</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1è¯»å–æ•°æ®å¹¶æ¸…ç†æ ¼å¼åŒ–">1ã€è¯»å–æ•°æ®å¹¶æ¸…ç†æ ¼å¼åŒ–</a></li>
            <li><a href="#2ç»Ÿè®¡spiderçš„æ¯”ä¾‹">2ã€ç»Ÿè®¡spiderçš„æ¯”ä¾‹</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#27pandasæ€æ ·æ‰¾å‡ºæœ€å½±å“ç»“æœçš„é‚£äº›ç‰¹å¾">27ã€Pandasæ€æ ·æ‰¾å‡ºæœ€å½±å“ç»“æœçš„é‚£äº›ç‰¹å¾ï¼Ÿ</a>
      <ul>
        <li><a href="#å®ä¾‹æ¼”ç¤ºæ³°å¦å°¼å…‹æ²‰èˆ¹äº‹ä»¶ä¸­æœ€å½±å“ç”Ÿæ­»çš„å› ç´ æœ‰å“ªäº›">å®ä¾‹æ¼”ç¤ºï¼šæ³°å¦å°¼å…‹æ²‰èˆ¹äº‹ä»¶ä¸­ï¼Œæœ€å½±å“ç”Ÿæ­»çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ</a>
          <ul>
            <li><a href="#1å¯¼å…¥ç›¸å…³çš„åŒ…">1ã€å¯¼å…¥ç›¸å…³çš„åŒ…</a></li>
            <li><a href="#2å¯¼å…¥æ³°å¦å°¼å…‹å·çš„æ•°æ®">2ã€å¯¼å…¥æ³°å¦å°¼å…‹å·çš„æ•°æ®</a></li>
            <li><a href="#3æ•°æ®æ¸…ç†å’Œè½¬æ¢">3ã€æ•°æ®æ¸…ç†å’Œè½¬æ¢</a></li>
            <li><a href="#4å°†ç‰¹å¾åˆ—å’Œç»“æœåˆ—æ‹†åˆ†å¼€">4ã€å°†ç‰¹å¾åˆ—å’Œç»“æœåˆ—æ‹†åˆ†å¼€</a></li>
            <li><a href="#5ä½¿ç”¨å¡æ–¹æ£€éªŒé€‰æ‹©topkçš„ç‰¹å¾">5ã€ä½¿ç”¨å¡æ–¹æ£€éªŒé€‰æ‹©topKçš„ç‰¹å¾</a></li>
            <li><a href="#6æŒ‰ç…§é‡è¦æ€§é¡ºåºæ‰“å°ç‰¹å¾åˆ—è¡¨">6ã€æŒ‰ç…§é‡è¦æ€§é¡ºåºæ‰“å°ç‰¹å¾åˆ—è¡¨</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
  <div class="post-outdated">
    <div class="warn">
      <p>ã€æ³¨æ„ã€‘æœ€åæ›´æ–°äº <span class="timeago" datetime="0001-01-01T00:00:00" title="January 1, 0001">January 1, 0001</span>ï¼Œæ–‡ä¸­å†…å®¹å¯èƒ½å·²è¿‡æ—¶ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p>
    </div>
  </div>
    <div class="post-content">
      <p>: | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&ndash;: | &mdash;&mdash;&ndash;: |
|    0 |      1 |    1193 |      5 | 978300760 |
|    1 |      1 |     661 |      3 | 978302109 |
|    2 |      1 |     914 |      3 | 978301968 |
|    3 |      1 |    3408 |      4 | 978300275 |
|    4 |      1 |    2355 |      5 | 978824291 |</p>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å®ç°æŒ‰ç…§ç”¨æˆ·IDåˆ†ç»„ï¼Œç„¶åå¯¹å…¶ä¸­ä¸€åˆ—å½’ä¸€åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">ratings_norm</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    @param dfï¼šæ¯ä¸ªç”¨æˆ·åˆ†ç»„çš„dataframe
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">min_value</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;Rating&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">max_value</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;Rating&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="p">[</span><span class="s2">&#34;Rating_norm&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;Rating&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">min_value</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max_value</span><span class="o">-</span><span class="n">min_value</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">df</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ratings</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;UserID&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">ratings_norm</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ratings</span><span class="p">[</span><span class="n">ratings</span><span class="p">[</span><span class="s2">&#34;UserID&#34;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
<th style="text-align:right">Rating_norm</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
<td style="text-align:right">1.0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
<td style="text-align:right">0.0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
<td style="text-align:right">0.0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
<td style="text-align:right">0.5</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
<td style="text-align:right">1.0</td>
</tr>
</tbody>
</table>
<p>å¯ä»¥çœ‹åˆ°UserID==1è¿™ä¸ªç”¨æˆ·ï¼ŒRating==3æ˜¯ä»–çš„æœ€ä½åˆ†ï¼Œæ˜¯ä¸ªä¹è§‚æ´¾ï¼Œæˆ‘ä»¬å½’ä¸€åŒ–åˆ°0åˆ†ï¼›</p>
<h3 id="å®ä¾‹2æ€æ ·å–æ¯ä¸ªåˆ†ç»„çš„topnæ•°æ®">å®ä¾‹2ï¼šæ€æ ·å–æ¯ä¸ªåˆ†ç»„çš„TOPNæ•°æ®ï¼Ÿ</h3>
<p>è·å–2018å¹´æ¯ä¸ªæœˆæ¸©åº¦æœ€é«˜çš„2å¤©æ•°æ®</p>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fpath</span> <span class="o">=</span> <span class="s2">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ›¿æ¢æ‰æ¸©åº¦çš„åç¼€â„ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&#34;bWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&#34;yWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;yWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ–°å¢ä¸€åˆ—ä¸ºæœˆä»½</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ymd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
<th style="text-align:right">month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
</tbody>
</table>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getWenduTopN</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">topn</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    è¿™é‡Œçš„dfï¼Œæ˜¯æ¯ä¸ªæœˆä»½åˆ†ç»„groupçš„df
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&#34;bWendu&#34;</span><span class="p">)[[</span><span class="s2">&#34;ymd&#34;</span><span class="p">,</span> <span class="s2">&#34;bWendu&#34;</span><span class="p">]][</span><span class="o">-</span><span class="n">topn</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;month&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">getWenduTopN</span><span class="p">,</span> <span class="n">topn</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">month</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01</td>
<td style="text-align:right">18</td>
<td style="text-align:right">2018-01-19</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2018-02</td>
<td style="text-align:right">56</td>
<td style="text-align:right">2018-02-26</td>
<td style="text-align:right">12</td>
</tr>
<tr>
<td style="text-align:right">2018-03</td>
<td style="text-align:right">85</td>
<td style="text-align:right">2018-03-27</td>
<td style="text-align:right">27</td>
</tr>
<tr>
<td style="text-align:right">2018-04</td>
<td style="text-align:right">118</td>
<td style="text-align:right">2018-04-29</td>
<td style="text-align:right">30</td>
</tr>
<tr>
<td style="text-align:right">2018-05</td>
<td style="text-align:right">150</td>
<td style="text-align:right">2018-05-31</td>
<td style="text-align:right">35</td>
</tr>
</tbody>
</table>
<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œgroubyçš„applyå‡½æ•°è¿”å›çš„dataframeï¼Œå…¶å®å’ŒåŸæ¥çš„dataframeå…¶å®å¯ä»¥å®Œå…¨ä¸ä¸€æ ·</p>
<h1 id="20pandasçš„stackå’Œpivotå®ç°æ•°æ®é€è§†">20ã€Pandasçš„stackå’Œpivotå®ç°æ•°æ®é€è§†</h1>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/12.png" alt=""></p>
<ol>
<li>ç»è¿‡ç»Ÿè®¡å¾—åˆ°å¤šç»´åº¦æŒ‡æ ‡æ•°æ®</li>
<li>ä½¿ç”¨unstackå®ç°æ•°æ®äºŒç»´é€è§†</li>
<li>ä½¿ç”¨pivotç®€åŒ–é€è§†</li>
<li>stackã€unstackã€pivotçš„è¯­æ³•</li>
</ol>
<h3 id="1-ç»è¿‡ç»Ÿè®¡å¾—åˆ°å¤šç»´åº¦æŒ‡æ ‡æ•°æ®">1. ç»è¿‡ç»Ÿè®¡å¾—åˆ°å¤šç»´åº¦æŒ‡æ ‡æ•°æ®</h3>
<p>éå¸¸å¸¸è§çš„ç»Ÿè®¡åœºæ™¯ï¼ŒæŒ‡å®šå¤šä¸ªç»´åº¦ï¼Œè®¡ç®—èšåˆåçš„æŒ‡æ ‡</p>
<p>å®ä¾‹ï¼šç»Ÿè®¡å¾—åˆ°â€œç”µå½±è¯„åˆ†æ•°æ®é›†â€ï¼Œæ¯ä¸ªæœˆä»½çš„æ¯ä¸ªåˆ†æ•°è¢«è¯„åˆ†å¤šå°‘æ¬¡ï¼šï¼ˆæœˆä»½ã€åˆ†æ•°1~5ã€æ¬¡æ•°ï¼‰</p>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;./datas/movielens-1m/ratings.dat&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">names</span><span class="o">=</span><span class="s2">&#34;UserID::MovieID::Rating::Timestamp&#34;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;::&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;::&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">engine</span><span class="o">=</span><span class="s2">&#34;python&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
</tr>
</tbody>
</table>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;pdate&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Timestamp&#34;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
<th style="text-align:right">pdate</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
<td style="text-align:right">2000-12-31 22:12:40</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
<td style="text-align:right">2000-12-31 22:35:09</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
<td style="text-align:right">2000-12-31 22:32:48</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
<td style="text-align:right">2000-12-31 22:04:35</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
<td style="text-align:right">2001-01-06 23:38:11</td>
</tr>
</tbody>
</table>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">UserID</span>                <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">MovieID</span>               <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Rating</span>                <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Timestamp</span>             <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">pdate</span>        <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å®ç°æ•°æ®ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl"><span class="n">df_group</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;pdate&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="s2">&#34;Rating&#34;</span><span class="p">])[</span><span class="s2">&#34;UserID&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pv</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_group</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[20]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right">Rating</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2608</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">6442</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">8400</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4495</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">629</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1464</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3297</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4403</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">2335</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">466</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1077</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2523</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">3032</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">1439</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1048</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2247</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">5501</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">6748</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3863</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<p>å¯¹è¿™æ ·æ ¼å¼çš„æ•°æ®ï¼Œæˆ‘æƒ³æŸ¥çœ‹æŒ‰æœˆä»½ï¼Œä¸åŒè¯„åˆ†çš„æ¬¡æ•°è¶‹åŠ¿ï¼Œæ˜¯æ²¡æ³•å®ç°çš„</p>
<p>éœ€è¦å°†æ•°æ®å˜æ¢æˆæ¯ä¸ªè¯„åˆ†æ˜¯ä¸€åˆ—æ‰å¯ä»¥å®ç°</p>
<h3 id="2-ä½¿ç”¨unstackå®ç°æ•°æ®äºŒç»´é€è§†">2. ä½¿ç”¨unstackå®ç°æ•°æ®äºŒç»´é€è§†</h3>
<p>ç›®çš„ï¼šæƒ³è¦ç”»å›¾å¯¹æ¯”æŒ‰ç…§æœˆä»½çš„ä¸åŒè¯„åˆ†çš„æ•°é‡è¶‹åŠ¿</p>
<p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_stack</span> <span class="o">=</span> <span class="n">df_group</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">df_stack</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[21]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Rating</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
<td style="text-align:right">2608</td>
<td style="text-align:right">6442</td>
<td style="text-align:right">8400</td>
<td style="text-align:right">4495</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">629</td>
<td style="text-align:right">1464</td>
<td style="text-align:right">3297</td>
<td style="text-align:right">4403</td>
<td style="text-align:right">2335</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">466</td>
<td style="text-align:right">1077</td>
<td style="text-align:right">2523</td>
<td style="text-align:right">3032</td>
<td style="text-align:right">1439</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1048</td>
<td style="text-align:right">2247</td>
<td style="text-align:right">5501</td>
<td style="text-align:right">6748</td>
<td style="text-align:right">3863</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4557</td>
<td style="text-align:right">7631</td>
<td style="text-align:right">18481</td>
<td style="text-align:right">25769</td>
<td style="text-align:right">17840</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">3196</td>
<td style="text-align:right">6500</td>
<td style="text-align:right">15211</td>
<td style="text-align:right">21838</td>
<td style="text-align:right">14365</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">4891</td>
<td style="text-align:right">9566</td>
<td style="text-align:right">25421</td>
<td style="text-align:right">34957</td>
<td style="text-align:right">22169</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">10873</td>
<td style="text-align:right">20597</td>
<td style="text-align:right">50509</td>
<td style="text-align:right">64198</td>
<td style="text-align:right">42497</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">3107</td>
<td style="text-align:right">5873</td>
<td style="text-align:right">14702</td>
<td style="text-align:right">19927</td>
<td style="text-align:right">13182</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">2121</td>
<td style="text-align:right">4785</td>
<td style="text-align:right">12175</td>
<td style="text-align:right">16095</td>
<td style="text-align:right">10324</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">17701</td>
<td style="text-align:right">32202</td>
<td style="text-align:right">76069</td>
<td style="text-align:right">102448</td>
<td style="text-align:right">67041</td>
</tr>
<tr>
<td style="text-align:right">12</td>
<td style="text-align:right">6458</td>
<td style="text-align:right">13007</td>
<td style="text-align:right">30866</td>
<td style="text-align:right">41156</td>
<td style="text-align:right">26760</td>
</tr>
</tbody>
</table>
<p>In [22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_stack</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1ba09b0ce48</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/13.png" alt=""></p>
<p>In [23]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># unstackå’Œstackæ˜¯äº’é€†æ“ä½œ</span>
</span></span><span class="line"><span class="cl"><span class="n">df_stack</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[23]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right">Rating</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2608</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">6442</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">8400</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4495</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">629</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1464</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3297</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4403</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">2335</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">466</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1077</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2523</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">3032</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">1439</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1048</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2247</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">5501</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">6748</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3863</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h3 id="3-ä½¿ç”¨pivotç®€åŒ–é€è§†">3. ä½¿ç”¨pivotç®€åŒ–é€è§†</h3>
<p>In [24]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_group</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[24]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right">Rating</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2608</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">6442</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">8400</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4495</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">629</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1464</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3297</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4403</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">2335</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">466</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1077</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2523</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">3032</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">1439</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1048</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2247</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">5501</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">6748</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">3863</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<p>In [25]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_reset</span> <span class="o">=</span> <span class="n">df_group</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">df_reset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[25]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pdate</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">pv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2608</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">6442</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">8400</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">4495</td>
</tr>
</tbody>
</table>
<p>In [26]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_pivot</span> <span class="o">=</span> <span class="n">df_reset</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="s2">&#34;pdate&#34;</span><span class="p">,</span> <span class="s2">&#34;Rating&#34;</span><span class="p">,</span> <span class="s2">&#34;pv&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [27]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_pivot</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[27]:</p>
<table>
<thead>
<tr>
<th style="text-align:right">Rating</th>
<th style="text-align:right">1</th>
<th style="text-align:right">2</th>
<th style="text-align:right">3</th>
<th style="text-align:right">4</th>
<th style="text-align:right">5</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1127</td>
<td style="text-align:right">2608</td>
<td style="text-align:right">6442</td>
<td style="text-align:right">8400</td>
<td style="text-align:right">4495</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">629</td>
<td style="text-align:right">1464</td>
<td style="text-align:right">3297</td>
<td style="text-align:right">4403</td>
<td style="text-align:right">2335</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">466</td>
<td style="text-align:right">1077</td>
<td style="text-align:right">2523</td>
<td style="text-align:right">3032</td>
<td style="text-align:right">1439</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1048</td>
<td style="text-align:right">2247</td>
<td style="text-align:right">5501</td>
<td style="text-align:right">6748</td>
<td style="text-align:right">3863</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">4557</td>
<td style="text-align:right">7631</td>
<td style="text-align:right">18481</td>
<td style="text-align:right">25769</td>
<td style="text-align:right">17840</td>
</tr>
</tbody>
</table>
<p>In [28]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_pivot</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[28]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1ba09db6d48</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/14.png" alt=""></p>
<p>*<strong>pivotæ–¹æ³•ç›¸å½“äºå¯¹dfä½¿ç”¨set_indexåˆ›å»ºåˆ†å±‚ç´¢å¼•ï¼Œç„¶åè°ƒç”¨unstack*</strong></p>
<h3 id="4-stackunstackpivotçš„è¯­æ³•">4. stackã€unstackã€pivotçš„è¯­æ³•</h3>
<h4 id="stackdataframestacklevel-1-dropnatrueå°†columnå˜æˆindexç±»ä¼¼æŠŠæ¨ªæ”¾çš„ä¹¦ç±å˜æˆç«–æ”¾">stackï¼šDataFrame.stack(level=-1, dropna=True)ï¼Œå°†columnå˜æˆindexï¼Œç±»ä¼¼æŠŠæ¨ªæ”¾çš„ä¹¦ç±å˜æˆç«–æ”¾</h4>
<p>level=-1ä»£è¡¨å¤šå±‚ç´¢å¼•çš„æœ€å†…å±‚ï¼Œå¯ä»¥é€šè¿‡==0ã€1ã€2æŒ‡å®šå¤šå±‚ç´¢å¼•çš„å¯¹åº”å±‚</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/15.png" alt=""></p>
<h4 id="unstackdataframeunstacklevel-1-fill_valuenoneå°†indexå˜æˆcolumnç±»ä¼¼æŠŠç«–æ”¾çš„ä¹¦ç±å˜æˆæ¨ªæ”¾">unstackï¼šDataFrame.unstack(level=-1, fill_value=None)ï¼Œå°†indexå˜æˆcolumnï¼Œç±»ä¼¼æŠŠç«–æ”¾çš„ä¹¦ç±å˜æˆæ¨ªæ”¾</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/16.png" alt=""></p>
<h4 id="pivotdataframepivotindexnone-columnsnone-valuesnoneæŒ‡å®šindexcolumnsvalueså®ç°äºŒç»´é€è§†">pivotï¼šDataFrame.pivot(index=None, columns=None, values=None)ï¼ŒæŒ‡å®šindexã€columnsã€valueså®ç°äºŒç»´é€è§†</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/17.png" alt=""></p>
<h1 id="21pandasæ€æ ·å¿«æ·æ–¹ä¾¿çš„å¤„ç†æ—¥æœŸæ•°æ®">21ã€Pandasæ€æ ·å¿«æ·æ–¹ä¾¿çš„å¤„ç†æ—¥æœŸæ•°æ®</h1>
<p>Pandasæ—¥æœŸå¤„ç†çš„ä½œç”¨ï¼šå°†2018-01-01ã€1/1/2018ç­‰å¤šç§æ—¥æœŸæ ¼å¼æ˜ å°„æˆç»Ÿä¸€çš„æ ¼å¼å¯¹è±¡ï¼Œåœ¨è¯¥å¯¹è±¡ä¸Šæä¾›å¼ºå¤§çš„åŠŸèƒ½æ”¯æŒ</p>
<p>å‡ ä¸ªæ¦‚å¿µï¼š</p>
<ol>
<li>pd.to_datetimeï¼špandasçš„ä¸€ä¸ªå‡½æ•°ï¼Œèƒ½å°†å­—ç¬¦ä¸²ã€åˆ—è¡¨ã€serieså˜æˆæ—¥æœŸå½¢å¼</li>
<li>Timestampï¼špandasè¡¨ç¤ºæ—¥æœŸçš„å¯¹è±¡å½¢å¼</li>
<li>DatetimeIndexï¼špandasè¡¨ç¤ºæ—¥æœŸçš„å¯¹è±¡åˆ—è¡¨å½¢å¼</li>
</ol>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>DatetimeIndexæ˜¯Timestampçš„åˆ—è¡¨å½¢å¼</li>
<li>pd.to_datetimeå¯¹å•ä¸ªæ—¥æœŸå­—ç¬¦ä¸²å¤„ç†ä¼šå¾—åˆ°Timestamp</li>
<li>pd.to_datetimeå¯¹æ—¥æœŸå­—ç¬¦ä¸²åˆ—è¡¨å¤„ç†ä¼šå¾—åˆ°DatetimeIndex</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/18.png" alt=""></p>
<h3 id="é—®é¢˜æ€æ ·ç»Ÿè®¡æ¯å‘¨æ¯æœˆæ¯å­£åº¦çš„æœ€é«˜æ¸©åº¦">é—®é¢˜ï¼šæ€æ ·ç»Ÿè®¡æ¯å‘¨ã€æ¯æœˆã€æ¯å­£åº¦çš„æœ€é«˜æ¸©åº¦ï¼Ÿ</h3>
<h3 id="1è¯»å–å¤©æ°”æ•°æ®åˆ°dataframe">1ã€è¯»å–å¤©æ°”æ•°æ®åˆ°dataframe</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fpath</span> <span class="o">=</span> <span class="s2">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ›¿æ¢æ‰æ¸©åº¦çš„åç¼€â„ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&#34;bWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&#34;yWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;yWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h3 id="2å°†æ—¥æœŸåˆ—è½¬æ¢æˆpandasçš„æ—¥æœŸ">2ã€å°†æ—¥æœŸåˆ—è½¬æ¢æˆpandasçš„æ—¥æœŸ</h3>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-04&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-01-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-07&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-08&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-01-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-10&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="o">...</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-12-22&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-12-23&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-12-24&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-12-25&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-12-26&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-12-27&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-12-28&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-12-29&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-12-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-12-31&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ymd&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">365</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># DatetimeIndexæ˜¯Timestampçš„åˆ—è¡¨å½¢å¼</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2018-01-01 00:00:00&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-æ–¹ä¾¿çš„å¯¹datetimeindexè¿›è¡ŒæŸ¥è¯¢">3ã€ æ–¹ä¾¿çš„å¯¹DatetimeIndexè¿›è¡ŒæŸ¥è¯¢</h3>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç­›é€‰å›ºå®šçš„æŸä¸€å¤©</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2018-01-05&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ymd</span>          <span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span>
</span></span><span class="line"><span class="cl"><span class="n">bWendu</span>                <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">yWendu</span>               <span class="o">-</span><span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="n">tianqi</span>             <span class="n">å¤šäº‘</span><span class="o">~</span><span class="n">æ™´</span>
</span></span><span class="line"><span class="cl"><span class="n">fengxiang</span>           <span class="n">è¥¿åŒ—é£</span>
</span></span><span class="line"><span class="cl"><span class="n">fengli</span>             <span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="n">çº§</span>
</span></span><span class="line"><span class="cl"><span class="n">aqi</span>                  <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="n">aqiInfo</span>               <span class="n">ä¼˜</span>
</span></span><span class="line"><span class="cl"><span class="n">aqiLevel</span>              <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ—¥æœŸåŒºé—´</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2018-01-05&#39;</span><span class="p">:</span><span class="s1">&#39;2018-01-10&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-06</td>
<td style="text-align:right">2018-01-06</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘~é˜´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">32</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-07</td>
<td style="text-align:right">2018-01-07</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-01-08</td>
<td style="text-align:right">2018-01-08</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">4-5çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-09</td>
<td style="text-align:right">2018-01-09</td>
<td style="text-align:right">1</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">34</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-10</td>
<td style="text-align:right">2018-01-10</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">-10</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">26</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æŒ‰æœˆä»½å‰ç¼€ç­›é€‰</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2018-03&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-03-01</td>
<td style="text-align:right">2018-03-01</td>
<td style="text-align:right">8</td>
<td style="text-align:right">-3</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">46</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-03-02</td>
<td style="text-align:right">2018-03-02</td>
<td style="text-align:right">9</td>
<td style="text-align:right">-1</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">95</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-03</td>
<td style="text-align:right">2018-03-03</td>
<td style="text-align:right">13</td>
<td style="text-align:right">3</td>
<td style="text-align:right">å¤šäº‘~é˜´</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">214</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2018-03-04</td>
<td style="text-align:right">2018-03-04</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œå—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">144</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-05</td>
<td style="text-align:right">2018-03-05</td>
<td style="text-align:right">8</td>
<td style="text-align:right">-3</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">94</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-06</td>
<td style="text-align:right">2018-03-06</td>
<td style="text-align:right">6</td>
<td style="text-align:right">-3</td>
<td style="text-align:right">å¤šäº‘~é˜´</td>
<td style="text-align:right">ä¸œå—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">67</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-07</td>
<td style="text-align:right">2018-03-07</td>
<td style="text-align:right">6</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">65</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-08</td>
<td style="text-align:right">2018-03-08</td>
<td style="text-align:right">8</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">62</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-09</td>
<td style="text-align:right">2018-03-09</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">132</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-10</td>
<td style="text-align:right">2018-03-10</td>
<td style="text-align:right">14</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">ä¸œå—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">171</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2018-03-11</td>
<td style="text-align:right">2018-03-11</td>
<td style="text-align:right">11</td>
<td style="text-align:right">0</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">81</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-12</td>
<td style="text-align:right">2018-03-12</td>
<td style="text-align:right">15</td>
<td style="text-align:right">3</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">174</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2018-03-13</td>
<td style="text-align:right">2018-03-13</td>
<td style="text-align:right">17</td>
<td style="text-align:right">5</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">287</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2018-03-14</td>
<td style="text-align:right">2018-03-14</td>
<td style="text-align:right">15</td>
<td style="text-align:right">6</td>
<td style="text-align:right">å¤šäº‘~é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">293</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2018-03-15</td>
<td style="text-align:right">2018-03-15</td>
<td style="text-align:right">12</td>
<td style="text-align:right">-1</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">70</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-16</td>
<td style="text-align:right">2018-03-16</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-1</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">58</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-17</td>
<td style="text-align:right">2018-03-17</td>
<td style="text-align:right">4</td>
<td style="text-align:right">0</td>
<td style="text-align:right">å°é›¨~é˜´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">81</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-18</td>
<td style="text-align:right">2018-03-18</td>
<td style="text-align:right">13</td>
<td style="text-align:right">1</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">134</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-19</td>
<td style="text-align:right">2018-03-19</td>
<td style="text-align:right">13</td>
<td style="text-align:right">2</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">ä¸œé£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">107</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-20</td>
<td style="text-align:right">2018-03-20</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">41</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-03-21</td>
<td style="text-align:right">2018-03-21</td>
<td style="text-align:right">11</td>
<td style="text-align:right">1</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">76</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-22</td>
<td style="text-align:right">2018-03-22</td>
<td style="text-align:right">17</td>
<td style="text-align:right">4</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">112</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-23</td>
<td style="text-align:right">2018-03-23</td>
<td style="text-align:right">18</td>
<td style="text-align:right">5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">146</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-24</td>
<td style="text-align:right">2018-03-24</td>
<td style="text-align:right">22</td>
<td style="text-align:right">5</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">119</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-25</td>
<td style="text-align:right">2018-03-25</td>
<td style="text-align:right">24</td>
<td style="text-align:right">7</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">78</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-26</td>
<td style="text-align:right">2018-03-26</td>
<td style="text-align:right">25</td>
<td style="text-align:right">7</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">151</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2018-03-27</td>
<td style="text-align:right">2018-03-27</td>
<td style="text-align:right">27</td>
<td style="text-align:right">11</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">243</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">2018-03-28</td>
<td style="text-align:right">2018-03-28</td>
<td style="text-align:right">25</td>
<td style="text-align:right">9</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">ä¸œé£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">387</td>
<td style="text-align:right">ä¸¥é‡æ±¡æŸ“</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">2018-03-29</td>
<td style="text-align:right">2018-03-29</td>
<td style="text-align:right">19</td>
<td style="text-align:right">7</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">119</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2018-03-30</td>
<td style="text-align:right">2018-03-30</td>
<td style="text-align:right">18</td>
<td style="text-align:right">8</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">68</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">2018-03-31</td>
<td style="text-align:right">23</td>
<td style="text-align:right">9</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">125</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æŒ‰æœˆä»½å‰ç¼€ç­›é€‰</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&#34;2018-07&#34;</span><span class="p">:</span><span class="s2">&#34;2018-09&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2018-07-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-04&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-07-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-07&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-08&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-07-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-10&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-11&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-12&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-07-13&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-14&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-16&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-07-17&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-18&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-19&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-20&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-07-21&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-22&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-23&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-24&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-07-25&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-26&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-27&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-28&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-07-29&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-07-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-01&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-08-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-05&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-08-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-07&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-08&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-09&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-08-10&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-11&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-12&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-13&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-08-14&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-16&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-17&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-08-18&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-19&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-20&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-21&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-08-22&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-23&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-24&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-25&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-08-26&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-27&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-28&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-29&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-08-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-08-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-02&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-09-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-06&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-09-07&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-08&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-10&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-09-11&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-12&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-13&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-14&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-09-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-16&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-17&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-18&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-09-19&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-20&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-21&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-22&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-09-23&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-24&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-25&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-26&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2018-09-27&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-28&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-29&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-30&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ymd&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æŒ‰å¹´ä»½å‰ç¼€ç­›é€‰</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&#34;2018&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">ymd</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h3 id="4æ–¹ä¾¿çš„è·å–å‘¨æœˆå­£åº¦">4ã€æ–¹ä¾¿çš„è·å–å‘¨ã€æœˆã€å­£åº¦</h3>
<p>Timestampã€DatetimeIndexæ”¯æŒå¤§é‡çš„å±æ€§å¯ä»¥è·å–æ—¥æœŸåˆ†é‡ï¼š
<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#time-date-components">https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#time-date-components</a></p>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å‘¨æ•°å­—åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">week</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Int64Index</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="o">...</span>
</span></span><span class="line"><span class="cl">            <span class="mi">51</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">           <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ymd&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">365</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æœˆæ•°å­—åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Int64Index</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="o">...</span>
</span></span><span class="line"><span class="cl">            <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">           <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ymd&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">365</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å­£åº¦æ•°å­—åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">quarter</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Int64Index([1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
</span></span><span class="line"><span class="cl">            ...
</span></span><span class="line"><span class="cl">            4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
</span></span><span class="line"><span class="cl">           dtype=&#39;int64&#39;, name=&#39;ymd&#39;, length=365)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="5ç»Ÿè®¡æ¯å‘¨æ¯æœˆæ¯ä¸ªå­£åº¦çš„æœ€é«˜æ¸©åº¦">5ã€ç»Ÿè®¡æ¯å‘¨ã€æ¯æœˆã€æ¯ä¸ªå­£åº¦çš„æœ€é«˜æ¸©åº¦</h3>
<h4 id="ç»Ÿè®¡æ¯å‘¨çš„æ•°æ®">ç»Ÿè®¡æ¯å‘¨çš„æ•°æ®</h4>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">week</span><span class="p">)[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ymd</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>    <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>    <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>    <span class="mi">7</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>   <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span>    <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">bWendu</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">week</span><span class="p">)[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x23300b75b88</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/19.png" alt=""></p>
<h4 id="ç»Ÿè®¡æ¯ä¸ªæœˆçš„æ•°æ®">ç»Ÿè®¡æ¯ä¸ªæœˆçš„æ•°æ®</h4>
<p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">)[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ymd</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>      <span class="mi">7</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>     <span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>     <span class="mi">27</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>     <span class="mi">30</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span>     <span class="mi">35</span>
</span></span><span class="line"><span class="cl"><span class="mi">6</span>     <span class="mi">38</span>
</span></span><span class="line"><span class="cl"><span class="mi">7</span>     <span class="mi">37</span>
</span></span><span class="line"><span class="cl"><span class="mi">8</span>     <span class="mi">36</span>
</span></span><span class="line"><span class="cl"><span class="mi">9</span>     <span class="mi">31</span>
</span></span><span class="line"><span class="cl"><span class="mi">10</span>    <span class="mi">25</span>
</span></span><span class="line"><span class="cl"><span class="mi">11</span>    <span class="mi">18</span>
</span></span><span class="line"><span class="cl"><span class="mi">12</span>    <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">bWendu</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">)[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x23302dac4c8</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/20.png" alt=""></p>
<h4 id="ç»Ÿè®¡æ¯ä¸ªå­£åº¦çš„æ•°æ®">ç»Ÿè®¡æ¯ä¸ªå­£åº¦çš„æ•°æ®</h4>
<p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">df.groupby(df.index.quarter)[&#34;bWendu&#34;].max()
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ymd</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>    <span class="mi">27</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>    <span class="mi">38</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>    <span class="mi">37</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>    <span class="mi">25</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">bWendu</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">quarter</span><span class="p">)[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x23302e338c8</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/21.png" alt=""></p>
<h1 id="22pandasæ€ä¹ˆå¤„ç†æ—¥æœŸç´¢å¼•çš„ç¼ºå¤±">22ã€Pandasæ€ä¹ˆå¤„ç†æ—¥æœŸç´¢å¼•çš„ç¼ºå¤±ï¼Ÿ</h1>
<p>é—®é¢˜ï¼šæŒ‰æ—¥æœŸç»Ÿè®¡çš„æ•°æ®ï¼Œç¼ºå¤±äº†æŸå¤©ï¼Œå¯¼è‡´æ•°æ®ä¸å…¨è¯¥æ€ä¹ˆè¡¥å……æ—¥æœŸï¼Ÿ</p>
<p>å¯ä»¥ç”¨ä¸¤ç§æ–¹æ³•å®ç°ï¼š
1ã€DataFrame.reindexï¼Œè°ƒæ•´dataframeçš„ç´¢å¼•ä»¥é€‚åº”æ–°çš„ç´¢å¼•
2ã€DataFrame.resampleï¼Œå¯ä»¥å¯¹æ—¶é—´åºåˆ—é‡é‡‡æ ·ï¼Œæ”¯æŒè¡¥å……ç¼ºå¤±å€¼</p>
<h2 id="é—®é¢˜å¦‚æœç¼ºå¤±äº†ç´¢å¼•è¯¥æ€ä¹ˆå¡«å……">é—®é¢˜ï¼šå¦‚æœç¼ºå¤±äº†ç´¢å¼•è¯¥æ€ä¹ˆå¡«å……ï¼Ÿ</h2>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;pdate&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;2019-12-01&#34;</span><span class="p">,</span> <span class="s2">&#34;2019-12-02&#34;</span><span class="p">,</span> <span class="s2">&#34;2019-12-04&#34;</span><span class="p">,</span> <span class="s2">&#34;2019-12-05&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;pv&#34;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;uv&#34;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pdate</th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&#34;pdate&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1a0d908bf48</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/22.png" alt=""></p>
<p>*<strong>é—®é¢˜ï¼Œè¿™é‡Œç¼ºå¤±äº†2019-12-03çš„æ•°æ®ï¼Œå¯¼è‡´æ•°æ®ä¸å…¨è¯¥æ€ä¹ˆè¡¥å……ï¼Ÿ*</strong></p>
<h2 id="æ–¹æ³•1ä½¿ç”¨pandasreindexæ–¹æ³•">æ–¹æ³•1ï¼šä½¿ç”¨pandas.reindexæ–¹æ³•</h2>
<h3 id="1å°†dfçš„ç´¢å¼•å˜æˆæ—¥æœŸç´¢å¼•">1ã€å°†dfçš„ç´¢å¼•å˜æˆæ—¥æœŸç´¢å¼•</h3>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_date</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&#34;pdate&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_date</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_date</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;2019-12-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-05&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;pdate&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å°†dfçš„ç´¢å¼•è®¾ç½®ä¸ºæ—¥æœŸç´¢å¼•</span>
</span></span><span class="line"><span class="cl"><span class="n">df_date</span> <span class="o">=</span> <span class="n">df_date</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_date</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">df_date</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_date</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2019-12-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-05&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;pdate&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2ä½¿ç”¨pandasreindexå¡«å……ç¼ºå¤±çš„ç´¢å¼•">2ã€ä½¿ç”¨pandas.reindexå¡«å……ç¼ºå¤±çš„ç´¢å¼•</h3>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆå®Œæ•´çš„æ—¥æœŸåºåˆ—</span>
</span></span><span class="line"><span class="cl"><span class="n">pdates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&#34;2019-12-01&#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;2019-12-05&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pdates</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2019-12-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-04&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2019-12-05&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_date_new</span> <span class="o">=</span> <span class="n">df_date</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">pdates</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_date_new</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2019-12-03</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_date_new</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1a0db1ab388</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/23.png" alt=""></p>
<h2 id="æ–¹æ³•2ä½¿ç”¨pandasresampleæ–¹æ³•">æ–¹æ³•2ï¼šä½¿ç”¨pandas.resampleæ–¹æ³•</h2>
<h3 id="1å…ˆå°†ç´¢å¼•å˜æˆæ—¥æœŸç´¢å¼•">1ã€å…ˆå°†ç´¢å¼•å˜æˆæ—¥æœŸç´¢å¼•</h3>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pdate</th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_new2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;pdate&#34;</span><span class="p">]))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&#34;pdate&#34;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_new2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_new2</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2019-12-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-05&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;pdate&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2ä½¿ç”¨dataframeçš„resampleçš„æ–¹æ³•æŒ‰ç…§å¤©é‡é‡‡æ ·">2ã€ä½¿ç”¨dataframeçš„resampleçš„æ–¹æ³•æŒ‰ç…§å¤©é‡é‡‡æ ·</h3>
<p>resampleçš„å«ä¹‰ï¼š
æ”¹å˜æ•°æ®çš„æ—¶é—´é¢‘ç‡ï¼Œæ¯”å¦‚æŠŠå¤©æ•°æ®å˜æˆæœˆä»½ï¼Œæˆ–è€…æŠŠå°æ—¶æ•°æ®å˜æˆåˆ†é’Ÿçº§åˆ«</p>
<p>resampleçš„è¯­æ³•ï¼š
(DataFrame or Series).resample(arguments).(aggregate function)</p>
<p>resampleçš„é‡‡æ ·è§„åˆ™å‚æ•°ï¼š
<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases">https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases</a></p>
<p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç”±äºé‡‡æ ·ä¼šè®©åŒºé—´å˜æˆä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥éœ€è¦æŒ‡å®šmeanç­‰é‡‡æ ·å€¼çš„è®¾å®šæ–¹æ³•</span>
</span></span><span class="line"><span class="cl"><span class="n">df_new2</span> <span class="o">=</span> <span class="n">df_new2</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&#34;D&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_new2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">100.0</td>
<td style="text-align:right">10.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">200.0</td>
<td style="text-align:right">20.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-03</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">0.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-04</td>
<td style="text-align:right">400.0</td>
<td style="text-align:right">40.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500.0</td>
<td style="text-align:right">50.0</td>
</tr>
</tbody>
</table>
<p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># resampleçš„ä½¿ç”¨æ–¹å¼</span>
</span></span><span class="line"><span class="cl"><span class="n">df_new2</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&#34;2D&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">pv</th>
<th style="text-align:right">uv</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">pdate</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-01</td>
<td style="text-align:right">150.0</td>
<td style="text-align:right">15.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-03</td>
<td style="text-align:right">200.0</td>
<td style="text-align:right">20.0</td>
</tr>
<tr>
<td style="text-align:right">2019-12-05</td>
<td style="text-align:right">500.0</td>
<td style="text-align:right">50.0</td>
</tr>
</tbody>
</table>
<h1 id="23pandasæ€æ ·å®ç°excelçš„vlookupå¹¶ä¸”åœ¨æŒ‡å®šåˆ—åé¢è¾“å‡º">23ã€Pandasæ€æ ·å®ç°Excelçš„vlookupå¹¶ä¸”åœ¨æŒ‡å®šåˆ—åé¢è¾“å‡ºï¼Ÿ</h1>
<p>èƒŒæ™¯ï¼š</p>
<ol>
<li>æœ‰ä¸¤ä¸ªexcelï¼Œä»–ä»¬æœ‰ç›¸åŒçš„ä¸€ä¸ªåˆ—ï¼›</li>
<li>æŒ‰ç…§è¿™ä¸ªåˆ—åˆå¹¶æˆä¸€ä¸ªå¤§çš„excelï¼Œå³vlookupåŠŸèƒ½ï¼Œè¦æ±‚ï¼š
<ul>
<li>åªéœ€è¦ç¬¬äºŒä¸ªexcelçš„å°‘é‡çš„åˆ—ï¼Œæ¯”å¦‚ä»40ä¸ªåˆ—ä¸­æŒ‘é€‰2ä¸ªåˆ—</li>
<li>æ–°å¢çš„æ¥è‡ªç¬¬äºŒä¸ªexcelçš„åˆ—éœ€è¦æ”¾åˆ°ç¬¬ä¸€ä¸ªexcelæŒ‡å®šçš„åˆ—åé¢ï¼›</li>
</ul>
</li>
<li>å°†ç»“æœè¾“å‡ºåˆ°ä¸€ä¸ªæ–°çš„excel;</li>
</ol>
<h3 id="æ­¥éª¤1è¯»å–ä¸¤ä¸ªæ•°æ®è¡¨">æ­¥éª¤1ï¼šè¯»å–ä¸¤ä¸ªæ•°æ®è¡¨</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å­¦ç”Ÿæˆç»©è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="n">df_grade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&#34;./course_datas/c23_excel_vlookup/å­¦ç”Ÿæˆç»©è¡¨.xlsx&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">df_grade</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ç­çº§</th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">è¯­æ–‡æˆç»©</th>
<th style="text-align:right">æ•°å­¦æˆç»©</th>
<th style="text-align:right">è‹±è¯­æˆç»©</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">99</td>
<td style="text-align:right">84</td>
<td style="text-align:right">88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">66</td>
<td style="text-align:right">95</td>
<td style="text-align:right">77</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">68</td>
<td style="text-align:right">68</td>
<td style="text-align:right">61</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">63</td>
<td style="text-align:right">66</td>
<td style="text-align:right">82</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">72</td>
<td style="text-align:right">95</td>
<td style="text-align:right">94</td>
</tr>
</tbody>
</table>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å­¦ç”Ÿä¿¡æ¯è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="n">df_sinfo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&#34;./course_datas/c23_excel_vlookup/å­¦ç”Ÿä¿¡æ¯è¡¨.xlsx&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">df_sinfo</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
<th style="text-align:right">å¹´é¾„</th>
<th style="text-align:right">ç±è´¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">25</td>
<td style="text-align:right">æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">19</td>
<td style="text-align:right">é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">24</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
</tbody>
</table>
<p>*<strong>ç›®æ ‡ï¼šæ€æ ·å°†ç¬¬äºŒä¸ªâ€œå­¦ç”Ÿä¿¡æ¯è¡¨â€çš„å§“åã€æ€§åˆ«ä¸¤åˆ—ï¼Œæ·»åŠ åˆ°ç¬¬ä¸€ä¸ªè¡¨â€œå­¦ç”Ÿæˆç»©è¡¨â€ï¼Œå¹¶ä¸”æ”¾åœ¨ç¬¬ä¸€ä¸ªè¡¨çš„â€œå­¦å·â€åˆ—åé¢ï¼Ÿ*</strong></p>
<h3 id="æ­¥éª¤2å®ç°ä¸¤ä¸ªè¡¨çš„å…³è”">æ­¥éª¤2ï¼šå®ç°ä¸¤ä¸ªè¡¨çš„å…³è”</h3>
<p>å³excelçš„vloopupåŠŸèƒ½</p>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># åªç­›é€‰ç¬¬äºŒä¸ªè¡¨çš„å°‘é‡çš„åˆ—</span>
</span></span><span class="line"><span class="cl"><span class="n">df_sinfo</span> <span class="o">=</span> <span class="n">df_sinfo</span><span class="p">[[</span><span class="s2">&#34;å­¦å·&#34;</span><span class="p">,</span> <span class="s2">&#34;å§“å&#34;</span><span class="p">,</span> <span class="s2">&#34;æ€§åˆ«&#34;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">df_sinfo</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
</tr>
</tbody>
</table>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df_grade</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">df_sinfo</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&#34;å­¦å·&#34;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&#34;å­¦å·&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ç­çº§</th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">è¯­æ–‡æˆç»©</th>
<th style="text-align:right">æ•°å­¦æˆç»©</th>
<th style="text-align:right">è‹±è¯­æˆç»©</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">99</td>
<td style="text-align:right">84</td>
<td style="text-align:right">88</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">66</td>
<td style="text-align:right">95</td>
<td style="text-align:right">77</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">68</td>
<td style="text-align:right">68</td>
<td style="text-align:right">61</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">63</td>
<td style="text-align:right">66</td>
<td style="text-align:right">82</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">72</td>
<td style="text-align:right">95</td>
<td style="text-align:right">94</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
</tr>
</tbody>
</table>
<h3 id="æ­¥éª¤3è°ƒæ•´åˆ—çš„é¡ºåº">æ­¥éª¤3ï¼šè°ƒæ•´åˆ—çš„é¡ºåº</h3>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">columns</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;ç­çº§&#39;</span><span class="p">,</span> <span class="s1">&#39;å­¦å·&#39;</span><span class="p">,</span> <span class="s1">&#39;è¯­æ–‡æˆç»©&#39;</span><span class="p">,</span> <span class="s1">&#39;æ•°å­¦æˆç»©&#39;</span><span class="p">,</span> <span class="s1">&#39;è‹±è¯­æˆç»©&#39;</span><span class="p">,</span> <span class="s1">&#39;å§“å&#39;</span><span class="p">,</span> <span class="s1">&#39;æ€§åˆ«&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é—®é¢˜æ€æ ·å°†å§“å-æ€§åˆ«ä¸¤åˆ—æ”¾åˆ°å­¦å·çš„åé¢">é—®é¢˜ï¼šæ€æ ·å°†&rsquo;å§“å&rsquo;, &lsquo;æ€§åˆ«&rsquo;ä¸¤åˆ—ï¼Œæ”¾åˆ°&rsquo;å­¦å·&rsquo;çš„åé¢ï¼Ÿ</h4>
<p>æ¥ä¸‹æ¥éœ€è¦ç”¨Pythonçš„è¯­æ³•å®ç°åˆ—è¡¨çš„å¤„ç†</p>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å°†columnså˜æˆpythonçš„åˆ—è¡¨å½¢å¼</span>
</span></span><span class="line"><span class="cl"><span class="n">new_columns</span> <span class="o">=</span> <span class="n">df_merge</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">new_columns</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;ç­çº§&#39;</span><span class="p">,</span> <span class="s1">&#39;å­¦å·&#39;</span><span class="p">,</span> <span class="s1">&#39;è¯­æ–‡æˆç»©&#39;</span><span class="p">,</span> <span class="s1">&#39;æ•°å­¦æˆç»©&#39;</span><span class="p">,</span> <span class="s1">&#39;è‹±è¯­æˆç»©&#39;</span><span class="p">,</span> <span class="s1">&#39;å§“å&#39;</span><span class="p">,</span> <span class="s1">&#39;æ€§åˆ«&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># æŒ‰é€†åºinsertï¼Œä¼šå°†&#34;å§“å&#34;ï¼Œ&#34;æ€§åˆ«&#34;æ”¾åˆ°&#34;å­¦å·&#34;çš„åé¢
</span></span><span class="line"><span class="cl">for name in [&#34;å§“å&#34;, &#34;æ€§åˆ«&#34;][::-1]:
</span></span><span class="line"><span class="cl">    new_columns.remove(name)
</span></span><span class="line"><span class="cl">    new_columns.insert(new_columns.index(&#34;å­¦å·&#34;)+1, name)
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">new_columns</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;ç­çº§&#39;</span><span class="p">,</span> <span class="s1">&#39;å­¦å·&#39;</span><span class="p">,</span> <span class="s1">&#39;å§“å&#39;</span><span class="p">,</span> <span class="s1">&#39;æ€§åˆ«&#39;</span><span class="p">,</span> <span class="s1">&#39;è¯­æ–‡æˆç»©&#39;</span><span class="p">,</span> <span class="s1">&#39;æ•°å­¦æˆç»©&#39;</span><span class="p">,</span> <span class="s1">&#39;è‹±è¯­æˆç»©&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span> <span class="o">=</span> <span class="n">df_merge</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_columns</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ç­çº§</th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
<th style="text-align:right">è¯­æ–‡æˆç»©</th>
<th style="text-align:right">æ•°å­¦æˆç»©</th>
<th style="text-align:right">è‹±è¯­æˆç»©</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">99</td>
<td style="text-align:right">84</td>
<td style="text-align:right">88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">66</td>
<td style="text-align:right">95</td>
<td style="text-align:right">77</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">68</td>
<td style="text-align:right">68</td>
<td style="text-align:right">61</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">63</td>
<td style="text-align:right">66</td>
<td style="text-align:right">82</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">C01</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">72</td>
<td style="text-align:right">95</td>
<td style="text-align:right">94</td>
</tr>
</tbody>
</table>
<h3 id="æ­¥éª¤4è¾“å‡ºæœ€ç»ˆçš„excelæ–‡ä»¶">æ­¥éª¤4ï¼šè¾“å‡ºæœ€ç»ˆçš„Excelæ–‡ä»¶</h3>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&#34;./course_datas/c23_excel_vlookup/åˆå¹¶åçš„æ•°æ®è¡¨.xlsx&#34;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="24pandasæ€æ ·ç»“åˆpyechartsç»˜åˆ¶äº¤äº’æ€§æŠ˜çº¿å›¾">24ã€Pandasæ€æ ·ç»“åˆPyechartsç»˜åˆ¶äº¤äº’æ€§æŠ˜çº¿å›¾ï¼Ÿ</h1>
<p>èƒŒæ™¯ï¼š</p>
<ul>
<li>Pandasæ˜¯Pythonç”¨äºæ•°æ®åˆ†æé¢†åŸŸçš„è¶…çº§ç‰›çš„åº“</li>
<li>Echartsæ˜¯ç™¾åº¦å¼€æºçš„éå¸¸å¥½ç”¨å¼ºå¤§çš„å¯è§†åŒ–å›¾è¡¨åº“ï¼ŒPyechartsæ˜¯å®ƒçš„Pythonåº“ç‰ˆæœ¬</li>
</ul>
<h2 id="1è¯»å–æ•°æ®">1ã€è¯»å–æ•°æ®</h2>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">xlsx_path</span> <span class="o">=</span> <span class="s2">&#34;./datas/stocks/baidu_stocks.xlsx&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xlsx_path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&#34;datetime&#34;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">code</th>
<th style="text-align:right">open</th>
<th style="text-align:right">close</th>
<th style="text-align:right">high</th>
<th style="text-align:right">low</th>
<th style="text-align:right">vol</th>
<th style="text-align:right">p_change</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">datetime</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-12-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">115.199997</td>
<td style="text-align:right">114.800003</td>
<td style="text-align:right">116.019997</td>
<td style="text-align:right">113.300003</td>
<td style="text-align:right">3493249</td>
<td style="text-align:right">-2.25</td>
</tr>
<tr>
<td style="text-align:right">2019-12-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">118.389999</td>
<td style="text-align:right">117.440002</td>
<td style="text-align:right">119.764999</td>
<td style="text-align:right">116.400002</td>
<td style="text-align:right">2203313</td>
<td style="text-align:right">-0.92</td>
</tr>
<tr>
<td style="text-align:right">2019-11-29</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">118.300003</td>
<td style="text-align:right">118.529999</td>
<td style="text-align:right">118.690002</td>
<td style="text-align:right">117.599998</td>
<td style="text-align:right">1917004</td>
<td style="text-align:right">-0.82</td>
</tr>
<tr>
<td style="text-align:right">2019-11-27</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">119.180000</td>
<td style="text-align:right">119.510002</td>
<td style="text-align:right">119.839996</td>
<td style="text-align:right">118.440002</td>
<td style="text-align:right">2341070</td>
<td style="text-align:right">0.77</td>
</tr>
<tr>
<td style="text-align:right">2019-11-26</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">120.010002</td>
<td style="text-align:right">118.599998</td>
<td style="text-align:right">120.440002</td>
<td style="text-align:right">118.099998</td>
<td style="text-align:right">3813176</td>
<td style="text-align:right">-1.43</td>
</tr>
</tbody>
</table>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2019-12-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-11-29&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-11-27&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2019-11-26&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-11-25&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-11-22&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-11-21&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2019-11-20&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-11-19&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="o">...</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2019-01-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-01-14&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-01-11&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-01-10&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2019-01-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-01-08&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-01-07&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-01-04&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;2019-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-01-02&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">227</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">df.sort_index(inplace=True)
</span></span><span class="line"><span class="cl">df.head()
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">code</th>
<th style="text-align:right">open</th>
<th style="text-align:right">close</th>
<th style="text-align:right">high</th>
<th style="text-align:right">low</th>
<th style="text-align:right">vol</th>
<th style="text-align:right">p_change</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">datetime</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-01-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">156.179993</td>
<td style="text-align:right">162.250000</td>
<td style="text-align:right">164.330002</td>
<td style="text-align:right">155.490005</td>
<td style="text-align:right">2996952</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2019-01-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">158.750000</td>
<td style="text-align:right">154.710007</td>
<td style="text-align:right">159.880005</td>
<td style="text-align:right">153.779999</td>
<td style="text-align:right">3879180</td>
<td style="text-align:right">-4.65</td>
</tr>
<tr>
<td style="text-align:right">2019-01-04</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">157.600006</td>
<td style="text-align:right">160.949997</td>
<td style="text-align:right">162.429993</td>
<td style="text-align:right">157.250000</td>
<td style="text-align:right">3847497</td>
<td style="text-align:right">4.03</td>
</tr>
<tr>
<td style="text-align:right">2019-01-07</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">162.600006</td>
<td style="text-align:right">162.600006</td>
<td style="text-align:right">164.490005</td>
<td style="text-align:right">158.509995</td>
<td style="text-align:right">3266091</td>
<td style="text-align:right">1.03</td>
</tr>
<tr>
<td style="text-align:right">2019-01-08</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">162.190002</td>
<td style="text-align:right">163.399994</td>
<td style="text-align:right">163.889999</td>
<td style="text-align:right">158.160004</td>
<td style="text-align:right">3253361</td>
<td style="text-align:right">0.49</td>
</tr>
</tbody>
</table>
<h2 id="2ä½¿ç”¨pyechartsç»˜åˆ¶æŠ˜çº¿å›¾">2ã€ä½¿ç”¨Pyechartsç»˜åˆ¶æŠ˜çº¿å›¾</h2>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œä½¿ç”¨pip install pyechartså®‰è£…</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyecharts.charts</span> <span class="kn">import</span> <span class="n">Line</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyecharts</span> <span class="kn">import</span> <span class="n">options</span> <span class="k">as</span> <span class="n">opts</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æŠ˜çº¿å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">line</span> <span class="o">=</span> <span class="n">Line</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># xè½´</span>
</span></span><span class="line"><span class="cl"><span class="n">line</span><span class="o">.</span><span class="n">add_xaxis</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¯ä¸ªyè½´</span>
</span></span><span class="line"><span class="cl"><span class="n">line</span><span class="o">.</span><span class="n">add_yaxis</span><span class="p">(</span><span class="s2">&#34;å¼€ç›˜ä»·&#34;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;open&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">line</span><span class="o">.</span><span class="n">add_yaxis</span><span class="p">(</span><span class="s2">&#34;æ”¶ç›˜ä»·&#34;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;close&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å›¾è¡¨é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="n">line</span><span class="o">.</span><span class="n">set_global_opts</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">title_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TitleOpts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;ç™¾åº¦è‚¡ç¥¨2019å¹´&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">tooltip_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TooltipOpts</span><span class="p">(</span><span class="n">trigger</span><span class="o">=</span><span class="s2">&#34;axis&#34;</span><span class="p">,</span> <span class="n">axis_pointer_type</span><span class="o">=</span><span class="s2">&#34;cross&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">pyecharts</span><span class="o">.</span><span class="n">charts</span><span class="o">.</span><span class="n">basic_charts</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">Line</span> <span class="n">at</span> <span class="mh">0x201bd51d088</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ¸²æŸ“æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">line</span><span class="o">.</span><span class="n">render_notebook</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="25pandasç»“åˆsklearnå®ç°æ³°å¦å°¼å…‹å­˜æ´»ç‡é¢„æµ‹">25ã€Pandasç»“åˆSklearnå®ç°æ³°å¦å°¼å…‹å­˜æ´»ç‡é¢„æµ‹</h1>
<h3 id="å®ä¾‹ç›®æ ‡å®ç°æ³°å¦å°¼å…‹å­˜æ´»é¢„æµ‹">å®ä¾‹ç›®æ ‡ï¼šå®ç°æ³°å¦å°¼å…‹å­˜æ´»é¢„æµ‹</h3>
<p>å¤„ç†æ­¥éª¤ï¼š
1ã€è¾“å…¥æ•°æ®ï¼šä½¿ç”¨Pandasè¯»å–è®­ç»ƒæ•°æ®(å†å²æ•°æ®ï¼Œç‰¹ç‚¹æ˜¯å·²ç»çŸ¥é“äº†è¿™ä¸ªäººæœ€åæœ‰æ²¡æœ‰æ´»ä¸‹æ¥)
2ã€è®­ç»ƒæ¨¡å‹ï¼šä½¿ç”¨Sklearnè®­ç»ƒæ¨¡å‹
3ã€ä½¿ç”¨æ¨¡å‹ï¼šå¯¹äºä¸€ä¸ªæ–°çš„ä¸çŸ¥é“å­˜æ´»çš„äººï¼Œé¢„ä¼°ä»–å­˜æ´»çš„æ¦‚ç‡</p>
<h3 id="æ­¥éª¤1è¯»å–è®­ç»ƒæ•°æ®">æ­¥éª¤1ï¼šè¯»å–è®­ç»ƒæ•°æ®</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;./datas/titanic/titanic_train.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cumings, Mrs. John Bradley (Florence Briggs Th&hellip;</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17599</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C85</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Heikkinen, Miss. Laina</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">STON/O2. 3101282</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113803</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">C123</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<p>*<strong>å…¶ä¸­ï¼ŒSurvived==1ä»£è¡¨è¿™ä¸ªäººæ´»ä¸‹æ¥äº†ã€==0ä»£è¡¨æ²¡æ´»ä¸‹æ¥ï¼›å…¶ä»–çš„éƒ½æ˜¯è¿™ä¸ªäººçš„ä¿¡æ¯å’Œå½“æ—¶çš„ä»“ä½ã€ç¥¨åŠ¡æƒ…å†µ*</strong></p>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æˆ‘ä»¬åªæŒ‘é€‰ä¸¤åˆ—ï¼Œä½œä¸ºé¢„æµ‹éœ€è¦çš„ç‰¹å¾</span>
</span></span><span class="line"><span class="cl"><span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="s1">&#39;Parch&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">X</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">feature_cols</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Parch</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
</tr>
</tbody>
</table>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å•ç‹¬æå–æ˜¯å¦å­˜æ´»çš„åˆ—ï¼Œä½œä¸ºé¢„æµ‹çš„ç›®æ ‡</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">Survived</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>    <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>    <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>    <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">Survived</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ­¥éª¤2è®­ç»ƒæ¨¡å‹">æ­¥éª¤2ï¼šè®­ç»ƒæ¨¡å‹</h3>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºæ¨¡å‹å¯¹è±¡</span>
</span></span><span class="line"><span class="cl"><span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®ç°æ¨¡å‹è®­ç»ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">logreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">linear_model</span><span class="o">/</span><span class="n">logistic</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">432</span><span class="p">:</span> <span class="ne">FutureWarning</span><span class="p">:</span> <span class="n">Default</span> <span class="n">solver</span> <span class="n">will</span> <span class="n">be</span> <span class="n">changed</span> <span class="n">to</span> <span class="s1">&#39;lbfgs&#39;</span> <span class="ow">in</span> <span class="mf">0.22</span><span class="o">.</span> <span class="n">Specify</span> <span class="n">a</span> <span class="n">solver</span> <span class="n">to</span> <span class="n">silence</span> <span class="n">this</span> <span class="n">warning</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="ne">FutureWarning</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">intercept_scaling</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">l1_ratio</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">multi_class</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">logreg</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mf">0.6879910213243546</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ­¥éª¤3å¯¹äºæœªçŸ¥æ•°æ®ä½¿ç”¨æ¨¡å‹">æ­¥éª¤3ï¼šå¯¹äºæœªçŸ¥æ•°æ®ä½¿ç”¨æ¨¡å‹</h3>
<p>æœºå™¨å­¦ä¹ çš„æ ¸å¿ƒç›®æ ‡ï¼Œæ˜¯ä½¿ç”¨æ¨¡å‹é¢„æµ‹æœªçŸ¥çš„äº‹ç‰©</p>
<p>æ¯”å¦‚é¢„æµ‹è‚¡ç¥¨æ˜å¤©æ˜¯æ¶¨è¿˜æ˜¯è·Œã€ä¸€å¥—æ–°çš„äºŒæ‰‹æˆ¿æˆäº¤ä»·å¤§æ¦‚å¤šå°‘é’±ã€ç”¨æˆ·æ‰“å¼€APPæœ€å¯èƒ½çœ‹é‚£äº›è§†é¢‘ç­‰é—®é¢˜</p>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ‰¾ä¸€ä¸ªå†å²æ•°æ®ä¸­ä¸å­˜åœ¨çš„æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">X</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;Pclass&#34;</span><span class="p">,</span> <span class="s2">&#34;Parch&#34;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Parch</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">54</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">27</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">438</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">98</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">43</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">437</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">86</td>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">167</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">13</td>
<td style="text-align:right">3</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">678</td>
<td style="text-align:right">3</td>
<td style="text-align:right">6</td>
</tr>
</tbody>
</table>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># é¢„æµ‹è¿™ä¸ªæ•°æ®å­˜æ´»çš„æ¦‚ç‡</span>
</span></span><span class="line"><span class="cl"><span class="n">logreg</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">logreg</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">array</span><span class="p">([[</span><span class="mf">0.35053893</span><span class="p">,</span> <span class="mf">0.64946107</span><span class="p">]])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="26pandaså¤„ç†åˆ†æç½‘ç«™åŸå§‹è®¿é—®æ—¥å¿—">26ã€Pandaså¤„ç†åˆ†æç½‘ç«™åŸå§‹è®¿é—®æ—¥å¿—</h1>
<p>ç›®æ ‡ï¼šçœŸå®é¡¹ç›®çš„å®æˆ˜ï¼Œæ¢ç´¢Pandasçš„æ•°æ®å¤„ç†ä¸åˆ†æ</p>
<p>å®ä¾‹ï¼š
æ•°æ®æ¥æºï¼šæŸå¤§ä½¬çš„wordpressåšå®¢http://www.crazyant.net/ çš„è®¿é—®æ—¥å¿—</p>
<p>å®ç°æ­¥éª¤ï¼š
1ã€è¯»å–æ•°æ®ã€æ¸…ç†ã€æ ¼å¼åŒ–
2ã€ç»Ÿè®¡çˆ¬è™«spiderçš„è®¿é—®æ¯”ä¾‹ï¼Œè¾“å‡ºæŸ±çŠ¶å›¾
3ã€ç»Ÿè®¡httpçŠ¶æ€ç çš„è®¿é—®å æ¯”ï¼Œè¾“å‡ºé¥¼å›¾
4ã€ç»Ÿè®¡æŒ‰å°æ—¶ã€æŒ‰å¤©çš„PV/UVæµé‡è¶‹åŠ¿ï¼Œè¾“å‡ºæŠ˜çº¿å›¾</p>
<h3 id="1è¯»å–æ•°æ®å¹¶æ¸…ç†æ ¼å¼åŒ–">1ã€è¯»å–æ•°æ®å¹¶æ¸…ç†æ ¼å¼åŒ–</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyecharts</span> <span class="kn">import</span> <span class="n">options</span> <span class="k">as</span> <span class="n">opts</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyecharts.charts</span> <span class="kn">import</span> <span class="n">Bar</span><span class="p">,</span><span class="n">Pie</span><span class="p">,</span><span class="n">Line</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># è¯»å–æ•´ä¸ªç›®å½•ï¼Œå°†æ‰€æœ‰çš„æ–‡ä»¶åˆå¹¶åˆ°ä¸€ä¸ªdataframe</span>
</span></span><span class="line"><span class="cl"><span class="n">data_dir</span> <span class="o">=</span> <span class="s2">&#34;./datas/crazyant/blog_access_log&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="sa">b</span><span class="s1">&#39;Skipping line 2245: expected 10 fields, saw 16</span><span class="se">\n</span><span class="s1">Skipping line 2889: expected 10 fields, saw 14</span><span class="se">\n</span><span class="s1">Skipping line 2890: expected 10 fields, saw 14</span><span class="se">\n</span><span class="s1">Skipping line 2891: expected 10 fields, saw 13</span><span class="se">\n</span><span class="s1">Skipping line 2892: expected 10 fields, saw 13</span><span class="se">\n</span><span class="s1">Skipping line 2900: expected 10 fields, saw 11</span><span class="se">\n</span><span class="s1">Skipping line 2902: expected 10 fields, saw 11</span><span class="se">\n</span><span class="s1">Skipping line 3790: expected 10 fields, saw 14</span><span class="se">\n</span><span class="s1">Skipping line 3791: expected 10 fields, saw 14</span><span class="se">\n</span><span class="s1">Skipping line 3792: expected 10 fields, saw 13</span><span class="se">\n</span><span class="s1">Skipping line 3793: expected 10 fields, saw 13</span><span class="se">\n</span><span class="s1">Skipping line 3833: expected 10 fields, saw 11</span><span class="se">\n</span><span class="s1">Skipping line 3835: expected 10 fields, saw 11</span><span class="se">\n</span><span class="s1">Skipping line 9936: expected 10 fields, saw 16</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="sa">b</span><span class="s1">&#39;Skipping line 11748: expected 10 fields, saw 11</span><span class="se">\n</span><span class="s1">Skipping line 11750: expected 10 fields, saw 11</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
<th style="text-align:right">2</th>
<th style="text-align:right">3</th>
<th style="text-align:right">4</th>
<th style="text-align:right">5</th>
<th style="text-align:right">6</th>
<th style="text-align:right">7</th>
<th style="text-align:right">8</th>
<th style="text-align:right">9</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">106.11.153.226</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">[02/Dec/2019:22:40:18</td>
<td style="text-align:right">+0800]</td>
<td style="text-align:right">GET /740.html?replytocom=1194 HTTP/1.0</td>
<td style="text-align:right">200</td>
<td style="text-align:right">13446</td>
<td style="text-align:right">-</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">42.156.254.60</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">[02/Dec/2019:22:40:23</td>
<td style="text-align:right">+0800]</td>
<td style="text-align:right">POST /wp-json/wordpress-popular-posts/v1/popular-posts HTTP/1.0</td>
<td style="text-align:right">201</td>
<td style="text-align:right">55</td>
<td style="text-align:right"><a href="http://www.crazyant.net/740.html?replytocom=1194">http://www.crazyant.net/740.html?replytocom=1194</a></td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">106.11.159.254</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">[02/Dec/2019:22:40:27</td>
<td style="text-align:right">+0800]</td>
<td style="text-align:right">GET /576.html HTTP/1.0</td>
<td style="text-align:right">200</td>
<td style="text-align:right">13461</td>
<td style="text-align:right">-</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">106.11.157.254</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">[02/Dec/2019:22:40:28</td>
<td style="text-align:right">+0800]</td>
<td style="text-align:right">GET /?lwfcdw=t9n2d3&amp;oqzohc=m5e7j1&amp;oubyvq=iab6a3&amp;oudmbg=6osqd3 HTTP/1.0</td>
<td style="text-align:right">200</td>
<td style="text-align:right">10485</td>
<td style="text-align:right">-</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">42.156.137.109</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">[02/Dec/2019:22:40:30</td>
<td style="text-align:right">+0800]</td>
<td style="text-align:right">POST /wp-json/wordpress-popular-posts/v1/popular-posts HTTP/1.0</td>
<td style="text-align:right">201</td>
<td style="text-align:right">55</td>
<td style="text-align:right"><a href="http://www.crazyant.net/576.html">http://www.crazyant.net/576.html</a></td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
</tbody>
</table>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">0</th>
<th style="text-align:right">3</th>
<th style="text-align:right">6</th>
<th style="text-align:right">9</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">106.11.153.226</td>
<td style="text-align:right">[02/Dec/2019:22:40:18</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">42.156.254.60</td>
<td style="text-align:right">[02/Dec/2019:22:40:23</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">106.11.159.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:27</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">106.11.157.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:28</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">42.156.137.109</td>
<td style="text-align:right">[02/Dec/2019:22:40:30</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
</tbody>
</table>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;ip&#34;</span><span class="p">,</span> <span class="s2">&#34;stime&#34;</span><span class="p">,</span> <span class="s2">&#34;status&#34;</span><span class="p">,</span> <span class="s2">&#34;client&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ip</th>
<th style="text-align:right">stime</th>
<th style="text-align:right">status</th>
<th style="text-align:right">client</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">106.11.153.226</td>
<td style="text-align:right">[02/Dec/2019:22:40:18</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">42.156.254.60</td>
<td style="text-align:right">[02/Dec/2019:22:40:23</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">106.11.159.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:27</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">106.11.157.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:28</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">42.156.137.109</td>
<td style="text-align:right">[02/Dec/2019:22:40:30</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
</tr>
</tbody>
</table>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ip</span>        <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">stime</span>     <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">status</span>    <span class="n">int64</span> 
</span></span><span class="line"><span class="cl"><span class="n">client</span>    <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2ç»Ÿè®¡spiderçš„æ¯”ä¾‹">2ã€ç»Ÿè®¡spiderçš„æ¯”ä¾‹</h3>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;is_spider&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;client&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&#34;spider&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ip</th>
<th style="text-align:right">stime</th>
<th style="text-align:right">status</th>
<th style="text-align:right">client</th>
<th style="text-align:right">is_spider</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">106.11.153.226</td>
<td style="text-align:right">[02/Dec/2019:22:40:18</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
<td style="text-align:right">True</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">42.156.254.60</td>
<td style="text-align:right">[02/Dec/2019:22:40:23</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
<td style="text-align:right">True</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">106.11.159.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:27</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
<td style="text-align:right">True</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">106.11.157.254</td>
<td style="text-align:right">[02/Dec/2019:22:40:28</td>
<td style="text-align:right">200</td>
<td style="text-align:right">YisouSpider</td>
<td style="text-align:right">True</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">42.156.137.109</td>
<td style="text-align:right">[02/Dec/2019:22:40:30</td>
<td style="text-align:right">201</td>
<td style="text-align:right">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 YisouSpider/5.0 Safari/537.36</td>
<td style="text-align:right">True</td>
</tr>
</tbody>
</table>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_spider</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;is_spider&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">df_spider</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kc">False</span>    <span class="mi">46641</span>
</span></span><span class="line"><span class="cl"><span class="kc">True</span>     <span class="mi">3637</span> 
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">is_spider</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">bar</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">Bar</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">add_xaxis</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df_spider</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">add_yaxis</span><span class="p">(</span><span class="s2">&#34;æ˜¯å¦Spider&#34;</span><span class="p">,</span> <span class="n">df_spider</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">set_global_opts</span><span class="p">(</span><span class="n">title_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TitleOpts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;çˆ¬è™«è®¿é—®é‡å æ¯”&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bar</span><span class="o">.</span><span class="n">render_notebook</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="27pandasæ€æ ·æ‰¾å‡ºæœ€å½±å“ç»“æœçš„é‚£äº›ç‰¹å¾">27ã€Pandasæ€æ ·æ‰¾å‡ºæœ€å½±å“ç»“æœçš„é‚£äº›ç‰¹å¾ï¼Ÿ</h1>
<p>åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>æœºå™¨å­¦ä¹ çš„ç‰¹å¾é€‰æ‹©ï¼Œå»é™¤æ— ç”¨çš„ç‰¹å¾ï¼Œå¯ä»¥æå‡æ¨¡å‹æ•ˆæœã€é™ä½è®­ç»ƒæ—¶é—´ç­‰ç­‰</li>
<li>æ•°æ®åˆ†æé¢†åŸŸï¼Œæ‰¾å‡ºæ”¶å…¥æ³¢åŠ¨çš„æœ€å¤§å› ç´ ï¼ï¼</li>
</ul>
<h2 id="å®ä¾‹æ¼”ç¤ºæ³°å¦å°¼å…‹æ²‰èˆ¹äº‹ä»¶ä¸­æœ€å½±å“ç”Ÿæ­»çš„å› ç´ æœ‰å“ªäº›">å®ä¾‹æ¼”ç¤ºï¼šæ³°å¦å°¼å…‹æ²‰èˆ¹äº‹ä»¶ä¸­ï¼Œæœ€å½±å“ç”Ÿæ­»çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ</h2>
<h3 id="1å¯¼å…¥ç›¸å…³çš„åŒ…">1ã€å¯¼å…¥ç›¸å…³çš„åŒ…</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç‰¹å¾æœ€å½±å“ç»“æœçš„Kä¸ªç‰¹å¾</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¡æ–¹æ£€éªŒï¼Œä½œä¸ºSelectKBestçš„å‚æ•°</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">chi2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2å¯¼å…¥æ³°å¦å°¼å…‹å·çš„æ•°æ®">2ã€å¯¼å…¥æ³°å¦å°¼å…‹å·çš„æ•°æ®</h3>
<p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;./datas/titanic/titanic_train.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Name</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Ticket</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Cabin</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Braund, Mr. Owen Harris</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A/5 21171</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Cumings, Mrs. John Bradley (Florence Briggs Th&hellip;</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">PC 17599</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C85</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Heikkinen, Miss. Laina</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">STON/O2. 3101282</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">113803</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">C123</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Allen, Mr. William Henry</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">373450</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&#34;PassengerId&#34;</span><span class="p">,</span> <span class="s2">&#34;Survived&#34;</span><span class="p">,</span> <span class="s2">&#34;Pclass&#34;</span><span class="p">,</span> <span class="s2">&#34;Sex&#34;</span><span class="p">,</span> <span class="s2">&#34;Age&#34;</span><span class="p">,</span> <span class="s2">&#34;SibSp&#34;</span><span class="p">,</span> <span class="s2">&#34;Parch&#34;</span><span class="p">,</span> <span class="s2">&#34;Fare&#34;</span><span class="p">,</span> <span class="s2">&#34;Embarked&#34;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<h3 id="3æ•°æ®æ¸…ç†å’Œè½¬æ¢">3ã€æ•°æ®æ¸…ç†å’Œè½¬æ¢</h3>
<h4 id="31-æŸ¥çœ‹æ˜¯å¦æœ‰ç©ºå€¼åˆ—">3.1 æŸ¥çœ‹æ˜¯å¦æœ‰ç©ºå€¼åˆ—</h4>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">891</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">890</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">9</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">PassengerId</span>    <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Survived</span>       <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Pclass</span>         <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Sex</span>            <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">Age</span>            <span class="mi">714</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="n">SibSp</span>          <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Parch</span>          <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">Fare</span>           <span class="mi">891</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="n">Embarked</span>       <span class="mi">889</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span> <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">object</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">62.8</span><span class="o">+</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="32-ç»™ageåˆ—å¡«å……å¹³å‡å€¼">3.2 ç»™Ageåˆ—å¡«å……å¹³å‡å€¼</h4>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Age&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<h4 id="32-å°†æ€§åˆ«åˆ—å˜æˆæ•°å­—">3.2 å°†æ€§åˆ«åˆ—å˜æˆæ•°å­—</h4>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ€§åˆ«</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">Sex</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">array</span><span class="p">([</span><span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Sex&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;male&#34;</span><span class="p">,</span> <span class="s2">&#34;Sex&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Sex&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;female&#34;</span><span class="p">,</span> <span class="s2">&#34;Sex&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">S</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">S</td>
</tr>
</tbody>
</table>
<h4 id="33-ç»™embarkedåˆ—å¡«å……ç©ºå€¼å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—">3.3 ç»™Embarkedåˆ—å¡«å……ç©ºå€¼ï¼Œå­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—</h4>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Embarked</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">Embarked</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">array</span><span class="p">([</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å¡«å……ç©ºå€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Embarked&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;Embarked&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å­—ç¬¦ä¸²å˜æˆæ•°å­—</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Embarked&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;S&#34;</span><span class="p">,</span> <span class="s2">&#34;Embarked&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Embarked&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="s2">&#34;Embarked&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;Embarked&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;Q&#34;</span><span class="p">,</span> <span class="s2">&#34;Embarked&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Survived</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h3 id="4å°†ç‰¹å¾åˆ—å’Œç»“æœåˆ—æ‹†åˆ†å¼€">4ã€å°†ç‰¹å¾åˆ—å’Œç»“æœåˆ—æ‹†åˆ†å¼€</h3>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&#34;Survived&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">X</span> <span class="o">=</span> <span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">PassengerId</th>
<th style="text-align:right">Pclass</th>
<th style="text-align:right">Sex</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">SibSp</th>
<th style="text-align:right">Parch</th>
<th style="text-align:right">Fare</th>
<th style="text-align:right">Embarked</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>    <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>    <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>    <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">Survived</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="5ä½¿ç”¨å¡æ–¹æ£€éªŒé€‰æ‹©topkçš„ç‰¹å¾">5ã€ä½¿ç”¨å¡æ–¹æ£€éªŒé€‰æ‹©topKçš„ç‰¹å¾</h3>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># é€‰æ‹©æ‰€æœ‰çš„ç‰¹å¾ï¼Œç›®çš„æ˜¯çœ‹åˆ°ç‰¹å¾é‡è¦æ€§æ’åº</span>
</span></span><span class="line"><span class="cl"><span class="n">bestfeatures</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span><span class="o">=</span><span class="n">chi2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">fit</span> <span class="o">=</span> <span class="n">bestfeatures</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="6æŒ‰ç…§é‡è¦æ€§é¡ºåºæ‰“å°ç‰¹å¾åˆ—è¡¨">6ã€æŒ‰ç…§é‡è¦æ€§é¡ºåºæ‰“å°ç‰¹å¾åˆ—è¡¨</h3>
<p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">scores_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_scores</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">0</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">3.312934</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">30.873699</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">170.348127</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">21.649163</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.581865</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">10.097499</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">4518.319091</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">2.771019</td>
</tr>
</tbody>
</table>
<p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_columns</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[18]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">0</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">PassengerId</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Pclass</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Sex</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Age</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">SibSp</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">Parch</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">Fare</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">Embarked</td>
</tr>
</tbody>
</table>
<p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># åˆå¹¶ä¸¤ä¸ªdf</span>
</span></span><span class="line"><span class="cl"><span class="n">df_feature_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_columns</span><span class="p">,</span><span class="n">df_scores</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ—å</span>
</span></span><span class="line"><span class="cl"><span class="n">df_feature_scores</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;feature_name&#39;</span><span class="p">,</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span>  <span class="c1">#naming the dataframe columns</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹</span>
</span></span><span class="line"><span class="cl"><span class="n">df_feature_scores</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">feature_name</th>
<th style="text-align:right">Score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">PassengerId</td>
<td style="text-align:right">3.312934</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Pclass</td>
<td style="text-align:right">30.873699</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Sex</td>
<td style="text-align:right">170.348127</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Age</td>
<td style="text-align:right">21.649163</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">SibSp</td>
<td style="text-align:right">2.581865</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">Parch</td>
<td style="text-align:right">10.097499</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">Fare</td>
<td style="text-align:right">4518.319091</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">Embarked</td>
<td style="text-align:right">2.771019</td>
</tr>
</tbody>
</table>
<p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_feature_scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&#34;Score&#34;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[20]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">feature_name</th>
<th style="text-align:right">Score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">Fare</td>
<td style="text-align:right">4518.319091</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Sex</td>
<td style="text-align:right">170.348127</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Pclass</td>
<td style="text-align:right">30.873699</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Age</td>
<td style="text-align:right">21.649163</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">Parch</td>
<td style="text-align:right">10.097499</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">PassengerId</td>
<td style="text-align:right">3.312934</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">Embarked</td>
<td style="text-align:right">2.771019</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">SibSp</td>
<td style="text-align:right">2.581865</td>
</tr>
</tbody>
</table>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">æ–‡ç« ä½œè€…</span>
    <span class="item-content">yuanshuai</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">ä¸Šæ¬¡æ›´æ–°</span>
    <span class="item-content">
        0001-01-01
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/yuanshuai1122.github.io/tags/python/">Python</a>
          <a href="/yuanshuai1122.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">æ•°æ®åˆ†æ</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäºŒï¼‰</span>
            <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
          </a>
        <a class="next" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E5%9B%9B-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E5%9B%9B/">
            <span class="next-text nav-default">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆå››ï¼‰</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="http://localhost:1313" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="http://localhost:1313" class="iconfont icon-twitter" title="twitter"></a>
      <a href="http://localhost:1313" class="iconfont icon-facebook" title="facebook"></a>
      <a href="http://localhost:1313" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="http://localhost:1313" class="iconfont icon-google" title="google"></a>
      <a href="http://localhost:1313" class="iconfont icon-github" title="github"></a>
      <a href="http://localhost:1313" class="iconfont icon-weibo" title="weibo"></a>
      <a href="http://localhost:1313" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="http://localhost:1313" class="iconfont icon-douban" title="douban"></a>
      <a href="http://localhost:1313" class="iconfont icon-pocket" title="pocket"></a>
      <a href="http://localhost:1313" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="http://localhost:1313" class="iconfont icon-instagram" title="instagram"></a>
      <a href="http://localhost:1313" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="http://localhost:1313" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="yuanshuai1122.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://gohugo.io">Hugo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>yuanshuai</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js" integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js" integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin="anonymous"></script>
  <script>
    var languageCode = "zh-cn".replace(/-/g, '_').replace(/_(.*)/, function ($0, $1) {return $0.replace($1, $1.toUpperCase());});
    timeago().render(document.querySelectorAll('.timeago'), languageCode);
    timeago.cancel();  
  </script>



<script type="text/javascript" src="/yuanshuai1122.github.io/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
