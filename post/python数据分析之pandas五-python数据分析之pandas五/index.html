<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäº”ï¼‰ - ğŸ§€ - ä½ å¥½</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="yuanshuai" /><meta name="description" content=": | &amp;mdash;: | &amp;mdash;: | &amp;mdash;: | &amp;mdash;: | &amp;mdash;: | | 0 | S001 | æ€ æ¶µ | å¥³ | 23 | å±±ä¸œ | | 1 | S002 | å©‰æ¸… | å¥³ | 25 | æ²³å— | | 2 | S003 | æºªæ¦• | å¥³ | 23 | æ¹–åŒ— | | 3 | S004 | æ¼ æ¶“ | å¥³ | 19 | é™•" /><meta name="keywords" content="blog, yuanshuai, yyss" />






<meta name="generator" content="Hugo 0.119.0 with theme even" />


<link rel="canonical" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%94-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%94/" />
<link rel="apple-touch-icon" sizes="180x180" href="/yuanshuai1122.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/yuanshuai1122.github.io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/yuanshuai1122.github.io/favicon-16x16.png">
<link rel="manifest" href="/yuanshuai1122.github.io/manifest.json">
<link rel="mask-icon" href="/yuanshuai1122.github.io/safari-pinned-tab.svg" color="#5bbad5">



<link href="/yuanshuai1122.github.io/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäº”ï¼‰" />
<meta property="og:description" content=": | &mdash;: | &mdash;: | &mdash;: | &mdash;: | &mdash;: | | 0 | S001 | æ€ æ¶µ | å¥³ | 23 | å±±ä¸œ | | 1 | S002 | å©‰æ¸… | å¥³ | 25 | æ²³å— | | 2 | S003 | æºªæ¦• | å¥³ | 23 | æ¹–åŒ— | | 3 | S004 | æ¼ æ¶“ | å¥³ | 19 | é™•" />
<meta property="og:type" content="article" />
<meta property="og:url" content="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%94-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%94/" /><meta property="article:section" content="post" />


<meta itemprop="name" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäº”ï¼‰">
<meta itemprop="description" content=": | &mdash;: | &mdash;: | &mdash;: | &mdash;: | &mdash;: | | 0 | S001 | æ€ æ¶µ | å¥³ | 23 | å±±ä¸œ | | 1 | S002 | å©‰æ¸… | å¥³ | 25 | æ²³å— | | 2 | S003 | æºªæ¦• | å¥³ | 23 | æ¹–åŒ— | | 3 | S004 | æ¼ æ¶“ | å¥³ | 19 | é™•">

<meta itemprop="wordCount" content="14063">
<meta itemprop="keywords" content="Python,æ•°æ®åˆ†æ," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäº”ï¼‰"/>
<meta name="twitter:description" content=": | &mdash;: | &mdash;: | &mdash;: | &mdash;: | &mdash;: | | 0 | S001 | æ€ æ¶µ | å¥³ | 23 | å±±ä¸œ | | 1 | S002 | å©‰æ¸… | å¥³ | 25 | æ²³å— | | 2 | S003 | æºªæ¦• | å¥³ | 23 | æ¹–åŒ— | | 3 | S004 | æ¼ æ¶“ | å¥³ | 19 | é™•"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">CNshuaiyuan</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="yuanshuai1122.github.io/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="yuanshuai1122.github.io/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="yuanshuai1122.github.io/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="yuanshuai1122.github.io/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">CNshuaiyuan</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäº”ï¼‰</h1>

      <div class="post-meta">
        <span class="post-time"> 0001-01-01 </span>
        
          <span class="more-meta"> çº¦ 14063 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 29 åˆ†é’Ÿ </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#åˆ›å»ºsqlalchemyå¯¹è±¡è¿æ¥mysql">åˆ›å»ºsqlalchemyå¯¹è±¡è¿æ¥MySQL</a></li>
            <li><a href="#æ–¹æ³•1å½“æ•°æ®è¡¨ä¸å­˜åœ¨æ—¶æ¯æ¬¡è¦†ç›–æ•´ä¸ªè¡¨">æ–¹æ³•1ï¼šå½“æ•°æ®è¡¨ä¸å­˜åœ¨æ—¶ï¼Œæ¯æ¬¡è¦†ç›–æ•´ä¸ªè¡¨</a></li>
            <li><a href="#æ–¹æ³•2å½“æ•°æ®è¡¨å­˜åœ¨æ—¶æ¯æ¬¡æ–°å¢æ•°æ®">æ–¹æ³•2ï¼šå½“æ•°æ®è¡¨å­˜åœ¨æ—¶ï¼Œæ¯æ¬¡æ–°å¢æ•°æ®</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#38pythonæ‰¹é‡ç¿»è¯‘è‹±è¯­å•è¯">38ã€Pythonæ‰¹é‡ç¿»è¯‘è‹±è¯­å•è¯</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1-è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶">1. è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶</a></li>
            <li><a href="#2-ä¸‹è½½ç½‘é¡µå¾—åˆ°ç½‘é¡µå†…å®¹">2. ä¸‹è½½ç½‘é¡µï¼Œå¾—åˆ°ç½‘é¡µå†…å®¹</a></li>
            <li><a href="#3-æå–htmlçš„æ­£æ–‡å†…å®¹">3. æå–HTMLçš„æ­£æ–‡å†…å®¹</a></li>
            <li><a href="#4-è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—">4. è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—</a></li>
            <li><a href="#5-åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªdataframe">5. åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªDataFrame</a></li>
            <li><a href="#6-å’Œå•è¯è¯å…¸å®ç°merge">6. å’Œå•è¯è¯å…¸å®ç°merge</a></li>
            <li><a href="#7-å­˜å…¥excel">7. å­˜å…¥Excel</a></li>
            <li><a href="#åç»­å‡çº§">åç»­å‡çº§ï¼š</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#39pythonè‡ªåŠ¨ç¿»è¯‘è‹±è¯­è®ºæ–‡pdf">39ã€Pythonè‡ªåŠ¨ç¿»è¯‘è‹±è¯­è®ºæ–‡PDF</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1-è¯»å–pdfæ–‡æœ¬å†…å®¹">1. è¯»å–PDFæ–‡æœ¬å†…å®¹</a></li>
            <li><a href="#2-è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶">2. è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶</a></li>
            <li><a href="#3-è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—">3. è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—</a></li>
            <li><a href="#4-åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªdataframe">4. åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªDataFrame</a></li>
            <li><a href="#5-å’Œå•è¯è¯å…¸å®ç°merge">5. å’Œå•è¯è¯å…¸å®ç°merge</a></li>
            <li><a href="#6-å­˜å…¥excel">6. å­˜å…¥Excel</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#40pandasæ€æ ·å®ç°groupbyèšåˆåå­—ç¬¦ä¸²åˆ—çš„åˆå¹¶">40ã€Pandasæ€æ ·å®ç°groupbyèšåˆåå­—ç¬¦ä¸²åˆ—çš„åˆå¹¶</a>
      <ul>
        <li>
          <ul>
            <li></li>
            <li><a href="#è¯»å–æ•°æ®">è¯»å–æ•°æ®</a></li>
            <li><a href="#æ–¹æ³•1">æ–¹æ³•1</a></li>
            <li><a href="#æ–¹æ³•2">æ–¹æ³•2</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#41pandasè¯»å–excelç»˜åˆ¶ç›´æ–¹å›¾">41ã€Pandasè¯»å–Excelç»˜åˆ¶ç›´æ–¹å›¾</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1-è¯»å–æ•°æ®">1. è¯»å–æ•°æ®</a></li>
            <li><a href="#2-ä½¿ç”¨matplotlibç”»ç›´æ–¹å›¾">2. ä½¿ç”¨matplotlibç”»ç›´æ–¹å›¾</a></li>
            <li><a href="#3-ä½¿ç”¨pyechartsç”»ç›´æ–¹å›¾">3. ä½¿ç”¨pyechartsç”»ç›´æ–¹å›¾</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#42pythonå¤„ç†excelä¸€åˆ—å˜å¤šåˆ—">42ã€Pythonå¤„ç†Excelä¸€åˆ—å˜å¤šåˆ—</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1-è¯»å–æ•°æ®-1">1. è¯»å–æ•°æ®</a></li>
            <li><a href="#2-å®ç°æ‹†åˆ†">2. å®ç°æ‹†åˆ†</a></li>
            <li><a href="#3-è¾“å‡ºåˆ°ç»“æœexcel">3. è¾“å‡ºåˆ°ç»“æœExcel</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#43pandasæŸ¥è¯¢æ•°æ®çš„ç®€ä¾¿æ–¹æ³•dfquery">43ã€PandasæŸ¥è¯¢æ•°æ®çš„ç®€ä¾¿æ–¹æ³•df.query</a>
      <ul>
        <li>
          <ul>
            <li><a href="#0è¯»å–æ•°æ®">0ã€è¯»å–æ•°æ®</a></li>
            <li><a href="#1ä½¿ç”¨dataframeæ¡ä»¶è¡¨è¾¾å¼æŸ¥è¯¢">1ã€ä½¿ç”¨dataframeæ¡ä»¶è¡¨è¾¾å¼æŸ¥è¯¢</a></li>
            <li><a href="#2ä½¿ç”¨dfqueryå¯ä»¥ç®€åŒ–æŸ¥è¯¢">2ã€ä½¿ç”¨df.queryå¯ä»¥ç®€åŒ–æŸ¥è¯¢</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#44pandasæŒ‰è¡Œéå†dataframeçš„3ç§æ–¹æ³•">44ã€PandasæŒ‰è¡Œéå†DataFrameçš„3ç§æ–¹æ³•</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1-dfiterrows">1. df.iterrows()</a></li>
            <li><a href="#2-dfitertuples">2. df.itertuples()</a></li>
            <li><a href="#3-forzip">3. for+zip</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#45pandaså®ç°æ¨¡ç³ŠåŒ¹é…mergeæ•°æ®çš„æ–¹æ³•">45ã€Pandaså®ç°æ¨¡ç³ŠåŒ¹é…Mergeæ•°æ®çš„æ–¹æ³•</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1-ä¸¤ä»½æ•°æ®">1. ä¸¤ä»½æ•°æ®</a></li>
            <li><a href="#æ–¹æ³•1æš´åŠ›ç¬›å¡å°”ç§¯--è¿‡æ»¤">æ–¹æ³•1ï¼šæš´åŠ›ç¬›å¡å°”ç§¯ + è¿‡æ»¤</a></li>
            <li><a href="#æ–¹æ³•2å°è¡¨å˜å­—å…¸åšmergeæœ€åexplode">æ–¹æ³•2ï¼šå°è¡¨å˜å­—å…¸åšmergeæœ€åexplode</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
  <div class="post-outdated">
    <div class="warn">
      <p>ã€æ³¨æ„ã€‘æœ€åæ›´æ–°äº <span class="timeago" datetime="0001-01-01T00:00:00" title="January 1, 0001">January 1, 0001</span>ï¼Œæ–‡ä¸­å†…å®¹å¯èƒ½å·²è¿‡æ—¶ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p>
    </div>
  </div>
    <div class="post-content">
      <p>: | &mdash;: | &mdash;: | &mdash;: | &mdash;: | &mdash;: |
|    0 | S001 | æ€ æ¶µ |   å¥³ |   23 | å±±ä¸œ |
|    1 | S002 | å©‰æ¸… |   å¥³ |   25 | æ²³å— |
|    2 | S003 | æºªæ¦• |   å¥³ |   23 | æ¹–åŒ— |
|    3 | S004 | æ¼ æ¶“ |   å¥³ |   19 | é™•è¥¿ |
|    4 | S005 | ç¥ˆåš |   å¥³ |   24 | å±±ä¸œ |</p>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å±•ç¤ºç´¢å¼•çš„name</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;id&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
<th style="text-align:right">å¹´é¾„</th>
<th style="text-align:right">ç±è´¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">id</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">25</td>
<td style="text-align:right">æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">19</td>
<td style="text-align:right">é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">24</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
</tbody>
</table>
<h3 id="åˆ›å»ºsqlalchemyå¯¹è±¡è¿æ¥mysql">åˆ›å»ºsqlalchemyå¯¹è±¡è¿æ¥MySQL</h3>
<p>SQLAlchemyæ˜¯Pythonä¸­çš„ORMæ¡†æ¶ï¼Œ Object-Relational Mappingï¼ŒæŠŠå…³ç³»æ•°æ®åº“çš„è¡¨ç»“æ„æ˜ å°„åˆ°å¯¹è±¡ä¸Šã€‚</p>
<ul>
<li>å®˜ç½‘ï¼šhttps://www.sqlalchemy.org/</li>
<li>å¦‚æœsqlalchemyåŒ…ä¸å­˜åœ¨ï¼Œç”¨è¿™ä¸ªå‘½ä»¤å®‰è£…ï¼špip install sqlalchemy</li>
<li>éœ€è¦å®‰è£…ä¾èµ–Pythonåº“ï¼špip install mysql-connector-python</li>
</ul>
<p>å¯ä»¥ç›´æ¥æ‰§è¡ŒSQLè¯­å¥</p>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&#34;mysql+mysqlconnector://root:123456@127.0.0.1:3306/test&#34;</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ–¹æ³•1å½“æ•°æ®è¡¨ä¸å­˜åœ¨æ—¶æ¯æ¬¡è¦†ç›–æ•´ä¸ªè¡¨">æ–¹æ³•1ï¼šå½“æ•°æ®è¡¨ä¸å­˜åœ¨æ—¶ï¼Œæ¯æ¬¡è¦†ç›–æ•´ä¸ªè¡¨</h3>
<p>æ¯æ¬¡è¿è¡Œä¼šdrop tableï¼Œæ–°å»ºè¡¨</p>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;student&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&#34;replace&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;show create table student&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s1">&#39;CREATE TABLE `student` (</span><span class="se">\n</span><span class="s1">  `id` bigint(20) DEFAULT NULL,</span><span class="se">\n</span><span class="s1">  `å­¦å·` text,</span><span class="se">\n</span><span class="s1">  `å§“å` text,</span><span class="se">\n</span><span class="s1">  `æ€§åˆ«` text,</span><span class="se">\n</span><span class="s1">  `å¹´é¾„` bigint(20) DEFAULT NULL,</span><span class="se">\n</span><span class="s1">  `ç±è´¯` text,</span><span class="se">\n</span><span class="s1">  KEY `ix_student_id` (`id`)</span><span class="se">\n</span><span class="s1">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;show create table student&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="err">`</span><span class="n">student</span><span class="err">`</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="err">`</span><span class="nb">id</span><span class="err">`</span> <span class="n">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="n">DEFAULT</span> <span class="n">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="err">`</span><span class="n">å­¦å·</span><span class="err">`</span> <span class="n">text</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="err">`</span><span class="n">å§“å</span><span class="err">`</span> <span class="n">text</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="err">`</span><span class="n">æ€§åˆ«</span><span class="err">`</span> <span class="n">text</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="err">`</span><span class="n">å¹´é¾„</span><span class="err">`</span> <span class="n">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="n">DEFAULT</span> <span class="n">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="err">`</span><span class="n">ç±è´¯</span><span class="err">`</span> <span class="n">text</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">KEY</span> <span class="err">`</span><span class="n">ix_student_id</span><span class="err">`</span> <span class="p">(</span><span class="err">`</span><span class="nb">id</span><span class="err">`</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="n">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;select count(1) from student&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">24</span><span class="p">,)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;select * from student limit 5&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;S001&#39;</span><span class="p">,</span> <span class="s1">&#39;æ€ æ¶µ&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;å±±ä¸œ&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;S002&#39;</span><span class="p">,</span> <span class="s1">&#39;å©‰æ¸…&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;æ²³å—&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;S003&#39;</span><span class="p">,</span> <span class="s1">&#39;æºªæ¦•&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;æ¹–åŒ—&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;S004&#39;</span><span class="p">,</span> <span class="s1">&#39;æ¼ æ¶“&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="s1">&#39;é™•è¥¿&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;S005&#39;</span><span class="p">,</span> <span class="s1">&#39;ç¥ˆåš&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;å±±ä¸œ&#39;</span><span class="p">)]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ–¹æ³•2å½“æ•°æ®è¡¨å­˜åœ¨æ—¶æ¯æ¬¡æ–°å¢æ•°æ®">æ–¹æ³•2ï¼šå½“æ•°æ®è¡¨å­˜åœ¨æ—¶ï¼Œæ¯æ¬¡æ–°å¢æ•°æ®</h3>
<p>åœºæ™¯ï¼šæ¯å¤©ä¼šæ–°å¢ä¸€éƒ¨åˆ†æ•°æ®ï¼Œè¦æ·»åŠ åˆ°æ•°æ®è¡¨ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ</p>
<p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="n">df_new</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
<th style="text-align:right">å¹´é¾„</th>
<th style="text-align:right">ç±è´¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">id</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">25</td>
<td style="text-align:right">æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">19</td>
<td style="text-align:right">é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">24</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
</tbody>
</table>
<p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_new</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;student&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&#34;append&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;SELECT * FROM student where id&lt;5 &#34;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;S001&#39;</span><span class="p">,</span> <span class="s1">&#39;æ€ æ¶µ&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;å±±ä¸œ&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;S002&#39;</span><span class="p">,</span> <span class="s1">&#39;å©‰æ¸…&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;æ²³å—&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;S003&#39;</span><span class="p">,</span> <span class="s1">&#39;æºªæ¦•&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;æ¹–åŒ—&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;S004&#39;</span><span class="p">,</span> <span class="s1">&#39;æ¼ æ¶“&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="s1">&#39;é™•è¥¿&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;S005&#39;</span><span class="p">,</span> <span class="s1">&#39;ç¥ˆåš&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;å±±ä¸œ&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;S001&#39;</span><span class="p">,</span> <span class="s1">&#39;æ€ æ¶µ&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;å±±ä¸œ&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;S002&#39;</span><span class="p">,</span> <span class="s1">&#39;å©‰æ¸…&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;æ²³å—&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;S003&#39;</span><span class="p">,</span> <span class="s1">&#39;æºªæ¦•&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;æ¹–åŒ—&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;S004&#39;</span><span class="p">,</span> <span class="s1">&#39;æ¼ æ¶“&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="s1">&#39;é™•è¥¿&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;S005&#39;</span><span class="p">,</span> <span class="s1">&#39;ç¥ˆåš&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;å±±ä¸œ&#39;</span><span class="p">)]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é—®é¢˜è§£å†³å…ˆæ ¹æ®æ•°æ®keyåˆ é™¤æ—§æ•°æ®">é—®é¢˜è§£å†³ï¼šå…ˆæ ¹æ®æ•°æ®KEYåˆ é™¤æ—§æ•°æ®</h4>
<p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_new</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">df_new</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">## å…ˆåˆ é™¤è¦æ–°å¢çš„æ•°æ®</span>
</span></span><span class="line"><span class="cl">    <span class="n">delete_sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;delete from student where id=</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">delete_sql</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">delete_sql</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">delete</span> <span class="kn">from</span> <span class="nn">student</span> <span class="n">where</span> <span class="nb">id</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">delete</span> <span class="kn">from</span> <span class="nn">student</span> <span class="n">where</span> <span class="nb">id</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">delete</span> <span class="kn">from</span> <span class="nn">student</span> <span class="n">where</span> <span class="nb">id</span><span class="o">=</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">delete</span> <span class="kn">from</span> <span class="nn">student</span> <span class="n">where</span> <span class="nb">id</span><span class="o">=</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">delete</span> <span class="kn">from</span> <span class="nn">student</span> <span class="n">where</span> <span class="nb">id</span><span class="o">=</span><span class="mi">4</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;SELECT * FROM student where id&lt;5 &#34;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;select count(1) from student&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">19</span><span class="p">,)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ–°å¢æ•°æ®åˆ°è¡¨ä¸­</span>
</span></span><span class="line"><span class="cl"><span class="n">df_new</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;student&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&#34;append&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;SELECT * FROM student where id&lt;5 &#34;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;S001&#39;</span><span class="p">,</span> <span class="s1">&#39;æ€ æ¶µ&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;å±±ä¸œ&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;S002&#39;</span><span class="p">,</span> <span class="s1">&#39;å©‰æ¸…&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;æ²³å—&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;S003&#39;</span><span class="p">,</span> <span class="s1">&#39;æºªæ¦•&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;æ¹–åŒ—&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;S004&#39;</span><span class="p">,</span> <span class="s1">&#39;æ¼ æ¶“&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="s1">&#39;é™•è¥¿&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;S005&#39;</span><span class="p">,</span> <span class="s1">&#39;ç¥ˆåš&#39;</span><span class="p">,</span> <span class="s1">&#39;å¥³&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;å±±ä¸œ&#39;</span><span class="p">)]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [23]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;SELECT count(1) FROM student&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[23]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">24</span><span class="p">,)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="38pythonæ‰¹é‡ç¿»è¯‘è‹±è¯­å•è¯">38ã€Pythonæ‰¹é‡ç¿»è¯‘è‹±è¯­å•è¯</h1>
<p>*<strong>ç”¨é€”ï¼š*</strong>
å¯¹æ‰¹é‡çš„è‹±è¯­æ–‡æœ¬ï¼Œç”Ÿæˆè‹±è¯­-æ±‰è¯­ç¿»è¯‘çš„å•è¯æœ¬ï¼Œæä¾›Excelä¸‹è½½</p>
<p>*<strong>æœ¬ä»£ç å®ç°ï¼š*</strong></p>
<ol>
<li>
<p>æä¾›ä¸€ä¸ªè‹±æ–‡æ–‡ç« URLï¼Œè‡ªåŠ¨ä¸‹è½½ç½‘é¡µï¼›</p>
</li>
<li>
<p>å®ç°ç½‘é¡µä¸­æ‰€æœ‰è‹±è¯­å•è¯çš„ç¿»è¯‘ï¼›</p>
</li>
<li>
<p>ä¸‹è½½ç¿»è¯‘ç»“æœçš„Excel</p>
<p>*<strong>æ¶‰åŠæŠ€æœ¯ï¼š*</strong></p>
</li>
<li>
<p>pandasçš„è¯»å–csvã€å¤šæ•°æ®mergeã€è¾“å‡ºExcel</p>
</li>
<li>
<p>requestsåº“ä¸‹è½½HTMLç½‘é¡µ</p>
</li>
<li>
<p>BeautifulSoupè§£æHTMLç½‘é¡µ</p>
</li>
<li>
<p>Pythonæ­£åˆ™è¡¨è¾¾å¼å®ç°è‹±æ–‡åˆ†è¯</p>
</li>
</ol>
<h3 id="1-è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶">1. è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶</h3>
<p>è¯å…¸æ–‡ä»¶æ¥è‡ªï¼šhttps://github.com/skywind3000/ECDICT ä½¿ç”¨æ­¥éª¤ï¼š</p>
<ol>
<li>ä¸‹è½½ä»£ç æ‰“åŒ…ï¼šhttps://github.com/skywind3000/ECDICT/archive/master.zip</li>
<li>è§£å‹master.zipï¼Œç„¶åè§£å‹å…¶ä¸­çš„â€ªstardict.csvæ–‡ä»¶</li>
</ol>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ³¨æ„ï¼šstardict.csvçš„åœ°å€éœ€è¦æ›¿æ¢æˆä½ è‡ªå·±çš„æ–‡ä»¶åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">df_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;D:/tmp/ECDICT-master/stardict.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">IPython</span>\<span class="n">core</span>\<span class="n">interactiveshell</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">3063</span><span class="p">:</span> <span class="n">DtypeWarning</span><span class="p">:</span> <span class="n">Columns</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="n">have</span> <span class="n">mixed</span> <span class="n">types</span><span class="o">.</span><span class="n">Specify</span> <span class="n">dtype</span> <span class="n">option</span> <span class="n">on</span> <span class="kn">import</span> <span class="nn">or</span> <span class="nb">set</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">interactivity</span><span class="o">=</span><span class="n">interactivity</span><span class="p">,</span> <span class="n">compiler</span><span class="o">=</span><span class="n">compiler</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_dict</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">3402564</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_dict</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">phonetic</th>
<th style="text-align:right">definition</th>
<th style="text-align:right">translation</th>
<th style="text-align:right">pos</th>
<th style="text-align:right">collins</th>
<th style="text-align:right">oxford</th>
<th style="text-align:right">tag</th>
<th style="text-align:right">bnc</th>
<th style="text-align:right">frq</th>
<th style="text-align:right">exchange</th>
<th style="text-align:right">detail</th>
<th style="text-align:right">audio</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">3370509</td>
<td style="text-align:right">WWDH</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[ç½‘ç»œ] æ·‡æ¥„å£‹</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">518014</td>
<td style="text-align:right">chauhtan (chotan)</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">å“ä¸¹</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">389953</td>
<td style="text-align:right">breviarist</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[ç½‘ç»œ] çŸ­ç¬›å¸ˆ</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">951231</td>
<td style="text-align:right">electric-vehicle</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">abbr. â€œEVâ€çš„å˜ä½“ï¼›â€œelectric carâ€çš„å˜ä½“\n[ç½‘ç»œ] ç”µåŠ¨æ±½è½¦</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">91258</td>
<td style="text-align:right">Albionian</td>
<td style="text-align:right">Ã¦l&rsquo;biÓ™niÓ™n</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[åœ°è´¨]é˜¿å°”æ¯”ç¿æœŸ</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æŠŠwordã€translationä¹‹å¤–çš„åˆ—æ‰”æ‰</span>
</span></span><span class="line"><span class="cl"><span class="n">df_dict</span> <span class="o">=</span> <span class="n">df_dict</span><span class="p">[[</span><span class="s2">&#34;word&#34;</span><span class="p">,</span> <span class="s2">&#34;translation&#34;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">df_dict</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">translation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">&lsquo;a</td>
<td style="text-align:right">na. ä¸€\nn. è‹±æ–‡å­—æ¯è¡¨çš„ç¬¬ä¸€å­—æ¯ï¼›ã€ä¹ã€‘AéŸ³\nart. å† ä»¥ä¸å®šå† è¯ä¸»è¦è¡¨ç¤ºç±»åˆ«...</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">&lsquo;A&rsquo; game</td>
<td style="text-align:right">[ç½‘ç»œ] æ¸¸æˆï¼›ä¸€ä¸ªæ¸¸æˆï¼›ä¸€å±€</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">&lsquo;AbbÄsÄ«yah</td>
<td style="text-align:right">[åœ°å] é˜¿å·´è¥¿è€¶ ( åŸƒ )</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">&lsquo;Abd al KÅ«rÄ«</td>
<td style="text-align:right">[åœ°å] é˜¿åœæœå‹’åº“é‡Œå²› ( ä¹Ÿé—¨ )</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">&lsquo;Abd al MÄjid</td>
<td style="text-align:right">[åœ°å] é˜¿åœæœå‹’é©¬å‰å¾· ( è‹ä¸¹ )</td>
</tr>
</tbody>
</table>
<h3 id="2-ä¸‹è½½ç½‘é¡µå¾—åˆ°ç½‘é¡µå†…å®¹">2. ä¸‹è½½ç½‘é¡µï¼Œå¾—åˆ°ç½‘é¡µå†…å®¹</h3>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Pandaså®˜æ–¹æ–‡æ¡£ä¸­çš„ä¸€ä¸ªURL</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://pandas.pydata.org/docs/user_guide/indexing.html&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">html_cont</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">html_cont</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;\n\n&lt;!DOCTYPE html&gt;\n\n&lt;html xmlns=&#34;http://www.w3.org/1999/xhtml&#34;&gt;\n  &lt;head&gt;\n    &lt;meta charset=&#34;utf-8&#34; /&gt;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-æå–htmlçš„æ­£æ–‡å†…å®¹">3. æå–HTMLçš„æ­£æ–‡å†…å®¹</h3>
<p>å³ï¼šå»é™¤HTMLæ ‡ç­¾ï¼Œè·å–æ­£æ–‡</p>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
</span></span><span class="line"><span class="cl"><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_cont</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">html_text</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">html_text</span><span class="p">[:</span><span class="mi">500</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;\n\n\nIndexing and selecting data â€” pandas 1.0.1 documentation\n\n\n\n\n\n\n\n\n\n\n\n\nMathJax.Hub.Config({&#34;tex2jax&#34;: {&#34;inlineMath&#34;: [[&#34;$&#34;, &#34;$&#34;], [&#34;\\\\(&#34;, &#34;\\\\)&#34;]], &#34;processEscapes&#34;: true, &#34;ignoreClass&#34;: &#34;document&#34;, &#34;processClass&#34;: &#34;math|output_area&#34;}})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHome\n\n\nWhat\&#39;s New in 1.0.0\n\n\nGetting started\n\n\nUser Guide\n\n\nAPI reference\n\n\nDevelopment\n\n\nRelease Notes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIO tools (text, CSV, HDF5, Ã¢\x80Â¦)\n\n\nIndexing and selecting data\n\n\nMultiIndex / advanced indexing\n\n\nMerge, join, a&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—">4. è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—</h3>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># åˆ†è¯</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="n">word_list</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;&#34;&#34;[ ,.\(\)/</span><span class="se">\n</span><span class="s2">|\-:=\$\[&#34;&#39;]&#34;&#34;&#34;</span><span class="p">,</span><span class="n">html_text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">word_list</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Indexing&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="s1">&#39;selecting&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;â€”&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># è¯»å–åœç”¨è¯è¡¨ï¼Œä»ç½‘ä¸Šå¤åˆ¶çš„ï¼Œä½äºå½“å‰ç›®å½•ä¸‹</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;./datas/stop_words/stop_words.txt&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">stop_words</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">list</span><span class="p">(</span><span class="n">stop_words</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;itself&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;showed&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;throughout&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;pointed&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;n&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;against&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;name&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;ran&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ•°æ®æ¸…æ´—</span>
</span></span><span class="line"><span class="cl"><span class="n">word_list_clean</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">word_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">word</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">word</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è¿‡æ»¤æ‰ç©ºè¯ã€æ•°å­—ã€å•ä¸ªå­—ç¬¦çš„è¯ã€åœç”¨è¯</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">word</span> <span class="ow">or</span> <span class="n">word</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">stop_words</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    <span class="n">word_list_clean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">word_list_clean</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;indexing&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;selecting&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;data&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;pandas&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;documentation&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;mathjax&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;hub&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;config&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;tex2jax&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;inlinemath&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;]]&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;processescapes&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;true&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;ignoreclass&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;document&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;processclass&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;math&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;output_area&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="5-åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªdataframe">5. åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªDataFrame</h3>
<p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_words</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;word&#34;</span><span class="p">:</span> <span class="n">word_list_clean</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">df_words</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">indexing</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">selecting</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">data</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">pandas</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">documentation</td>
</tr>
</tbody>
</table>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_words</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">4915</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç»Ÿè®¡è¯é¢‘</span>
</span></span><span class="line"><span class="cl"><span class="n">df_words</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_words</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;word&#34;</span><span class="p">)[</span><span class="s2">&#34;word&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="s2">&#34;size&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&#34;count&#34;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_words</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">620</td>
<td style="text-align:right">df</td>
<td style="text-align:right">161</td>
</tr>
<tr>
<td style="text-align:right">659</td>
<td style="text-align:right">dtype</td>
<td style="text-align:right">87</td>
</tr>
<tr>
<td style="text-align:right">1274</td>
<td style="text-align:right">true</td>
<td style="text-align:right">86</td>
</tr>
<tr>
<td style="text-align:right">593</td>
<td style="text-align:right">dataframe</td>
<td style="text-align:right">80</td>
</tr>
<tr>
<td style="text-align:right">1038</td>
<td style="text-align:right">pd</td>
<td style="text-align:right">75</td>
</tr>
<tr>
<td style="text-align:right">917</td>
<td style="text-align:right">loc</td>
<td style="text-align:right">72</td>
</tr>
<tr>
<td style="text-align:right">970</td>
<td style="text-align:right">nan</td>
<td style="text-align:right">72</td>
</tr>
<tr>
<td style="text-align:right">721</td>
<td style="text-align:right">false</td>
<td style="text-align:right">58</td>
</tr>
<tr>
<td style="text-align:right">914</td>
<td style="text-align:right">list</td>
<td style="text-align:right">58</td>
</tr>
<tr>
<td style="text-align:right">835</td>
<td style="text-align:right">indexing</td>
<td style="text-align:right">53</td>
</tr>
</tbody>
</table>
<h3 id="6-å’Œå•è¯è¯å…¸å®ç°merge">6. å’Œå•è¯è¯å…¸å®ç°merge</h3>
<p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">left</span> <span class="o">=</span> <span class="n">df_dict</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">right</span> <span class="o">=</span> <span class="n">df_words</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">left_on</span> <span class="o">=</span> <span class="s2">&#34;word&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">right_on</span> <span class="o">=</span> <span class="s2">&#34;word&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">translation</th>
<th style="text-align:right">count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">658</td>
<td style="text-align:right">team</td>
<td style="text-align:right">n. é˜Ÿ, ç»„\nvt. æŠŠé©¬(ç‰›)å¥—åœ¨åŒä¸€è¾†è½¦ä¸Š, æŠŠ&hellip;ç¼–æˆä¸€ç»„\nvi. é©¾é©¶å¡è½¦, åä½œ</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">523</td>
<td style="text-align:right">providing</td>
<td style="text-align:right">conj. ä»¥&hellip;ä¸ºæ¡ä»¶, å‡å¦‚</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">394</td>
<td style="text-align:right">lines</td>
<td style="text-align:right">n. å°è¯</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">118</td>
<td style="text-align:right">columns</td>
<td style="text-align:right">å¡”å™¨</td>
<td style="text-align:right">49</td>
</tr>
<tr>
<td style="text-align:right">136</td>
<td style="text-align:right">conforms</td>
<td style="text-align:right">v. éµå®ˆ( conformçš„ç¬¬ä¸‰äººç§°å•æ•° ); é¡ºåº”; ç›¸ä¸€è‡´; ç›¸ç¬¦åˆ</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">529</td>
<td style="text-align:right">python</td>
<td style="text-align:right">n. å¤§èŸ’, å·¨èŸ’\n[è®¡] Python ç¨‹åºè®¾è®¡è¯­è¨€ï¼›äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨ Python</td>
<td style="text-align:right">26</td>
</tr>
<tr>
<td style="text-align:right">185</td>
<td style="text-align:right">determine</td>
<td style="text-align:right">v. å†³å®š, å†³å¿ƒ</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">285</td>
<td style="text-align:right">forward</td>
<td style="text-align:right">a. å‘å‰çš„, æ—©çš„, è¿…é€Ÿçš„, åœ¨å‰çš„, è¿›æ­¥çš„\nvt. ä¿ƒè¿›&hellip;çš„ç”Ÿé•¿, è½¬å¯„, è¿&hellip;</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">49</td>
<td style="text-align:right">arguments</td>
<td style="text-align:right">n. å‚æ•°</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">564</td>
<td style="text-align:right">reported</td>
<td style="text-align:right">a. æŠ¥å‘Šçš„ï¼›æ®æŠ¥é“çš„</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">718</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="7-å­˜å…¥excel">7. å­˜å…¥Excel</h3>
<p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&#34;./38. batch_chinese_english.xlsx&#34;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åç»­å‡çº§">åç»­å‡çº§ï¼š</h3>
<ol>
<li>å¯ä»¥æä¾›txt/excel/word/pdfçš„æ‰¹é‡è¾“å…¥ï¼Œç”Ÿæˆå•è¯æœ¬ï¼›</li>
<li>å¯ä»¥åšæˆç½‘é¡µã€å¾®ä¿¡å°ç¨‹åºçš„å½¢å¼ï¼Œåœ¨çº¿è®¿é—®å’Œä½¿ç”¨</li>
<li>ç”¨æˆ·å¯ä»¥æ ‡è®°æˆ–ä¸Šä¼ â€œå·²ç»è®¤è¯†çš„è¯è¯­â€ï¼Œæ¯æ¬¡è¿‡æ»¤æ‰</li>
</ol>
<h1 id="39pythonè‡ªåŠ¨ç¿»è¯‘è‹±è¯­è®ºæ–‡pdf">39ã€Pythonè‡ªåŠ¨ç¿»è¯‘è‹±è¯­è®ºæ–‡PDF</h1>
<p>*<strong>æ¶‰åŠæŠ€æœ¯ï¼š*</strong></p>
<ol>
<li>Pythonè¯»å–PDFæ–‡æœ¬</li>
<li>pandasçš„è¯»å–csvã€å¤šæ•°æ®mergeã€è¾“å‡ºExcel</li>
<li>Pythonæ­£åˆ™è¡¨è¾¾å¼å®ç°è‹±æ–‡åˆ†è¯</li>
</ol>
<h3 id="1-è¯»å–pdfæ–‡æœ¬å†…å®¹">1. è¯»å–PDFæ–‡æœ¬å†…å®¹</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">i</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="o">.</span><span class="n">tuna</span><span class="o">.</span><span class="n">tsinghua</span><span class="o">.</span><span class="n">edu</span><span class="o">.</span><span class="n">cn</span><span class="o">/</span><span class="n">simple</span> <span class="n">pdfplumber</span>
</span></span><span class="line"><span class="cl"><span class="n">Looking</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="o">.</span><span class="n">tuna</span><span class="o">.</span><span class="n">tsinghua</span><span class="o">.</span><span class="n">edu</span><span class="o">.</span><span class="n">cn</span><span class="o">/</span><span class="n">simple</span>
</span></span><span class="line"><span class="cl"><span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pdfplumber</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>\<span class="n">anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="mf">0.5.16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">chardet</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>\<span class="n">anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pdfplumber</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.0.4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pdfminer</span><span class="o">.</span><span class="n">six</span><span class="o">==</span><span class="mi">20200104</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>\<span class="n">anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pdfplumber</span><span class="p">)</span> <span class="p">(</span><span class="mi">20200104</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pillow</span><span class="o">&gt;=</span><span class="mf">7.0.0</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>\<span class="n">anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pdfplumber</span><span class="p">)</span> <span class="p">(</span><span class="mf">7.0.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">unicodecsv</span><span class="o">&gt;=</span><span class="mf">0.14.1</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>\<span class="n">anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pdfplumber</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.14.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">six</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>\<span class="n">anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pdfplumber</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.14.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">wand</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>\<span class="n">anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pdfplumber</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.5.9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pycryptodome</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>\<span class="n">anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pdfplumber</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.9.7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">sortedcontainers</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>\<span class="n">anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pdfminer.six</span><span class="o">==</span><span class="mi">20200104</span><span class="o">-&gt;</span><span class="n">pdfplumber</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.1.0</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [48]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pdfplumber</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">read_pdf</span><span class="p">(</span><span class="n">pdf_fpath</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">pdf</span> <span class="o">=</span> <span class="n">pdfplumber</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">pdf_fpath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">page_conts</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">pages</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">page_conts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">extract_text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">pdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34; &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page_conts</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [49]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pdf_fpath</span> <span class="o">=</span> <span class="s2">&#34;D:/tmp/Wide &amp; Deep Learning for Recommender Systems.pdf&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">pdf_cont</span> <span class="o">=</span> <span class="n">read_pdf</span><span class="p">(</span><span class="n">pdf_fpath</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [50]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">pdf_cont</span><span class="p">[:</span><span class="mi">2000</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">Wide</span> <span class="o">&amp;</span> <span class="n">Deep</span> <span class="n">Learning</span> <span class="k">for</span> <span class="n">Recommender</span> <span class="n">Systems</span>
</span></span><span class="line"><span class="cl"><span class="n">Heng</span><span class="o">-</span><span class="n">Tze</span> <span class="n">Cheng</span><span class="p">,</span> <span class="n">Levent</span> <span class="n">Koc</span><span class="p">,</span> <span class="n">Jeremiah</span> <span class="n">Harmsen</span><span class="p">,</span> <span class="n">Tal</span> <span class="n">Shaked</span><span class="p">,</span> <span class="n">Tushar</span> <span class="n">Chandra</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">Hrishi</span> <span class="n">Aradhye</span><span class="p">,</span> <span class="n">Glen</span> <span class="n">Anderson</span><span class="p">,</span> <span class="n">Greg</span> <span class="n">Corrado</span><span class="p">,</span> <span class="n">Wei</span> <span class="n">Chai</span><span class="p">,</span> <span class="n">Mustafa</span> <span class="n">Ispir</span><span class="p">,</span> <span class="n">Rohan</span> <span class="n">Anil</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">Zakaria</span> <span class="n">Haque</span><span class="p">,</span> <span class="n">Lichan</span> <span class="n">Hong</span><span class="p">,</span> <span class="n">Vihan</span> <span class="n">Jain</span><span class="p">,</span> <span class="n">Xiaobing</span> <span class="n">Liu</span><span class="p">,</span> <span class="n">Hemal</span> <span class="n">Shah</span>
</span></span><span class="line"><span class="cl"><span class="err">âˆ—</span>
</span></span><span class="line"><span class="cl"><span class="n">GoogleInc</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">ABSTRACT</span>
</span></span><span class="line"><span class="cl"><span class="n">have</span> <span class="n">never</span> <span class="ow">or</span> <span class="n">rarely</span> <span class="n">occurred</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">past</span><span class="o">.</span> <span class="n">Recommenda</span><span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="n">tions</span> <span class="n">based</span> <span class="n">on</span> <span class="n">memorization</span> <span class="n">are</span> <span class="n">usually</span> <span class="n">more</span> <span class="n">topical</span> <span class="ow">and</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span> <span class="n">Generalized</span> <span class="n">linear</span> <span class="n">models</span> <span class="k">with</span> <span class="n">nonlinear</span> <span class="n">feature</span> <span class="n">transfor</span><span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="n">directly</span> <span class="n">relevant</span> <span class="n">to</span> <span class="n">the</span> <span class="n">items</span> <span class="n">on</span> <span class="n">which</span> <span class="n">users</span> <span class="n">have</span> <span class="n">already</span>
</span></span><span class="line"><span class="cl"><span class="mi">0</span> <span class="n">mations</span> <span class="n">are</span> <span class="n">widely</span> <span class="n">used</span> <span class="k">for</span> <span class="n">large</span><span class="o">-</span><span class="n">scale</span> <span class="n">regression</span> <span class="ow">and</span> <span class="n">clas</span><span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="n">performed</span> <span class="n">actions</span><span class="o">.</span> <span class="n">Compared</span> <span class="k">with</span> <span class="n">memorization</span><span class="p">,</span> <span class="n">general</span><span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span> <span class="n">siï¬cationproblemswithsparseinputs</span><span class="o">.</span> <span class="n">Memorizationoffea</span><span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="n">ization</span> <span class="n">tends</span> <span class="n">to</span> <span class="n">improve</span> <span class="n">the</span> <span class="n">diversity</span> <span class="n">of</span> <span class="n">the</span> <span class="n">recommended</span>
</span></span><span class="line"><span class="cl">  <span class="n">tureinteractionsthroughawide</span> <span class="n">setofcross</span><span class="o">-</span><span class="n">productfeature</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="n">items</span><span class="o">.</span> <span class="n">Inthispaper</span><span class="p">,</span><span class="n">wefocusontheappsrecommendation</span>
</span></span><span class="line"><span class="cl"><span class="n">transformationsareeï¬€ectiveandinterpretable</span><span class="p">,</span><span class="n">whilegener</span><span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="n">u</span> <span class="n">problemfortheGooglePlaystore</span><span class="p">,</span><span class="n">buttheapproachshould</span>
</span></span><span class="line"><span class="cl"><span class="n">alizationrequiresmorefeatureengineeringeï¬€ort</span><span class="o">.</span> <span class="n">Withless</span>
</span></span><span class="line"><span class="cl"><span class="n">J</span> <span class="n">apply</span> <span class="n">to</span> <span class="n">generic</span> <span class="n">recommender</span> <span class="n">systems</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">featureengineering</span><span class="p">,</span><span class="n">deepneuralnetworkscangeneralizebet</span><span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span> <span class="n">Formassive</span><span class="o">-</span><span class="n">scaleonlinerecommendationandrankingsys</span><span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="n">tertounseenfeaturecombinationsthroughlow</span><span class="o">-</span><span class="n">dimensional</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span> <span class="n">temsinanindustrialsetting</span><span class="p">,</span><span class="n">generalizedlinearmodelssuch</span>
</span></span><span class="line"><span class="cl"><span class="n">denseembeddingslearnedforthesparsefeatures</span><span class="o">.</span> <span class="n">However</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="k">as</span> <span class="n">logistic</span> <span class="n">regression</span> <span class="n">are</span> <span class="n">widely</span> <span class="n">used</span> <span class="n">because</span> <span class="n">they</span> <span class="n">are</span> <span class="n">sim</span><span class="o">-</span>
</span></span><span class="line"><span class="cl">  <span class="n">deep</span> <span class="n">neural</span> <span class="n">networks</span> <span class="k">with</span> <span class="n">embeddings</span> <span class="n">can</span> <span class="n">over</span><span class="o">-</span><span class="n">generalize</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span> <span class="n">ple</span><span class="p">,</span><span class="n">scalableandinterpretable</span><span class="o">.</span> <span class="n">Themodelsareoftentrained</span>
</span></span><span class="line"><span class="cl"><span class="n">G</span> <span class="n">andrecommendlessrelevantitemswhentheuser</span><span class="o">-</span><span class="n">iteminter</span><span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="n">onbinarizedsparsefeatureswithone</span><span class="o">-</span><span class="n">hotencoding</span><span class="o">.</span> <span class="n">E</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">,</span><span class="n">the</span>
</span></span><span class="line"><span class="cl"><span class="n">actions</span> <span class="n">are</span> <span class="n">sparse</span> <span class="ow">and</span> <span class="n">high</span><span class="o">-</span><span class="n">rank</span><span class="o">.</span> <span class="n">In</span> <span class="n">this</span> <span class="n">paper</span><span class="p">,</span> <span class="n">we</span> <span class="n">present</span>
</span></span><span class="line"><span class="cl"><span class="n">L</span> <span class="n">binary</span> <span class="n">feature</span><span class="err">â€œ</span><span class="n">user_installed_app</span><span class="o">=</span><span class="n">netflix</span><span class="err">â€</span><span class="n">has</span> <span class="n">value</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">Wide</span> <span class="o">&amp;</span> <span class="n">Deep</span> <span class="n">learning</span><span class="err">â€”</span><span class="n">jointly</span> <span class="n">trained</span> <span class="n">wide</span> <span class="n">linear</span> <span class="n">models</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span> <span class="k">if</span> <span class="n">the</span> <span class="n">user</span> <span class="n">installed</span> <span class="n">Netï¬‚ix</span><span class="o">.</span> <span class="n">Memorization</span> <span class="n">can</span> <span class="n">be</span> <span class="n">achieved</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="n">anddeepneuralnetworks</span><span class="err">â€”</span><span class="n">tocombinethebeneï¬tsofmem</span><span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="n">orization</span> <span class="ow">and</span> <span class="n">generalization</span> <span class="k">for</span> <span class="n">recommender</span> <span class="n">systems</span><span class="o">.</span> <span class="n">We</span> <span class="n">eï¬€ectively</span> <span class="n">using</span> <span class="n">cross</span><span class="o">-</span><span class="n">product</span> <span class="n">t</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶">2. è¯»å–è‹±è¯­-æ±‰è¯­ç¿»è¯‘è¯å…¸æ–‡ä»¶</h3>
<p>è¯å…¸æ–‡ä»¶æ¥è‡ªï¼šhttps://github.com/skywind3000/ECDICT ä½¿ç”¨æ­¥éª¤ï¼š</p>
<ol>
<li>ä¸‹è½½ä»£ç æ‰“åŒ…ï¼šhttps://github.com/skywind3000/ECDICT/archive/master.zip</li>
<li>è§£å‹master.zipï¼Œç„¶åè§£å‹å…¶ä¸­çš„â€ªstardict.csvæ–‡ä»¶</li>
</ol>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ³¨æ„ï¼šstardict.csvçš„åœ°å€éœ€è¦æ›¿æ¢æˆä½ è‡ªå·±çš„æ–‡ä»¶åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">df_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;D:/tmp/ECDICT-master/stardict.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">:</span>\<span class="n">Anaconda3</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">IPython</span>\<span class="n">core</span>\<span class="n">interactiveshell</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">3063</span><span class="p">:</span> <span class="n">DtypeWarning</span><span class="p">:</span> <span class="n">Columns</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="n">have</span> <span class="n">mixed</span> <span class="n">types</span><span class="o">.</span><span class="n">Specify</span> <span class="n">dtype</span> <span class="n">option</span> <span class="n">on</span> <span class="kn">import</span> <span class="nn">or</span> <span class="nb">set</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">interactivity</span><span class="o">=</span><span class="n">interactivity</span><span class="p">,</span> <span class="n">compiler</span><span class="o">=</span><span class="n">compiler</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_dict</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">3402564</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_dict</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">phonetic</th>
<th style="text-align:right">definition</th>
<th style="text-align:right">translation</th>
<th style="text-align:right">pos</th>
<th style="text-align:right">collins</th>
<th style="text-align:right">oxford</th>
<th style="text-align:right">tag</th>
<th style="text-align:right">bnc</th>
<th style="text-align:right">frq</th>
<th style="text-align:right">exchange</th>
<th style="text-align:right">detail</th>
<th style="text-align:right">audio</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">801655</td>
<td style="text-align:right">design height</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">è®¾è®¡é«˜åº¦</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2739800</td>
<td style="text-align:right">shibu</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[ç½‘ç»œ] æ–¹å›æ˜¥å ‚ï¼›å–Šå§</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1232187</td>
<td style="text-align:right">genus Testudo</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[ç½‘ç»œ] Testudoå±</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">s:genus testudoes</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2403094</td>
<td style="text-align:right">profit-and-loss statements</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">[ä¼šè®¡] æŸç›Šè¡¨</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">0:profit-and-loss statement/1:s</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1197174</td>
<td style="text-align:right">gain limited sensitivity</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">æé™å¢ç›Šçµæ•åº¦</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æŠŠwordã€translationä¹‹å¤–çš„åˆ—æ‰”æ‰</span>
</span></span><span class="line"><span class="cl"><span class="n">df_dict</span> <span class="o">=</span> <span class="n">df_dict</span><span class="p">[[</span><span class="s2">&#34;word&#34;</span><span class="p">,</span> <span class="s2">&#34;translation&#34;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">df_dict</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">translation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">&lsquo;a</td>
<td style="text-align:right">na. ä¸€\nn. è‹±æ–‡å­—æ¯è¡¨çš„ç¬¬ä¸€å­—æ¯ï¼›ã€ä¹ã€‘AéŸ³\nart. å† ä»¥ä¸å®šå† è¯ä¸»è¦è¡¨ç¤ºç±»åˆ«...</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">&lsquo;A&rsquo; game</td>
<td style="text-align:right">[ç½‘ç»œ] æ¸¸æˆï¼›ä¸€ä¸ªæ¸¸æˆï¼›ä¸€å±€</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">&lsquo;AbbÄsÄ«yah</td>
<td style="text-align:right">[åœ°å] é˜¿å·´è¥¿è€¶ ( åŸƒ )</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">&lsquo;Abd al KÅ«rÄ«</td>
<td style="text-align:right">[åœ°å] é˜¿åœæœå‹’åº“é‡Œå²› ( ä¹Ÿé—¨ )</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">&lsquo;Abd al MÄjid</td>
<td style="text-align:right">[åœ°å] é˜¿åœæœå‹’é©¬å‰å¾· ( è‹ä¸¹ )</td>
</tr>
</tbody>
</table>
<h3 id="3-è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—">3. è‹±æ–‡åˆ†è¯å’Œæ•°æ®æ¸…æ´—</h3>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># åˆ†è¯</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="n">word_list</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;&#34;&#34;[ ,.\(\)/</span><span class="se">\n</span><span class="s2">|\-:=\$\[&#34;&#39;]&#34;&#34;&#34;</span><span class="p">,</span> <span class="n">pdf_cont</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">word_list</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;Wide&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;&amp;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;Deep&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;Learning&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;for&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;Recommender&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;Systems&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;Heng&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;Tze&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;Cheng&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ•°æ®æ¸…æ´—</span>
</span></span><span class="line"><span class="cl"><span class="n">word_list_clean</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">word_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">word</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">word</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è¿‡æ»¤æ‰ç©ºè¯ã€æ•°å­—ã€å•ä¸ªå­—ç¬¦çš„è¯ã€åœç”¨è¯</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">word</span> <span class="ow">or</span> <span class="n">word</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    <span class="n">word_list_clean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">word_list_clean</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;wide&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;deep&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;learning&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;for&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;recommender&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;systems&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;heng&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;tze&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;cheng&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;levent&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;koc&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;jeremiah&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;harmsen&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;tal&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;shaked&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;tushar&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;chandra&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;hrishi&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;aradhye&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;glen&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªdataframe">4. åˆ†è¯ç»“æœæ„é€ æˆä¸€ä¸ªDataFrame</h3>
<p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_words</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;word&#34;</span><span class="p">:</span> <span class="n">word_list_clean</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">df_words</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">wide</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">deep</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">learning</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">for</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">recommender</td>
</tr>
</tbody>
</table>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_words</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">2322</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç»Ÿè®¡è¯é¢‘</span>
</span></span><span class="line"><span class="cl"><span class="n">df_words</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_words</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;word&#34;</span><span class="p">)[</span><span class="s2">&#34;word&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="s2">&#34;size&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&#34;count&#34;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_words</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">804</td>
<td style="text-align:right">the</td>
<td style="text-align:right">128</td>
</tr>
<tr>
<td style="text-align:right">57</td>
<td style="text-align:right">and</td>
<td style="text-align:right">67</td>
</tr>
<tr>
<td style="text-align:right">546</td>
<td style="text-align:right">of</td>
<td style="text-align:right">46</td>
</tr>
<tr>
<td style="text-align:right">503</td>
<td style="text-align:right">model</td>
<td style="text-align:right">41</td>
</tr>
<tr>
<td style="text-align:right">939</td>
<td style="text-align:right">wide</td>
<td style="text-align:right">36</td>
</tr>
<tr>
<td style="text-align:right">374</td>
<td style="text-align:right">in</td>
<td style="text-align:right">36</td>
</tr>
<tr>
<td style="text-align:right">203</td>
<td style="text-align:right">deep</td>
<td style="text-align:right">35</td>
</tr>
<tr>
<td style="text-align:right">405</td>
<td style="text-align:right">is</td>
<td style="text-align:right">31</td>
</tr>
<tr>
<td style="text-align:right">286</td>
<td style="text-align:right">for</td>
<td style="text-align:right">30</td>
</tr>
<tr>
<td style="text-align:right">845</td>
<td style="text-align:right">to</td>
<td style="text-align:right">29</td>
</tr>
</tbody>
</table>
<h3 id="5-å’Œå•è¯è¯å…¸å®ç°merge">5. å’Œå•è¯è¯å…¸å®ç°merge</h3>
<p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">left</span> <span class="o">=</span> <span class="n">df_dict</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">right</span> <span class="o">=</span> <span class="n">df_words</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">left_on</span> <span class="o">=</span> <span class="s2">&#34;word&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">right_on</span> <span class="o">=</span> <span class="s2">&#34;word&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [32]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[32]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">word</th>
<th style="text-align:right">translation</th>
<th style="text-align:right">count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">account</td>
<td style="text-align:right">n. æŠ¥å‘Š, è§£é‡Š, ä¼°ä»·, ç†ç”±, åˆ©æ¶¦, ç®—è´¦, å¸ç›®\nvi. æŠ¥å¸, è§£é‡Š, å¯¼è‡´,&hellip;</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">380</td>
<td style="text-align:right">prediction</td>
<td style="text-align:right">n. é¢„è¨€, é¢„æŠ¥\n[åŒ–] é¢„æµ‹</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">185</td>
<td style="text-align:right">generalization</td>
<td style="text-align:right">n. ä¸€èˆ¬åŒ–, æ™®éåŒ–, æ¦‚æ‹¬\n[åŒ–] æ¨å¹¿; æ™®é€‚åŒ–</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">56</td>
<td style="text-align:right">burget</td>
<td style="text-align:right">[äººå] ä¼¯å‰ç‰¹</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">372</td>
<td style="text-align:right">pipeline</td>
<td style="text-align:right">n. ç®¡é“, ä¼ é€’é€”å¾„\n[åŒ–] ç®¡è·¯; ç®¡çº¿</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">237</td>
<td style="text-align:right">include</td>
<td style="text-align:right">vt. åŒ…æ‹¬, æŠŠ&hellip;ç®—å…¥, åŒ…ä½\n[è®¡] DOSå†…éƒ¨å‘½ä»¤:åœ¨CONFIG.SYSæ–‡ä»¶çš„&hellip;</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">524</td>
<td style="text-align:right">threads</td>
<td style="text-align:right">n. çº¿ï¼›ç›¸å…³ä¸²è¿ï¼›çº¿ç¨‹ï¼ˆthreadçš„å¤æ•°ï¼‰</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">208</td>
<td style="text-align:right">heng</td>
<td style="text-align:right">n. æ’; ç©</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">62</td>
<td style="text-align:right">capacity</td>
<td style="text-align:right">n. å®¹é‡, èƒ½åŠ›, æ‰èƒ½, èµ„æ ¼\n[è®¡] å®¹é‡</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">228</td>
<td style="text-align:right">important</td>
<td style="text-align:right">a. é‡è¦çš„, æœ‰åœ°ä½çš„, å¤§é‡çš„, æ˜¾è¦çš„, è‡ªè´Ÿçš„\n[è®¡] è¦ç‚¹</td>
<td style="text-align:right">2</td>
</tr>
</tbody>
</table>
<p>In [33]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[33]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">607</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="6-å­˜å…¥excel">6. å­˜å…¥Excel</h3>
<p>In [34]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&#34;./39. pdf_chinese_english.xlsx&#34;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="40pandasæ€æ ·å®ç°groupbyèšåˆåå­—ç¬¦ä¸²åˆ—çš„åˆå¹¶">40ã€Pandasæ€æ ·å®ç°groupbyèšåˆåå­—ç¬¦ä¸²åˆ—çš„åˆå¹¶</h1>
<h4 id="éœ€æ±‚">éœ€æ±‚ï¼š</h4>
<p>è®¡ç®—æ¯ä¸ªæœˆçš„æœ€é«˜æ¸©åº¦ã€æœ€ä½æ¸©åº¦ã€å‡ºç°çš„é£å‘åˆ—è¡¨ã€å‡ºç°çš„ç©ºæ°”è´¨é‡åˆ—è¡¨</p>
<h4 id="æ•°æ®è¾“å…¥">æ•°æ®è¾“å…¥</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/31.png" alt=""></p>
<h4 id="æ•°æ®è¾“å‡º">æ•°æ®è¾“å‡º</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/32.png" alt=""></p>
<h3 id="è¯»å–æ•°æ®">è¯»å–æ•°æ®</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fpath</span> <span class="o">=</span> <span class="s2">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3â„ƒ</td>
<td style="text-align:right">-6â„ƒ</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2â„ƒ</td>
<td style="text-align:right">-5â„ƒ</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2â„ƒ</td>
<td style="text-align:right">-5â„ƒ</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h4 id="çŸ¥è¯†ä½¿ç”¨dfinfoå¯ä»¥æŸ¥çœ‹æ¯åˆ—çš„ç±»å‹">çŸ¥è¯†ï¼šä½¿ç”¨df.info()å¯ä»¥æŸ¥çœ‹æ¯åˆ—çš„ç±»å‹</h4>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">365</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">364</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">9</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"> <span class="c1">#   Column     Non-Null Count  Dtype </span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>  <span class="o">------</span>     <span class="o">--------------</span>  <span class="o">-----</span> 
</span></span><span class="line"><span class="cl"> <span class="mi">0</span>   <span class="n">ymd</span>        <span class="mi">365</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="nb">object</span>
</span></span><span class="line"><span class="cl"> <span class="mi">1</span>   <span class="n">bWendu</span>     <span class="mi">365</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="nb">object</span>
</span></span><span class="line"><span class="cl"> <span class="mi">2</span>   <span class="n">yWendu</span>     <span class="mi">365</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="nb">object</span>
</span></span><span class="line"><span class="cl"> <span class="mi">3</span>   <span class="n">tianqi</span>     <span class="mi">365</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="nb">object</span>
</span></span><span class="line"><span class="cl"> <span class="mi">4</span>   <span class="n">fengxiang</span>  <span class="mi">365</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="nb">object</span>
</span></span><span class="line"><span class="cl"> <span class="mi">5</span>   <span class="n">fengli</span>     <span class="mi">365</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="nb">object</span>
</span></span><span class="line"><span class="cl"> <span class="mi">6</span>   <span class="n">aqi</span>        <span class="mi">365</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">int64</span> 
</span></span><span class="line"><span class="cl"> <span class="mi">7</span>   <span class="n">aqiInfo</span>    <span class="mi">365</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="nb">object</span>
</span></span><span class="line"><span class="cl"> <span class="mi">8</span>   <span class="n">aqiLevel</span>   <span class="mi">365</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">int64</span> 
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">int64</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">object</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">25.8</span><span class="o">+</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="çŸ¥è¯†seriesæ€æ ·ä»strç±»å‹å˜æˆint">çŸ¥è¯†ï¼šseriesæ€æ ·ä»strç±»å‹å˜æˆint</h4>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;yWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;yWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h4 id="çŸ¥è¯†è¿›è¡Œæ—¥æœŸåˆ—è§£æå¯ä»¥æ–¹ä¾¿æå–æœˆä»½">çŸ¥è¯†ï¼šè¿›è¡Œæ—¥æœŸåˆ—è§£æï¼Œå¯ä»¥æ–¹ä¾¿æå–æœˆä»½</h4>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>       <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>       <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>       <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>       <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>       <span class="mi">1</span>
</span></span><span class="line"><span class="cl">       <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="mi">360</span>    <span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="mi">361</span>    <span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="mi">362</span>    <span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="mi">363</span>    <span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="mi">364</span>    <span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="çŸ¥è¯†serieså¯ä»¥ç”¨seriesuniqueå»é‡">çŸ¥è¯†ï¼šserieså¯ä»¥ç”¨Series.uniqueå»é‡</h4>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;fengxiang&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-v" data-lang="v"><span class="line"><span class="cl"><span class="nb">array</span><span class="p">([</span><span class="s1">&#39;ä¸œåŒ—é£&#39;</span><span class="p">,</span> <span class="s1">&#39;åŒ—é£&#39;</span><span class="p">,</span> <span class="s1">&#39;è¥¿åŒ—é£&#39;</span><span class="p">,</span> <span class="s1">&#39;è¥¿å—é£&#39;</span><span class="p">,</span> <span class="s1">&#39;å—é£&#39;</span><span class="p">,</span> <span class="s1">&#39;ä¸œå—é£&#39;</span><span class="p">,</span> <span class="s1">&#39;ä¸œé£&#39;</span><span class="p">,</span> <span class="s1">&#39;è¥¿é£&#39;</span><span class="p">],</span> <span class="nv">dtype</span><span class="o">=</span><span class="nv">object</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="çŸ¥è¯†å¯ä»¥ç”¨joinserieså®ç°æ•°ç»„åˆå¹¶æˆå¤§å­—ç¬¦ä¸²">çŸ¥è¯†ï¼šå¯ä»¥ç”¨&quot;,&quot;.join(series)å®ç°æ•°ç»„åˆå¹¶æˆå¤§å­—ç¬¦ä¸²</h4>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s2">&#34;,&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;fengxiang&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s1">&#39;ä¸œåŒ—é£,åŒ—é£,è¥¿åŒ—é£,è¥¿å—é£,å—é£,ä¸œå—é£,ä¸œé£,è¥¿é£&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ–¹æ³•1">æ–¹æ³•1</h3>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span><span class="n">agg</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="c1"># æ–°åˆ—å = (åŸåˆ—åï¼Œå‡½æ•°)</span>
</span></span><span class="line"><span class="cl">          <span class="n">æœ€é«˜æ¸©åº¦</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;bWendu&#34;</span><span class="p">,</span> <span class="s2">&#34;max&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="n">æœ€ä½æ¸©åº¦</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;yWendu&#34;</span><span class="p">,</span> <span class="s2">&#34;min&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="n">é£å‘åˆ—è¡¨</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;fengxiang&#34;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="s2">&#34;,&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">unique</span><span class="p">())),</span>
</span></span><span class="line"><span class="cl">          <span class="n">ç©ºæ°”è´¨é‡åˆ—è¡¨</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;aqiInfo&#34;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="s2">&#34;,&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;ymd&#34;</span><span class="p">:</span><span class="s2">&#34;æœˆä»½&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æœˆä»½</th>
<th style="text-align:right">æœ€é«˜æ¸©åº¦</th>
<th style="text-align:right">æœ€ä½æ¸©åº¦</th>
<th style="text-align:right">é£å‘åˆ—è¡¨</th>
<th style="text-align:right">ç©ºæ°”è´¨é‡åˆ—è¡¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">ä¸œåŒ—é£,åŒ—é£,è¥¿åŒ—é£,è¥¿å—é£,å—é£,ä¸œå—é£,ä¸œé£</td>
<td style="text-align:right">è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">-10</td>
<td style="text-align:right">åŒ—é£,è¥¿å—é£,å—é£,è¥¿åŒ—é£,è¥¿é£,ä¸œåŒ—é£,ä¸œé£</td>
<td style="text-align:right">è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">27</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">è¥¿å—é£,åŒ—é£,ä¸œå—é£,å—é£,ä¸œåŒ—é£,ä¸œé£</td>
<td style="text-align:right">ä¼˜,è‰¯,é‡åº¦æ±¡æŸ“,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“,ä¸¥é‡æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">30</td>
<td style="text-align:right">1</td>
<td style="text-align:right">å—é£,åŒ—é£,ä¸œåŒ—é£,è¥¿å—é£,è¥¿åŒ—é£,ä¸œå—é£</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“,è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">35</td>
<td style="text-align:right">10</td>
<td style="text-align:right">ä¸œåŒ—é£,åŒ—é£,è¥¿å—é£,å—é£,ä¸œå—é£,ä¸œé£,è¥¿é£,è¥¿åŒ—é£</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“,ä¼˜,è‰¯,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">38</td>
<td style="text-align:right">17</td>
<td style="text-align:right">è¥¿å—é£,å—é£,åŒ—é£,ä¸œé£,ä¸œå—é£,ä¸œåŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
<td style="text-align:right">37</td>
<td style="text-align:right">22</td>
<td style="text-align:right">ä¸œå—é£,è¥¿å—é£,å—é£,ä¸œåŒ—é£,ä¸œé£,è¥¿é£,åŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
<td style="text-align:right">36</td>
<td style="text-align:right">20</td>
<td style="text-align:right">ä¸œå—é£,å—é£,ä¸œé£,ä¸œåŒ—é£,åŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">31</td>
<td style="text-align:right">11</td>
<td style="text-align:right">å—é£,åŒ—é£,è¥¿å—é£,è¥¿åŒ—é£</td>
<td style="text-align:right">ä¼˜,è‰¯,è½»åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">25</td>
<td style="text-align:right">1</td>
<td style="text-align:right">åŒ—é£,è¥¿åŒ—é£,å—é£,è¥¿é£,ä¸œåŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">ä¼˜,è‰¯,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
<td style="text-align:right">18</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">å—é£,åŒ—é£,è¥¿å—é£,ä¸œå—é£,è¥¿åŒ—é£,ä¸œåŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“,ä¼˜,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">12</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">ä¸œå—é£,ä¸œåŒ—é£,è¥¿åŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“,è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“</td>
</tr>
</tbody>
</table>
<h3 id="æ–¹æ³•2">æ–¹æ³•2</h3>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">agg_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ³¨æ„ï¼Œè¿™ä¸ªxæ˜¯æ¯ä¸ªåˆ†ç»„çš„dataframe&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æœ€é«˜æ¸©åº¦&#34;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æœ€ä½æ¸©åº¦&#34;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;yWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;é£å‘åˆ—è¡¨&#34;</span><span class="p">:</span> <span class="s2">&#34;,&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&#34;fengxiang&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ç©ºæ°”è´¨é‡åˆ—è¡¨&#34;</span><span class="p">:</span> <span class="s2">&#34;,&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&#34;aqiInfo&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">df</span> \
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span> \
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">agg_func</span><span class="p">)</span> \
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> \
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;ymd&#34;</span><span class="p">:</span><span class="s2">&#34;æœˆä»½&#34;</span><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æœˆä»½</th>
<th style="text-align:right">æœ€é«˜æ¸©åº¦</th>
<th style="text-align:right">æœ€ä½æ¸©åº¦</th>
<th style="text-align:right">é£å‘åˆ—è¡¨</th>
<th style="text-align:right">ç©ºæ°”è´¨é‡åˆ—è¡¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">ä¸œåŒ—é£,åŒ—é£,è¥¿åŒ—é£,è¥¿å—é£,å—é£,ä¸œå—é£,ä¸œé£</td>
<td style="text-align:right">è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">-10</td>
<td style="text-align:right">åŒ—é£,è¥¿å—é£,å—é£,è¥¿åŒ—é£,è¥¿é£,ä¸œåŒ—é£,ä¸œé£</td>
<td style="text-align:right">è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">27</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">è¥¿å—é£,åŒ—é£,ä¸œå—é£,å—é£,ä¸œåŒ—é£,ä¸œé£</td>
<td style="text-align:right">ä¼˜,è‰¯,é‡åº¦æ±¡æŸ“,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“,ä¸¥é‡æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">30</td>
<td style="text-align:right">1</td>
<td style="text-align:right">å—é£,åŒ—é£,ä¸œåŒ—é£,è¥¿å—é£,è¥¿åŒ—é£,ä¸œå—é£</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“,è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">35</td>
<td style="text-align:right">10</td>
<td style="text-align:right">ä¸œåŒ—é£,åŒ—é£,è¥¿å—é£,å—é£,ä¸œå—é£,ä¸œé£,è¥¿é£,è¥¿åŒ—é£</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“,ä¼˜,è‰¯,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">38</td>
<td style="text-align:right">17</td>
<td style="text-align:right">è¥¿å—é£,å—é£,åŒ—é£,ä¸œé£,ä¸œå—é£,ä¸œåŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
<td style="text-align:right">37</td>
<td style="text-align:right">22</td>
<td style="text-align:right">ä¸œå—é£,è¥¿å—é£,å—é£,ä¸œåŒ—é£,ä¸œé£,è¥¿é£,åŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
<td style="text-align:right">36</td>
<td style="text-align:right">20</td>
<td style="text-align:right">ä¸œå—é£,å—é£,ä¸œé£,ä¸œåŒ—é£,åŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,ä¼˜</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">31</td>
<td style="text-align:right">11</td>
<td style="text-align:right">å—é£,åŒ—é£,è¥¿å—é£,è¥¿åŒ—é£</td>
<td style="text-align:right">ä¼˜,è‰¯,è½»åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">25</td>
<td style="text-align:right">1</td>
<td style="text-align:right">åŒ—é£,è¥¿åŒ—é£,å—é£,è¥¿é£,ä¸œåŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">ä¼˜,è‰¯,è½»åº¦æ±¡æŸ“,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
<td style="text-align:right">18</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">å—é£,åŒ—é£,è¥¿å—é£,ä¸œå—é£,è¥¿åŒ—é£,ä¸œåŒ—é£</td>
<td style="text-align:right">è‰¯,è½»åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“,ä¼˜,ä¸­åº¦æ±¡æŸ“</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">12</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">ä¸œå—é£,ä¸œåŒ—é£,è¥¿åŒ—é£,è¥¿å—é£</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“,é‡åº¦æ±¡æŸ“,è‰¯,ä¼˜,è½»åº¦æ±¡æŸ“</td>
</tr>
</tbody>
</table>
<h1 id="41pandasè¯»å–excelç»˜åˆ¶ç›´æ–¹å›¾">41ã€Pandasè¯»å–Excelç»˜åˆ¶ç›´æ–¹å›¾</h1>
<p>*<strong>ç›´æ–¹å›¾(Histogram)ï¼š*</strong>
ç›´æ–¹å›¾æ˜¯æ•°å€¼æ•°æ®åˆ†å¸ƒçš„ç²¾ç¡®å›¾å½¢è¡¨ç¤ºï¼Œæ˜¯ä¸€ä¸ªè¿ç»­å˜é‡ï¼ˆå®šé‡å˜é‡ï¼‰çš„æ¦‚ç‡åˆ†å¸ƒçš„ä¼°è®¡ï¼Œå®ƒæ˜¯ä¸€ç§æ¡å½¢å›¾ã€‚
ä¸ºäº†æ„å»ºç›´æ–¹å›¾ï¼Œç¬¬ä¸€æ­¥æ˜¯å°†å€¼çš„èŒƒå›´åˆ†æ®µï¼Œå³å°†æ•´ä¸ªå€¼çš„èŒƒå›´åˆ†æˆä¸€ç³»åˆ—é—´éš”ï¼Œç„¶åè®¡ç®—æ¯ä¸ªé—´éš”ä¸­æœ‰å¤šå°‘å€¼ã€‚</p>
<h3 id="1-è¯»å–æ•°æ®">1. è¯»å–æ•°æ®</h3>
<p>æ³¢æ–¯é¡¿æˆ¿ä»·æ•°æ®é›†</p>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&#34;./datas/boston-house-prices/housing.xlsx&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">CRIM</th>
<th style="text-align:right">ZN</th>
<th style="text-align:right">INDUS</th>
<th style="text-align:right">CHAS</th>
<th style="text-align:right">NOX</th>
<th style="text-align:right">RM</th>
<th style="text-align:right">AGE</th>
<th style="text-align:right">DIS</th>
<th style="text-align:right">RAD</th>
<th style="text-align:right">TAX</th>
<th style="text-align:right">PTRATIO</th>
<th style="text-align:right">B</th>
<th style="text-align:right">LSTAT</th>
<th style="text-align:right">MEDV</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0.00632</td>
<td style="text-align:right">18.0</td>
<td style="text-align:right">2.31</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.538</td>
<td style="text-align:right">6.575</td>
<td style="text-align:right">65.2</td>
<td style="text-align:right">4.0900</td>
<td style="text-align:right">1</td>
<td style="text-align:right">296</td>
<td style="text-align:right">15.3</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">4.98</td>
<td style="text-align:right">24.0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">0.02731</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">7.07</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.469</td>
<td style="text-align:right">6.421</td>
<td style="text-align:right">78.9</td>
<td style="text-align:right">4.9671</td>
<td style="text-align:right">2</td>
<td style="text-align:right">242</td>
<td style="text-align:right">17.8</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">9.14</td>
<td style="text-align:right">21.6</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">0.02729</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">7.07</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.469</td>
<td style="text-align:right">7.185</td>
<td style="text-align:right">61.1</td>
<td style="text-align:right">4.9671</td>
<td style="text-align:right">2</td>
<td style="text-align:right">242</td>
<td style="text-align:right">17.8</td>
<td style="text-align:right">392.83</td>
<td style="text-align:right">4.03</td>
<td style="text-align:right">34.7</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">0.03237</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">2.18</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.458</td>
<td style="text-align:right">6.998</td>
<td style="text-align:right">45.8</td>
<td style="text-align:right">6.0622</td>
<td style="text-align:right">3</td>
<td style="text-align:right">222</td>
<td style="text-align:right">18.7</td>
<td style="text-align:right">394.63</td>
<td style="text-align:right">2.94</td>
<td style="text-align:right">33.4</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">0.06905</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">2.18</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.458</td>
<td style="text-align:right">7.147</td>
<td style="text-align:right">54.2</td>
<td style="text-align:right">6.0622</td>
<td style="text-align:right">3</td>
<td style="text-align:right">222</td>
<td style="text-align:right">18.7</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">5.33</td>
<td style="text-align:right">36.2</td>
</tr>
<tr>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
<td style="text-align:right">&hellip;</td>
</tr>
<tr>
<td style="text-align:right">501</td>
<td style="text-align:right">0.06263</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">11.93</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.573</td>
<td style="text-align:right">6.593</td>
<td style="text-align:right">69.1</td>
<td style="text-align:right">2.4786</td>
<td style="text-align:right">1</td>
<td style="text-align:right">273</td>
<td style="text-align:right">21.0</td>
<td style="text-align:right">391.99</td>
<td style="text-align:right">9.67</td>
<td style="text-align:right">22.4</td>
</tr>
<tr>
<td style="text-align:right">502</td>
<td style="text-align:right">0.04527</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">11.93</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.573</td>
<td style="text-align:right">6.120</td>
<td style="text-align:right">76.7</td>
<td style="text-align:right">2.2875</td>
<td style="text-align:right">1</td>
<td style="text-align:right">273</td>
<td style="text-align:right">21.0</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">9.08</td>
<td style="text-align:right">20.6</td>
</tr>
<tr>
<td style="text-align:right">503</td>
<td style="text-align:right">0.06076</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">11.93</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.573</td>
<td style="text-align:right">6.976</td>
<td style="text-align:right">91.0</td>
<td style="text-align:right">2.1675</td>
<td style="text-align:right">1</td>
<td style="text-align:right">273</td>
<td style="text-align:right">21.0</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">5.64</td>
<td style="text-align:right">23.9</td>
</tr>
<tr>
<td style="text-align:right">504</td>
<td style="text-align:right">0.10959</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">11.93</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.573</td>
<td style="text-align:right">6.794</td>
<td style="text-align:right">89.3</td>
<td style="text-align:right">2.3889</td>
<td style="text-align:right">1</td>
<td style="text-align:right">273</td>
<td style="text-align:right">21.0</td>
<td style="text-align:right">393.45</td>
<td style="text-align:right">6.48</td>
<td style="text-align:right">22.0</td>
</tr>
<tr>
<td style="text-align:right">505</td>
<td style="text-align:right">0.04741</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">11.93</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.573</td>
<td style="text-align:right">6.030</td>
<td style="text-align:right">80.8</td>
<td style="text-align:right">2.5050</td>
<td style="text-align:right">1</td>
<td style="text-align:right">273</td>
<td style="text-align:right">21.0</td>
<td style="text-align:right">396.90</td>
<td style="text-align:right">7.88</td>
<td style="text-align:right">11.9</td>
</tr>
</tbody>
</table>
<p>506 rows Ã— 14 columns</p>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">:</span> <span class="mi">506</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">505</span>
</span></span><span class="line"><span class="cl"><span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">14</span> <span class="n">columns</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"> <span class="c1">#   Column   Non-Null Count  Dtype  </span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>  <span class="o">------</span>   <span class="o">--------------</span>  <span class="o">-----</span>  
</span></span><span class="line"><span class="cl"> <span class="mi">0</span>   <span class="n">CRIM</span>     <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"> <span class="mi">1</span>   <span class="n">ZN</span>       <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"> <span class="mi">2</span>   <span class="n">INDUS</span>    <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"> <span class="mi">3</span>   <span class="n">CHAS</span>     <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">int64</span>  
</span></span><span class="line"><span class="cl"> <span class="mi">4</span>   <span class="n">NOX</span>      <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"> <span class="mi">5</span>   <span class="n">RM</span>       <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"> <span class="mi">6</span>   <span class="n">AGE</span>      <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"> <span class="mi">7</span>   <span class="n">DIS</span>      <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"> <span class="mi">8</span>   <span class="n">RAD</span>      <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">int64</span>  
</span></span><span class="line"><span class="cl"> <span class="mi">9</span>   <span class="n">TAX</span>      <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">int64</span>  
</span></span><span class="line"><span class="cl"> <span class="mi">10</span>  <span class="n">PTRATIO</span>  <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"> <span class="mi">11</span>  <span class="n">B</span>        <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"> <span class="mi">12</span>  <span class="n">LSTAT</span>    <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"> <span class="mi">13</span>  <span class="n">MEDV</span>     <span class="mi">506</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>    <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">55.5</span> <span class="n">KB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;MEDV&#34;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>      <span class="mf">24.0</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>      <span class="mf">21.6</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>      <span class="mf">34.7</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>      <span class="mf">33.4</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>      <span class="mf">36.2</span>
</span></span><span class="line"><span class="cl">       <span class="o">...</span> 
</span></span><span class="line"><span class="cl"><span class="mi">501</span>    <span class="mf">22.4</span>
</span></span><span class="line"><span class="cl"><span class="mi">502</span>    <span class="mf">20.6</span>
</span></span><span class="line"><span class="cl"><span class="mi">503</span>    <span class="mf">23.9</span>
</span></span><span class="line"><span class="cl"><span class="mi">504</span>    <span class="mf">22.0</span>
</span></span><span class="line"><span class="cl"><span class="mi">505</span>    <span class="mf">11.9</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">MEDV</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">506</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-ä½¿ç”¨matplotlibç”»ç›´æ–¹å›¾">2. ä½¿ç”¨matplotlibç”»ç›´æ–¹å›¾</h3>
<p>matplotlibç›´æ–¹å›¾æ–‡æ¡£ï¼šhttps://matplotlib.org/3.2.0/api/_as_gen/matplotlib.pyplot.hist.html</p>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;MEDV&#34;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/33.png" alt=""></p>
<h3 id="3-ä½¿ç”¨pyechartsç”»ç›´æ–¹å›¾">3. ä½¿ç”¨pyechartsç”»ç›´æ–¹å›¾</h3>
<p>pyechartsç›´æ–¹å›¾æ–‡æ¡£ï¼šhttp://gallery.pyecharts.org/#/Bar/bar_histogram
numpyç›´æ–¹å›¾æ–‡æ¡£ï¼šhttps://docs.scipy.org/doc/numpy/reference/generated/numpy.histogram.html</p>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyecharts</span> <span class="kn">import</span> <span class="n">options</span> <span class="k">as</span> <span class="n">opts</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyecharts.charts</span> <span class="kn">import</span> <span class="n">Bar</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># éœ€è¦è‡ªå·±è®¡ç®—æœ‰å¤šå°‘ä¸ªé—´éš”ã€ä»¥åŠæ¯ä¸ªé—´éš”æœ‰å¤šå°‘ä¸ªå€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">hist</span><span class="p">,</span><span class="n">bin_edges</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;MEDV&#34;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># è¿™æ˜¯æ¯ä¸ªé—´éš”çš„åˆ†å‰²ç‚¹</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_edges</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">array</span><span class="p">([</span> <span class="mf">5.</span>  <span class="p">,</span>  <span class="mf">5.45</span><span class="p">,</span>  <span class="mf">5.9</span> <span class="p">,</span>  <span class="mf">6.35</span><span class="p">,</span>  <span class="mf">6.8</span> <span class="p">,</span>  <span class="mf">7.25</span><span class="p">,</span>  <span class="mf">7.7</span> <span class="p">,</span>  <span class="mf">8.15</span><span class="p">,</span>  <span class="mf">8.6</span> <span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mf">9.05</span><span class="p">,</span>  <span class="mf">9.5</span> <span class="p">,</span>  <span class="mf">9.95</span><span class="p">,</span> <span class="mf">10.4</span> <span class="p">,</span> <span class="mf">10.85</span><span class="p">,</span> <span class="mf">11.3</span> <span class="p">,</span> <span class="mf">11.75</span><span class="p">,</span> <span class="mf">12.2</span> <span class="p">,</span> <span class="mf">12.65</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">13.1</span> <span class="p">,</span> <span class="mf">13.55</span><span class="p">,</span> <span class="mf">14.</span>  <span class="p">,</span> <span class="mf">14.45</span><span class="p">,</span> <span class="mf">14.9</span> <span class="p">,</span> <span class="mf">15.35</span><span class="p">,</span> <span class="mf">15.8</span> <span class="p">,</span> <span class="mf">16.25</span><span class="p">,</span> <span class="mf">16.7</span> <span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">17.15</span><span class="p">,</span> <span class="mf">17.6</span> <span class="p">,</span> <span class="mf">18.05</span><span class="p">,</span> <span class="mf">18.5</span> <span class="p">,</span> <span class="mf">18.95</span><span class="p">,</span> <span class="mf">19.4</span> <span class="p">,</span> <span class="mf">19.85</span><span class="p">,</span> <span class="mf">20.3</span> <span class="p">,</span> <span class="mf">20.75</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">21.2</span> <span class="p">,</span> <span class="mf">21.65</span><span class="p">,</span> <span class="mf">22.1</span> <span class="p">,</span> <span class="mf">22.55</span><span class="p">,</span> <span class="mf">23.</span>  <span class="p">,</span> <span class="mf">23.45</span><span class="p">,</span> <span class="mf">23.9</span> <span class="p">,</span> <span class="mf">24.35</span><span class="p">,</span> <span class="mf">24.8</span> <span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">25.25</span><span class="p">,</span> <span class="mf">25.7</span> <span class="p">,</span> <span class="mf">26.15</span><span class="p">,</span> <span class="mf">26.6</span> <span class="p">,</span> <span class="mf">27.05</span><span class="p">,</span> <span class="mf">27.5</span> <span class="p">,</span> <span class="mf">27.95</span><span class="p">,</span> <span class="mf">28.4</span> <span class="p">,</span> <span class="mf">28.85</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">29.3</span> <span class="p">,</span> <span class="mf">29.75</span><span class="p">,</span> <span class="mf">30.2</span> <span class="p">,</span> <span class="mf">30.65</span><span class="p">,</span> <span class="mf">31.1</span> <span class="p">,</span> <span class="mf">31.55</span><span class="p">,</span> <span class="mf">32.</span>  <span class="p">,</span> <span class="mf">32.45</span><span class="p">,</span> <span class="mf">32.9</span> <span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">33.35</span><span class="p">,</span> <span class="mf">33.8</span> <span class="p">,</span> <span class="mf">34.25</span><span class="p">,</span> <span class="mf">34.7</span> <span class="p">,</span> <span class="mf">35.15</span><span class="p">,</span> <span class="mf">35.6</span> <span class="p">,</span> <span class="mf">36.05</span><span class="p">,</span> <span class="mf">36.5</span> <span class="p">,</span> <span class="mf">36.95</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">37.4</span> <span class="p">,</span> <span class="mf">37.85</span><span class="p">,</span> <span class="mf">38.3</span> <span class="p">,</span> <span class="mf">38.75</span><span class="p">,</span> <span class="mf">39.2</span> <span class="p">,</span> <span class="mf">39.65</span><span class="p">,</span> <span class="mf">40.1</span> <span class="p">,</span> <span class="mf">40.55</span><span class="p">,</span> <span class="mf">41.</span>  <span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">41.45</span><span class="p">,</span> <span class="mf">41.9</span> <span class="p">,</span> <span class="mf">42.35</span><span class="p">,</span> <span class="mf">42.8</span> <span class="p">,</span> <span class="mf">43.25</span><span class="p">,</span> <span class="mf">43.7</span> <span class="p">,</span> <span class="mf">44.15</span><span class="p">,</span> <span class="mf">44.6</span> <span class="p">,</span> <span class="mf">45.05</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">45.5</span> <span class="p">,</span> <span class="mf">45.95</span><span class="p">,</span> <span class="mf">46.4</span> <span class="p">,</span> <span class="mf">46.85</span><span class="p">,</span> <span class="mf">47.3</span> <span class="p">,</span> <span class="mf">47.75</span><span class="p">,</span> <span class="mf">48.2</span> <span class="p">,</span> <span class="mf">48.65</span><span class="p">,</span> <span class="mf">49.1</span> <span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">49.55</span><span class="p">,</span> <span class="mf">50.</span>  <span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">len</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">101</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># è¿™æ˜¯é—´éš”çš„è®¡æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">hist</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mi">19</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">5</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">len</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">100</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å¯¹bin_edgesçš„è§£é‡Šä¸ºä»€ä¹ˆæ˜¯101ä¸ªæ¯”histè®¡æ•°å¤š1ä¸ª">å¯¹bin_edgesçš„è§£é‡Šï¼Œä¸ºä»€ä¹ˆæ˜¯101ä¸ªï¼Ÿæ¯”histè®¡æ•°å¤š1ä¸ªï¼Ÿ</h4>
<p>ä¸¾ä¾‹ï¼šå¦‚æœbinsæ˜¯[1, 2, 3, 4]ï¼Œé‚£ä¹ˆä¼šåˆ†æˆ3ä¸ªåŒºé—´ï¼š[1, 2)ã€[2, 3)ã€[3, 4]ï¼›
å…¶ä¸­binsçš„ç¬¬ä¸€ä¸ªå€¼æ˜¯æ•°ç»„çš„æœ€å°å€¼ï¼Œbinsçš„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯æ•°ç»„çš„æœ€å¤§å€¼</p>
<p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ³¨æ„è§‚å¯Ÿï¼Œminæ˜¯binsçš„ç¬¬ä¸€ä¸ªå€¼ï¼Œmaxæ˜¯binsçš„æœ€åä¸€ä¸ªå…ƒç´ </span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;MEDV&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">count</span>    <span class="mf">506.000000</span>
</span></span><span class="line"><span class="cl"><span class="n">mean</span>      <span class="mf">22.532806</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span>        <span class="mf">9.197104</span>
</span></span><span class="line"><span class="cl"><span class="nb">min</span>        <span class="mf">5.000000</span>
</span></span><span class="line"><span class="cl"><span class="mi">25</span><span class="o">%</span>       <span class="mf">17.025000</span>
</span></span><span class="line"><span class="cl"><span class="mi">50</span><span class="o">%</span>       <span class="mf">21.200000</span>
</span></span><span class="line"><span class="cl"><span class="mi">75</span><span class="o">%</span>       <span class="mf">25.000000</span>
</span></span><span class="line"><span class="cl"><span class="nb">max</span>       <span class="mf">50.000000</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">MEDV</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># æŸ¥çœ‹binsæ¯ä¸€ä¸ªå€¼å’Œå‰ä¸€ä¸ªå€¼çš„å·®å€¼ï¼Œå¯ä»¥çœ‹åˆ°è¿™æ˜¯ç­‰åˆ†çš„æ•°æ®
</span></span><span class="line"><span class="cl">np.diff(bin_edges)
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">array</span><span class="p">([</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="mf">0.45</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># è¿™äº›é—´éš”çš„æ•°ç›®ï¼Œåˆšå¥½ç­‰äºè®¡æ•°histçš„æ•°ç›®</span>
</span></span><span class="line"><span class="cl"><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">100</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># pyechartsçš„ç›´æ–¹å›¾ä½¿ç”¨barå®ç°</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å–bins[:-1]ï¼Œæ„æ€æ˜¯ç”¨æ¯ä¸ªåŒºé—´çš„å·¦è¾¹å…ƒç´ ä½œä¸ºxè½´çš„å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">bar</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">Bar</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">add_xaxis</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">add_yaxis</span><span class="p">(</span><span class="s2">&#34;ä»·æ ¼åˆ†å¸ƒ&#34;</span><span class="p">,</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">hist</span><span class="p">],</span> <span class="n">category_gap</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">set_global_opts</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">title_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TitleOpts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;æ³¢æ–¯é¡¿æˆ¿ä»·-ä»·æ ¼åˆ†å¸ƒ-ç›´æ–¹å›¾&#34;</span><span class="p">,</span> <span class="n">pos_left</span><span class="o">=</span><span class="s2">&#34;center&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">legend_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">LegendOpts</span><span class="p">(</span><span class="n">is_show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">bar</span><span class="o">.</span><span class="n">render_notebook</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="42pythonå¤„ç†excelä¸€åˆ—å˜å¤šåˆ—">42ã€Pythonå¤„ç†Excelä¸€åˆ—å˜å¤šåˆ—</h1>
<h3 id="1-è¯»å–æ•°æ®-1">1. è¯»å–æ•°æ®</h3>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&#34;./course_datas/c42_split_onecolumn_tomany/å­¦ç”Ÿæ•°æ®è¡¨.xlsx&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">æ•°æ®</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ:å¥³:23:å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…:å¥³:25:æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•:å¥³:23:æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“:å¥³:19:é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš:å¥³:24:å±±ä¸œ</td>
</tr>
</tbody>
</table>
<h3 id="2-å®ç°æ‹†åˆ†">2. å®ç°æ‹†åˆ†</h3>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">split_func</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">line</span><span class="p">[</span><span class="s2">&#34;å§“å&#34;</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="s2">&#34;æ€§åˆ«&#34;</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="s2">&#34;å¹´é¾„&#34;</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="s2">&#34;åŸå¸‚&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s2">&#34;æ•°æ®&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">line</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">split_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">æ•°æ®</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
<th style="text-align:right">å¹´é¾„</th>
<th style="text-align:right">åŸå¸‚</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ:å¥³:23:å±±ä¸œ</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…:å¥³:25:æ²³å—</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">25</td>
<td style="text-align:right">æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•:å¥³:23:æ¹–åŒ—</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“:å¥³:19:é™•è¥¿</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">19</td>
<td style="text-align:right">é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš:å¥³:24:å±±ä¸œ</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">24</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
</tbody>
</table>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&#34;æ•°æ®&#34;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å­¦å·</th>
<th style="text-align:right">å§“å</th>
<th style="text-align:right">æ€§åˆ«</th>
<th style="text-align:right">å¹´é¾„</th>
<th style="text-align:right">åŸå¸‚</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">S001</td>
<td style="text-align:right">æ€ æ¶µ</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">S002</td>
<td style="text-align:right">å©‰æ¸…</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">25</td>
<td style="text-align:right">æ²³å—</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">S003</td>
<td style="text-align:right">æºªæ¦•</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">23</td>
<td style="text-align:right">æ¹–åŒ—</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">S004</td>
<td style="text-align:right">æ¼ æ¶“</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">19</td>
<td style="text-align:right">é™•è¥¿</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">S005</td>
<td style="text-align:right">ç¥ˆåš</td>
<td style="text-align:right">å¥³</td>
<td style="text-align:right">24</td>
<td style="text-align:right">å±±ä¸œ</td>
</tr>
</tbody>
</table>
<h3 id="3-è¾“å‡ºåˆ°ç»“æœexcel">3. è¾“å‡ºåˆ°ç»“æœExcel</h3>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&#34;./course_datas/c42_split_onecolumn_tomany/å­¦ç”Ÿæ•°æ®è¡¨_æ‹†åˆ†å.xlsx&#34;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="43pandasæŸ¥è¯¢æ•°æ®çš„ç®€ä¾¿æ–¹æ³•dfquery">43ã€PandasæŸ¥è¯¢æ•°æ®çš„ç®€ä¾¿æ–¹æ³•df.query</h1>
<p>æ€æ ·è¿›è¡Œå¤æ‚ç»„åˆæ¡ä»¶å¯¹æ•°æ®æŸ¥è¯¢ï¼š</p>
<ul>
<li>æ–¹å¼1. ä½¿ç”¨df[(df[&ldquo;a&rdquo;] &gt; 3) &amp; (df[&ldquo;b&rdquo;]&lt;5)]çš„æ–¹å¼ï¼›</li>
<li>æ–¹å¼2. ä½¿ç”¨df.query(&ldquo;a&gt;3 &amp; b&lt;5&rdquo;)çš„æ–¹å¼ï¼›</li>
</ul>
<p>æ–¹æ³•2çš„è¯­æ³•æ›´åŠ ç®€æ´</p>
<p>æ€§èƒ½å¯¹æ¯”ï¼š</p>
<ul>
<li>å½“æ•°æ®é‡å°æ—¶ï¼Œæ–¹æ³•1æ›´å¿«ï¼›</li>
<li>å½“æ•°æ®é‡å¤§æ—¶ï¼Œå› ä¸ºæ–¹æ³•2ç›´æ¥ç”¨Cè¯­è¨€å®ç°ï¼ŒèŠ‚çœæ–¹æ³•1ä¸´æ—¶æ•°ç»„çš„å¤šæ¬¡å¤åˆ¶ï¼Œæ–¹æ³•2æ›´å¿«ï¼›</li>
</ul>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mf">1.0.1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="0è¯»å–æ•°æ®">0ã€è¯»å–æ•°æ®</h3>
<p>æ•°æ®ä¸ºåŒ—äº¬2018å¹´å…¨å¹´å¤©æ°”é¢„æŠ¥</p>
<p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3â„ƒ</td>
<td style="text-align:right">-6â„ƒ</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2â„ƒ</td>
<td style="text-align:right">-5â„ƒ</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2â„ƒ</td>
<td style="text-align:right">-5â„ƒ</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0â„ƒ</td>
<td style="text-align:right">-8â„ƒ</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3â„ƒ</td>
<td style="text-align:right">-6â„ƒ</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ›¿æ¢æ‰æ¸©åº¦çš„åç¼€â„ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&#34;bWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&#34;yWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;yWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="1ä½¿ç”¨dataframeæ¡ä»¶è¡¨è¾¾å¼æŸ¥è¯¢">1ã€ä½¿ç”¨dataframeæ¡ä»¶è¡¨è¾¾å¼æŸ¥è¯¢</h3>
<h4 id="æœ€ä½æ¸©åº¦ä½äº-10åº¦çš„åˆ—è¡¨">æœ€ä½æ¸©åº¦ä½äº-10åº¦çš„åˆ—è¡¨</h4>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;yWendu&#34;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">22</td>
<td style="text-align:right">2018-01-23</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">31</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">23</td>
<td style="text-align:right">2018-01-24</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">-11</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">34</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">24</td>
<td style="text-align:right">2018-01-25</td>
<td style="text-align:right">-3</td>
<td style="text-align:right">-11</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">27</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">359</td>
<td style="text-align:right">2018-12-26</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">-11</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">2çº§</td>
<td style="text-align:right">26</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">360</td>
<td style="text-align:right">2018-12-27</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">3çº§</td>
<td style="text-align:right">48</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h4 id="å¤æ‚æ¡ä»¶æŸ¥è¯¢">å¤æ‚æ¡ä»¶æŸ¥è¯¢</h4>
<p>æ³¨æ„ï¼Œç»„åˆæ¡ä»¶ç”¨&amp;ç¬¦å·åˆå¹¶ï¼Œæ¯ä¸ªæ¡ä»¶åˆ¤æ–­éƒ½å¾—å¸¦æ‹¬å·</p>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æŸ¥è¯¢æœ€é«˜æ¸©åº¦å°äº30åº¦ï¼Œå¹¶ä¸”æœ€ä½æ¸©åº¦å¤§äº15åº¦ï¼Œå¹¶ä¸”æ˜¯æ™´å¤©ï¼Œå¹¶ä¸”å¤©æ°”ä¸ºä¼˜çš„æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">30</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;yWendu&#34;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">15</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;tianqi&#34;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;æ™´&#39;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;aqiLevel&#34;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">235</td>
<td style="text-align:right">2018-08-24</td>
<td style="text-align:right">30</td>
<td style="text-align:right">20</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">40</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">249</td>
<td style="text-align:right">2018-09-07</td>
<td style="text-align:right">27</td>
<td style="text-align:right">16</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">22</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h3 id="2ä½¿ç”¨dfqueryå¯ä»¥ç®€åŒ–æŸ¥è¯¢">2ã€ä½¿ç”¨df.queryå¯ä»¥ç®€åŒ–æŸ¥è¯¢</h3>
<p>å½¢å¼ï¼šDataFrame.query(expr, inplace=False, **kwargs)</p>
<p>å…¶ä¸­exprä¸ºè¦è¿”å›booleanç»“æœçš„å­—ç¬¦ä¸²è¡¨è¾¾å¼</p>
<p>å½¢å¦‚ï¼š</p>
<ul>
<li>df.query(&lsquo;a&lt;100&rsquo;)</li>
<li>df.query(&lsquo;a &lt; b &amp; b &lt; c&rsquo;)ï¼Œæˆ–è€…df.query(&rsquo;(a&lt;b)&amp;(b&lt;c)&rsquo;)</li>
</ul>
<p>df.queryå¯æ”¯æŒçš„è¡¨è¾¾å¼è¯­æ³•ï¼š</p>
<ul>
<li>é€»è¾‘æ“ä½œç¬¦: &amp;, |, ~</li>
<li>æ¯”è¾ƒæ“ä½œç¬¦: &lt;, &lt;=, ==, !=, &gt;=, &gt;</li>
<li>å•å˜é‡æ“ä½œç¬¦: -</li>
<li>å¤šå˜é‡æ“ä½œç¬¦: +, -, *, /, %</li>
</ul>
<p>df.queryä¸­å¯ä»¥ä½¿ç”¨@varçš„æ–¹å¼ä¼ å…¥å¤–éƒ¨å˜é‡</p>
<p>df.queryæ”¯æŒçš„è¯­æ³•æ¥è‡ªNumExprï¼Œåœ°å€ï¼š
<a href="https://numexpr.readthedocs.io/projects/NumExpr3/en/latest/index.html">https://numexpr.readthedocs.io/projects/NumExpr3/en/latest/index.html</a></p>
<h4 id="æŸ¥è¯¢æœ€ä½æ¸©åº¦ä½äº-10åº¦çš„åˆ—è¡¨">æŸ¥è¯¢æœ€ä½æ¸©åº¦ä½äº-10åº¦çš„åˆ—è¡¨</h4>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;yWendu &lt; 3&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h4 id="æŸ¥è¯¢æœ€é«˜æ¸©åº¦å°äº30åº¦å¹¶ä¸”æœ€ä½æ¸©åº¦å¤§äº15åº¦å¹¶ä¸”æ˜¯æ™´å¤©å¹¶ä¸”å¤©æ°”ä¸ºä¼˜çš„æ•°æ®">æŸ¥è¯¢æœ€é«˜æ¸©åº¦å°äº30åº¦ï¼Œå¹¶ä¸”æœ€ä½æ¸©åº¦å¤§äº15åº¦ï¼Œå¹¶ä¸”æ˜¯æ™´å¤©ï¼Œå¹¶ä¸”å¤©æ°”ä¸ºä¼˜çš„æ•°æ®</h4>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æŸ¥è¯¢æœ€é«˜æ¸©åº¦å°äº30åº¦ï¼Œå¹¶ä¸”æœ€ä½æ¸©åº¦å¤§äº15åº¦ï¼Œå¹¶ä¸”æ˜¯æ™´å¤©ï¼Œå¹¶ä¸”å¤©æ°”ä¸ºä¼˜çš„æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;bWendu&lt;=30 &amp; yWendu&gt;=15 &amp; tianqi==&#39;æ™´&#39; &amp; aqiLevel==1&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">235</td>
<td style="text-align:right">2018-08-24</td>
<td style="text-align:right">30</td>
<td style="text-align:right">20</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">40</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">249</td>
<td style="text-align:right">2018-09-07</td>
<td style="text-align:right">27</td>
<td style="text-align:right">16</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">22</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h4 id="æŸ¥è¯¢æ¸©å·®å¤§äº15åº¦çš„æ—¥å­">æŸ¥è¯¢æ¸©å·®å¤§äº15åº¦çš„æ—¥å­</h4>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;bWendu-yWendu &gt;= 15&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">68</td>
<td style="text-align:right">2018-03-10</td>
<td style="text-align:right">14</td>
<td style="text-align:right">-2</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">ä¸œå—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">171</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">82</td>
<td style="text-align:right">2018-03-24</td>
<td style="text-align:right">22</td>
<td style="text-align:right">5</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">119</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">83</td>
<td style="text-align:right">2018-03-25</td>
<td style="text-align:right">24</td>
<td style="text-align:right">7</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">78</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">84</td>
<td style="text-align:right">2018-03-26</td>
<td style="text-align:right">25</td>
<td style="text-align:right">7</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">151</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">85</td>
<td style="text-align:right">2018-03-27</td>
<td style="text-align:right">27</td>
<td style="text-align:right">11</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">243</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“</td>
<td style="text-align:right">5</td>
</tr>
</tbody>
</table>
<h4 id="å¯ä»¥ä½¿ç”¨å¤–éƒ¨çš„å˜é‡">å¯ä»¥ä½¿ç”¨å¤–éƒ¨çš„å˜é‡</h4>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æŸ¥è¯¢æ¸©åº¦åœ¨è¿™ä¸¤ä¸ªæ¸©åº¦ä¹‹é—´çš„æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">high_temperature</span> <span class="o">=</span> <span class="mi">15</span>
</span></span><span class="line"><span class="cl"><span class="n">low_temperature</span> <span class="o">=</span> <span class="mi">13</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;yWendu&lt;=@high_temperature &amp; yWendu&gt;=@low_temperature&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">107</td>
<td style="text-align:right">2018-04-18</td>
<td style="text-align:right">27</td>
<td style="text-align:right">14</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">147</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">108</td>
<td style="text-align:right">2018-04-19</td>
<td style="text-align:right">26</td>
<td style="text-align:right">13</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">ä¸œå—é£</td>
<td style="text-align:right">4-5çº§</td>
<td style="text-align:right">170</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">109</td>
<td style="text-align:right">2018-04-20</td>
<td style="text-align:right">28</td>
<td style="text-align:right">14</td>
<td style="text-align:right">å¤šäº‘~å°é›¨</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">4-5çº§</td>
<td style="text-align:right">164</td>
<td style="text-align:right">ä¸­åº¦æ±¡æŸ“</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">116</td>
<td style="text-align:right">2018-04-27</td>
<td style="text-align:right">25</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">112</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">119</td>
<td style="text-align:right">2018-04-30</td>
<td style="text-align:right">24</td>
<td style="text-align:right">14</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">3-4çº§</td>
<td style="text-align:right">62</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
</tbody>
</table>
<h1 id="44pandasæŒ‰è¡Œéå†dataframeçš„3ç§æ–¹æ³•">44ã€PandasæŒ‰è¡Œéå†DataFrameçš„3ç§æ–¹æ³•</h1>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">collections</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> 
</span></span><span class="line"><span class="cl">    <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0.329292</td>
<td style="text-align:right">0.975468</td>
<td style="text-align:right">0.133584</td>
<td style="text-align:right">0.224582</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">0.535746</td>
<td style="text-align:right">0.451585</td>
<td style="text-align:right">0.713250</td>
<td style="text-align:right">0.409770</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">0.735287</td>
<td style="text-align:right">0.667472</td>
<td style="text-align:right">0.950622</td>
<td style="text-align:right">0.245938</td>
</tr>
</tbody>
</table>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="1-dfiterrows">1. df.iterrows()</h3>
<h4 id="ä½¿ç”¨æ–¹å¼">ä½¿ç”¨æ–¹å¼</h4>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&#34;B&#34;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&#34;C&#34;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&#34;D&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="mi">0</span> <span class="n">A</span>    <span class="mf">0.329292</span>
</span></span><span class="line"><span class="cl"><span class="n">B</span>    <span class="mf">0.975468</span>
</span></span><span class="line"><span class="cl"><span class="n">C</span>    <span class="mf">0.133584</span>
</span></span><span class="line"><span class="cl"><span class="n">D</span>    <span class="mf">0.224582</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="mi">0</span> <span class="mf">0.3292915092119043</span> <span class="mf">0.9754683984716609</span> <span class="mf">0.1335841433264423</span> <span class="mf">0.22458227907355865</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ—¶é—´è€—è´¹">æ—¶é—´è€—è´¹</h4>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">%%</span><span class="n">time</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="p">[(</span><span class="n">row</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&#34;B&#34;</span><span class="p">])]</span> <span class="o">+=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s2">&#34;B&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mf">7.82</span> <span class="n">s</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mf">35.6</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mf">7.85</span> <span class="n">s</span>
</span></span><span class="line"><span class="cl"><span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">7.89</span> <span class="n">s</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-dfitertuples">2. df.itertuples()</h3>
<h4 id="ä½¿ç”¨æ–¹å¼-1">ä½¿ç”¨æ–¹å¼</h4>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="n">Pandas</span><span class="p">(</span><span class="n">Index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mf">0.3292915092119043</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mf">0.9754683984716609</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.1335841433264423</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="mf">0.22458227907355865</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">0</span> <span class="mf">0.3292915092119043</span> <span class="mf">0.9754683984716609</span> <span class="mf">0.1335841433264423</span> <span class="mf">0.22458227907355865</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ—¶é—´è€—è´¹-1">æ—¶é—´è€—è´¹</h4>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">%%</span><span class="n">time</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="p">[(</span><span class="n">row</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">B</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">row</span><span class="o">.</span><span class="n">A</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">B</span>
</span></span><span class="line"><span class="cl"><span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mi">168</span> <span class="n">ms</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mf">8.35</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mi">177</span> <span class="n">ms</span>
</span></span><span class="line"><span class="cl"><span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mi">178</span> <span class="n">ms</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-forzip">3. for+zip</h3>
<h4 id="ä½¿ç”¨æ–¹å¼-2">ä½¿ç”¨æ–¹å¼</h4>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ—¢ä¸éœ€è¦ç±»å‹æ£€æŸ¥ï¼Œä¹Ÿä¸éœ€è¦æ„å»ºnamedtuple</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç¼ºç‚¹æ˜¯éœ€è¦æŒ¨ä¸ªæŒ‡å®šå˜é‡</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;B&#34;</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="mf">0.3292915092119043</span> <span class="mf">0.9754683984716609</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ—¶é—´è€—è´¹-2">æ—¶é—´è€—è´¹</h4>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">%%</span><span class="n">time</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;B&#34;</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="p">[(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
</span></span><span class="line"><span class="cl"><span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mf">82.2</span> <span class="n">ms</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mf">7.05</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mf">89.2</span> <span class="n">ms</span>
</span></span><span class="line"><span class="cl"><span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">89.9</span> <span class="n">ms</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="45pandaså®ç°æ¨¡ç³ŠåŒ¹é…mergeæ•°æ®çš„æ–¹æ³•">45ã€Pandaså®ç°æ¨¡ç³ŠåŒ¹é…Mergeæ•°æ®çš„æ–¹æ³•</h1>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="1-ä¸¤ä»½æ•°æ®">1. ä¸¤ä»½æ•°æ®</h3>
<p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å…³é”®è¯æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">df_keyword</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;keyid&#34;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;keyword&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;numpy&#34;</span><span class="p">,</span> <span class="s2">&#34;pandas&#34;</span><span class="p">,</span> <span class="s2">&#34;matplotlib&#34;</span><span class="p">,</span> <span class="s2">&#34;sklearn&#34;</span><span class="p">,</span> <span class="s2">&#34;tensorflow&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">df_keyword</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">keyid</th>
<th style="text-align:right">keyword</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
</tr>
</tbody>
</table>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å¥å­æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">df_sentence</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;senid&#34;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;sentence&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Tensorflowå’ŒNumpyçš„å…³ç³»&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç &#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">df_sentence</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
</tbody>
</table>
<h3 id="æ–¹æ³•1æš´åŠ›ç¬›å¡å°”ç§¯--è¿‡æ»¤">æ–¹æ³•1ï¼šæš´åŠ›ç¬›å¡å°”ç§¯ + è¿‡æ»¤</h3>
<h4 id="æ–°å¢æ•°å­—å®Œå…¨ä¸€æ ·çš„åˆ—">æ–°å¢æ•°å­—å®Œå…¨ä¸€æ ·çš„åˆ—</h4>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_keyword</span><span class="p">[</span><span class="s2">&#34;match&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">df_sentence</span><span class="p">[</span><span class="s2">&#34;match&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_keyword</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">keyid</th>
<th style="text-align:right">keyword</th>
<th style="text-align:right">match</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_sentence</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
<th style="text-align:right">match</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<h4 id="å®ç°merge">å®ç°merge</h4>
<p>ç»“æœè¡Œæ•° = Aè¡¨è¡Œæ•° * Bè¡¨è¡Œæ•°</p>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_keyword</span><span class="p">,</span> <span class="n">df_sentence</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_merge</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">keyid</th>
<th style="text-align:right">keyword</th>
<th style="text-align:right">match</th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">12</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">13</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:right">14</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">15</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">16</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">17</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">18</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">19</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">20</td>
<td style="text-align:right">2</td>
<td style="text-align:right">matplotlib</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:right">21</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">22</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">23</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">24</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">25</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">26</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">27</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:right">28</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">29</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">30</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">31</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">32</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">33</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">34</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
</tbody>
</table>
<h4 id="è¿‡æ»¤å‡ºç»“æœ">è¿‡æ»¤å‡ºç»“æœ</h4>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">match_func</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&#34;keyword&#34;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&#34;sentence&#34;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df_merge</span><span class="p">[</span><span class="n">df_merge</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">match_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">keyid</th>
<th style="text-align:right">keyword</th>
<th style="text-align:right">match</th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
</tr>
<tr>
<td style="text-align:right">27</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:right">32</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
</tr>
<tr>
<td style="text-align:right">33</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
</tr>
</tbody>
</table>
<h3 id="æ–¹æ³•2å°è¡¨å˜å­—å…¸åšmergeæœ€åexplode">æ–¹æ³•2ï¼šå°è¡¨å˜å­—å…¸åšmergeæœ€åexplode</h3>
<h4 id="æ„å»ºè¦joinçš„keyindexçš„å…³ç³»">æ„å»ºè¦joinçš„key:indexçš„å…³ç³»</h4>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">key_word_dict</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">row</span><span class="o">.</span><span class="n">keyword</span> <span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">keyid</span> 
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_keyword</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">key_word_dict</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{</span><span class="s1">&#39;numpy&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;matplotlib&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;sklearn&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;tensorflow&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å¤§è¡¨æœå¯»å°è¡¨å­—å…¸">å¤§è¡¨æœå¯»å°è¡¨å­—å…¸</h4>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">merge_func</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ–°å¢ä¸€åˆ—ï¼Œè¡¨ç¤ºèƒ½åŒ¹é…çš„keyids</span>
</span></span><span class="line"><span class="cl">    <span class="n">row</span><span class="p">[</span><span class="s2">&#34;keyids&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="n">keyid</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">key_word</span><span class="p">,</span> <span class="n">keyid</span> <span class="ow">in</span> <span class="n">key_word_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">key_word</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&#34;sentence&#34;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">row</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df_merge</span> <span class="o">=</span> <span class="n">df_sentence</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">merge_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
<th style="text-align:right">match</th>
<th style="text-align:right">keyids</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[1]</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[0]</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[1]</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[1]</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[4]</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
<td style="text-align:right">[0, 4]</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
<td style="text-align:right">1</td>
<td style="text-align:right">[3]</td>
</tr>
</tbody>
</table>
<h4 id="å±•å¼€ç„¶ååšmerge">å±•å¼€ç„¶ååšmerge</h4>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merge</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&#34;keyids&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
<th style="text-align:right">match</th>
<th style="text-align:right">keyids</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">left</span> <span class="o">=</span> <span class="n">df_merge</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&#34;keyids&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">right</span> <span class="o">=</span> <span class="n">df_keyword</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">left_on</span> <span class="o">=</span> <span class="s2">&#34;keyids&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">right_on</span> <span class="o">=</span> <span class="s2">&#34;keyid&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_result</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">senid</th>
<th style="text-align:right">sentence</th>
<th style="text-align:right">match_x</th>
<th style="text-align:right">keyids</th>
<th style="text-align:right">keyid</th>
<th style="text-align:right">keyword</th>
<th style="text-align:right">match_y</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">10</td>
<td style="text-align:right">æ€æ ·ç”¨Pandaså®ç°æ•°æ®çš„Mergeï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasæ‰¹é‡æ‹†åˆ†ä¸åˆå¹¶Excelæ–‡ä»¶ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">æ€æ ·ä½¿ç”¨Pandasçš„mapå’Œapplyå‡½æ•°ï¼Ÿ</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">pandas</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">11</td>
<td style="text-align:right">Pythonä¹‹Numpyè¯¦ç»†æ•™ç¨‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">numpy</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">14</td>
<td style="text-align:right">æ·±åº¦å­¦ä¹ åŠTensorFlowç®€ä»‹</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">15</td>
<td style="text-align:right">Tensorflowå’ŒNumpyçš„å…³ç³»</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
<td style="text-align:right">tensorflow</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">16</td>
<td style="text-align:right">åŸºäºsklearnçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ä»£ç </td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">sklearn</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">æ–‡ç« ä½œè€…</span>
    <span class="item-content">yuanshuai</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">ä¸Šæ¬¡æ›´æ–°</span>
    <span class="item-content">
        0001-01-01
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/yuanshuai1122.github.io/tags/python/">Python</a>
          <a href="/yuanshuai1122.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">æ•°æ®åˆ†æ</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E5%9B%9B-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E5%9B%9B/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆå››ï¼‰</span>
            <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
          </a>
        <a class="next" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%80-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%80/">
            <span class="next-text nav-default">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆä¸€ï¼‰</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="http://localhost:1313" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="http://localhost:1313" class="iconfont icon-twitter" title="twitter"></a>
      <a href="http://localhost:1313" class="iconfont icon-facebook" title="facebook"></a>
      <a href="http://localhost:1313" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="http://localhost:1313" class="iconfont icon-google" title="google"></a>
      <a href="http://localhost:1313" class="iconfont icon-github" title="github"></a>
      <a href="http://localhost:1313" class="iconfont icon-weibo" title="weibo"></a>
      <a href="http://localhost:1313" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="http://localhost:1313" class="iconfont icon-douban" title="douban"></a>
      <a href="http://localhost:1313" class="iconfont icon-pocket" title="pocket"></a>
      <a href="http://localhost:1313" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="http://localhost:1313" class="iconfont icon-instagram" title="instagram"></a>
      <a href="http://localhost:1313" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="http://localhost:1313" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="yuanshuai1122.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://gohugo.io">Hugo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>yuanshuai</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js" integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js" integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin="anonymous"></script>
  <script>
    var languageCode = "zh-cn".replace(/-/g, '_').replace(/_(.*)/, function ($0, $1) {return $0.replace($1, $1.toUpperCase());});
    timeago().render(document.querySelectorAll('.timeago'), languageCode);
    timeago.cancel();  
  </script>



<script type="text/javascript" src="/yuanshuai1122.github.io/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
