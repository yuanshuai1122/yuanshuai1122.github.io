<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäºŒï¼‰ - ğŸ§€ - ä½ å¥½</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="yuanshuai" /><meta name="description" content=": | &amp;mdash;&amp;mdash;&amp;mdash;: | &amp;mdash;&amp;ndash;: | &amp;mdash;&amp;ndash;: | &amp;mdash;&amp;mdash;: | &amp;mdash;&amp;mdash;&amp;ndash;: | &amp;mdash;&amp;ndash;: | &amp;mdash;: | &amp;mdash;&amp;mdash;: | &amp;mdash;&amp;mdash;-: | | 0 | 2018-01-01 | 3â„ƒ | -6â„ƒ | æ™´~å¤šäº‘ | ä¸œåŒ—é£ | 1-2çº§ | 59 | è‰¯ | 2 | | 1 | 2018-01-02 | 2â„ƒ | -5â„ƒ | é˜´~å¤šäº‘ | ä¸œ" /><meta name="keywords" content="blog, yuanshuai, yyss" />






<meta name="generator" content="Hugo 0.119.0 with theme even" />


<link rel="canonical" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C/" />
<link rel="apple-touch-icon" sizes="180x180" href="/yuanshuai1122.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/yuanshuai1122.github.io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/yuanshuai1122.github.io/favicon-16x16.png">
<link rel="manifest" href="/yuanshuai1122.github.io/manifest.json">
<link rel="mask-icon" href="/yuanshuai1122.github.io/safari-pinned-tab.svg" color="#5bbad5">



<link href="/yuanshuai1122.github.io/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäºŒï¼‰" />
<meta property="og:description" content=": | &mdash;&mdash;&mdash;: | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;: | &mdash;&mdash;-: | | 0 | 2018-01-01 | 3â„ƒ | -6â„ƒ | æ™´~å¤šäº‘ | ä¸œåŒ—é£ | 1-2çº§ | 59 | è‰¯ | 2 | | 1 | 2018-01-02 | 2â„ƒ | -5â„ƒ | é˜´~å¤šäº‘ | ä¸œ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%BA%8C/" /><meta property="article:section" content="post" />


<meta itemprop="name" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäºŒï¼‰">
<meta itemprop="description" content=": | &mdash;&mdash;&mdash;: | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;: | &mdash;&mdash;-: | | 0 | 2018-01-01 | 3â„ƒ | -6â„ƒ | æ™´~å¤šäº‘ | ä¸œåŒ—é£ | 1-2çº§ | 59 | è‰¯ | 2 | | 1 | 2018-01-02 | 2â„ƒ | -5â„ƒ | é˜´~å¤šäº‘ | ä¸œ">

<meta itemprop="wordCount" content="15371">
<meta itemprop="keywords" content="Python,æ•°æ®åˆ†æ," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäºŒï¼‰"/>
<meta name="twitter:description" content=": | &mdash;&mdash;&mdash;: | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;: | &mdash;&mdash;-: | | 0 | 2018-01-01 | 3â„ƒ | -6â„ƒ | æ™´~å¤šäº‘ | ä¸œåŒ—é£ | 1-2çº§ | 59 | è‰¯ | 2 | | 1 | 2018-01-02 | 2â„ƒ | -5â„ƒ | é˜´~å¤šäº‘ | ä¸œ"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">CNshuaiyuan</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="yuanshuai1122.github.io/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="yuanshuai1122.github.io/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="yuanshuai1122.github.io/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="yuanshuai1122.github.io/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">CNshuaiyuan</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆäºŒï¼‰</h1>

      <div class="post-meta">
        <span class="post-time"> 0001-01-01 </span>
        
          <span class="more-meta"> çº¦ 15371 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 31 åˆ†é’Ÿ </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#1è·å–seriesçš„strå±æ€§ä½¿ç”¨å„ç§å­—ç¬¦ä¸²å¤„ç†å‡½æ•°">1ã€è·å–Seriesçš„strå±æ€§ï¼Œä½¿ç”¨å„ç§å­—ç¬¦ä¸²å¤„ç†å‡½æ•°</a></li>
            <li><a href="#2ä½¿ç”¨strçš„startswithcontainsç­‰å¾—åˆ°boolçš„serieså¯ä»¥åšæ¡ä»¶æŸ¥è¯¢">2ã€ä½¿ç”¨strçš„startswithã€containsç­‰å¾—åˆ°boolçš„Serieså¯ä»¥åšæ¡ä»¶æŸ¥è¯¢</a></li>
            <li><a href="#3éœ€è¦å¤šæ¬¡strå¤„ç†çš„é“¾å¼æ“ä½œ">3ã€éœ€è¦å¤šæ¬¡strå¤„ç†çš„é“¾å¼æ“ä½œ</a></li>
            <li><a href="#4-ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†">4. ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†</a></li>
          </ul>
        </li>
        <li><a href="#11pandasçš„axiså‚æ•°æ€ä¹ˆç†è§£">11ã€Pandasçš„axiså‚æ•°æ€ä¹ˆç†è§£ï¼Ÿ</a>
          <ul>
            <li><a href="#1å•åˆ—dropå°±æ˜¯åˆ é™¤æŸä¸€åˆ—">1ã€å•åˆ—dropï¼Œå°±æ˜¯åˆ é™¤æŸä¸€åˆ—</a></li>
            <li><a href="#2å•è¡Œdropå°±æ˜¯åˆ é™¤æŸä¸€è¡Œ">2ã€å•è¡Œdropï¼Œå°±æ˜¯åˆ é™¤æŸä¸€è¡Œ</a></li>
            <li><a href="#3æŒ‰axis0indexæ‰§è¡Œmeanèšåˆæ“ä½œ">3ã€æŒ‰axis=0/indexæ‰§è¡Œmeanèšåˆæ“ä½œ</a></li>
            <li><a href="#4æŒ‰axis1columnsæ‰§è¡Œmeanèšåˆæ“ä½œ">4ã€æŒ‰axis=1/columnsæ‰§è¡Œmeanèšåˆæ“ä½œ</a></li>
            <li><a href="#5å†æ¬¡ä¸¾ä¾‹åŠ æ·±ç†è§£">5ã€å†æ¬¡ä¸¾ä¾‹ï¼ŒåŠ æ·±ç†è§£</a></li>
          </ul>
        </li>
        <li><a href="#12pandasçš„ç´¢å¼•indexçš„ç”¨é€”">12ã€Pandasçš„ç´¢å¼•indexçš„ç”¨é€”</a></li>
        <li><a href="#1ä½¿ç”¨indexæŸ¥è¯¢æ•°æ®">1ã€ä½¿ç”¨indexæŸ¥è¯¢æ•°æ®</a></li>
        <li><a href="#2-ä½¿ç”¨indexä¼šæå‡æŸ¥è¯¢æ€§èƒ½">2. ä½¿ç”¨indexä¼šæå‡æŸ¥è¯¢æ€§èƒ½</a>
          <ul>
            <li><a href="#å®éªŒ1å®Œå…¨éšæœºçš„é¡ºåºæŸ¥è¯¢">å®éªŒ1ï¼šå®Œå…¨éšæœºçš„é¡ºåºæŸ¥è¯¢</a></li>
            <li><a href="#å®éªŒ2å°†indexæ’åºåçš„æŸ¥è¯¢">å®éªŒ2ï¼šå°†indexæ’åºåçš„æŸ¥è¯¢</a></li>
          </ul>
        </li>
        <li><a href="#3-ä½¿ç”¨indexèƒ½è‡ªåŠ¨å¯¹é½æ•°æ®">3. ä½¿ç”¨indexèƒ½è‡ªåŠ¨å¯¹é½æ•°æ®</a></li>
        <li><a href="#4-ä½¿ç”¨indexæ›´å¤šæ›´å¼ºå¤§çš„æ•°æ®ç»“æ„æ”¯æŒ">4. ä½¿ç”¨indexæ›´å¤šæ›´å¼ºå¤§çš„æ•°æ®ç»“æ„æ”¯æŒ</a></li>
      </ul>
    </li>
    <li><a href="#13pandasæ€æ ·å®ç°dataframeçš„merge">13ã€Pandasæ€æ ·å®ç°DataFrameçš„Merge</a>
      <ul>
        <li>
          <ul>
            <li><a href="#mergeçš„è¯­æ³•">mergeçš„è¯­æ³•ï¼š</a></li>
            <li><a href="#1ç”µå½±æ•°æ®é›†çš„joinå®ä¾‹">1ã€ç”µå½±æ•°æ®é›†çš„joinå®ä¾‹</a></li>
            <li><a href="#2ç†è§£mergeæ—¶æ•°é‡çš„å¯¹é½å…³ç³»">2ã€ç†è§£mergeæ—¶æ•°é‡çš„å¯¹é½å…³ç³»</a></li>
            <li><a href="#3ç†è§£left-joinright-joininner-joinouter-joinçš„åŒºåˆ«">3ã€ç†è§£left joinã€right joinã€inner joinã€outer joinçš„åŒºåˆ«</a></li>
            <li><a href="#4å¦‚æœå‡ºç°ékeyçš„å­—æ®µé‡åæ€ä¹ˆåŠ">4ã€å¦‚æœå‡ºç°éKeyçš„å­—æ®µé‡åæ€ä¹ˆåŠ</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#14pandaså®ç°æ•°æ®çš„åˆå¹¶concat">14ã€Pandaså®ç°æ•°æ®çš„åˆå¹¶concat</a>
      <ul>
        <li>
          <ul>
            <li></li>
            <li><a href="#ä¸€ä½¿ç”¨pandasconcatåˆå¹¶æ•°æ®">ä¸€ã€ä½¿ç”¨pandas.concatåˆå¹¶æ•°æ®</a></li>
            <li><a href="#äºŒä½¿ç”¨dataframeappendæŒ‰è¡Œåˆå¹¶æ•°æ®">äºŒã€ä½¿ç”¨DataFrame.appendæŒ‰è¡Œåˆå¹¶æ•°æ®</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#15pandasæ‰¹é‡æ‹†åˆ†excelä¸åˆå¹¶excel">15ã€Pandasæ‰¹é‡æ‹†åˆ†Excelä¸åˆå¹¶Excel</a>
      <ul>
        <li>
          <ul>
            <li><a href="#0è¯»å–æºexcelåˆ°pandas">0ã€è¯»å–æºExcelåˆ°Pandas</a></li>
            <li><a href="#ä¸€å°†ä¸€ä¸ªå¤§excelç­‰ä»½æ‹†æˆå¤šä¸ªexcel">ä¸€ã€å°†ä¸€ä¸ªå¤§Excelç­‰ä»½æ‹†æˆå¤šä¸ªExcel</a></li>
            <li><a href="#äºŒåˆå¹¶å¤šä¸ªå°excelåˆ°ä¸€ä¸ªå¤§excel">äºŒã€åˆå¹¶å¤šä¸ªå°Excelåˆ°ä¸€ä¸ªå¤§Excel</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#16pandasæ€æ ·å®ç°groupbyåˆ†ç»„ç»Ÿè®¡">16ã€Pandasæ€æ ·å®ç°groupbyåˆ†ç»„ç»Ÿè®¡</a>
      <ul>
        <li>
          <ul>
            <li><a href="#ä¸€åˆ†ç»„ä½¿ç”¨èšåˆå‡½æ•°åšæ•°æ®ç»Ÿè®¡">ä¸€ã€åˆ†ç»„ä½¿ç”¨èšåˆå‡½æ•°åšæ•°æ®ç»Ÿè®¡</a></li>
            <li><a href="#äºŒéå†groupbyçš„ç»“æœç†è§£æ‰§è¡Œæµç¨‹">äºŒã€éå†groupbyçš„ç»“æœç†è§£æ‰§è¡Œæµç¨‹</a></li>
            <li><a href="#ä¸‰å®ä¾‹åˆ†ç»„æ¢ç´¢å¤©æ°”æ•°æ®">ä¸‰ã€å®ä¾‹åˆ†ç»„æ¢ç´¢å¤©æ°”æ•°æ®</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#17pandasçš„åˆ†å±‚ç´¢å¼•multiindex">17ã€Pandasçš„åˆ†å±‚ç´¢å¼•MultiIndex</a>
      <ul>
        <li>
          <ul>
            <li><a href="#ä¸€seriesçš„åˆ†å±‚ç´¢å¼•multiindex">ä¸€ã€Seriesçš„åˆ†å±‚ç´¢å¼•MultiIndex</a></li>
            <li><a href="#äºŒseriesæœ‰å¤šå±‚ç´¢å¼•multiindexæ€æ ·ç­›é€‰æ•°æ®">äºŒã€Seriesæœ‰å¤šå±‚ç´¢å¼•MultiIndexæ€æ ·ç­›é€‰æ•°æ®ï¼Ÿ</a></li>
            <li><a href="#ä¸‰dataframeçš„å¤šå±‚ç´¢å¼•multiindex">ä¸‰ã€DataFrameçš„å¤šå±‚ç´¢å¼•MultiIndex</a></li>
            <li><a href="#å››dataframeæœ‰å¤šå±‚ç´¢å¼•multiindexæ€æ ·ç­›é€‰æ•°æ®">å››ã€DataFrameæœ‰å¤šå±‚ç´¢å¼•MultiIndexæ€æ ·ç­›é€‰æ•°æ®ï¼Ÿ</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#18pandasçš„æ•°æ®è½¬æ¢å‡½æ•°mapapplyapplymap">18ã€Pandasçš„æ•°æ®è½¬æ¢å‡½æ•°mapã€applyã€applymap</a>
      <ul>
        <li>
          <ul>
            <li><a href="#1-mapç”¨äºserieså€¼çš„è½¬æ¢">1. mapç”¨äºSerieså€¼çš„è½¬æ¢</a></li>
            <li><a href="#2-applyç”¨äºserieså’Œdataframeçš„è½¬æ¢">2. applyç”¨äºSerieså’ŒDataFrameçš„è½¬æ¢</a></li>
            <li><a href="#3-applymapç”¨äºdataframeæ‰€æœ‰å€¼çš„è½¬æ¢">3. applymapç”¨äºDataFrameæ‰€æœ‰å€¼çš„è½¬æ¢</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
  <div class="post-outdated">
    <div class="warn">
      <p>ã€æ³¨æ„ã€‘æœ€åæ›´æ–°äº <span class="timeago" datetime="0001-01-01T00:00:00" title="January 1, 0001">January 1, 0001</span>ï¼Œæ–‡ä¸­å†…å®¹å¯èƒ½å·²è¿‡æ—¶ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p>
    </div>
  </div>
    <div class="post-content">
      <p>: | &mdash;&mdash;&mdash;: | &mdash;&ndash;: | &mdash;&ndash;: | &mdash;&mdash;: | &mdash;&mdash;&ndash;: | &mdash;&ndash;: | &mdash;: | &mdash;&mdash;: | &mdash;&mdash;-: |
|    0 | 2018-01-01 |     3â„ƒ |    -6â„ƒ | æ™´~å¤šäº‘ |    ä¸œåŒ—é£ |  1-2çº§ |   59 |      è‰¯ |        2 |
|    1 | 2018-01-02 |     2â„ƒ |    -5â„ƒ | é˜´~å¤šäº‘ |    ä¸œåŒ—é£ |  1-2çº§ |   49 |      ä¼˜ |        1 |
|    2 | 2018-01-03 |     2â„ƒ |    -5â„ƒ |    å¤šäº‘ |      åŒ—é£ |  1-2çº§ |   28 |      ä¼˜ |        1 |
|    3 | 2018-01-04 |     0â„ƒ |    -8â„ƒ |      é˜´ |    ä¸œåŒ—é£ |  1-2çº§ |   28 |      ä¼˜ |        1 |
|    4 | 2018-01-05 |     3â„ƒ |    -6â„ƒ | å¤šäº‘~æ™´ |    è¥¿åŒ—é£ |  1-2çº§ |   50 |      ä¼˜ |        1 |</p>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ymd</span>          <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">bWendu</span>       <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">yWendu</span>       <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">tianqi</span>       <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">fengxiang</span>    <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">fengli</span>       <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">aqi</span>           <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">aqiInfo</span>      <span class="nb">object</span>
</span></span><span class="line"><span class="cl"><span class="n">aqiLevel</span>      <span class="n">int64</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="1è·å–seriesçš„strå±æ€§ä½¿ç”¨å„ç§å­—ç¬¦ä¸²å¤„ç†å‡½æ•°">1ã€è·å–Seriesçš„strå±æ€§ï¼Œä½¿ç”¨å„ç§å­—ç¬¦ä¸²å¤„ç†å‡½æ•°</h3>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">StringMethods</span> <span class="n">at</span> <span class="mh">0x1af21871808</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>       <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>       <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>       <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>       <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>       <span class="mi">3</span>
</span></span><span class="line"><span class="cl">       <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="mi">360</span>    <span class="o">-</span><span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="mi">361</span>    <span class="o">-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="mi">362</span>    <span class="o">-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="mi">363</span>    <span class="o">-</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="mi">364</span>    <span class="o">-</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">bWendu</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># åˆ¤æ–­æ˜¯ä¸æ˜¯æ•°å­—</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl">       <span class="o">...</span>  
</span></span><span class="line"><span class="cl"><span class="mi">360</span>    <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">361</span>    <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">362</span>    <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">363</span>    <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">364</span>    <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">bWendu</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;aqi&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">---------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="ne">AttributeError</span>                            <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="mi">12</span><span class="n">cdcbdb6f81</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;aqi&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">:</span>\<span class="n">appdata</span>\<span class="n">python37</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">generic</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mi">5173</span>             <span class="ow">or</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accessors</span>
</span></span><span class="line"><span class="cl">   <span class="mi">5174</span>         <span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="mi">5175</span>             <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mi">5176</span>         <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">   <span class="mi">5177</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_axis</span><span class="o">.</span><span class="n">_can_hold_identifiers_and_holds_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">:</span>\<span class="n">appdata</span>\<span class="n">python37</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">accessor</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="mi">173</span>             <span class="c1"># we&#39;re accessing the attribute of the class, i.e., Dataset.geo</span>
</span></span><span class="line"><span class="cl">    <span class="mi">174</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accessor</span>
</span></span><span class="line"><span class="cl"><span class="o">--&gt;</span> <span class="mi">175</span>         <span class="n">accessor_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accessor</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="mi">176</span>         <span class="c1"># Replace the property with the accessor object. Inspired by:</span>
</span></span><span class="line"><span class="cl">    <span class="mi">177</span>         <span class="c1"># http://www.pydanny.com/cached-property.html</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">:</span>\<span class="n">appdata</span>\<span class="n">python37</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">strings</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mi">1915</span> 
</span></span><span class="line"><span class="cl">   <span class="mi">1916</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="mi">1917</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_inferred_dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mi">1918</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_is_categorical</span> <span class="o">=</span> <span class="n">is_categorical_dtype</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mi">1919</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">:</span>\<span class="n">appdata</span>\<span class="n">python37</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">strings</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mi">1965</span> 
</span></span><span class="line"><span class="cl">   <span class="mi">1966</span>         <span class="k">if</span> <span class="n">inferred_dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_types</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="mi">1967</span>             <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&#34;Can only use .str accessor with string &#34;</span> <span class="s2">&#34;values!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mi">1968</span>         <span class="k">return</span> <span class="n">inferred_dtype</span>
</span></span><span class="line"><span class="cl">   <span class="mi">1969</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="ne">AttributeError</span><span class="p">:</span> <span class="n">Can</span> <span class="n">only</span> <span class="n">use</span> <span class="o">.</span><span class="n">str</span> <span class="n">accessor</span> <span class="k">with</span> <span class="n">string</span> <span class="n">values</span><span class="err">!</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2ä½¿ç”¨strçš„startswithcontainsç­‰å¾—åˆ°boolçš„serieså¯ä»¥åšæ¡ä»¶æŸ¥è¯¢">2ã€ä½¿ç”¨strçš„startswithã€containsç­‰å¾—åˆ°boolçš„Serieså¯ä»¥åšæ¡ä»¶æŸ¥è¯¢</h3>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">condition</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;2018-03&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">condition</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>      <span class="kc">False</span>
</span></span><span class="line"><span class="cl">       <span class="o">...</span>  
</span></span><span class="line"><span class="cl"><span class="mi">360</span>    <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">361</span>    <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">362</span>    <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">363</span>    <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="mi">364</span>    <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">59</td>
<td style="text-align:right">2018-03-01</td>
<td style="text-align:right">8â„ƒ</td>
<td style="text-align:right">-3â„ƒ</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">è¥¿å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">46</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">60</td>
<td style="text-align:right">2018-03-02</td>
<td style="text-align:right">9â„ƒ</td>
<td style="text-align:right">-1â„ƒ</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">95</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">61</td>
<td style="text-align:right">2018-03-03</td>
<td style="text-align:right">13â„ƒ</td>
<td style="text-align:right">3â„ƒ</td>
<td style="text-align:right">å¤šäº‘~é˜´</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">214</td>
<td style="text-align:right">é‡åº¦æ±¡æŸ“</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:right">62</td>
<td style="text-align:right">2018-03-04</td>
<td style="text-align:right">7â„ƒ</td>
<td style="text-align:right">-2â„ƒ</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œå—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">144</td>
<td style="text-align:right">è½»åº¦æ±¡æŸ“</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">63</td>
<td style="text-align:right">2018-03-05</td>
<td style="text-align:right">8â„ƒ</td>
<td style="text-align:right">-3â„ƒ</td>
<td style="text-align:right">æ™´</td>
<td style="text-align:right">å—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">94</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
</tbody>
</table>
<h3 id="3éœ€è¦å¤šæ¬¡strå¤„ç†çš„é“¾å¼æ“ä½œ">3ã€éœ€è¦å¤šæ¬¡strå¤„ç†çš„é“¾å¼æ“ä½œ</h3>
<p>æ€æ ·æå–201803è¿™æ ·çš„æ•°å­—æœˆä»½ï¼Ÿ
1ã€å…ˆå°†æ—¥æœŸ2018-03-31æ›¿æ¢æˆ20180331çš„å½¢å¼
2ã€æå–æœˆä»½å­—ç¬¦ä¸²201803</p>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>      <span class="mi">20180101</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>      <span class="mi">20180102</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>      <span class="mi">20180103</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>      <span class="mi">20180104</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>      <span class="mi">20180105</span>
</span></span><span class="line"><span class="cl">         <span class="o">...</span>   
</span></span><span class="line"><span class="cl"><span class="mi">360</span>    <span class="mi">20181227</span>
</span></span><span class="line"><span class="cl"><span class="mi">361</span>    <span class="mi">20181228</span>
</span></span><span class="line"><span class="cl"><span class="mi">362</span>    <span class="mi">20181229</span>
</span></span><span class="line"><span class="cl"><span class="mi">363</span>    <span class="mi">20181230</span>
</span></span><span class="line"><span class="cl"><span class="mi">364</span>    <span class="mi">20181231</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ¯æ¬¡è°ƒç”¨å‡½æ•°ï¼Œéƒ½è¿”å›ä¸€ä¸ªæ–°Series</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">---------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="ne">AttributeError</span>                            <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">13</span><span class="o">-</span><span class="n">ae278fb12255</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="mi">1</span> <span class="c1"># æ¯æ¬¡è°ƒç”¨å‡½æ•°ï¼Œéƒ½è¿”å›ä¸€ä¸ªæ–°Series</span>
</span></span><span class="line"><span class="cl"><span class="o">----&gt;</span> <span class="mi">2</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">:</span>\<span class="n">appdata</span>\<span class="n">python37</span>\<span class="n">lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">pandas</span>\<span class="n">core</span>\<span class="n">generic</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mi">5177</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_axis</span><span class="o">.</span><span class="n">_can_hold_identifiers_and_holds_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="mi">5178</span>                 <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="mi">5179</span>             <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mi">5180</span> 
</span></span><span class="line"><span class="cl">   <span class="mi">5181</span>     <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">&#39;Series&#39;</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;slice&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>      <span class="mi">201801</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>      <span class="mi">201801</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>      <span class="mi">201801</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>      <span class="mi">201801</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>      <span class="mi">201801</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>  
</span></span><span class="line"><span class="cl"><span class="mi">360</span>    <span class="mi">201812</span>
</span></span><span class="line"><span class="cl"><span class="mi">361</span>    <span class="mi">201812</span>
</span></span><span class="line"><span class="cl"><span class="mi">362</span>    <span class="mi">201812</span>
</span></span><span class="line"><span class="cl"><span class="mi">363</span>    <span class="mi">201812</span>
</span></span><span class="line"><span class="cl"><span class="mi">364</span>    <span class="mi">201812</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># sliceå°±æ˜¯åˆ‡ç‰‡è¯­æ³•ï¼Œå¯ä»¥ç›´æ¥ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>      <span class="mi">201801</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>      <span class="mi">201801</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>      <span class="mi">201801</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>      <span class="mi">201801</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>      <span class="mi">201801</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>  
</span></span><span class="line"><span class="cl"><span class="mi">360</span>    <span class="mi">201812</span>
</span></span><span class="line"><span class="cl"><span class="mi">361</span>    <span class="mi">201812</span>
</span></span><span class="line"><span class="cl"><span class="mi">362</span>    <span class="mi">201812</span>
</span></span><span class="line"><span class="cl"><span class="mi">363</span>    <span class="mi">201812</span>
</span></span><span class="line"><span class="cl"><span class="mi">364</span>    <span class="mi">201812</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†">4. ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†</h3>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ·»åŠ æ–°åˆ—</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_nianyueri</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">year</span><span class="p">,</span><span class="n">month</span><span class="p">,</span><span class="n">day</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;ymd&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">å¹´</span><span class="si">{</span><span class="n">month</span><span class="si">}</span><span class="s2">æœˆ</span><span class="si">{</span><span class="n">day</span><span class="si">}</span><span class="s2">æ—¥&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ä¸­æ–‡æ—¥æœŸ&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_nianyueri</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ä¸­æ–‡æ—¥æœŸ&#34;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>      <span class="mi">2018</span><span class="n">å¹´01æœˆ01æ—¥</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>      <span class="mi">2018</span><span class="n">å¹´01æœˆ02æ—¥</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>      <span class="mi">2018</span><span class="n">å¹´01æœˆ03æ—¥</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>      <span class="mi">2018</span><span class="n">å¹´01æœˆ04æ—¥</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>      <span class="mi">2018</span><span class="n">å¹´01æœˆ05æ—¥</span>
</span></span><span class="line"><span class="cl">          <span class="o">...</span>     
</span></span><span class="line"><span class="cl"><span class="mi">360</span>    <span class="mi">2018</span><span class="n">å¹´12æœˆ27æ—¥</span>
</span></span><span class="line"><span class="cl"><span class="mi">361</span>    <span class="mi">2018</span><span class="n">å¹´12æœˆ28æ—¥</span>
</span></span><span class="line"><span class="cl"><span class="mi">362</span>    <span class="mi">2018</span><span class="n">å¹´12æœˆ29æ—¥</span>
</span></span><span class="line"><span class="cl"><span class="mi">363</span>    <span class="mi">2018</span><span class="n">å¹´12æœˆ30æ—¥</span>
</span></span><span class="line"><span class="cl"><span class="mi">364</span>    <span class="mi">2018</span><span class="n">å¹´12æœˆ31æ—¥</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">ä¸­æ–‡æ—¥æœŸ</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é—®é¢˜ï¼šæ€æ ·å°†â€œ2018å¹´12æœˆ31æ—¥â€ä¸­çš„å¹´ã€æœˆã€æ—¥ä¸‰ä¸ªä¸­æ–‡å­—ç¬¦å»é™¤ï¼Ÿ</p>
<p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ–¹æ³•1ï¼šé“¾å¼replace</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ä¸­æ–‡æ—¥æœŸ&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;å¹´&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;æœˆ&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;æ—¥&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>      <span class="mi">20180101</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>      <span class="mi">20180102</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>      <span class="mi">20180103</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>      <span class="mi">20180104</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>      <span class="mi">20180105</span>
</span></span><span class="line"><span class="cl">         <span class="o">...</span>   
</span></span><span class="line"><span class="cl"><span class="mi">360</span>    <span class="mi">20181227</span>
</span></span><span class="line"><span class="cl"><span class="mi">361</span>    <span class="mi">20181228</span>
</span></span><span class="line"><span class="cl"><span class="mi">362</span>    <span class="mi">20181229</span>
</span></span><span class="line"><span class="cl"><span class="mi">363</span>    <span class="mi">20181230</span>
</span></span><span class="line"><span class="cl"><span class="mi">364</span>    <span class="mi">20181231</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">ä¸­æ–‡æ—¥æœŸ</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>*<strong>Series.stré»˜è®¤å°±å¼€å¯äº†æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼*</strong></p>
<p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ–¹æ³•2ï¼šæ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;ä¸­æ–‡æ—¥æœŸ&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;[å¹´æœˆæ—¥]&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>      <span class="mi">20180101</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>      <span class="mi">20180102</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>      <span class="mi">20180103</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>      <span class="mi">20180104</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>      <span class="mi">20180105</span>
</span></span><span class="line"><span class="cl">         <span class="o">...</span>   
</span></span><span class="line"><span class="cl"><span class="mi">360</span>    <span class="mi">20181227</span>
</span></span><span class="line"><span class="cl"><span class="mi">361</span>    <span class="mi">20181228</span>
</span></span><span class="line"><span class="cl"><span class="mi">362</span>    <span class="mi">20181229</span>
</span></span><span class="line"><span class="cl"><span class="mi">363</span>    <span class="mi">20181230</span>
</span></span><span class="line"><span class="cl"><span class="mi">364</span>    <span class="mi">20181231</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">ä¸­æ–‡æ—¥æœŸ</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="11pandasçš„axiså‚æ•°æ€ä¹ˆç†è§£">11ã€Pandasçš„axiså‚æ•°æ€ä¹ˆç†è§£ï¼Ÿ</h2>
<ul>
<li>
<p>axis=0æˆ–è€…&quot;index&quot;ï¼š</p>
<ul>
<li>å¦‚æœæ˜¯å•è¡Œæ“ä½œï¼Œå°±æŒ‡çš„æ˜¯æŸä¸€è¡Œ</li>
<li>å¦‚æœæ˜¯èšåˆæ“ä½œï¼ŒæŒ‡çš„æ˜¯è·¨è¡Œcross rows</li>
</ul>
</li>
<li>
<p>axis=1æˆ–è€…&quot;columns&quot;ï¼š</p>
<ul>
<li>
<p>å¦‚æœæ˜¯å•åˆ—æ“ä½œï¼Œå°±æŒ‡çš„æ˜¯æŸä¸€åˆ—</p>
</li>
<li>
<p>å¦‚æœæ˜¯èšåˆæ“ä½œï¼ŒæŒ‡çš„æ˜¯è·¨åˆ—cross columns</p>
<p>*<strong>æŒ‰å“ªä¸ªaxisï¼Œå°±æ˜¯è¿™ä¸ªaxisè¦åŠ¨èµ·æ¥(ç±»ä¼¼è¢«foréå†)ï¼Œå…¶å®ƒçš„axisä¿æŒä¸åŠ¨*</strong></p>
</li>
</ul>
</li>
</ul>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">df
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table>
<h3 id="1å•åˆ—dropå°±æ˜¯åˆ é™¤æŸä¸€åˆ—">1ã€å•åˆ—dropï¼Œå°±æ˜¯åˆ é™¤æŸä¸€åˆ—</h3>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä»£è¡¨çš„å°±æ˜¯åˆ é™¤æŸåˆ—</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&#34;A&#34;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table>
<h3 id="2å•è¡Œdropå°±æ˜¯åˆ é™¤æŸä¸€è¡Œ">2ã€å•è¡Œdropï¼Œå°±æ˜¯åˆ é™¤æŸä¸€è¡Œ</h3>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä»£è¡¨çš„å°±æ˜¯åˆ é™¤æŸè¡Œ</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table>
<h3 id="3æŒ‰axis0indexæ‰§è¡Œmeanèšåˆæ“ä½œ">3ã€æŒ‰axis=0/indexæ‰§è¡Œmeanèšåˆæ“ä½œ</h3>
<p>åç›´è§‰ï¼šè¾“å‡ºçš„ä¸æ˜¯æ¯è¡Œçš„ç»“æœï¼Œè€Œæ˜¯æ¯åˆ—çš„ç»“æœ</p>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># axis=0 or axis=index</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">A</span>    <span class="mf">4.0</span>
</span></span><span class="line"><span class="cl"><span class="n">B</span>    <span class="mf">5.0</span>
</span></span><span class="line"><span class="cl"><span class="n">C</span>    <span class="mf">6.0</span>
</span></span><span class="line"><span class="cl"><span class="n">D</span>    <span class="mf">7.0</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/1.png" alt=""></p>
<p>*<strong>æŒ‡å®šäº†æŒ‰å“ªä¸ªaxisï¼Œå°±æ˜¯è¿™ä¸ªaxisè¦åŠ¨èµ·æ¥(ç±»ä¼¼è¢«foréå†)ï¼Œå…¶å®ƒçš„axisä¿æŒä¸åŠ¨*</strong></p>
<h3 id="4æŒ‰axis1columnsæ‰§è¡Œmeanèšåˆæ“ä½œ">4ã€æŒ‰axis=1/columnsæ‰§è¡Œmeanèšåˆæ“ä½œ</h3>
<p>åç›´è§‰ï¼šè¾“å‡ºçš„ä¸æ˜¯æ¯è¡Œçš„ç»“æœï¼Œè€Œæ˜¯æ¯åˆ—çš„ç»“æœ</p>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
</tr>
</tbody>
</table>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># axis=1 or axis=columns</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>    <span class="mf">1.5</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>    <span class="mf">5.5</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>    <span class="mf">9.5</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/2.png" alt=""></p>
<p>*<strong>æŒ‡å®šäº†æŒ‰å“ªä¸ªaxisï¼Œå°±æ˜¯è¿™ä¸ªaxisè¦åŠ¨èµ·æ¥(ç±»ä¼¼è¢«foréå†)ï¼Œå…¶å®ƒçš„axisä¿æŒä¸åŠ¨*</strong></p>
<h3 id="5å†æ¬¡ä¸¾ä¾‹åŠ æ·±ç†è§£">5ã€å†æ¬¡ä¸¾ä¾‹ï¼ŒåŠ æ·±ç†è§£</h3>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_sum_value</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;B&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;C&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s2">&#34;D&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s2">&#34;sum_value&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_sum_value</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">df
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">sum_value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
<td style="text-align:right">7</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">8</td>
<td style="text-align:right">9</td>
<td style="text-align:right">10</td>
<td style="text-align:right">11</td>
<td style="text-align:right">38</td>
</tr>
</tbody>
</table>
<p>*<strong>æŒ‡å®šäº†æŒ‰å“ªä¸ªaxisï¼Œå°±æ˜¯è¿™ä¸ªaxisè¦åŠ¨èµ·æ¥(ç±»ä¼¼è¢«foréå†)ï¼Œå…¶å®ƒçš„axisä¿æŒä¸åŠ¨*</strong></p>
<h2 id="12pandasçš„ç´¢å¼•indexçš„ç”¨é€”">12ã€Pandasçš„ç´¢å¼•indexçš„ç”¨é€”</h2>
<p>æŠŠæ•°æ®å­˜å‚¨äºæ™®é€šçš„columnåˆ—ä¹Ÿèƒ½ç”¨äºæ•°æ®æŸ¥è¯¢ï¼Œé‚£ä½¿ç”¨indexæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p>
<p>indexçš„ç”¨é€”æ€»ç»“ï¼š</p>
<ol>
<li>æ›´æ–¹ä¾¿çš„æ•°æ®æŸ¥è¯¢ï¼›</li>
<li>ä½¿ç”¨indexå¯ä»¥è·å¾—æ€§èƒ½æå‡ï¼›</li>
<li>è‡ªåŠ¨çš„æ•°æ®å¯¹é½åŠŸèƒ½ï¼›</li>
<li>æ›´å¤šæ›´å¼ºå¤§çš„æ•°æ®ç»“æ„æ”¯æŒï¼›</li>
</ol>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;./datas/ml-latest-small/ratings.csv&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982703</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964981247</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">47</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964983815</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">50</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964982931</td>
</tr>
</tbody>
</table>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">userId</span>       <span class="mi">100836</span>
</span></span><span class="line"><span class="cl"><span class="n">movieId</span>      <span class="mi">100836</span>
</span></span><span class="line"><span class="cl"><span class="n">rating</span>       <span class="mi">100836</span>
</span></span><span class="line"><span class="cl"><span class="n">timestamp</span>    <span class="mi">100836</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="1ä½¿ç”¨indexæŸ¥è¯¢æ•°æ®">1ã€ä½¿ç”¨indexæŸ¥è¯¢æ•°æ®</h2>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># drop==Falseï¼Œè®©ç´¢å¼•åˆ—è¿˜ä¿æŒåœ¨column</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&#34;userId&#34;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982703</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964981247</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">47</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964983815</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">50</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">964982931</td>
</tr>
</tbody>
</table>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Int64Index</span><span class="p">([</span>  <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="o">...</span>
</span></span><span class="line"><span class="cl">            <span class="mi">610</span><span class="p">,</span> <span class="mi">610</span><span class="p">,</span> <span class="mi">610</span><span class="p">,</span> <span class="mi">610</span><span class="p">,</span> <span class="mi">610</span><span class="p">,</span> <span class="mi">610</span><span class="p">,</span> <span class="mi">610</span><span class="p">,</span> <span class="mi">610</span><span class="p">,</span> <span class="mi">610</span><span class="p">,</span> <span class="mi">610</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">           <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;userId&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">100836</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨indexçš„æŸ¥è¯¢æ–¹æ³•</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">500</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005527755</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">11</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005528017</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">39</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527926</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527980</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">104</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005528065</td>
</tr>
</tbody>
</table>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨columnçš„conditionæŸ¥è¯¢æ–¹æ³•</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&#34;userId&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">500</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">1</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005527755</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">11</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005528017</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">39</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527926</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">1005527980</td>
</tr>
<tr>
<td style="text-align:right">500</td>
<td style="text-align:right">500</td>
<td style="text-align:right">104</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">1005528065</td>
</tr>
</tbody>
</table>
<h2 id="2-ä½¿ç”¨indexä¼šæå‡æŸ¥è¯¢æ€§èƒ½">2. ä½¿ç”¨indexä¼šæå‡æŸ¥è¯¢æ€§èƒ½</h2>
<ul>
<li>å¦‚æœindexæ˜¯å”¯ä¸€çš„ï¼ŒPandasä¼šä½¿ç”¨å“ˆå¸Œè¡¨ä¼˜åŒ–ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¸ºO(1);</li>
<li>å¦‚æœindexä¸æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯æœ‰åºï¼ŒPandasä¼šä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ç®—æ³•ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¸ºO(logN);</li>
<li>å¦‚æœindexæ˜¯å®Œå…¨éšæœºçš„ï¼Œé‚£ä¹ˆæ¯æ¬¡æŸ¥è¯¢éƒ½è¦æ‰«æå…¨è¡¨ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¸ºO(N);</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/3.png" alt=""></p>
<h3 id="å®éªŒ1å®Œå…¨éšæœºçš„é¡ºåºæŸ¥è¯¢">å®éªŒ1ï¼šå®Œå…¨éšæœºçš„é¡ºåºæŸ¥è¯¢</h3>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å°†æ•°æ®éšæœºæ‰“æ•£</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">shuffle</span>
</span></span><span class="line"><span class="cl"><span class="n">df_shuffle</span> <span class="o">=</span> <span class="n">shuffle</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_shuffle</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">160</td>
<td style="text-align:right">160</td>
<td style="text-align:right">2340</td>
<td style="text-align:right">1.0</td>
<td style="text-align:right">985383314</td>
</tr>
<tr>
<td style="text-align:right">129</td>
<td style="text-align:right">129</td>
<td style="text-align:right">1136</td>
<td style="text-align:right">3.5</td>
<td style="text-align:right">1167375403</td>
</tr>
<tr>
<td style="text-align:right">167</td>
<td style="text-align:right">167</td>
<td style="text-align:right">44191</td>
<td style="text-align:right">4.5</td>
<td style="text-align:right">1154718915</td>
</tr>
<tr>
<td style="text-align:right">536</td>
<td style="text-align:right">536</td>
<td style="text-align:right">276</td>
<td style="text-align:right">3.0</td>
<td style="text-align:right">832839990</td>
</tr>
<tr>
<td style="text-align:right">67</td>
<td style="text-align:right">67</td>
<td style="text-align:right">5952</td>
<td style="text-align:right">2.0</td>
<td style="text-align:right">1501274082</td>
</tr>
</tbody>
</table>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç´¢å¼•æ˜¯å¦æ˜¯é€’å¢çš„</span>
</span></span><span class="line"><span class="cl"><span class="n">df_shuffle</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_monotonic_increasing</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kc">False</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_shuffle</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kc">False</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># è®¡æ—¶ï¼ŒæŸ¥è¯¢id==500æ•°æ®æ€§èƒ½</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">timeit</span> <span class="n">df_shuffle</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">500</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="mi">376</span> <span class="n">Âµs</span> <span class="err">Â±</span> <span class="mf">52.4</span> <span class="n">Âµs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">Â±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å®éªŒ2å°†indexæ’åºåçš„æŸ¥è¯¢">å®éªŒ2ï¼šå°†indexæ’åºåçš„æŸ¥è¯¢</h3>
<p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_sorted</span> <span class="o">=</span> <span class="n">df_shuffle</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">userId</th>
<th style="text-align:right">movieId</th>
<th style="text-align:right">rating</th>
<th style="text-align:right">timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">userId</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2985</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964983034</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2617</td>
<td style="text-align:right">2.0</td>
<td style="text-align:right">964982588</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3639</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982271</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">6</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982224</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">733</td>
<td style="text-align:right">4.0</td>
<td style="text-align:right">964982400</td>
</tr>
</tbody>
</table>
<p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç´¢å¼•æ˜¯å¦æ˜¯é€’å¢çš„</span>
</span></span><span class="line"><span class="cl"><span class="n">df_sorted</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_monotonic_increasing</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kc">True</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_sorted</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kc">False</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">%</span><span class="n">timeit</span> <span class="n">df_sorted</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">500</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="mi">203</span> <span class="n">Âµs</span> <span class="err">Â±</span> <span class="mf">20.8</span> <span class="n">Âµs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">Â±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="3-ä½¿ç”¨indexèƒ½è‡ªåŠ¨å¯¹é½æ•°æ®">3. ä½¿ç”¨indexèƒ½è‡ªåŠ¨å¯¹é½æ•°æ®</h2>
<p>åŒ…æ‹¬serieså’Œdataframe</p>
<p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&#34;abc&#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">s1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">a</span>    <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span>    <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span>    <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&#34;bcd&#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [23]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">s2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[23]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">b</span>    <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span>    <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span>    <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [24]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">s1</span><span class="o">+</span><span class="n">s2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[24]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">a</span>    <span class="n">NaN</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span>    <span class="mf">4.0</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span>    <span class="mf">6.0</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span>    <span class="n">NaN</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="4-ä½¿ç”¨indexæ›´å¤šæ›´å¼ºå¤§çš„æ•°æ®ç»“æ„æ”¯æŒ">4. ä½¿ç”¨indexæ›´å¤šæ›´å¼ºå¤§çš„æ•°æ®ç»“æ„æ”¯æŒ</h2>
<p>*<strong>å¾ˆå¤šå¼ºå¤§çš„ç´¢å¼•æ•°æ®ç»“æ„*</strong></p>
<ul>
<li>CategoricalIndexï¼ŒåŸºäºåˆ†ç±»æ•°æ®çš„Indexï¼Œæå‡æ€§èƒ½ï¼›</li>
<li>MultiIndexï¼Œå¤šç»´ç´¢å¼•ï¼Œç”¨äºgroupbyå¤šç»´èšåˆåç»“æœç­‰ï¼›</li>
<li>DatetimeIndexï¼Œæ—¶é—´ç±»å‹ç´¢å¼•ï¼Œå¼ºå¤§çš„æ—¥æœŸå’Œæ—¶é—´çš„æ–¹æ³•æ”¯æŒï¼›</li>
</ul>
<h1 id="13pandasæ€æ ·å®ç°dataframeçš„merge">13ã€Pandasæ€æ ·å®ç°DataFrameçš„Merge</h1>
<p>Pandasçš„Mergeï¼Œç›¸å½“äºSqlçš„Joinï¼Œå°†ä¸åŒçš„è¡¨æŒ‰keyå…³è”åˆ°ä¸€ä¸ªè¡¨</p>
<h3 id="mergeçš„è¯­æ³•">mergeçš„è¯­æ³•ï¼š</h3>
<p>pd.merge(left, right, how=&lsquo;inner&rsquo;, on=None, left_on=None, right_on=None, left_index=False, right_index=False, sort=True, suffixes=(&rsquo;_x&rsquo;, &lsquo;_y&rsquo;), copy=True, indicator=False, validate=None)</p>
<ul>
<li>leftï¼Œrightï¼šè¦mergeçš„dataframeæˆ–è€…æœ‰nameçš„Series</li>
<li>howï¼šjoinç±»å‹ï¼Œ&rsquo;left&rsquo;, &lsquo;right&rsquo;, &lsquo;outer&rsquo;, &lsquo;inner&rsquo;</li>
<li>onï¼šjoinçš„keyï¼Œleftå’Œrightéƒ½éœ€è¦æœ‰è¿™ä¸ªkey</li>
<li>left_onï¼šleftçš„dfæˆ–è€…seriesçš„key</li>
<li>right_onï¼šrightçš„dfæˆ–è€…seiresçš„key</li>
<li>left_indexï¼Œright_indexï¼šä½¿ç”¨indexè€Œä¸æ˜¯æ™®é€šçš„columnåšjoin</li>
<li>suffixesï¼šä¸¤ä¸ªå…ƒç´ çš„åç¼€ï¼Œå¦‚æœåˆ—æœ‰é‡åï¼Œè‡ªåŠ¨æ·»åŠ åç¼€ï¼Œé»˜è®¤æ˜¯(&rsquo;_x&rsquo;, &lsquo;_y&rsquo;)</li>
</ul>
<p>æ–‡æ¡£åœ°å€ï¼šhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html</p>
<p>æœ¬æ¬¡è®²è§£æçº²ï¼š</p>
<ol>
<li>ç”µå½±æ•°æ®é›†çš„joinå®ä¾‹</li>
<li>ç†è§£mergeæ—¶ä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šçš„æ•°é‡å¯¹é½å…³ç³»</li>
<li>ç†è§£left joinã€right joinã€inner joinã€outer joinçš„åŒºåˆ«</li>
<li>å¦‚æœå‡ºç°éKeyçš„å­—æ®µé‡åæ€ä¹ˆåŠ</li>
</ol>
<h3 id="1ç”µå½±æ•°æ®é›†çš„joinå®ä¾‹">1ã€ç”µå½±æ•°æ®é›†çš„joinå®ä¾‹</h3>
<h4 id="ç”µå½±è¯„åˆ†æ•°æ®é›†">ç”µå½±è¯„åˆ†æ•°æ®é›†</h4>
<p>æ˜¯æ¨èç³»ç»Ÿç ”ç©¶çš„å¾ˆå¥½çš„æ•°æ®é›†
ä½äºæœ¬ä»£ç ç›®å½•ï¼š./datas/movielens-1m</p>
<p>åŒ…å«ä¸‰ä¸ªæ–‡ä»¶ï¼š</p>
<ol>
<li>ç”¨æˆ·å¯¹ç”µå½±çš„è¯„åˆ†æ•°æ® ratings.dat</li>
<li>ç”¨æˆ·æœ¬èº«çš„ä¿¡æ¯æ•°æ® users.dat</li>
<li>ç”µå½±æœ¬èº«çš„æ•°æ® movies.dat</li>
</ol>
<p>å¯ä»¥å…³è”ä¸‰ä¸ªè¡¨ï¼Œå¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„å¤§è¡¨</p>
<p>æ•°æ®é›†å®˜æ–¹åœ°å€ï¼šhttps://grouplens.org/datasets/movielens/</p>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;./datas/movielens-1m/ratings.dat&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;::&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">names</span><span class="o">=</span><span class="s2">&#34;UserID::MovieID::Rating::Timestamp&#34;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;::&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
</tr>
</tbody>
</table>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_users</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;./datas/movielens-1m/users.dat&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;::&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">names</span><span class="o">=</span><span class="s2">&#34;UserID::Gender::Age::Occupation::Zip-code&#34;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;::&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_users</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">M</td>
<td style="text-align:right">56</td>
<td style="text-align:right">16</td>
<td style="text-align:right">70072</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">15</td>
<td style="text-align:right">55117</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">M</td>
<td style="text-align:right">45</td>
<td style="text-align:right">7</td>
<td style="text-align:right">02460</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">20</td>
<td style="text-align:right">55455</td>
</tr>
</tbody>
</table>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;./datas/movielens-1m/movies.dat&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;::&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">names</span><span class="o">=</span><span class="s2">&#34;MovieID::Title::Genres&#34;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;::&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_movies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">Toy Story (1995)</td>
<td style="text-align:right">Animation|Children&rsquo;s|Comedy</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">Jumanji (1995)</td>
<td style="text-align:right">Adventure|Children&rsquo;s|Fantasy</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">Grumpier Old Men (1995)</td>
<td style="text-align:right">Comedy|Romance</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
<td style="text-align:right">Waiting to Exhale (1995)</td>
<td style="text-align:right">Comedy|Drama</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5</td>
<td style="text-align:right">Father of the Bride Part II (1995)</td>
<td style="text-align:right">Comedy</td>
</tr>
</tbody>
</table>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_ratings_users</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">   <span class="n">df_ratings</span><span class="p">,</span> <span class="n">df_users</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&#34;UserID&#34;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&#34;UserID&#34;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&#34;inner&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_ratings_users</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">661</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978302109</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">914</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978301968</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3408</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978300275</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2355</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978824291</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
</tr>
</tbody>
</table>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_ratings_users_movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_ratings_users</span><span class="p">,</span> <span class="n">df_movies</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&#34;MovieID&#34;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&#34;MovieID&#34;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&#34;inner&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_ratings_users_movies</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">UserID</th>
<th style="text-align:right">MovieID</th>
<th style="text-align:right">Rating</th>
<th style="text-align:right">Timestamp</th>
<th style="text-align:right">Gender</th>
<th style="text-align:right">Age</th>
<th style="text-align:right">Occupation</th>
<th style="text-align:right">Zip-code</th>
<th style="text-align:right">Title</th>
<th style="text-align:right">Genres</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978300760</td>
<td style="text-align:right">F</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48067</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978298413</td>
<td style="text-align:right">M</td>
<td style="text-align:right">56</td>
<td style="text-align:right">16</td>
<td style="text-align:right">70072</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978220179</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">12</td>
<td style="text-align:right">32793</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">15</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978199279</td>
<td style="text-align:right">M</td>
<td style="text-align:right">25</td>
<td style="text-align:right">7</td>
<td style="text-align:right">22903</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">17</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978158471</td>
<td style="text-align:right">M</td>
<td style="text-align:right">50</td>
<td style="text-align:right">1</td>
<td style="text-align:right">95350</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">18</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">4</td>
<td style="text-align:right">978156168</td>
<td style="text-align:right">F</td>
<td style="text-align:right">18</td>
<td style="text-align:right">3</td>
<td style="text-align:right">95825</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">19</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">982730936</td>
<td style="text-align:right">M</td>
<td style="text-align:right">1</td>
<td style="text-align:right">10</td>
<td style="text-align:right">48073</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">24</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978136709</td>
<td style="text-align:right">F</td>
<td style="text-align:right">25</td>
<td style="text-align:right">7</td>
<td style="text-align:right">10023</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">28</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">3</td>
<td style="text-align:right">978125194</td>
<td style="text-align:right">F</td>
<td style="text-align:right">25</td>
<td style="text-align:right">1</td>
<td style="text-align:right">14607</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">33</td>
<td style="text-align:right">1193</td>
<td style="text-align:right">5</td>
<td style="text-align:right">978557765</td>
<td style="text-align:right">M</td>
<td style="text-align:right">45</td>
<td style="text-align:right">3</td>
<td style="text-align:right">55421</td>
<td style="text-align:right">One Flew Over the Cuckoo&rsquo;s Nest (1975)</td>
<td style="text-align:right">Drama</td>
</tr>
</tbody>
</table>
<h3 id="2ç†è§£mergeæ—¶æ•°é‡çš„å¯¹é½å…³ç³»">2ã€ç†è§£mergeæ—¶æ•°é‡çš„å¯¹é½å…³ç³»</h3>
<p>ä»¥ä¸‹å…³ç³»è¦æ­£ç¡®ç†è§£ï¼š</p>
<ul>
<li>one-to-oneï¼šä¸€å¯¹ä¸€å…³ç³»ï¼Œå…³è”çš„keyéƒ½æ˜¯å”¯ä¸€çš„
<ul>
<li>æ¯”å¦‚(å­¦å·ï¼Œå§“å) merge (å­¦å·ï¼Œå¹´é¾„)</li>
<li>ç»“æœæ¡æ•°ä¸ºï¼š1*1</li>
</ul>
</li>
<li>one-to-manyï¼šä¸€å¯¹å¤šå…³ç³»ï¼Œå·¦è¾¹å”¯ä¸€keyï¼Œå³è¾¹ä¸å”¯ä¸€key
<ul>
<li>æ¯”å¦‚(å­¦å·ï¼Œå§“å) merge (å­¦å·ï¼Œ[è¯­æ–‡æˆç»©ã€æ•°å­¦æˆç»©ã€è‹±è¯­æˆç»©])</li>
<li>ç»“æœæ¡æ•°ä¸ºï¼š1*N</li>
</ul>
</li>
<li>many-to-manyï¼šå¤šå¯¹å¤šå…³ç³»ï¼Œå·¦è¾¹å³è¾¹éƒ½ä¸æ˜¯å”¯ä¸€çš„
<ul>
<li>æ¯”å¦‚ï¼ˆå­¦å·ï¼Œ[è¯­æ–‡æˆç»©ã€æ•°å­¦æˆç»©ã€è‹±è¯­æˆç»©]ï¼‰ merge (å­¦å·ï¼Œ[ç¯®çƒã€è¶³çƒã€ä¹’ä¹“çƒ])</li>
<li>ç»“æœæ¡æ•°ä¸ºï¼šM*N</li>
</ul>
</li>
</ul>
<h4 id="21-one-to-one-ä¸€å¯¹ä¸€å…³ç³»çš„merge">2.1 one-to-one ä¸€å¯¹ä¸€å…³ç³»çš„merge</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/4.png" alt=""></p>
<p>In[12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sno&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;name_a&#39;</span><span class="p">,</span> <span class="s1">&#39;name_b&#39;</span><span class="p">,</span> <span class="s1">&#39;name_c&#39;</span><span class="p">,</span> <span class="s1">&#39;name_d&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                    <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">left</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">name_d</td>
</tr>
</tbody>
</table>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sno&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;21&#39;</span><span class="p">,</span> <span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;23&#39;</span><span class="p">,</span> <span class="s1">&#39;24&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                    <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">right</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">age</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">21</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">23</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">24</td>
</tr>
</tbody>
</table>
<p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä¸€å¯¹ä¸€å…³ç³»ï¼Œç»“æœä¸­æœ‰4æ¡</span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;sno&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
<th style="text-align:right">age</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">21</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
<td style="text-align:right">23</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">name_d</td>
<td style="text-align:right">24</td>
</tr>
</tbody>
</table>
<h4 id="22-one-to-many-ä¸€å¯¹å¤šå…³ç³»çš„merge">2.2 one-to-many ä¸€å¯¹å¤šå…³ç³»çš„merge</h4>
<p>æ³¨æ„ï¼šæ•°æ®ä¼šè¢«å¤åˆ¶</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/5.png" alt=""></p>
<p>In[15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sno&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;name_a&#39;</span><span class="p">,</span> <span class="s1">&#39;name_b&#39;</span><span class="p">,</span> <span class="s1">&#39;name_c&#39;</span><span class="p">,</span> <span class="s1">&#39;name_d&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                    <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">left</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">14</td>
<td style="text-align:right">name_d</td>
</tr>
</tbody>
</table>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sno&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                       <span class="s1">&#39;grade&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;è¯­æ–‡88&#39;</span><span class="p">,</span> <span class="s1">&#39;æ•°å­¦90&#39;</span><span class="p">,</span> <span class="s1">&#39;è‹±è¯­75&#39;</span><span class="p">,</span><span class="s1">&#39;è¯­æ–‡66&#39;</span><span class="p">,</span> <span class="s1">&#39;æ•°å­¦55&#39;</span><span class="p">,</span> <span class="s1">&#39;è‹±è¯­29&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                     <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">right</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">è¯­æ–‡88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">æ•°å­¦90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">è‹±è¯­75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">13</td>
<td style="text-align:right">è‹±è¯­29</td>
</tr>
</tbody>
</table>
<p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ•°ç›®ä»¥å¤šçš„ä¸€è¾¹ä¸ºå‡†</span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;sno&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">name</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">è¯­æ–‡88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">æ•°å­¦90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">name_a</td>
<td style="text-align:right">è‹±è¯­75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">name_b</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">13</td>
<td style="text-align:right">name_c</td>
<td style="text-align:right">è‹±è¯­29</td>
</tr>
</tbody>
</table>
<h4 id="23-many-to-many-å¤šå¯¹å¤šå…³ç³»çš„merge">2.3 many-to-many å¤šå¯¹å¤šå…³ç³»çš„merge</h4>
<p>æ³¨æ„ï¼šç»“æœæ•°é‡ä¼šå‡ºç°ä¹˜æ³•</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/6.png" alt=""></p>
<p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sno&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;çˆ±å¥½&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ç¯®çƒ&#39;</span><span class="p">,</span> <span class="s1">&#39;ç¾½æ¯›çƒ&#39;</span><span class="p">,</span> <span class="s1">&#39;ä¹’ä¹“çƒ&#39;</span><span class="p">,</span> <span class="s1">&#39;ç¯®çƒ&#39;</span><span class="p">,</span> <span class="s2">&#34;è¶³çƒ&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                    <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">left</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[18]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">çˆ±å¥½</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¯®çƒ</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¾½æ¯›çƒ</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ä¹’ä¹“çƒ</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ç¯®çƒ</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">è¶³çƒ</td>
</tr>
</tbody>
</table>
<p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sno&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                       <span class="s1">&#39;grade&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;è¯­æ–‡88&#39;</span><span class="p">,</span> <span class="s1">&#39;æ•°å­¦90&#39;</span><span class="p">,</span> <span class="s1">&#39;è‹±è¯­75&#39;</span><span class="p">,</span><span class="s1">&#39;è¯­æ–‡66&#39;</span><span class="p">,</span> <span class="s1">&#39;æ•°å­¦55&#39;</span><span class="p">,</span> <span class="s1">&#39;è‹±è¯­29&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                     <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">right</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">è¯­æ–‡88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">æ•°å­¦90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">è‹±è¯­75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">12</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">12</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">13</td>
<td style="text-align:right">è‹±è¯­29</td>
</tr>
</tbody>
</table>
<p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;sno&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[20]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sno</th>
<th style="text-align:right">çˆ±å¥½</th>
<th style="text-align:right">grade</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¯®çƒ</td>
<td style="text-align:right">è¯­æ–‡88</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¯®çƒ</td>
<td style="text-align:right">æ•°å­¦90</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¯®çƒ</td>
<td style="text-align:right">è‹±è¯­75</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¾½æ¯›çƒ</td>
<td style="text-align:right">è¯­æ–‡88</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¾½æ¯›çƒ</td>
<td style="text-align:right">æ•°å­¦90</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">11</td>
<td style="text-align:right">ç¾½æ¯›çƒ</td>
<td style="text-align:right">è‹±è¯­75</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ä¹’ä¹“çƒ</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ä¹’ä¹“çƒ</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ç¯®çƒ</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">12</td>
<td style="text-align:right">ç¯®çƒ</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">12</td>
<td style="text-align:right">è¶³çƒ</td>
<td style="text-align:right">è¯­æ–‡66</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">12</td>
<td style="text-align:right">è¶³çƒ</td>
<td style="text-align:right">æ•°å­¦55</td>
</tr>
</tbody>
</table>
<h3 id="3ç†è§£left-joinright-joininner-joinouter-joinçš„åŒºåˆ«">3ã€ç†è§£left joinã€right joinã€inner joinã€outer joinçš„åŒºåˆ«</h3>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/7.png" alt=""></p>
<p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">]})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K4&#39;</span><span class="p">,</span> <span class="s1">&#39;K5&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="s1">&#39;D5&#39;</span><span class="p">]})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">left
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[22]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
</tr>
</tbody>
</table>
<p>In [23]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">right</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[23]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table>
<h4 id="31-inner-joiné»˜è®¤">3.1 inner joinï¼Œé»˜è®¤</h4>
<p>å·¦è¾¹å’Œå³è¾¹çš„keyéƒ½æœ‰ï¼Œæ‰ä¼šå‡ºç°åœ¨ç»“æœé‡Œ</p>
<p>In [24]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[24]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
</tbody>
</table>
<h4 id="32-left-join">3.2 left join</h4>
<p>å·¦è¾¹çš„éƒ½ä¼šå‡ºç°åœ¨ç»“æœé‡Œï¼Œå³è¾¹çš„å¦‚æœæ— æ³•åŒ¹é…åˆ™ä¸ºNull</p>
<p>In [25]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[25]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
</tbody>
</table>
<h4 id="33-right-join">3.3 right join</h4>
<p>å³è¾¹çš„éƒ½ä¼šå‡ºç°åœ¨ç»“æœé‡Œï¼Œå·¦è¾¹çš„å¦‚æœæ— æ³•åŒ¹é…åˆ™ä¸ºNull</p>
<p>In [26]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[26]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table>
<h4 id="34-outer-join">3.4 outer join</h4>
<p>å·¦è¾¹ã€å³è¾¹çš„éƒ½ä¼šå‡ºç°åœ¨ç»“æœé‡Œï¼Œå¦‚æœæ— æ³•åŒ¹é…åˆ™ä¸ºNull</p>
<p>In [27]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[27]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table>
<h3 id="4å¦‚æœå‡ºç°ékeyçš„å­—æ®µé‡åæ€ä¹ˆåŠ">4ã€å¦‚æœå‡ºç°éKeyçš„å­—æ®µé‡åæ€ä¹ˆåŠ</h3>
<p>In [28]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">]})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K4&#39;</span><span class="p">,</span> <span class="s1">&#39;K5&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A10&#39;</span><span class="p">,</span> <span class="s1">&#39;A11&#39;</span><span class="p">,</span> <span class="s1">&#39;A12&#39;</span><span class="p">,</span> <span class="s1">&#39;A13&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                      <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="s1">&#39;D5&#39;</span><span class="p">]})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [29]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">left</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[29]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
</tr>
</tbody>
</table>
<p>In [30]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">right</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[30]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A10</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A11</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">K4</td>
<td style="text-align:right">A12</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">K5</td>
<td style="text-align:right">A13</td>
<td style="text-align:right">D5</td>
</tr>
</tbody>
</table>
<p>In [31]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[31]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A_x</th>
<th style="text-align:right">B</th>
<th style="text-align:right">A_y</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">A10</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">A11</td>
<td style="text-align:right">D1</td>
</tr>
</tbody>
</table>
<p>In [32]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_left&#39;</span><span class="p">,</span> <span class="s1">&#39;_right&#39;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[32]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">key</th>
<th style="text-align:right">A_left</th>
<th style="text-align:right">B</th>
<th style="text-align:right">A_right</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">K0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">A10</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">K1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">A11</td>
<td style="text-align:right">D1</td>
</tr>
</tbody>
</table>
<h1 id="14pandaså®ç°æ•°æ®çš„åˆå¹¶concat">14ã€Pandaså®ç°æ•°æ®çš„åˆå¹¶concat</h1>
<h4 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯ï¼š</h4>
<p>æ‰¹é‡åˆå¹¶ç›¸åŒæ ¼å¼çš„Excelã€ç»™DataFrameæ·»åŠ è¡Œã€ç»™DataFrameæ·»åŠ åˆ—</p>
<h4 id="ä¸€å¥è¯è¯´æ˜concatè¯­æ³•">ä¸€å¥è¯è¯´æ˜concatè¯­æ³•ï¼š</h4>
<ul>
<li>ä½¿ç”¨æŸç§åˆå¹¶æ–¹å¼(inner/outer)</li>
<li>æ²¿ç€æŸä¸ªè½´å‘(axis=0/1)</li>
<li>æŠŠå¤šä¸ªPandaså¯¹è±¡(DataFrame/Series)åˆå¹¶æˆä¸€ä¸ªã€‚</li>
</ul>
<h4 id="concatè¯­æ³•pandasconcatobjs-axis0-joinouter-ignore_indexfalse">concatè¯­æ³•ï¼špandas.concat(objs, axis=0, join=&lsquo;outer&rsquo;, ignore_index=False)</h4>
<ul>
<li>objsï¼šä¸€ä¸ªåˆ—è¡¨ï¼Œå†…å®¹å¯ä»¥æ˜¯DataFrameæˆ–è€…Seriesï¼Œå¯ä»¥æ··åˆ</li>
<li>axisï¼šé»˜è®¤æ˜¯0ä»£è¡¨æŒ‰è¡Œåˆå¹¶ï¼Œå¦‚æœç­‰äº1ä»£è¡¨æŒ‰åˆ—åˆå¹¶</li>
<li>joinï¼šåˆå¹¶çš„æ—¶å€™ç´¢å¼•çš„å¯¹é½æ–¹å¼ï¼Œé»˜è®¤æ˜¯outer joinï¼Œä¹Ÿå¯ä»¥æ˜¯inner join</li>
<li>ignore_indexï¼šæ˜¯å¦å¿½ç•¥æ‰åŸæ¥çš„æ•°æ®ç´¢å¼•</li>
</ul>
<h4 id="appendè¯­æ³•dataframeappendother-ignore_indexfalse">appendè¯­æ³•ï¼šDataFrame.append(other, ignore_index=False)</h4>
<p>appendåªæœ‰æŒ‰è¡Œåˆå¹¶ï¼Œæ²¡æœ‰æŒ‰åˆ—åˆå¹¶ï¼Œç›¸å½“äºconcatæŒ‰è¡Œçš„ç®€å†™å½¢å¼</p>
<ul>
<li>otherï¼šå•ä¸ªdataframeã€seriesã€dictï¼Œæˆ–è€…åˆ—è¡¨</li>
<li>ignore_indexï¼šæ˜¯å¦å¿½ç•¥æ‰åŸæ¥çš„æ•°æ®ç´¢å¼•</li>
</ul>
<h4 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£ï¼š</h4>
<ul>
<li>pandas.concatçš„apiæ–‡æ¡£ï¼šhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html</li>
<li>pandas.concatçš„æ•™ç¨‹ï¼šhttps://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html</li>
<li>pandas.appendçš„apiæ–‡æ¡£ï¼šhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html</li>
</ul>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">warnings</span>
</span></span><span class="line"><span class="cl"><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä¸€ä½¿ç”¨pandasconcatåˆå¹¶æ•°æ®">ä¸€ã€ä½¿ç”¨pandas.concatåˆå¹¶æ•°æ®</h3>
<p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;E0&#39;</span><span class="p">,</span> <span class="s1">&#39;E1&#39;</span><span class="p">,</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="s1">&#39;E3&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                   <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">df1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
</tr>
</tbody>
</table>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="s1">&#39;A7&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                     <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;B7&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                     <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="s1">&#39;C7&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                     <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="s1">&#39;D5&#39;</span><span class="p">,</span> <span class="s1">&#39;D6&#39;</span><span class="p">,</span> <span class="s1">&#39;D7&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                     <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">,</span> <span class="s1">&#39;F5&#39;</span><span class="p">,</span> <span class="s1">&#39;F6&#39;</span><span class="p">,</span> <span class="s1">&#39;F7&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                   <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">df2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
<td style="text-align:right">F4</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
<td style="text-align:right">F5</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
<td style="text-align:right">F6</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">F7</td>
</tr>
</tbody>
</table>
<p>*<strong>1ã€é»˜è®¤çš„concatï¼Œå‚æ•°ä¸ºaxis=0ã€join=outerã€ignore_index=False*</strong></p>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F4</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F5</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F6</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F7</td>
</tr>
</tbody>
</table>
<p>*<strong>2ã€ä½¿ç”¨ignore_index=Trueå¯ä»¥å¿½ç•¥åŸæ¥çš„ç´¢å¼•*</strong></p>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">NaN</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F5</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F6</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">F7</td>
</tr>
</tbody>
</table>
<p>*<strong>3ã€ä½¿ç”¨join=innerè¿‡æ»¤æ‰ä¸åŒ¹é…çš„åˆ—*</strong></p>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&#34;inner&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">A4</td>
<td style="text-align:right">B4</td>
<td style="text-align:right">C4</td>
<td style="text-align:right">D4</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">A5</td>
<td style="text-align:right">B5</td>
<td style="text-align:right">C5</td>
<td style="text-align:right">D5</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">A6</td>
<td style="text-align:right">B6</td>
<td style="text-align:right">C6</td>
<td style="text-align:right">D6</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">A7</td>
<td style="text-align:right">B7</td>
<td style="text-align:right">C7</td>
<td style="text-align:right">D7</td>
</tr>
</tbody>
</table>
<p>*<strong>4ã€ä½¿ç”¨axis=1ç›¸å½“äºæ·»åŠ æ–°åˆ—*</strong></p>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
</tr>
</tbody>
</table>
<p>*<strong>Aï¼šæ·»åŠ ä¸€åˆ—Series*</strong></p>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;F&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">s1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table>
<p>*<strong>Bï¼šæ·»åŠ å¤šåˆ—Series*</strong></p>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">s2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">]</span><span class="o">+</span><span class="s2">&#34;_GG&#34;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">s2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">0</span>    <span class="n">A0_GG</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>    <span class="n">A1_GG</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>    <span class="n">A2_GG</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>    <span class="n">A3_GG</span>
</span></span><span class="line"><span class="cl"><span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">s2</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s2">&#34;G&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">F</th>
<th style="text-align:right">G</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A0_GG</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">A1_GG</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">A2_GG</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">A3_GG</td>
</tr>
</tbody>
</table>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># åˆ—è¡¨å¯ä»¥åªæœ‰Series</span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">F</th>
<th style="text-align:right">G</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A0_GG</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">A1_GG</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">A2_GG</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">A3_GG</td>
</tr>
</tbody>
</table>
<p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># åˆ—è¡¨æ˜¯å¯ä»¥æ··åˆé¡ºåºçš„</span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span><span class="n">s2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">F</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right">E</th>
<th style="text-align:right">G</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">A0</td>
<td style="text-align:right">B0</td>
<td style="text-align:right">C0</td>
<td style="text-align:right">D0</td>
<td style="text-align:right">E0</td>
<td style="text-align:right">A0_GG</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">A1</td>
<td style="text-align:right">B1</td>
<td style="text-align:right">C1</td>
<td style="text-align:right">D1</td>
<td style="text-align:right">E1</td>
<td style="text-align:right">A1_GG</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">A2</td>
<td style="text-align:right">B2</td>
<td style="text-align:right">C2</td>
<td style="text-align:right">D2</td>
<td style="text-align:right">E2</td>
<td style="text-align:right">A2_GG</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
<td style="text-align:right">A3</td>
<td style="text-align:right">B3</td>
<td style="text-align:right">C3</td>
<td style="text-align:right">D3</td>
<td style="text-align:right">E3</td>
<td style="text-align:right">A3_GG</td>
</tr>
</tbody>
</table>
<h3 id="äºŒä½¿ç”¨dataframeappendæŒ‰è¡Œåˆå¹¶æ•°æ®">äºŒã€ä½¿ç”¨DataFrame.appendæŒ‰è¡Œåˆå¹¶æ•°æ®</h3>
<p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">df1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
</tbody>
</table>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">df2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
</tr>
</tbody>
</table>
<p>*<strong>1ã€ç»™1ä¸ªdataframeæ·»åŠ å¦ä¸€ä¸ªdataframe*</strong></p>
<p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
</tr>
</tbody>
</table>
<p>*<strong>2ã€å¿½ç•¥åŸæ¥çš„ç´¢å¼•ignore_index=True*</strong></p>
<p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[18]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">5</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">7</td>
<td style="text-align:right">8</td>
</tr>
</tbody>
</table>
<p>*<strong>3ã€å¯ä»¥ä¸€è¡Œä¸€è¡Œçš„ç»™DataFrameæ·»åŠ æ•°æ®*</strong></p>
<p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä¸€ä¸ªç©ºçš„df</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<p>*<strong>Aï¼šä½æ€§èƒ½ç‰ˆæœ¬*</strong></p>
<p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ³¨æ„è¿™é‡Œæ¯æ¬¡éƒ½åœ¨å¤åˆ¶</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[20]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
</tr>
</tbody>
</table>
<p>*<strong>Bï¼šæ€§èƒ½å¥½çš„ç‰ˆæœ¬*</strong></p>
<p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç¬¬ä¸€ä¸ªå…¥å‚æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œé¿å…äº†å¤šæ¬¡å¤åˆ¶</span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">i</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[21]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">4</td>
</tr>
</tbody>
</table>
<h1 id="15pandasæ‰¹é‡æ‹†åˆ†excelä¸åˆå¹¶excel">15ã€Pandasæ‰¹é‡æ‹†åˆ†Excelä¸åˆå¹¶Excel</h1>
<p>å®ä¾‹æ¼”ç¤ºï¼š</p>
<ol>
<li>å°†ä¸€ä¸ªå¤§Excelç­‰ä»½æ‹†æˆå¤šä¸ªExcel</li>
<li>å°†å¤šä¸ªå°Excelåˆå¹¶æˆä¸€ä¸ªå¤§Excelå¹¶æ ‡è®°æ¥æº</li>
</ol>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">work_dir</span><span class="o">=</span><span class="s2">&#34;./course_datas/c15_excel_split_merge&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">splits_dir</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">work_dir</span><span class="si">}</span><span class="s2">/splits&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">splits_dir</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">splits_dir</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="0è¯»å–æºexcelåˆ°pandas">0ã€è¯»å–æºExcelåˆ°Pandas</h3>
<p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_source</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">work_dir</span><span class="si">}</span><span class="s2">/crazyant_blog_articles_source.xlsx&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_source</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">id</th>
<th style="text-align:right">title</th>
<th style="text-align:right">tags</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2585</td>
<td style="text-align:right">Tensorflowæ€æ ·æ¥æ”¶å˜é•¿åˆ—è¡¨ç‰¹å¾</td>
<td style="text-align:right">python,tensorflow,ç‰¹å¾å·¥ç¨‹</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2583</td>
<td style="text-align:right">Pandaså®ç°æ•°æ®çš„åˆå¹¶concat</td>
<td style="text-align:right">pandas,python,æ•°æ®åˆ†æ</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2574</td>
<td style="text-align:right">Pandasçš„Indexç´¢å¼•æœ‰ä»€ä¹ˆç”¨é€”ï¼Ÿ</td>
<td style="text-align:right">pandas,python,æ•°æ®åˆ†æ</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2564</td>
<td style="text-align:right">æœºå™¨å­¦ä¹ å¸¸ç”¨æ•°æ®é›†å¤§å…¨</td>
<td style="text-align:right">python,æœºå™¨å­¦ä¹ </td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2561</td>
<td style="text-align:right">ä¸€ä¸ªæ•°æ®ç§‘å­¦å®¶çš„ä¿®ç‚¼è·¯å¾„</td>
<td style="text-align:right">æ•°æ®åˆ†æ</td>
</tr>
</tbody>
</table>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_source</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">258</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_source</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">258</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">total_row_count</span> <span class="o">=</span> <span class="n">df_source</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">total_row_count</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">258</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä¸€å°†ä¸€ä¸ªå¤§excelç­‰ä»½æ‹†æˆå¤šä¸ªexcel">ä¸€ã€å°†ä¸€ä¸ªå¤§Excelç­‰ä»½æ‹†æˆå¤šä¸ªExcel</h3>
<ol>
<li>ä½¿ç”¨df.ilocæ–¹æ³•ï¼Œå°†ä¸€ä¸ªå¤§çš„dataframeï¼Œæ‹†åˆ†æˆå¤šä¸ªå°dataframe</li>
<li>å°†ä½¿ç”¨dataframe.to_excelä¿å­˜æ¯ä¸ªå°Excel</li>
</ol>
<h4 id="1è®¡ç®—æ‹†åˆ†åçš„æ¯ä¸ªexcelçš„è¡Œæ•°">1ã€è®¡ç®—æ‹†åˆ†åçš„æ¯ä¸ªexcelçš„è¡Œæ•°</h4>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># è¿™ä¸ªå¤§excelï¼Œä¼šæ‹†åˆ†ç»™è¿™å‡ ä¸ªäºº</span>
</span></span><span class="line"><span class="cl"><span class="n">user_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;xiao_shuai&#34;</span><span class="p">,</span> <span class="s2">&#34;xiao_wang&#34;</span><span class="p">,</span> <span class="s2">&#34;xiao_ming&#34;</span><span class="p">,</span> <span class="s2">&#34;xiao_lei&#34;</span><span class="p">,</span> <span class="s2">&#34;xiao_bo&#34;</span><span class="p">,</span> <span class="s2">&#34;xiao_hong&#34;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ¯ä¸ªäººçš„ä»»åŠ¡æ•°ç›®</span>
</span></span><span class="line"><span class="cl"><span class="n">split_size</span> <span class="o">=</span> <span class="n">total_row_count</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="n">user_names</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">total_row_count</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">user_names</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">split_size</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">split_size</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mi">43</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2æ‹†åˆ†æˆå¤šä¸ªdataframe">2ã€æ‹†åˆ†æˆå¤šä¸ªdataframe</h4>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_subs</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">user_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">user_names</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ilocçš„å¼€å§‹ç´¢å¼•</span>
</span></span><span class="line"><span class="cl">    <span class="n">begin</span> <span class="o">=</span> <span class="n">idx</span><span class="o">*</span><span class="n">split_size</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ilocçš„ç»“æŸç´¢å¼•</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span> <span class="o">=</span> <span class="n">begin</span><span class="o">+</span><span class="n">split_size</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å®ç°dfæŒ‰ç…§ilocæ‹†åˆ†</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_sub</span> <span class="o">=</span> <span class="n">df_source</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">begin</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å°†æ¯ä¸ªå­dfå­˜å…¥åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_subs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="n">user_name</span><span class="p">,</span> <span class="n">df_sub</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="3å°†æ¯ä¸ªdatafameå­˜å…¥excel">3ã€å°†æ¯ä¸ªdatafameå­˜å…¥excel</h4>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">user_name</span><span class="p">,</span> <span class="n">df_sub</span> <span class="ow">in</span> <span class="n">df_subs</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">splits_dir</span><span class="si">}</span><span class="s2">/crazyant_blog_articles_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2">.xlsx&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_sub</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="äºŒåˆå¹¶å¤šä¸ªå°excelåˆ°ä¸€ä¸ªå¤§excel">äºŒã€åˆå¹¶å¤šä¸ªå°Excelåˆ°ä¸€ä¸ªå¤§Excel</h3>
<ol>
<li>éå†æ–‡ä»¶å¤¹ï¼Œå¾—åˆ°è¦åˆå¹¶çš„Excelæ–‡ä»¶åˆ—è¡¨</li>
<li>åˆ†åˆ«è¯»å–åˆ°dataframeï¼Œç»™æ¯ä¸ªdfæ·»åŠ ä¸€åˆ—ç”¨äºæ ‡è®°æ¥æº</li>
<li>ä½¿ç”¨pd.concatè¿›è¡Œdfæ‰¹é‡åˆå¹¶</li>
<li>å°†åˆå¹¶åçš„dataframeè¾“å‡ºåˆ°excel</li>
</ol>
<h4 id="1-éå†æ–‡ä»¶å¤¹å¾—åˆ°è¦åˆå¹¶çš„excelåç§°åˆ—è¡¨">1. éå†æ–‡ä»¶å¤¹ï¼Œå¾—åˆ°è¦åˆå¹¶çš„Excelåç§°åˆ—è¡¨</h4>
<p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="n">excel_names</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">excel_name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">splits_dir</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">excel_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">excel_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">excel_names</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;crazyant_blog_articles_0_xiao_shuai.xlsx&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;crazyant_blog_articles_1_xiao_wang.xlsx&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;crazyant_blog_articles_2_xiao_ming.xlsx&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;crazyant_blog_articles_3_xiao_lei.xlsx&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;crazyant_blog_articles_4_xiao_bo.xlsx&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;crazyant_blog_articles_5_xiao_hong.xlsx&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2-åˆ†åˆ«è¯»å–åˆ°dataframe">2. åˆ†åˆ«è¯»å–åˆ°dataframe</h4>
<p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">excel_name</span> <span class="ow">in</span> <span class="n">excel_names</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è¯»å–æ¯ä¸ªexcelåˆ°df</span>
</span></span><span class="line"><span class="cl">    <span class="n">excel_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">splits_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">excel_name</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_split</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">excel_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å¾—åˆ°username</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span> <span class="o">=</span> <span class="n">excel_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;crazyant_blog_articles_&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;.xlsx&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">excel_name</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç»™æ¯ä¸ªdfæ·»åŠ 1åˆ—ï¼Œå³ç”¨æˆ·åå­—</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_split</span><span class="p">[</span><span class="s2">&#34;username&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_split</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">crazyant_blog_articles_0_xiao_shuai</span><span class="o">.</span><span class="n">xlsx</span> <span class="n">xiao_shuai</span>
</span></span><span class="line"><span class="cl"><span class="n">crazyant_blog_articles_1_xiao_wang</span><span class="o">.</span><span class="n">xlsx</span> <span class="n">xiao_wang</span>
</span></span><span class="line"><span class="cl"><span class="n">crazyant_blog_articles_2_xiao_ming</span><span class="o">.</span><span class="n">xlsx</span> <span class="n">xiao_ming</span>
</span></span><span class="line"><span class="cl"><span class="n">crazyant_blog_articles_3_xiao_lei</span><span class="o">.</span><span class="n">xlsx</span> <span class="n">xiao_lei</span>
</span></span><span class="line"><span class="cl"><span class="n">crazyant_blog_articles_4_xiao_bo</span><span class="o">.</span><span class="n">xlsx</span> <span class="n">xiao_bo</span>
</span></span><span class="line"><span class="cl"><span class="n">crazyant_blog_articles_5_xiao_hong</span><span class="o">.</span><span class="n">xlsx</span> <span class="n">xiao_hong</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="3-ä½¿ç”¨pdconcatè¿›è¡Œåˆå¹¶">3. ä½¿ç”¨pd.concatè¿›è¡Œåˆå¹¶</h4>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merged</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">258</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merged</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[18]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">id</th>
<th style="text-align:right">title</th>
<th style="text-align:right">tags</th>
<th style="text-align:right">username</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2585</td>
<td style="text-align:right">Tensorflowæ€æ ·æ¥æ”¶å˜é•¿åˆ—è¡¨ç‰¹å¾</td>
<td style="text-align:right">python,tensorflow,ç‰¹å¾å·¥ç¨‹</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2583</td>
<td style="text-align:right">Pandaså®ç°æ•°æ®çš„åˆå¹¶concat</td>
<td style="text-align:right">pandas,python,æ•°æ®åˆ†æ</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2574</td>
<td style="text-align:right">Pandasçš„Indexç´¢å¼•æœ‰ä»€ä¹ˆç”¨é€”ï¼Ÿ</td>
<td style="text-align:right">pandas,python,æ•°æ®åˆ†æ</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2564</td>
<td style="text-align:right">æœºå™¨å­¦ä¹ å¸¸ç”¨æ•°æ®é›†å¤§å…¨</td>
<td style="text-align:right">python,æœºå™¨å­¦ä¹ </td>
<td style="text-align:right">xiao_shuai</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2561</td>
<td style="text-align:right">ä¸€ä¸ªæ•°æ®ç§‘å­¦å®¶çš„ä¿®ç‚¼è·¯å¾„</td>
<td style="text-align:right">æ•°æ®åˆ†æ</td>
<td style="text-align:right">xiao_shuai</td>
</tr>
</tbody>
</table>
<p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merged</span><span class="p">[</span><span class="s2">&#34;username&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">xiao_hong</span>     <span class="mi">43</span>
</span></span><span class="line"><span class="cl"><span class="n">xiao_bo</span>       <span class="mi">43</span>
</span></span><span class="line"><span class="cl"><span class="n">xiao_shuai</span>    <span class="mi">43</span>
</span></span><span class="line"><span class="cl"><span class="n">xiao_lei</span>      <span class="mi">43</span>
</span></span><span class="line"><span class="cl"><span class="n">xiao_wang</span>     <span class="mi">43</span>
</span></span><span class="line"><span class="cl"><span class="n">xiao_ming</span>     <span class="mi">43</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="4-å°†åˆå¹¶åçš„dataframeè¾“å‡ºåˆ°excel">4. å°†åˆå¹¶åçš„dataframeè¾“å‡ºåˆ°excel</h4>
<p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df_merged</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">work_dir</span><span class="si">}</span><span class="s2">/crazyant_blog_articles_merged.xlsx&#34;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="16pandasæ€æ ·å®ç°groupbyåˆ†ç»„ç»Ÿè®¡">16ã€Pandasæ€æ ·å®ç°groupbyåˆ†ç»„ç»Ÿè®¡</h1>
<p>ç±»ä¼¼SQLï¼š
select city,max(temperature) from city_weather group by city;</p>
<p>groupbyï¼šå…ˆå¯¹æ•°æ®åˆ†ç»„ï¼Œç„¶ååœ¨æ¯ä¸ªåˆ†ç»„ä¸Šåº”ç”¨èšåˆå‡½æ•°ã€è½¬æ¢å‡½æ•°</p>
<p>æœ¬æ¬¡æ¼”ç¤ºï¼š
ä¸€ã€åˆ†ç»„ä½¿ç”¨èšåˆå‡½æ•°åšæ•°æ®ç»Ÿè®¡
äºŒã€éå†groupbyçš„ç»“æœç†è§£æ‰§è¡Œæµç¨‹
ä¸‰ã€å®ä¾‹åˆ†ç»„æ¢ç´¢å¤©æ°”æ•°æ®</p>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åŠ ä¸Šè¿™ä¸€å¥ï¼Œèƒ½åœ¨jupyter notebookå±•ç¤ºmatplotå›¾è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                   <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">)})</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">0.542903</td>
<td style="text-align:right">0.788896</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.903407</td>
<td style="text-align:right">0.428031</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-1.093602</td>
<td style="text-align:right">0.837348</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.665189</td>
<td style="text-align:right">-1.505290</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-0.498339</td>
<td style="text-align:right">0.534438</td>
</tr>
</tbody>
</table>
<h3 id="ä¸€åˆ†ç»„ä½¿ç”¨èšåˆå‡½æ•°åšæ•°æ®ç»Ÿè®¡">ä¸€ã€åˆ†ç»„ä½¿ç”¨èšåˆå‡½æ•°åšæ•°æ®ç»Ÿè®¡</h3>
<h4 id="1å•ä¸ªåˆ—groupbyæŸ¥è¯¢æ‰€æœ‰æ•°æ®åˆ—çš„ç»Ÿè®¡">1ã€å•ä¸ªåˆ—groupbyï¼ŒæŸ¥è¯¢æ‰€æœ‰æ•°æ®åˆ—çš„ç»Ÿè®¡</h4>
<p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">0.436595</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">1.083423</td>
</tr>
</tbody>
</table>
<p>æˆ‘ä»¬çœ‹åˆ°ï¼š</p>
<ol>
<li>groupbyä¸­çš„&rsquo;A&rsquo;å˜æˆäº†æ•°æ®çš„ç´¢å¼•åˆ—</li>
<li>å› ä¸ºè¦ç»Ÿè®¡sumï¼Œä½†Båˆ—ä¸æ˜¯æ•°å­—ï¼Œæ‰€ä»¥è¢«è‡ªåŠ¨å¿½ç•¥æ‰</li>
</ol>
<h4 id="2å¤šä¸ªåˆ—groupbyæŸ¥è¯¢æ‰€æœ‰æ•°æ®åˆ—çš„ç»Ÿè®¡">2ã€å¤šä¸ªåˆ—groupbyï¼ŒæŸ¥è¯¢æ‰€æœ‰æ•°æ®åˆ—çš„ç»Ÿè®¡</h4>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right">B</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.061143</td>
<td style="text-align:right">-0.358197</td>
</tr>
<tr>
<td style="text-align:right">three</td>
<td style="text-align:right">-0.498339</td>
<td style="text-align:right">0.534438</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.998504</td>
<td style="text-align:right">0.632690</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<p>æˆ‘ä»¬çœ‹åˆ°ï¼š(&lsquo;A&rsquo;,&lsquo;B&rsquo;)æˆå¯¹å˜æˆäº†äºŒçº§ç´¢å¼•</p>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.061143</td>
<td style="text-align:right">-0.358197</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-0.498339</td>
<td style="text-align:right">0.534438</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.998504</td>
<td style="text-align:right">0.632690</td>
</tr>
</tbody>
</table>
<h4 id="3åŒæ—¶æŸ¥çœ‹å¤šç§æ•°æ®ç»Ÿè®¡">3ã€åŒæ—¶æŸ¥çœ‹å¤šç§æ•°æ®ç»Ÿè®¡</h4>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"></td>
<td style="text-align:right">sum</td>
<td style="text-align:right">mean</td>
<td style="text-align:right">std</td>
<td style="text-align:right">sum</td>
<td style="text-align:right">mean</td>
<td style="text-align:right">std</td>
</tr>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">-0.714313</td>
<td style="text-align:right">0.741583</td>
<td style="text-align:right">0.436595</td>
<td style="text-align:right">0.145532</td>
<td style="text-align:right">0.526544</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">-0.523527</td>
<td style="text-align:right">0.637822</td>
<td style="text-align:right">1.083423</td>
<td style="text-align:right">0.216685</td>
<td style="text-align:right">0.977686</td>
</tr>
</tbody>
</table>
<p>æˆ‘ä»¬çœ‹åˆ°ï¼šåˆ—å˜æˆäº†å¤šçº§ç´¢å¼•</p>
<h4 id="4æŸ¥çœ‹å•åˆ—çš„ç»“æœæ•°æ®ç»Ÿè®¡">4ã€æŸ¥çœ‹å•åˆ—çš„ç»“æœæ•°æ®ç»Ÿè®¡</h4>
<p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ–¹æ³•1ï¼šé¢„è¿‡æ»¤ï¼Œæ€§èƒ½æ›´å¥½</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sum</th>
<th style="text-align:right">mean</th>
<th style="text-align:right">std</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">-0.714313</td>
<td style="text-align:right">0.741583</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">-0.523527</td>
<td style="text-align:right">0.637822</td>
</tr>
</tbody>
</table>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ–¹æ³•2</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">])[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sum</th>
<th style="text-align:right">mean</th>
<th style="text-align:right">std</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">-0.714313</td>
<td style="text-align:right">0.741583</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">-0.523527</td>
<td style="text-align:right">0.637822</td>
</tr>
</tbody>
</table>
<h4 id="5ä¸åŒåˆ—ä½¿ç”¨ä¸åŒçš„èšåˆå‡½æ•°">5ã€ä¸åŒåˆ—ä½¿ç”¨ä¸åŒçš„èšåˆå‡½æ•°</h4>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&#34;C&#34;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="s2">&#34;D&#34;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">A</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">bar</td>
<td style="text-align:right">-2.142940</td>
<td style="text-align:right">0.145532</td>
</tr>
<tr>
<td style="text-align:right">foo</td>
<td style="text-align:right">-2.617633</td>
<td style="text-align:right">0.216685</td>
</tr>
</tbody>
</table>
<h3 id="äºŒéå†groupbyçš„ç»“æœç†è§£æ‰§è¡Œæµç¨‹">äºŒã€éå†groupbyçš„ç»“æœç†è§£æ‰§è¡Œæµç¨‹</h3>
<p>forå¾ªç¯å¯ä»¥ç›´æ¥éå†æ¯ä¸ªgroup</p>
<h5 id="1éå†å•ä¸ªåˆ—èšåˆçš„åˆ†ç»„">1ã€éå†å•ä¸ªåˆ—èšåˆçš„åˆ†ç»„</h5>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">groupby</span><span class="o">.</span><span class="n">generic</span><span class="o">.</span><span class="n">DataFrameGroupBy</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x00000123B250E548</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">group</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">bar</span>
</span></span><span class="line"><span class="cl">     <span class="n">A</span>      <span class="n">B</span>         <span class="n">C</span>         <span class="n">D</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>  <span class="n">bar</span>    <span class="n">one</span> <span class="o">-</span><span class="mf">0.375789</span> <span class="o">-</span><span class="mf">0.345869</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>  <span class="n">bar</span>  <span class="n">three</span> <span class="o">-</span><span class="mf">1.564748</span>  <span class="mf">0.081163</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span>  <span class="n">bar</span>    <span class="n">two</span> <span class="o">-</span><span class="mf">0.202403</span>  <span class="mf">0.701301</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">foo</span>
</span></span><span class="line"><span class="cl">     <span class="n">A</span>      <span class="n">B</span>         <span class="n">C</span>         <span class="n">D</span>
</span></span><span class="line"><span class="cl"><span class="mi">0</span>  <span class="n">foo</span>    <span class="n">one</span>  <span class="mf">0.542903</span>  <span class="mf">0.788896</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>  <span class="n">foo</span>    <span class="n">two</span> <span class="o">-</span><span class="mf">0.903407</span>  <span class="mf">0.428031</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>  <span class="n">foo</span>    <span class="n">two</span> <span class="o">-</span><span class="mf">1.093602</span>  <span class="mf">0.837348</span>
</span></span><span class="line"><span class="cl"><span class="mi">6</span>  <span class="n">foo</span>    <span class="n">one</span> <span class="o">-</span><span class="mf">0.665189</span> <span class="o">-</span><span class="mf">1.505290</span>
</span></span><span class="line"><span class="cl"><span class="mi">7</span>  <span class="n">foo</span>  <span class="n">three</span> <span class="o">-</span><span class="mf">0.498339</span>  <span class="mf">0.534438</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>*<strong>å¯ä»¥è·å–å•ä¸ªåˆ†ç»„çš„æ•°æ®*</strong></p>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.375789</td>
<td style="text-align:right">-0.345869</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">three</td>
<td style="text-align:right">-1.564748</td>
<td style="text-align:right">0.081163</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.202403</td>
<td style="text-align:right">0.701301</td>
</tr>
</tbody>
</table>
<h5 id="2éå†å¤šä¸ªåˆ—èšåˆçš„åˆ†ç»„">2ã€éå†å¤šä¸ªåˆ—èšåˆçš„åˆ†ç»„</h5>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">for name,group in g:
</span></span><span class="line"><span class="cl">    print(name)
</span></span><span class="line"><span class="cl">    print(group)
</span></span><span class="line"><span class="cl">    print()
</span></span><span class="line"><span class="cl">(&#39;bar&#39;, &#39;one&#39;)
</span></span><span class="line"><span class="cl">     A    B         C         D
</span></span><span class="line"><span class="cl">1  bar  one -0.375789 -0.345869
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(&#39;bar&#39;, &#39;three&#39;)
</span></span><span class="line"><span class="cl">     A      B         C         D
</span></span><span class="line"><span class="cl">3  bar  three -1.564748  0.081163
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(&#39;bar&#39;, &#39;two&#39;)
</span></span><span class="line"><span class="cl">     A    B         C         D
</span></span><span class="line"><span class="cl">5  bar  two -0.202403  0.701301
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(&#39;foo&#39;, &#39;one&#39;)
</span></span><span class="line"><span class="cl">     A    B         C         D
</span></span><span class="line"><span class="cl">0  foo  one  0.542903  0.788896
</span></span><span class="line"><span class="cl">6  foo  one -0.665189 -1.505290
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(&#39;foo&#39;, &#39;three&#39;)
</span></span><span class="line"><span class="cl">     A      B         C         D
</span></span><span class="line"><span class="cl">7  foo  three -0.498339  0.534438
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(&#39;foo&#39;, &#39;two&#39;)
</span></span><span class="line"><span class="cl">     A    B         C         D
</span></span><span class="line"><span class="cl">2  foo  two -0.903407  0.428031
</span></span><span class="line"><span class="cl">4  foo  two -1.093602  0.837348
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œnameæ˜¯ä¸€ä¸ª2ä¸ªå…ƒç´ çš„tupleï¼Œä»£è¡¨ä¸åŒçš„åˆ—</p>
<p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">get_group</span><span class="p">((</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">0.542903</td>
<td style="text-align:right">0.788896</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">-0.665189</td>
<td style="text-align:right">-1.505290</td>
</tr>
</tbody>
</table>
<p>*<strong>å¯ä»¥ç›´æ¥æŸ¥è¯¢groupåçš„æŸå‡ åˆ—ï¼Œç”ŸæˆSeriesæˆ–è€…å­DataFrame*</strong></p>
<p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">g</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">groupby</span><span class="o">.</span><span class="n">generic</span><span class="o">.</span><span class="n">SeriesGroupBy</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x00000123C33F64C8</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">group</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>   <span class="o">-</span><span class="mf">0.375789</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">C</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>   <span class="o">-</span><span class="mf">1.564748</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">C</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span>   <span class="o">-</span><span class="mf">0.202403</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">C</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">0</span>    <span class="mf">0.542903</span>
</span></span><span class="line"><span class="cl"><span class="mi">6</span>   <span class="o">-</span><span class="mf">0.665189</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">C</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">7</span>   <span class="o">-</span><span class="mf">0.498339</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">C</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="s1">&#39;&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>   <span class="o">-</span><span class="mf">0.903407</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>   <span class="o">-</span><span class="mf">1.093602</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">C</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="s1">&#39;&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶å®æ‰€æœ‰çš„èšåˆç»Ÿè®¡ï¼Œéƒ½æ˜¯åœ¨dataframeå’Œseriesä¸Šè¿›è¡Œçš„ï¼›</p>
<h3 id="ä¸‰å®ä¾‹åˆ†ç»„æ¢ç´¢å¤©æ°”æ•°æ®">ä¸‰ã€å®ä¾‹åˆ†ç»„æ¢ç´¢å¤©æ°”æ•°æ®</h3>
<p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fpath</span> <span class="o">=</span> <span class="s2">&#34;./datas/beijing_tianqi/beijing_tianqi_2018.csv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ›¿æ¢æ‰æ¸©åº¦çš„åç¼€â„ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&#34;bWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;bWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&#34;yWendu&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;yWendu&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;â„ƒ&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[18]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ–°å¢ä¸€åˆ—ä¸ºæœˆä»½</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ymd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
<th style="text-align:right">month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
</tbody>
</table>
<h4 id="1æŸ¥çœ‹æ¯ä¸ªæœˆçš„æœ€é«˜æ¸©åº¦">1ã€æŸ¥çœ‹æ¯ä¸ªæœˆçš„æœ€é«˜æ¸©åº¦</h4>
<p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)[</span><span class="s1">&#39;bWendu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">month</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">01</span>     <span class="mi">7</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">02</span>    <span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">03</span>    <span class="mi">27</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">04</span>    <span class="mi">30</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">05</span>    <span class="mi">35</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">06</span>    <span class="mi">38</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">07</span>    <span class="mi">37</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">08</span>    <span class="mi">36</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span>    <span class="mi">31</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">10</span>    <span class="mi">25</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">11</span>    <span class="mi">18</span>
</span></span><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">12</span>    <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">bWendu</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x123c344b308</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/python_pandas/8.png" alt=""></p>
<h4 id="2æŸ¥çœ‹æ¯ä¸ªæœˆçš„æœ€é«˜æ¸©åº¦æœ€ä½æ¸©åº¦å¹³å‡ç©ºæ°”è´¨é‡æŒ‡æ•°">2ã€æŸ¥çœ‹æ¯ä¸ªæœˆçš„æœ€é«˜æ¸©åº¦ã€æœ€ä½æ¸©åº¦ã€å¹³å‡ç©ºæ°”è´¨é‡æŒ‡æ•°</h4>
<p>In [23]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[23]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ymd</th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">tianqi</th>
<th style="text-align:right">fengxiang</th>
<th style="text-align:right">fengli</th>
<th style="text-align:right">aqi</th>
<th style="text-align:right">aqiInfo</th>
<th style="text-align:right">aqiLevel</th>
<th style="text-align:right">month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2018-01-01</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">æ™´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">59</td>
<td style="text-align:right">è‰¯</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01-02</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">é˜´~å¤šäº‘</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">49</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2018-01-03</td>
<td style="text-align:right">2</td>
<td style="text-align:right">-5</td>
<td style="text-align:right">å¤šäº‘</td>
<td style="text-align:right">åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2018-01-04</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-8</td>
<td style="text-align:right">é˜´</td>
<td style="text-align:right">ä¸œåŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">28</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2018-01-05</td>
<td style="text-align:right">3</td>
<td style="text-align:right">-6</td>
<td style="text-align:right">å¤šäº‘~æ™´</td>
<td style="text-align:right">è¥¿åŒ—é£</td>
<td style="text-align:right">1-2çº§</td>
<td style="text-align:right">50</td>
<td style="text-align:right">ä¼˜</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2018-01</td>
</tr>
</tbody>
</table>
<p>In [24]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">group_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&#34;bWendu&#34;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="s2">&#34;yWendu&#34;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="s2">&#34;aqi&#34;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">group_data</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[24]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">bWendu</th>
<th style="text-align:right">yWendu</th>
<th style="text-align:right">aqi</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">month</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2018-01</td>
<td style="text-align:right">7</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">60.677419</td>
</tr>
<tr>
<td style="text-align:right">2018-02</td>
<td style="text-align:right">12</td>
<td style="text-align:right">-10</td>
<td style="text-align:right">78.857143</td>
</tr>
<tr>
<td style="text-align:right">2018-03</td>
<td style="text-align:right">27</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">130.322581</td>
</tr>
<tr>
<td style="text-align:right">2018-04</td>
<td style="text-align:right">30</td>
<td style="text-align:right">1</td>
<td style="text-align:right">102.866667</td>
</tr>
<tr>
<td style="text-align:right">2018-05</td>
<td style="text-align:right">35</td>
<td style="text-align:right">10</td>
<td style="text-align:right">99.064516</td>
</tr>
<tr>
<td style="text-align:right">2018-06</td>
<td style="text-align:right">38</td>
<td style="text-align:right">17</td>
<td style="text-align:right">82.300000</td>
</tr>
<tr>
<td style="text-align:right">2018-07</td>
<td style="text-align:right">37</td>
<td style="text-align:right">22</td>
<td style="text-align:right">72.677419</td>
</tr>
<tr>
<td style="text-align:right">2018-08</td>
<td style="text-align:right">36</td>
<td style="text-align:right">20</td>
<td style="text-align:right">59.516129</td>
</tr>
<tr>
<td style="text-align:right">2018-09</td>
<td style="text-align:right">31</td>
<td style="text-align:right">11</td>
<td style="text-align:right">50.433333</td>
</tr>
<tr>
<td style="text-align:right">2018-10</td>
<td style="text-align:right">25</td>
<td style="text-align:right">1</td>
<td style="text-align:right">67.096774</td>
</tr>
<tr>
<td style="text-align:right">2018-11</td>
<td style="text-align:right">18</td>
<td style="text-align:right">-4</td>
<td style="text-align:right">105.100000</td>
</tr>
<tr>
<td style="text-align:right">2018-12</td>
<td style="text-align:right">10</td>
<td style="text-align:right">-12</td>
<td style="text-align:right">77.354839</td>
</tr>
</tbody>
</table>
<p>In [25]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">group_data</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[25]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x123c5502d48</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/python_pandas/9.png" alt=""></p>
<h1 id="17pandasçš„åˆ†å±‚ç´¢å¼•multiindex">17ã€Pandasçš„åˆ†å±‚ç´¢å¼•MultiIndex</h1>
<p>ä¸ºä»€ä¹ˆè¦å­¦ä¹ åˆ†å±‚ç´¢å¼•MultiIndexï¼Ÿ</p>
<ul>
<li>åˆ†å±‚ç´¢å¼•ï¼šåœ¨ä¸€ä¸ªè½´å‘ä¸Šæ‹¥æœ‰å¤šä¸ªç´¢å¼•å±‚çº§ï¼Œå¯ä»¥è¡¨è¾¾æ›´é«˜ç»´åº¦æ•°æ®çš„å½¢å¼ï¼›</li>
<li>å¯ä»¥æ›´æ–¹ä¾¿çš„è¿›è¡Œæ•°æ®ç­›é€‰ï¼Œå¦‚æœæœ‰åºåˆ™æ€§èƒ½æ›´å¥½ï¼›</li>
<li>groupbyç­‰æ“ä½œçš„ç»“æœï¼Œå¦‚æœæ˜¯å¤šKEYï¼Œç»“æœæ˜¯åˆ†å±‚ç´¢å¼•ï¼Œéœ€è¦ä¼šä½¿ç”¨</li>
<li>ä¸€èˆ¬ä¸éœ€è¦è‡ªå·±åˆ›å»ºåˆ†å±‚ç´¢å¼•(MultiIndexæœ‰æ„é€ å‡½æ•°ä½†ä¸€èˆ¬ä¸ç”¨)</li>
</ul>
<p>æ¼”ç¤ºæ•°æ®ï¼šç™¾åº¦ã€é˜¿é‡Œå·´å·´ã€çˆ±å¥‡è‰ºã€äº¬ä¸œå››å®¶å…¬å¸çš„10å¤©è‚¡ç¥¨æ•°æ®
æ•°æ®æ¥è‡ªï¼šè‹±ä¸ºè´¢ç»
<a href="https://cn.investing.com/">https://cn.investing.com/</a></p>
<p>æœ¬æ¬¡æ¼”ç¤ºæçº²ï¼š
ä¸€ã€Seriesçš„åˆ†å±‚ç´¢å¼•MultiIndex
äºŒã€Seriesæœ‰å¤šå±‚ç´¢å¼•æ€æ ·ç­›é€‰æ•°æ®ï¼Ÿ
ä¸‰ã€DataFrameçš„å¤šå±‚ç´¢å¼•MultiIndex
å››ã€DataFrameæœ‰å¤šå±‚ç´¢å¼•æ€æ ·ç­›é€‰æ•°æ®ï¼Ÿ</p>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;./datas/stocks/äº’è”ç½‘å…¬å¸è‚¡ç¥¨.xlsx&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">---------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">574</span><span class="n">feeeb8bb0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">stocks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;./datas/stocks/äº’è”ç½‘å…¬å¸è‚¡ç¥¨.xlsx&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pd&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[4]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
</tbody>
</table>
<p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="p">[</span><span class="s2">&#34;å…¬å¸&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">array</span><span class="p">([</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;BABA&#39;</span><span class="p">,</span> <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;JD&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;å…¬å¸&#39;</span><span class="p">)[</span><span class="s2">&#34;æ”¶ç›˜&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">å…¬å¸</span>
</span></span><span class="line"><span class="cl"><span class="n">BABA</span>    <span class="mf">166.80</span>
</span></span><span class="line"><span class="cl"><span class="n">BIDU</span>    <span class="mf">102.98</span>
</span></span><span class="line"><span class="cl"><span class="n">IQ</span>       <span class="mf">15.90</span>
</span></span><span class="line"><span class="cl"><span class="n">JD</span>       <span class="mf">28.35</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">æ”¶ç›˜</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä¸€seriesçš„åˆ†å±‚ç´¢å¼•multiindex">ä¸€ã€Seriesçš„åˆ†å±‚ç´¢å¼•MultiIndex</h3>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ser</span> <span class="o">=</span> <span class="n">stocks</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;å…¬å¸&#39;</span><span class="p">,</span> <span class="s1">&#39;æ—¥æœŸ&#39;</span><span class="p">])[</span><span class="s1">&#39;æ”¶ç›˜&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ser</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">å…¬å¸</span>    <span class="n">æ—¥æœŸ</span>        
</span></span><span class="line"><span class="cl"><span class="n">BABA</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>    <span class="mf">165.15</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>    <span class="mf">165.77</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>    <span class="mf">169.48</span>
</span></span><span class="line"><span class="cl"><span class="n">BIDU</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>    <span class="mf">102.00</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>    <span class="mf">102.62</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>    <span class="mf">104.32</span>
</span></span><span class="line"><span class="cl"><span class="n">IQ</span>    <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>     <span class="mf">15.92</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>     <span class="mf">15.72</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>     <span class="mf">16.06</span>
</span></span><span class="line"><span class="cl"><span class="n">JD</span>    <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>     <span class="mf">28.19</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>     <span class="mf">28.06</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>     <span class="mf">28.80</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">æ”¶ç›˜</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¤šç»´ç´¢å¼•ä¸­ï¼Œç©ºç™½çš„æ„æ€æ˜¯ï¼šä½¿ç”¨ä¸Šé¢çš„å€¼</p>
<p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ser</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">MultiIndex</span><span class="p">([(</span><span class="s1">&#39;BABA&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-01&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s1">&#39;BABA&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s1">&#39;BABA&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-01&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-01&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;JD&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-01&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;JD&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;JD&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">           <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;å…¬å¸&#39;</span><span class="p">,</span> <span class="s1">&#39;æ—¥æœŸ&#39;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># unstackæŠŠäºŒçº§ç´¢å¼•å˜æˆåˆ—</span>
</span></span><span class="line"><span class="cl"><span class="n">ser</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[10]:</p>
<table>
<thead>
<tr>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">2019-10-01</th>
<th style="text-align:right">2019-10-02</th>
<th style="text-align:right">2019-10-03</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">169.48</td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">104.32</td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">16.06</td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.80</td>
</tr>
</tbody>
</table>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ser</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">å…¬å¸</span>    <span class="n">æ—¥æœŸ</span>        
</span></span><span class="line"><span class="cl"><span class="n">BABA</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>    <span class="mf">165.15</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>    <span class="mf">165.77</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>    <span class="mf">169.48</span>
</span></span><span class="line"><span class="cl"><span class="n">BIDU</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>    <span class="mf">102.00</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>    <span class="mf">102.62</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>    <span class="mf">104.32</span>
</span></span><span class="line"><span class="cl"><span class="n">IQ</span>    <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>     <span class="mf">15.92</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>     <span class="mf">15.72</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>     <span class="mf">16.06</span>
</span></span><span class="line"><span class="cl"><span class="n">JD</span>    <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>     <span class="mf">28.19</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>     <span class="mf">28.06</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>     <span class="mf">28.80</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">æ”¶ç›˜</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ser</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[12]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">æ”¶ç›˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
</tr>
</tbody>
</table>
<h3 id="äºŒseriesæœ‰å¤šå±‚ç´¢å¼•multiindexæ€æ ·ç­›é€‰æ•°æ®">äºŒã€Seriesæœ‰å¤šå±‚ç´¢å¼•MultiIndexæ€æ ·ç­›é€‰æ•°æ®ï¼Ÿ</h3>
<p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ser</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">å…¬å¸</span>    <span class="n">æ—¥æœŸ</span>        
</span></span><span class="line"><span class="cl"><span class="n">BABA</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>    <span class="mf">165.15</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>    <span class="mf">165.77</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>    <span class="mf">169.48</span>
</span></span><span class="line"><span class="cl"><span class="n">BIDU</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>    <span class="mf">102.00</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>    <span class="mf">102.62</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>    <span class="mf">104.32</span>
</span></span><span class="line"><span class="cl"><span class="n">IQ</span>    <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>     <span class="mf">15.92</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>     <span class="mf">15.72</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>     <span class="mf">16.06</span>
</span></span><span class="line"><span class="cl"><span class="n">JD</span>    <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>     <span class="mf">28.19</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>     <span class="mf">28.06</span>
</span></span><span class="line"><span class="cl">      <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>     <span class="mf">28.80</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">æ”¶ç›˜</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ser</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;BIDU&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">æ—¥æœŸ</span>
</span></span><span class="line"><span class="cl"><span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span>    <span class="mf">102.00</span>
</span></span><span class="line"><span class="cl"><span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>    <span class="mf">102.62</span>
</span></span><span class="line"><span class="cl"><span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>    <span class="mf">104.32</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">æ”¶ç›˜</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å¤šå±‚ç´¢å¼•ï¼Œå¯ä»¥ç”¨å…ƒç»„çš„å½¢å¼ç­›é€‰</span>
</span></span><span class="line"><span class="cl"><span class="n">ser</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">)]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mf">102.62</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ser</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">å…¬å¸</span>
</span></span><span class="line"><span class="cl"><span class="n">BABA</span>    <span class="mf">165.77</span>
</span></span><span class="line"><span class="cl"><span class="n">BIDU</span>    <span class="mf">102.62</span>
</span></span><span class="line"><span class="cl"><span class="n">IQ</span>       <span class="mf">15.72</span>
</span></span><span class="line"><span class="cl"><span class="n">JD</span>       <span class="mf">28.06</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">æ”¶ç›˜</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä¸‰dataframeçš„å¤šå±‚ç´¢å¼•multiindex">ä¸‰ã€DataFrameçš„å¤šå±‚ç´¢å¼•MultiIndex</h3>
<p>In [17]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[17]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
</tbody>
</table>
<p>In [18]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;å…¬å¸&#39;</span><span class="p">,</span> <span class="s1">&#39;æ—¥æœŸ&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">stocks</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[18]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">168.01</td>
<td style="text-align:right">168.23</td>
<td style="text-align:right">163.64</td>
<td style="text-align:right">14.19</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">16.14</td>
<td style="text-align:right">16.22</td>
<td style="text-align:right">15.50</td>
<td style="text-align:right">11.65</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<p>In [19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">index</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[19]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">MultiIndex</span><span class="p">([(</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-01&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s1">&#39;BABA&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s1">&#39;BABA&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s1">&#39;BABA&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-01&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-01&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;JD&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;JD&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span>  <span class="s1">&#39;JD&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-01&#39;</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">           <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;å…¬å¸&#39;</span><span class="p">,</span> <span class="s1">&#39;æ—¥æœŸ&#39;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [20]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">stocks</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[20]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">168.01</td>
<td style="text-align:right">168.23</td>
<td style="text-align:right">163.64</td>
<td style="text-align:right">14.19</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">16.14</td>
<td style="text-align:right">16.22</td>
<td style="text-align:right">15.50</td>
<td style="text-align:right">11.65</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h3 id="å››dataframeæœ‰å¤šå±‚ç´¢å¼•multiindexæ€æ ·ç­›é€‰æ•°æ®">å››ã€DataFrameæœ‰å¤šå±‚ç´¢å¼•MultiIndexæ€æ ·ç­›é€‰æ•°æ®ï¼Ÿ</h3>
<p>ã€*<strong>é‡è¦çŸ¥è¯†*</strong>ã€‘åœ¨é€‰æ‹©æ•°æ®æ—¶ï¼š</p>
<ul>
<li>å…ƒç»„(key1,key2)ä»£è¡¨ç­›é€‰å¤šå±‚ç´¢å¼•ï¼Œå…¶ä¸­key1æ˜¯ç´¢å¼•ç¬¬ä¸€çº§ï¼Œkey2æ˜¯ç¬¬äºŒçº§ï¼Œæ¯”å¦‚key1=JD, key2=2019-10-02</li>
<li>åˆ—è¡¨[key1,key2]ä»£è¡¨åŒä¸€å±‚çš„å¤šä¸ªKEYï¼Œå…¶ä¸­key1å’Œkey2æ˜¯å¹¶åˆ—çš„åŒçº§ç´¢å¼•ï¼Œæ¯”å¦‚key1=JD, key2=BIDU</li>
</ul>
<p>In [21]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;BIDU&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[21]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
</tbody>
</table>
<p>In [22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">),</span> <span class="p">:]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[22]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">æ”¶ç›˜</span>     <span class="mf">102.62</span>
</span></span><span class="line"><span class="cl"><span class="n">å¼€ç›˜</span>     <span class="mf">100.85</span>
</span></span><span class="line"><span class="cl"><span class="n">é«˜</span>      <span class="mf">103.24</span>
</span></span><span class="line"><span class="cl"><span class="n">ä½</span>       <span class="mf">99.50</span>
</span></span><span class="line"><span class="cl"><span class="n">äº¤æ˜“é‡</span>      <span class="mf">2.69</span>
</span></span><span class="line"><span class="cl"><span class="n">æ¶¨è·Œå¹…</span>      <span class="mf">0.01</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="p">(</span><span class="n">BIDU</span><span class="p">,</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span><span class="p">),</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [23]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-02&#39;</span><span class="p">),</span> <span class="s1">&#39;å¼€ç›˜&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[23]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mf">100.85</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [24]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;JD&#39;</span><span class="p">],</span> <span class="p">:]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[24]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<p>In [25]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">loc</span><span class="p">[([</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;JD&#39;</span><span class="p">],</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">),</span> <span class="p">:]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[25]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
</tr>
</tbody>
</table>
<p>In [26]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">loc</span><span class="p">[([</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;JD&#39;</span><span class="p">],</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">),</span> <span class="s1">&#39;æ”¶ç›˜&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[26]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">å…¬å¸</span>    <span class="n">æ—¥æœŸ</span>        
</span></span><span class="line"><span class="cl"><span class="n">BIDU</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>    <span class="mf">104.32</span>
</span></span><span class="line"><span class="cl"><span class="n">JD</span>    <span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span>     <span class="mf">28.80</span>
</span></span><span class="line"><span class="cl"><span class="n">Name</span><span class="p">:</span> <span class="n">æ”¶ç›˜</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [27]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;2019-10-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">]),</span> <span class="s1">&#39;æ”¶ç›˜&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[27]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å…¬å¸    æ—¥æœŸ        
</span></span><span class="line"><span class="cl">BIDU  2019-10-02    102.62
</span></span><span class="line"><span class="cl">      2019-10-03    104.32
</span></span><span class="line"><span class="cl">Name: æ”¶ç›˜, dtype: float64
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [28]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># slice(None)ä»£è¡¨ç­›é€‰è¿™ä¸€ç´¢å¼•çš„æ‰€æœ‰å†…å®¹</span>
</span></span><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;2019-10-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-10-03&#39;</span><span class="p">]),</span> <span class="p">:]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[28]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">å…¬å¸</td>
<td style="text-align:right">æ—¥æœŸ</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<p>In [29]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">stocks.reset_index()
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[29]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">165.15</td>
<td style="text-align:right">168.01</td>
<td style="text-align:right">168.23</td>
<td style="text-align:right">163.64</td>
<td style="text-align:right">14.19</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">15.92</td>
<td style="text-align:right">16.14</td>
<td style="text-align:right">16.22</td>
<td style="text-align:right">15.50</td>
<td style="text-align:right">11.65</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">15.72</td>
<td style="text-align:right">15.85</td>
<td style="text-align:right">15.87</td>
<td style="text-align:right">15.12</td>
<td style="text-align:right">8.10</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">IQ</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">16.06</td>
<td style="text-align:right">15.71</td>
<td style="text-align:right">16.38</td>
<td style="text-align:right">15.32</td>
<td style="text-align:right">10.08</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">28.19</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">28.57</td>
<td style="text-align:right">27.97</td>
<td style="text-align:right">10.64</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">28.06</td>
<td style="text-align:right">28.00</td>
<td style="text-align:right">28.22</td>
<td style="text-align:right">27.53</td>
<td style="text-align:right">9.53</td>
<td style="text-align:right">0.00</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">JD</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">28.80</td>
<td style="text-align:right">28.11</td>
<td style="text-align:right">28.97</td>
<td style="text-align:right">27.82</td>
<td style="text-align:right">8.77</td>
<td style="text-align:right">0.03</td>
</tr>
</tbody>
</table>
<h1 id="18pandasçš„æ•°æ®è½¬æ¢å‡½æ•°mapapplyapplymap">18ã€Pandasçš„æ•°æ®è½¬æ¢å‡½æ•°mapã€applyã€applymap</h1>
<p>æ•°æ®è½¬æ¢å‡½æ•°å¯¹æ¯”ï¼šmapã€applyã€applymapï¼š</p>
<ol>
<li>mapï¼šåªç”¨äºSeriesï¼Œå®ç°æ¯ä¸ªå€¼-&gt;å€¼çš„æ˜ å°„ï¼›</li>
<li>applyï¼šç”¨äºSerieså®ç°æ¯ä¸ªå€¼çš„å¤„ç†ï¼Œç”¨äºDataframeå®ç°æŸä¸ªè½´çš„Seriesçš„å¤„ç†ï¼›</li>
<li>applymapï¼šåªèƒ½ç”¨äºDataFrameï¼Œç”¨äºå¤„ç†è¯¥DataFrameçš„æ¯ä¸ªå…ƒç´ ï¼›</li>
</ol>
<h3 id="1-mapç”¨äºserieså€¼çš„è½¬æ¢">1. mapç”¨äºSerieså€¼çš„è½¬æ¢</h3>
<p>å®ä¾‹ï¼šå°†è‚¡ç¥¨ä»£ç è‹±æ–‡è½¬æ¢æˆä¸­æ–‡åå­—</p>
<p>Series.map(dict) or Series.map(function)å‡å¯</p>
<p>In [1]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="n">stocks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;./datas/stocks/äº’è”ç½‘å…¬å¸è‚¡ç¥¨.xlsx&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[1]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
</tr>
</tbody>
</table>
<p>In [2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="p">[</span><span class="s2">&#34;å…¬å¸&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[2]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">array</span><span class="p">([</span><span class="s1">&#39;BIDU&#39;</span><span class="p">,</span> <span class="s1">&#39;BABA&#39;</span><span class="p">,</span> <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;JD&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [3]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å…¬å¸è‚¡ç¥¨ä»£ç åˆ°ä¸­æ–‡çš„æ˜ å°„ï¼Œæ³¨æ„è¿™é‡Œæ˜¯å°å†™</span>
</span></span><span class="line"><span class="cl"><span class="n">dict_company_names</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;bidu&#34;</span><span class="p">:</span> <span class="s2">&#34;ç™¾åº¦&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;baba&#34;</span><span class="p">:</span> <span class="s2">&#34;é˜¿é‡Œå·´å·´&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;iq&#34;</span><span class="p">:</span> <span class="s2">&#34;çˆ±å¥‡è‰º&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;jd&#34;</span><span class="p">:</span> <span class="s2">&#34;äº¬ä¸œ&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ–¹æ³•1seriesmapdict">æ–¹æ³•1ï¼šSeries.map(dict)</h4>
<p>In [4]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="p">[</span><span class="s2">&#34;å…¬å¸ä¸­æ–‡1&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stocks</span><span class="p">[</span><span class="s2">&#34;å…¬å¸&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">dict_company_names</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [5]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[5]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
</tbody>
</table>
<h4 id="æ–¹æ³•2seriesmapfunction">æ–¹æ³•2ï¼šSeries.map(function)</h4>
<p>functionçš„å‚æ•°æ˜¯Seriesçš„æ¯ä¸ªå…ƒç´ çš„å€¼</p>
<p>In [6]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">stocks[&#34;å…¬å¸ä¸­æ–‡2&#34;] = stocks[&#34;å…¬å¸&#34;].map(lambda x : dict_company_names[x.lower()])
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [7]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">stocks.head()
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[7]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡1</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
</tbody>
</table>
<h3 id="2-applyç”¨äºserieså’Œdataframeçš„è½¬æ¢">2. applyç”¨äºSerieså’ŒDataFrameçš„è½¬æ¢</h3>
<ul>
<li>Series.apply(function), å‡½æ•°çš„å‚æ•°æ˜¯æ¯ä¸ªå€¼</li>
<li>DataFrame.apply(function), å‡½æ•°çš„å‚æ•°æ˜¯Series</li>
</ul>
<h4 id="seriesapplyfunction">Series.apply(function)</h4>
<p>functionçš„å‚æ•°æ˜¯Seriesçš„æ¯ä¸ªå€¼</p>
<p>In [8]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="p">[</span><span class="s2">&#34;å…¬å¸ä¸­æ–‡3&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stocks</span><span class="p">[</span><span class="s2">&#34;å…¬å¸&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">dict_company_names</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [9]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[9]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡1</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡2</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡3</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
</tbody>
</table>
<h4 id="dataframeapplyfunction">DataFrame.apply(function)</h4>
<p>functionçš„å‚æ•°æ˜¯å¯¹åº”è½´çš„Series</p>
<p>In [10]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="p">[</span><span class="s2">&#34;å…¬å¸ä¸­æ–‡4&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stocks</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">dict_company_names</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s2">&#34;å…¬å¸&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()],</span> 
</span></span><span class="line"><span class="cl">    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„è¿™ä¸ªä»£ç ï¼š
1ã€applyæ˜¯åœ¨stocksè¿™ä¸ªDataFrameä¸Šè°ƒç”¨ï¼›
2ã€lambda xçš„xæ˜¯ä¸€ä¸ªSeriesï¼Œå› ä¸ºæŒ‡å®šäº†axis=1æ‰€ä»¥Seiresçš„keyæ˜¯åˆ—åï¼Œå¯ä»¥ç”¨x[&lsquo;å…¬å¸&rsquo;]è·å–</p>
<p>In [11]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[11]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡1</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡2</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡3</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
</tbody>
</table>
<h3 id="3-applymapç”¨äºdataframeæ‰€æœ‰å€¼çš„è½¬æ¢">3. applymapç”¨äºDataFrameæ‰€æœ‰å€¼çš„è½¬æ¢</h3>
<p>In [12]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">sub_df</span> <span class="o">=</span> <span class="n">stocks</span><span class="p">[[</span><span class="s1">&#39;æ”¶ç›˜&#39;</span><span class="p">,</span> <span class="s1">&#39;å¼€ç›˜&#39;</span><span class="p">,</span> <span class="s1">&#39;é«˜&#39;</span><span class="p">,</span> <span class="s1">&#39;ä½&#39;</span><span class="p">,</span> <span class="s1">&#39;äº¤æ˜“é‡&#39;</span><span class="p">]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [13]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">sub_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[13]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">104.32</td>
<td style="text-align:right">102.35</td>
<td style="text-align:right">104.73</td>
<td style="text-align:right">101.15</td>
<td style="text-align:right">2.24</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">102.62</td>
<td style="text-align:right">100.85</td>
<td style="text-align:right">103.24</td>
<td style="text-align:right">99.50</td>
<td style="text-align:right">2.69</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">102.00</td>
<td style="text-align:right">102.80</td>
<td style="text-align:right">103.26</td>
<td style="text-align:right">101.00</td>
<td style="text-align:right">1.78</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">169.48</td>
<td style="text-align:right">166.65</td>
<td style="text-align:right">170.18</td>
<td style="text-align:right">165.00</td>
<td style="text-align:right">10.39</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">165.77</td>
<td style="text-align:right">162.82</td>
<td style="text-align:right">166.88</td>
<td style="text-align:right">161.90</td>
<td style="text-align:right">11.60</td>
</tr>
</tbody>
</table>
<p>In [14]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å°†è¿™äº›æ•°å­—å–æ•´æ•°ï¼Œåº”ç”¨äºæ‰€æœ‰å…ƒç´ </span>
</span></span><span class="line"><span class="cl"><span class="n">sub_df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[14]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">104</td>
<td style="text-align:right">102</td>
<td style="text-align:right">104</td>
<td style="text-align:right">101</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">102</td>
<td style="text-align:right">100</td>
<td style="text-align:right">103</td>
<td style="text-align:right">99</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">102</td>
<td style="text-align:right">102</td>
<td style="text-align:right">103</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">169</td>
<td style="text-align:right">166</td>
<td style="text-align:right">170</td>
<td style="text-align:right">165</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">165</td>
<td style="text-align:right">162</td>
<td style="text-align:right">166</td>
<td style="text-align:right">161</td>
<td style="text-align:right">11</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">165</td>
<td style="text-align:right">168</td>
<td style="text-align:right">168</td>
<td style="text-align:right">163</td>
<td style="text-align:right">14</td>
</tr>
<tr>
<td style="text-align:right">6</td>
<td style="text-align:right">16</td>
<td style="text-align:right">15</td>
<td style="text-align:right">16</td>
<td style="text-align:right">15</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">15</td>
<td style="text-align:right">15</td>
<td style="text-align:right">15</td>
<td style="text-align:right">15</td>
<td style="text-align:right">8</td>
</tr>
<tr>
<td style="text-align:right">8</td>
<td style="text-align:right">15</td>
<td style="text-align:right">16</td>
<td style="text-align:right">16</td>
<td style="text-align:right">15</td>
<td style="text-align:right">11</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">27</td>
<td style="text-align:right">8</td>
</tr>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">27</td>
<td style="text-align:right">9</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">28</td>
<td style="text-align:right">27</td>
<td style="text-align:right">10</td>
</tr>
</tbody>
</table>
<p>In [15]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ç›´æ¥ä¿®æ”¹åŸdfçš„è¿™å‡ åˆ—</span>
</span></span><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;æ”¶ç›˜&#39;</span><span class="p">,</span> <span class="s1">&#39;å¼€ç›˜&#39;</span><span class="p">,</span> <span class="s1">&#39;é«˜&#39;</span><span class="p">,</span> <span class="s1">&#39;ä½&#39;</span><span class="p">,</span> <span class="s1">&#39;äº¤æ˜“é‡&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">sub_df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In [16]:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">stocks</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Out[16]:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:right">å…¬å¸</th>
<th style="text-align:right">æ”¶ç›˜</th>
<th style="text-align:right">å¼€ç›˜</th>
<th style="text-align:right">é«˜</th>
<th style="text-align:right">ä½</th>
<th style="text-align:right">äº¤æ˜“é‡</th>
<th style="text-align:right">æ¶¨è·Œå¹…</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡1</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡2</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡3</th>
<th style="text-align:right">å…¬å¸ä¸­æ–‡4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">104</td>
<td style="text-align:right">102</td>
<td style="text-align:right">104</td>
<td style="text-align:right">101</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102</td>
<td style="text-align:right">100</td>
<td style="text-align:right">103</td>
<td style="text-align:right">99</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2019-10-01</td>
<td style="text-align:right">BIDU</td>
<td style="text-align:right">102</td>
<td style="text-align:right">102</td>
<td style="text-align:right">103</td>
<td style="text-align:right">101</td>
<td style="text-align:right">1</td>
<td style="text-align:right">-0.01</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
<td style="text-align:right">ç™¾åº¦</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2019-10-03</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">169</td>
<td style="text-align:right">166</td>
<td style="text-align:right">170</td>
<td style="text-align:right">165</td>
<td style="text-align:right">10</td>
<td style="text-align:right">0.02</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2019-10-02</td>
<td style="text-align:right">BABA</td>
<td style="text-align:right">165</td>
<td style="text-align:right">162</td>
<td style="text-align:right">166</td>
<td style="text-align:right">161</td>
<td style="text-align:right">11</td>
<td style="text-align:right">0.00</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
<td style="text-align:right">é˜¿é‡Œå·´å·´</td>
</tr>
</tbody>
</table>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">æ–‡ç« ä½œè€…</span>
    <span class="item-content">yuanshuai</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">ä¸Šæ¬¡æ›´æ–°</span>
    <span class="item-content">
        0001-01-01
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/yuanshuai1122.github.io/tags/python/">Python</a>
          <a href="/yuanshuai1122.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">æ•°æ®åˆ†æ</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="yuanshuai1122.github.io/post/python%E7%88%AC%E8%99%AB%E4%B9%8B%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB-python%E7%88%AC%E8%99%AB%E4%B9%8B%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Pythonçˆ¬è™«ä¹‹éªŒè¯ç è¯†åˆ«</span>
            <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
          </a>
        <a class="next" href="yuanshuai1122.github.io/post/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%89-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8Bpandas%E4%B8%89/">
            <span class="next-text nav-default">Pythonæ•°æ®åˆ†æä¹‹Pandasï¼ˆä¸‰ï¼‰</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="http://localhost:1313" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="http://localhost:1313" class="iconfont icon-twitter" title="twitter"></a>
      <a href="http://localhost:1313" class="iconfont icon-facebook" title="facebook"></a>
      <a href="http://localhost:1313" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="http://localhost:1313" class="iconfont icon-google" title="google"></a>
      <a href="http://localhost:1313" class="iconfont icon-github" title="github"></a>
      <a href="http://localhost:1313" class="iconfont icon-weibo" title="weibo"></a>
      <a href="http://localhost:1313" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="http://localhost:1313" class="iconfont icon-douban" title="douban"></a>
      <a href="http://localhost:1313" class="iconfont icon-pocket" title="pocket"></a>
      <a href="http://localhost:1313" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="http://localhost:1313" class="iconfont icon-instagram" title="instagram"></a>
      <a href="http://localhost:1313" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="http://localhost:1313" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="yuanshuai1122.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://gohugo.io">Hugo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>yuanshuai</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js" integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js" integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin="anonymous"></script>
  <script>
    var languageCode = "zh-cn".replace(/-/g, '_').replace(/_(.*)/, function ($0, $1) {return $0.replace($1, $1.toUpperCase());});
    timeago().render(document.querySelectorAll('.timeago'), languageCode);
    timeago.cancel();  
  </script>



<script type="text/javascript" src="/yuanshuai1122.github.io/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
