<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>SpringBoot2æ ¸å¿ƒæŠ€æœ¯-webå¼€å‘ - ğŸ§€ - ä½ å¥½</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="yuanshuai" /><meta name="description" content="BindingAwareModelMap æ˜¯Model ä¹Ÿæ˜¯Map mavContainer.getModel(); è·å–åˆ°å€¼çš„ 1.4ã€è‡ªå®šä¹‰å¯¹è±¡å‚æ•°ï¼š å¯ä»¥è‡ªåŠ¨ç±»å‹è½¬æ¢ä¸æ ¼å¼åŒ–ï¼Œå¯ä»¥çº§è”å°è£…ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20" /><meta name="keywords" content="blog, yuanshuai, yyss" />






<meta name="generator" content="Hugo 0.119.0 with theme even" />


<link rel="canonical" href="yuanshuai1122.github.io/post/springboot2%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF-web%E5%BC%80%E5%8F%91-springboot2%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF-web%E5%BC%80%E5%8F%91/" />
<link rel="apple-touch-icon" sizes="180x180" href="/yuanshuai1122.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/yuanshuai1122.github.io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/yuanshuai1122.github.io/favicon-16x16.png">
<link rel="manifest" href="/yuanshuai1122.github.io/manifest.json">
<link rel="mask-icon" href="/yuanshuai1122.github.io/safari-pinned-tab.svg" color="#5bbad5">



<link href="/yuanshuai1122.github.io/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="SpringBoot2æ ¸å¿ƒæŠ€æœ¯-webå¼€å‘" />
<meta property="og:description" content="BindingAwareModelMap æ˜¯Model ä¹Ÿæ˜¯Map mavContainer.getModel(); è·å–åˆ°å€¼çš„ 1.4ã€è‡ªå®šä¹‰å¯¹è±¡å‚æ•°ï¼š å¯ä»¥è‡ªåŠ¨ç±»å‹è½¬æ¢ä¸æ ¼å¼åŒ–ï¼Œå¯ä»¥çº§è”å°è£…ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20" />
<meta property="og:type" content="article" />
<meta property="og:url" content="yuanshuai1122.github.io/post/springboot2%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF-web%E5%BC%80%E5%8F%91-springboot2%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF-web%E5%BC%80%E5%8F%91/" /><meta property="article:section" content="post" />


<meta itemprop="name" content="SpringBoot2æ ¸å¿ƒæŠ€æœ¯-webå¼€å‘">
<meta itemprop="description" content="BindingAwareModelMap æ˜¯Model ä¹Ÿæ˜¯Map mavContainer.getModel(); è·å–åˆ°å€¼çš„ 1.4ã€è‡ªå®šä¹‰å¯¹è±¡å‚æ•°ï¼š å¯ä»¥è‡ªåŠ¨ç±»å‹è½¬æ¢ä¸æ ¼å¼åŒ–ï¼Œå¯ä»¥çº§è”å°è£…ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20">

<meta itemprop="wordCount" content="10505">
<meta itemprop="keywords" content="Java,SpringBoot," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SpringBoot2æ ¸å¿ƒæŠ€æœ¯-webå¼€å‘"/>
<meta name="twitter:description" content="BindingAwareModelMap æ˜¯Model ä¹Ÿæ˜¯Map mavContainer.getModel(); è·å–åˆ°å€¼çš„ 1.4ã€è‡ªå®šä¹‰å¯¹è±¡å‚æ•°ï¼š å¯ä»¥è‡ªåŠ¨ç±»å‹è½¬æ¢ä¸æ ¼å¼åŒ–ï¼Œå¯ä»¥çº§è”å°è£…ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">CNshuaiyuan</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="yuanshuai1122.github.io/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="yuanshuai1122.github.io/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="yuanshuai1122.github.io/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="yuanshuai1122.github.io/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">CNshuaiyuan</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="yuanshuai1122.github.io/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">SpringBoot2æ ¸å¿ƒæŠ€æœ¯-webå¼€å‘</h1>

      <div class="post-meta">
        <span class="post-time"> 0001-01-01 </span>
        
          <span class="more-meta"> çº¦ 10505 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 21 åˆ†é’Ÿ </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#14è‡ªå®šä¹‰å¯¹è±¡å‚æ•°">1.4ã€è‡ªå®šä¹‰å¯¹è±¡å‚æ•°ï¼š</a></li>
          </ul>
        </li>
        <li><a href="#2pojoå°è£…è¿‡ç¨‹">2ã€POJOå°è£…è¿‡ç¨‹</a></li>
        <li><a href="#3å‚æ•°å¤„ç†åŸç†">3ã€å‚æ•°å¤„ç†åŸç†</a>
          <ul>
            <li><a href="#1handleradapter">1ã€HandlerAdapter</a></li>
            <li><a href="#2æ‰§è¡Œç›®æ ‡æ–¹æ³•">2ã€æ‰§è¡Œç›®æ ‡æ–¹æ³•</a></li>
            <li><a href="#3å‚æ•°è§£æå™¨-handlermethodargumentresolver">3ã€å‚æ•°è§£æå™¨-HandlerMethodArgumentResolver</a></li>
            <li><a href="#4è¿”å›å€¼å¤„ç†å™¨">4ã€è¿”å›å€¼å¤„ç†å™¨</a></li>
            <li><a href="#5å¦‚ä½•ç¡®å®šç›®æ ‡æ–¹æ³•æ¯ä¸€ä¸ªå‚æ•°çš„å€¼">5ã€å¦‚ä½•ç¡®å®šç›®æ ‡æ–¹æ³•æ¯ä¸€ä¸ªå‚æ•°çš„å€¼</a></li>
            <li><a href="#heading"></a></li>
            <li><a href="#6ç›®æ ‡æ–¹æ³•æ‰§è¡Œå®Œæˆ">6ã€ç›®æ ‡æ–¹æ³•æ‰§è¡Œå®Œæˆ</a></li>
            <li><a href="#7å¤„ç†æ´¾å‘ç»“æœ">7ã€å¤„ç†æ´¾å‘ç»“æœ</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#heading-1"></a></li>
    <li><a href="#heading-2"></a></li>
    <li><a href="#4æ•°æ®å“åº”ä¸å†…å®¹åå•†">4ã€æ•°æ®å“åº”ä¸å†…å®¹åå•†</a>
      <ul>
        <li><a href="#1å“åº”json">1ã€å“åº”JSON</a>
          <ul>
            <li><a href="#11jacksonjarresponsebody">1.1ã€jackson.jar+@ResponseBody</a></li>
            <li><a href="#12springmvcåˆ°åº•æ”¯æŒå“ªäº›è¿”å›å€¼">1.2ã€SpringMVCåˆ°åº•æ”¯æŒå“ªäº›è¿”å›å€¼</a></li>
            <li><a href="#13httpmessageconverteråŸç†">1.3ã€HTTPMessageConverteråŸç†</a></li>
          </ul>
        </li>
        <li><a href="#2å†…å®¹åå•†">2ã€å†…å®¹åå•†</a>
          <ul>
            <li><a href="#1å¼•å…¥xmlä¾èµ–">1ã€å¼•å…¥xmlä¾èµ–</a></li>
            <li><a href="#2postmanåˆ†åˆ«æµ‹è¯•è¿”å›jsonå’Œxml">2ã€postmanåˆ†åˆ«æµ‹è¯•è¿”å›jsonå’Œxml</a></li>
            <li><a href="#3å¼€å¯æµè§ˆå™¨å‚æ•°æ–¹å¼å†…å®¹åå•†åŠŸèƒ½">3ã€å¼€å¯æµè§ˆå™¨å‚æ•°æ–¹å¼å†…å®¹åå•†åŠŸèƒ½</a></li>
            <li><a href="#4å†…å®¹åå•†åŸç†">4ã€å†…å®¹åå•†åŸç†</a></li>
            <li><a href="#5è‡ªå®šä¹‰-messageconverter">5ã€è‡ªå®šä¹‰ MessageConverter</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#5è§†å›¾è§£æä¸æ¨¡æ¿å¼•æ“">5ã€è§†å›¾è§£æä¸æ¨¡æ¿å¼•æ“</a>
      <ul>
        <li><a href="#1è§†å›¾è§£æ">1ã€è§†å›¾è§£æ</a>
          <ul>
            <li><a href="#1è§†å›¾è§£æåŸç†æµç¨‹">1ã€è§†å›¾è§£æåŸç†æµç¨‹</a></li>
          </ul>
        </li>
        <li><a href="#2æ¨¡æ¿å¼•æ“-thymeleaf">2ã€æ¨¡æ¿å¼•æ“-Thymeleaf</a>
          <ul>
            <li><a href="#1thymeleafç®€ä»‹">1ã€thymeleafç®€ä»‹</a></li>
            <li><a href="#2åŸºæœ¬è¯­æ³•">2ã€åŸºæœ¬è¯­æ³•</a></li>
            <li><a href="#3è®¾ç½®å±æ€§å€¼-thattr">3ã€è®¾ç½®å±æ€§å€¼-th:attr</a></li>
            <li><a href="#4è¿­ä»£">4ã€è¿­ä»£</a></li>
            <li><a href="#5æ¡ä»¶è¿ç®—">5ã€æ¡ä»¶è¿ç®—</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#heading-3"></a>
      <ul>
        <li>
          <ul>
            <li><a href="#6å±æ€§ä¼˜å…ˆçº§">6ã€å±æ€§ä¼˜å…ˆçº§</a></li>
          </ul>
        </li>
        <li><a href="#3thymeleafä½¿ç”¨">3ã€thymeleafä½¿ç”¨</a>
          <ul>
            <li></li>
          </ul>
        </li>
        <li><a href="#4æ„å»ºåå°ç®¡ç†ç³»ç»Ÿ">4ã€æ„å»ºåå°ç®¡ç†ç³»ç»Ÿ</a>
          <ul>
            <li><a href="#1é¡¹ç›®åˆ›å»º">1ã€é¡¹ç›®åˆ›å»º</a></li>
            <li><a href="#2é™æ€èµ„æºå¤„ç†">2ã€é™æ€èµ„æºå¤„ç†</a></li>
            <li><a href="#3è·¯å¾„æ„å»º">3ã€è·¯å¾„æ„å»º</a></li>
            <li><a href="#4æ¨¡æ¿æŠ½å–">4ã€æ¨¡æ¿æŠ½å–</a></li>
            <li><a href="#5é¡µé¢è·³è½¬">5ã€é¡µé¢è·³è½¬</a></li>
            <li><a href="#6æ•°æ®æ¸²æŸ“">6ã€æ•°æ®æ¸²æŸ“</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#6æ‹¦æˆªå™¨">6ã€æ‹¦æˆªå™¨</a>
      <ul>
        <li><a href="#1handlerinterceptor-æ¥å£">1ã€HandlerInterceptor æ¥å£</a></li>
        <li><a href="#2é…ç½®æ‹¦æˆªå™¨">2ã€é…ç½®æ‹¦æˆªå™¨</a></li>
        <li><a href="#3æ‹¦æˆªå™¨åŸç†">3ã€æ‹¦æˆªå™¨åŸç†</a></li>
      </ul>
    </li>
    <li><a href="#7æ–‡ä»¶ä¸Šä¼ ">7ã€æ–‡ä»¶ä¸Šä¼ </a>
      <ul>
        <li><a href="#1é¡µé¢è¡¨å•">1ã€é¡µé¢è¡¨å•</a></li>
        <li><a href="#2æ–‡ä»¶ä¸Šä¼ ä»£ç ">2ã€æ–‡ä»¶ä¸Šä¼ ä»£ç </a></li>
        <li><a href="#3è‡ªåŠ¨é…ç½®åŸç†">3ã€è‡ªåŠ¨é…ç½®åŸç†</a></li>
      </ul>
    </li>
    <li><a href="#8å¼‚å¸¸å¤„ç†">8ã€å¼‚å¸¸å¤„ç†</a>
      <ul>
        <li><a href="#1é”™è¯¯å¤„ç†">1ã€é”™è¯¯å¤„ç†</a>
          <ul>
            <li></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#9webåŸç”Ÿç»„ä»¶æ³¨å…¥servletfilterlistener">9ã€WebåŸç”Ÿç»„ä»¶æ³¨å…¥ï¼ˆServletã€Filterã€Listenerï¼‰</a>
      <ul>
        <li><a href="#1ä½¿ç”¨servlet-api">1ã€ä½¿ç”¨Servlet API</a></li>
        <li><a href="#2ä½¿ç”¨registrationbean">2ã€ä½¿ç”¨RegistrationBean</a></li>
      </ul>
    </li>
    <li><a href="#10åµŒå…¥å¼servletå®¹å™¨">10ã€åµŒå…¥å¼Servletå®¹å™¨</a>
      <ul>
        <li><a href="#1åˆ‡æ¢åµŒå…¥å¼servletå®¹å™¨">1ã€åˆ‡æ¢åµŒå…¥å¼Servletå®¹å™¨</a></li>
        <li><a href="#2å®šåˆ¶servletå®¹å™¨">2ã€å®šåˆ¶Servletå®¹å™¨</a></li>
      </ul>
    </li>
    <li><a href="#11å®šåˆ¶åŒ–åŸç†">11ã€å®šåˆ¶åŒ–åŸç†</a>
      <ul>
        <li><a href="#1å®šåˆ¶åŒ–çš„å¸¸è§æ–¹å¼">1ã€å®šåˆ¶åŒ–çš„å¸¸è§æ–¹å¼</a></li>
        <li><a href="#2åŸç†åˆ†æå¥—è·¯">2ã€åŸç†åˆ†æå¥—è·¯</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
  <div class="post-outdated">
    <div class="warn">
      <p>ã€æ³¨æ„ã€‘æœ€åæ›´æ–°äº <span class="timeago" datetime="0001-01-01T00:00:00" title="January 1, 0001">January 1, 0001</span>ï¼Œæ–‡ä¸­å†…å®¹å¯èƒ½å·²è¿‡æ—¶ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p>
    </div>
  </div>
    <div class="post-content">
      <blockquote>
<p>BindingAwareModelMap æ˜¯Model ä¹Ÿæ˜¯Map</p>
</blockquote>
<p><strong>mavContainer</strong>.getModel(); è·å–åˆ°å€¼çš„</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/19.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/20.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/21.png" alt=""></p>
<h3 id="14è‡ªå®šä¹‰å¯¹è±¡å‚æ•°">1.4ã€è‡ªå®šä¹‰å¯¹è±¡å‚æ•°ï¼š</h3>
<p>å¯ä»¥è‡ªåŠ¨ç±»å‹è½¬æ¢ä¸æ ¼å¼åŒ–ï¼Œå¯ä»¥çº§è”å°è£…ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> *     å§“åï¼š &lt;input name=&#34;userName&#34;/&gt; &lt;br/&gt;
</span></span></span><span class="line"><span class="cl"><span class="cm"> *     å¹´é¾„ï¼š &lt;input name=&#34;age&#34;/&gt; &lt;br/&gt;
</span></span></span><span class="line"><span class="cl"><span class="cm"> *     ç”Ÿæ—¥ï¼š &lt;input name=&#34;birth&#34;/&gt; &lt;br/&gt;
</span></span></span><span class="line"><span class="cl"><span class="cm"> *     å® ç‰©å§“åï¼š&lt;input name=&#34;pet.name&#34;/&gt;&lt;br/&gt;
</span></span></span><span class="line"><span class="cl"><span class="cm"> *     å® ç‰©å¹´é¾„ï¼š&lt;input name=&#34;pet.age&#34;/&gt;
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Data</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">userName</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Date</span> <span class="n">birth</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Pet</span> <span class="n">pet</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Data</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pet</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="2pojoå°è£…è¿‡ç¨‹">2ã€POJOå°è£…è¿‡ç¨‹</h2>
<ul>
<li><strong>ServletModelAttributeMethodProcessor</strong></li>
</ul>
<h2 id="3å‚æ•°å¤„ç†åŸç†">3ã€å‚æ•°å¤„ç†åŸç†</h2>
<ul>
<li>HandlerMappingä¸­æ‰¾åˆ°èƒ½å¤„ç†è¯·æ±‚çš„Handlerï¼ˆController.method()ï¼‰</li>
<li>ä¸ºå½“å‰Handler æ‰¾ä¸€ä¸ªé€‚é…å™¨ HandlerAdapterï¼› <strong>RequestMappingHandlerAdapter</strong></li>
<li>é€‚é…å™¨æ‰§è¡Œç›®æ ‡æ–¹æ³•å¹¶ç¡®å®šæ–¹æ³•å‚æ•°çš„æ¯ä¸€ä¸ªå€¼</li>
</ul>
<h3 id="1handleradapter">1ã€HandlerAdapter</h3>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/22.png" alt=""></p>
<p>0 - æ”¯æŒæ–¹æ³•ä¸Šæ ‡æ³¨@RequestMapping</p>
<p>1 - æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹çš„</p>
<p>xxxxxx</p>
<h3 id="2æ‰§è¡Œç›®æ ‡æ–¹æ³•">2ã€æ‰§è¡Œç›®æ ‡æ–¹æ³•</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// Actually invoke the handler.
</span></span></span><span class="line"><span class="cl"><span class="c1">//DispatcherServlet -- doDispatch
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">mv</span> <span class="o">=</span> <span class="n">ha</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">processedRequest</span><span class="o">,</span> <span class="n">response</span><span class="o">,</span> <span class="n">mappedHandler</span><span class="o">.</span><span class="na">getHandler</span><span class="o">());</span>
</span></span><span class="line"><span class="cl"><span class="n">mav</span> <span class="o">=</span> <span class="n">invokeHandlerMethod</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">,</span> <span class="n">handlerMethod</span><span class="o">);</span> <span class="c1">//æ‰§è¡Œç›®æ ‡æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//ServletInvocableHandlerMethod
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Object</span> <span class="n">returnValue</span> <span class="o">=</span> <span class="n">invokeForRequest</span><span class="o">(</span><span class="n">webRequest</span><span class="o">,</span> <span class="n">mavContainer</span><span class="o">,</span> <span class="n">providedArgs</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//è·å–æ–¹æ³•çš„å‚æ•°å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Object</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="n">getMethodArgumentValues</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">mavContainer</span><span class="o">,</span> <span class="n">providedArgs</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3å‚æ•°è§£æå™¨-handlermethodargumentresolver">3ã€å‚æ•°è§£æå™¨-HandlerMethodArgumentResolver</h3>
<p>ç¡®å®šå°†è¦æ‰§è¡Œçš„ç›®æ ‡æ–¹æ³•çš„æ¯ä¸€ä¸ªå‚æ•°çš„å€¼æ˜¯ä»€ä¹ˆ;</p>
<p>SpringMVCç›®æ ‡æ–¹æ³•èƒ½å†™å¤šå°‘ç§å‚æ•°ç±»å‹ã€‚å–å†³äºå‚æ•°è§£æå™¨ã€‚</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/23.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/24.png" alt=""></p>
<ul>
<li>å½“å‰è§£æå™¨æ˜¯å¦æ”¯æŒè§£æè¿™ç§å‚æ•°</li>
<li>æ”¯æŒå°±è°ƒç”¨ resolveArgument</li>
</ul>
<h3 id="4è¿”å›å€¼å¤„ç†å™¨">4ã€è¿”å›å€¼å¤„ç†å™¨</h3>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/25.png" alt=""></p>
<h3 id="5å¦‚ä½•ç¡®å®šç›®æ ‡æ–¹æ³•æ¯ä¸€ä¸ªå‚æ•°çš„å€¼">5ã€å¦‚ä½•ç¡®å®šç›®æ ‡æ–¹æ³•æ¯ä¸€ä¸ªå‚æ•°çš„å€¼</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="o">============</span><span class="n">InvocableHandlerMethod</span><span class="o">==========================</span>
</span></span><span class="line"><span class="cl"><span class="kd">protected</span> <span class="n">Object</span><span class="o">[]</span> <span class="nf">getMethodArgumentValues</span><span class="o">(</span><span class="n">NativeWebRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nd">@Nullable</span> <span class="n">ModelAndViewContainer</span> <span class="n">mavContainer</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Object</span><span class="o">...</span> <span class="n">providedArgs</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">MethodParameter</span><span class="o">[]</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">getMethodParameters</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">ObjectUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">parameters</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">EMPTY_ARGS</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">parameters</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">parameters</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">MethodParameter</span> <span class="n">parameter</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">            <span class="n">parameter</span><span class="o">.</span><span class="na">initParameterNameDiscovery</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">parameterNameDiscoverer</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">args</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">findProvidedArgument</span><span class="o">(</span><span class="n">parameter</span><span class="o">,</span> <span class="n">providedArgs</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(!</span><span class="k">this</span><span class="o">.</span><span class="na">resolvers</span><span class="o">.</span><span class="na">supportsParameter</span><span class="o">(</span><span class="n">parameter</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalStateException</span><span class="o">(</span><span class="n">formatArgumentError</span><span class="o">(</span><span class="n">parameter</span><span class="o">,</span> <span class="s">&#34;No suitable resolver&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">args</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">resolvers</span><span class="o">.</span><span class="na">resolveArgument</span><span class="o">(</span><span class="n">parameter</span><span class="o">,</span> <span class="n">mavContainer</span><span class="o">,</span> <span class="n">request</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="na">dataBinderFactory</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// Leave stack trace for later, exception may actually be resolved and handled...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">if</span> <span class="o">(</span><span class="n">logger</span><span class="o">.</span><span class="na">isDebugEnabled</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">String</span> <span class="n">exMsg</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="o">(</span><span class="n">exMsg</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">exMsg</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">parameter</span><span class="o">.</span><span class="na">getExecutable</span><span class="o">().</span><span class="na">toGenericString</span><span class="o">()))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="n">formatArgumentError</span><span class="o">(</span><span class="n">parameter</span><span class="o">,</span> <span class="n">exMsg</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">throw</span> <span class="n">ex</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">args</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="51æŒ¨ä¸ªåˆ¤æ–­æ‰€æœ‰å‚æ•°è§£æå™¨é‚£ä¸ªæ”¯æŒè§£æè¿™ä¸ªå‚æ•°">5.1ã€æŒ¨ä¸ªåˆ¤æ–­æ‰€æœ‰å‚æ•°è§£æå™¨é‚£ä¸ªæ”¯æŒè§£æè¿™ä¸ªå‚æ•°</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">    <span class="nd">@Nullable</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">HandlerMethodArgumentResolver</span> <span class="nf">getArgumentResolver</span><span class="o">(</span><span class="n">MethodParameter</span> <span class="n">parameter</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">HandlerMethodArgumentResolver</span> <span class="n">result</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">argumentResolverCache</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">parameter</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="o">(</span><span class="n">HandlerMethodArgumentResolver</span> <span class="n">resolver</span> <span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="na">argumentResolvers</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">resolver</span><span class="o">.</span><span class="na">supportsParameter</span><span class="o">(</span><span class="n">parameter</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">result</span> <span class="o">=</span> <span class="n">resolver</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">this</span><span class="o">.</span><span class="na">argumentResolverCache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">parameter</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="52è§£æè¿™ä¸ªå‚æ•°çš„å€¼">5.2ã€è§£æè¿™ä¸ªå‚æ•°çš„å€¼</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">è°ƒç”¨å„è‡ª</span> <span class="n">HandlerMethodArgumentResolver</span> <span class="n">çš„</span> <span class="n">resolveArgument</span> <span class="n">æ–¹æ³•å³å¯</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="53è‡ªå®šä¹‰ç±»å‹å‚æ•°-å°è£…pojo">5.3ã€è‡ªå®šä¹‰ç±»å‹å‚æ•° å°è£…POJO</h4>
<p><strong>ServletModelAttributeMethodProcessor  è¿™ä¸ªå‚æ•°å¤„ç†å™¨æ”¯æŒ</strong></p>
<p><strong>æ˜¯å¦ä¸ºç®€å•ç±»å‹ã€‚</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isSimpleValueType</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">(</span><span class="n">Void</span><span class="o">.</span><span class="na">class</span> <span class="o">!=</span> <span class="n">type</span> <span class="o">&amp;&amp;</span> <span class="kt">void</span><span class="o">.</span><span class="na">class</span> <span class="o">!=</span> <span class="n">type</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">                <span class="o">(</span><span class="n">ClassUtils</span><span class="o">.</span><span class="na">isPrimitiveOrWrapper</span><span class="o">(</span><span class="n">type</span><span class="o">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                <span class="n">Enum</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">type</span><span class="o">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                <span class="n">CharSequence</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">type</span><span class="o">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                <span class="n">Number</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">type</span><span class="o">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                <span class="n">Date</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">type</span><span class="o">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                <span class="n">Temporal</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">type</span><span class="o">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                <span class="n">URI</span><span class="o">.</span><span class="na">class</span> <span class="o">==</span> <span class="n">type</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                <span class="n">URL</span><span class="o">.</span><span class="na">class</span> <span class="o">==</span> <span class="n">type</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                <span class="n">Locale</span><span class="o">.</span><span class="na">class</span> <span class="o">==</span> <span class="n">type</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                <span class="n">Class</span><span class="o">.</span><span class="na">class</span> <span class="o">==</span> <span class="n">type</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Nullable</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">final</span> <span class="n">Object</span> <span class="nf">resolveArgument</span><span class="o">(</span><span class="n">MethodParameter</span> <span class="n">parameter</span><span class="o">,</span> <span class="nd">@Nullable</span> <span class="n">ModelAndViewContainer</span> <span class="n">mavContainer</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">NativeWebRequest</span> <span class="n">webRequest</span><span class="o">,</span> <span class="nd">@Nullable</span> <span class="n">WebDataBinderFactory</span> <span class="n">binderFactory</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Assert</span><span class="o">.</span><span class="na">state</span><span class="o">(</span><span class="n">mavContainer</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">,</span> <span class="s">&#34;ModelAttributeMethodProcessor requires ModelAndViewContainer&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Assert</span><span class="o">.</span><span class="na">state</span><span class="o">(</span><span class="n">binderFactory</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">,</span> <span class="s">&#34;ModelAttributeMethodProcessor requires WebDataBinderFactory&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="o">.</span><span class="na">getNameForParameter</span><span class="o">(</span><span class="n">parameter</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">ModelAttribute</span> <span class="n">ann</span> <span class="o">=</span> <span class="n">parameter</span><span class="o">.</span><span class="na">getParameterAnnotation</span><span class="o">(</span><span class="n">ModelAttribute</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">ann</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">mavContainer</span><span class="o">.</span><span class="na">setBinding</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">ann</span><span class="o">.</span><span class="na">binding</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Object</span> <span class="n">attribute</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">BindingResult</span> <span class="n">bindingResult</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">mavContainer</span><span class="o">.</span><span class="na">containsAttribute</span><span class="o">(</span><span class="n">name</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">attribute</span> <span class="o">=</span> <span class="n">mavContainer</span><span class="o">.</span><span class="na">getModel</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Create attribute instance
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">attribute</span> <span class="o">=</span> <span class="n">createAttribute</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">parameter</span><span class="o">,</span> <span class="n">binderFactory</span><span class="o">,</span> <span class="n">webRequest</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">catch</span> <span class="o">(</span><span class="n">BindException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">isBindExceptionRequired</span><span class="o">(</span><span class="n">parameter</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// No BindingResult parameter -&gt; fail with BindException
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="k">throw</span> <span class="n">ex</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// Otherwise, expose null/empty value and associated BindingResult
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">if</span> <span class="o">(</span><span class="n">parameter</span><span class="o">.</span><span class="na">getParameterType</span><span class="o">()</span> <span class="o">==</span> <span class="n">Optional</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">attribute</span> <span class="o">=</span> <span class="n">Optional</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="n">bindingResult</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="na">getBindingResult</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">bindingResult</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Bean property binding and validation;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// skipped in case of binding failure on construction.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">WebDataBinder</span> <span class="n">binder</span> <span class="o">=</span> <span class="n">binderFactory</span><span class="o">.</span><span class="na">createBinder</span><span class="o">(</span><span class="n">webRequest</span><span class="o">,</span> <span class="n">attribute</span><span class="o">,</span> <span class="n">name</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">binder</span><span class="o">.</span><span class="na">getTarget</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(!</span><span class="n">mavContainer</span><span class="o">.</span><span class="na">isBindingDisabled</span><span class="o">(</span><span class="n">name</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">bindRequestParameters</span><span class="o">(</span><span class="n">binder</span><span class="o">,</span> <span class="n">webRequest</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="n">validateIfApplicable</span><span class="o">(</span><span class="n">binder</span><span class="o">,</span> <span class="n">parameter</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">binder</span><span class="o">.</span><span class="na">getBindingResult</span><span class="o">().</span><span class="na">hasErrors</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">isBindExceptionRequired</span><span class="o">(</span><span class="n">binder</span><span class="o">,</span> <span class="n">parameter</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">throw</span> <span class="k">new</span> <span class="n">BindException</span><span class="o">(</span><span class="n">binder</span><span class="o">.</span><span class="na">getBindingResult</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Value type adaptation, also covering java.util.Optional
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(!</span><span class="n">parameter</span><span class="o">.</span><span class="na">getParameterType</span><span class="o">().</span><span class="na">isInstance</span><span class="o">(</span><span class="n">attribute</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">attribute</span> <span class="o">=</span> <span class="n">binder</span><span class="o">.</span><span class="na">convertIfNecessary</span><span class="o">(</span><span class="n">binder</span><span class="o">.</span><span class="na">getTarget</span><span class="o">(),</span> <span class="n">parameter</span><span class="o">.</span><span class="na">getParameterType</span><span class="o">(),</span> <span class="n">parameter</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">bindingResult</span> <span class="o">=</span> <span class="n">binder</span><span class="o">.</span><span class="na">getBindingResult</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Add resolved attribute and BindingResult at the end of the model
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">bindingResultModel</span> <span class="o">=</span> <span class="n">bindingResult</span><span class="o">.</span><span class="na">getModel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">mavContainer</span><span class="o">.</span><span class="na">removeAttributes</span><span class="o">(</span><span class="n">bindingResultModel</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">mavContainer</span><span class="o">.</span><span class="na">addAllAttributes</span><span class="o">(</span><span class="n">bindingResultModel</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">attribute</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="heading"></h3>
<p><strong>WebDataBinder binder = binderFactory.createBinder(webRequest, attribute, name);</strong></p>
<p><strong>WebDataBinder :webæ•°æ®ç»‘å®šå™¨ï¼Œå°†è¯·æ±‚å‚æ•°çš„å€¼ç»‘å®šåˆ°æŒ‡å®šçš„JavaBeané‡Œé¢</strong></p>
<p><strong>WebDataBinder åˆ©ç”¨å®ƒé‡Œé¢çš„ Converters å°†è¯·æ±‚æ•°æ®è½¬æˆæŒ‡å®šçš„æ•°æ®ç±»å‹ã€‚å†æ¬¡å°è£…åˆ°JavaBeanä¸­</strong></p>
<p>**
**</p>
<p><strong>GenericConversionServiceï¼šåœ¨è®¾ç½®æ¯ä¸€ä¸ªå€¼çš„æ—¶å€™ï¼Œæ‰¾å®ƒé‡Œé¢çš„æ‰€æœ‰converteré‚£ä¸ªå¯ä»¥å°†è¿™ä¸ªæ•°æ®ç±»å‹ï¼ˆrequestå¸¦æ¥å‚æ•°çš„å­—ç¬¦ä¸²ï¼‰è½¬æ¢åˆ°æŒ‡å®šçš„ç±»å‹ï¼ˆJavaBean &ndash; Integerï¼‰</strong></p>
<p><strong>byte &ndash; &gt; file</strong></p>
<p>**
**</p>
<p>@FunctionalInterface<strong>public interface</strong> Converter&lt;S, T&gt;</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/26.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/27.png" alt=""></p>
<p>æœªæ¥æˆ‘ä»¬å¯ä»¥ç»™WebDataBinderé‡Œé¢æ”¾è‡ªå·±çš„Converterï¼›</p>
<p><strong>private static final class</strong> StringToNumber&lt;T <strong>extends</strong> Number&gt; <strong>implements</strong> Converter&lt;String, T&gt;</p>
<p>è‡ªå®šä¹‰ Converter</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">    <span class="c1">//1ã€WebMvcConfigurerå®šåˆ¶åŒ–SpringMVCçš„åŠŸèƒ½
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">WebMvcConfigurer</span> <span class="nf">webMvcConfigurer</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">WebMvcConfigurer</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configurePathMatch</span><span class="o">(</span><span class="n">PathMatchConfigurer</span> <span class="n">configurer</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">UrlPathHelper</span> <span class="n">urlPathHelper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UrlPathHelper</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// ä¸ç§»é™¤ï¼›åé¢çš„å†…å®¹ã€‚çŸ©é˜µå˜é‡åŠŸèƒ½å°±å¯ä»¥ç”Ÿæ•ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">urlPathHelper</span><span class="o">.</span><span class="na">setRemoveSemicolonContent</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">configurer</span><span class="o">.</span><span class="na">setUrlPathHelper</span><span class="o">(</span><span class="n">urlPathHelper</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addFormatters</span><span class="o">(</span><span class="n">FormatterRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">registry</span><span class="o">.</span><span class="na">addConverter</span><span class="o">(</span><span class="k">new</span> <span class="n">Converter</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Pet</span><span class="o">&gt;()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">                    <span class="kd">public</span> <span class="n">Pet</span> <span class="nf">convert</span><span class="o">(</span><span class="n">String</span> <span class="n">source</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="c1">// å•ŠçŒ«,3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                        <span class="k">if</span><span class="o">(!</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">source</span><span class="o">)){</span>
</span></span><span class="line"><span class="cl">                            <span class="n">Pet</span> <span class="n">pet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pet</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                            <span class="n">String</span><span class="o">[]</span> <span class="n">split</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34;,&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                            <span class="n">pet</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">split</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
</span></span><span class="line"><span class="cl">                            <span class="n">pet</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">split</span><span class="o">[</span><span class="mi">1</span><span class="o">]));</span>
</span></span><span class="line"><span class="cl">                            <span class="k">return</span> <span class="n">pet</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">}</span>
</span></span><span class="line"><span class="cl">                        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">});</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">};</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="6ç›®æ ‡æ–¹æ³•æ‰§è¡Œå®Œæˆ">6ã€ç›®æ ‡æ–¹æ³•æ‰§è¡Œå®Œæˆ</h3>
<p>å°†æ‰€æœ‰çš„æ•°æ®éƒ½æ”¾åœ¨ <strong>ModelAndViewContainer</strong>ï¼›åŒ…å«è¦å»çš„é¡µé¢åœ°å€Viewã€‚è¿˜åŒ…å«Modelæ•°æ®ã€‚</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/28.png" alt=""></p>
<h3 id="7å¤„ç†æ´¾å‘ç»“æœ">7ã€å¤„ç†æ´¾å‘ç»“æœ</h3>
<p><strong>processDispatchResult</strong>(processedRequest, response, mappedHandler, mv, dispatchException);</p>
<p>renderMergedOutputModel(mergedModel, getRequestToExpose(request), response);</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">InternalResourceView</span><span class="err">ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">renderMergedOutputModel</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">model</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Expose the model object as request attributes.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">exposeModelAsRequestAttributes</span><span class="o">(</span><span class="n">model</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Expose helpers as request attributes, if any.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">exposeHelpers</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Determine the path for the request dispatcher.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">String</span> <span class="n">dispatcherPath</span> <span class="o">=</span> <span class="n">prepareForRendering</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Obtain a RequestDispatcher for the target resource (typically a JSP).
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">RequestDispatcher</span> <span class="n">rd</span> <span class="o">=</span> <span class="n">getRequestDispatcher</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">dispatcherPath</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">rd</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">ServletException</span><span class="o">(</span><span class="s">&#34;Could not get RequestDispatcher for [&#34;</span> <span class="o">+</span> <span class="n">getUrl</span><span class="o">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                    <span class="s">&#34;]: Check that the corresponding file exists within your web application archive!&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// If already included or response already committed, perform include, else forward.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">useInclude</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="n">getContentType</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">logger</span><span class="o">.</span><span class="na">isDebugEnabled</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&#34;Including [&#34;</span> <span class="o">+</span> <span class="n">getUrl</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">rd</span><span class="o">.</span><span class="na">include</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Note: The forwarded resource is supposed to determine the content type itself.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">logger</span><span class="o">.</span><span class="na">isDebugEnabled</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&#34;Forwarding to [&#34;</span> <span class="o">+</span> <span class="n">getUrl</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">rd</span><span class="o">.</span><span class="na">forward</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="heading-1"></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">æš´éœ²æ¨¡å‹ä½œä¸ºè¯·æ±‚åŸŸå±æ€§</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Expose the model object as request attributes.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">exposeModelAsRequestAttributes</span><span class="o">(</span><span class="n">model</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="heading-2"></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">protected</span> <span class="kt">void</span> <span class="nf">exposeModelAsRequestAttributes</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">model</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//modelä¸­çš„æ‰€æœ‰æ•°æ®éå†æŒ¨ä¸ªæ”¾åœ¨è¯·æ±‚åŸŸä¸­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">model</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">name</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">request</span><span class="o">.</span><span class="na">removeAttribute</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="4æ•°æ®å“åº”ä¸å†…å®¹åå•†">4ã€æ•°æ®å“åº”ä¸å†…å®¹åå•†</h1>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/29.jpg" alt=""></p>
<h2 id="1å“åº”json">1ã€å“åº”JSON</h2>
<h3 id="11jacksonjarresponsebody">1.1ã€jackson.jar+@ResponseBody</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">webåœºæ™¯è‡ªåŠ¨å¼•å…¥äº†jsonåœºæ™¯
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-json<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;version&gt;</span>2.3.4.RELEASE<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;scope&gt;</span>compile<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/30.png" alt=""></p>
<p>ç»™å‰ç«¯è‡ªåŠ¨è¿”å›jsonæ•°æ®ï¼›</p>
<h4 id="1è¿”å›å€¼è§£æå™¨">1ã€è¿”å›å€¼è§£æå™¨</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/31.png" alt=""></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="o">.</span><span class="na">returnValueHandlers</span><span class="o">.</span><span class="na">handleReturnValue</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">					<span class="n">returnValue</span><span class="o">,</span> <span class="n">getReturnValueType</span><span class="o">(</span><span class="n">returnValue</span><span class="o">),</span> <span class="n">mavContainer</span><span class="o">,</span> <span class="n">webRequest</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">		<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">	<span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleReturnValue</span><span class="o">(</span><span class="nd">@Nullable</span> <span class="n">Object</span> <span class="n">returnValue</span><span class="o">,</span> <span class="n">MethodParameter</span> <span class="n">returnType</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">			<span class="n">ModelAndViewContainer</span> <span class="n">mavContainer</span><span class="o">,</span> <span class="n">NativeWebRequest</span> <span class="n">webRequest</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="n">HandlerMethodReturnValueHandler</span> <span class="n">handler</span> <span class="o">=</span> <span class="n">selectHandler</span><span class="o">(</span><span class="n">returnValue</span><span class="o">,</span> <span class="n">returnType</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="o">(</span><span class="n">handler</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">&#34;Unknown return value type: &#34;</span> <span class="o">+</span> <span class="n">returnType</span><span class="o">.</span><span class="na">getParameterType</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">		<span class="o">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">handler</span><span class="o">.</span><span class="na">handleReturnValue</span><span class="o">(</span><span class="n">returnValue</span><span class="o">,</span> <span class="n">returnType</span><span class="o">,</span> <span class="n">mavContainer</span><span class="o">,</span> <span class="n">webRequest</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">RequestResponseBodyMethodProcessor</span>  	
</span></span><span class="line"><span class="cl"><span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleReturnValue</span><span class="o">(</span><span class="nd">@Nullable</span> <span class="n">Object</span> <span class="n">returnValue</span><span class="o">,</span> <span class="n">MethodParameter</span> <span class="n">returnType</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">			<span class="n">ModelAndViewContainer</span> <span class="n">mavContainer</span><span class="o">,</span> <span class="n">NativeWebRequest</span> <span class="n">webRequest</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">			<span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">HttpMediaTypeNotAcceptableException</span><span class="o">,</span> <span class="n">HttpMessageNotWritableException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="n">mavContainer</span><span class="o">.</span><span class="na">setRequestHandled</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">ServletServerHttpRequest</span> <span class="n">inputMessage</span> <span class="o">=</span> <span class="n">createInputMessage</span><span class="o">(</span><span class="n">webRequest</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">ServletServerHttpResponse</span> <span class="n">outputMessage</span> <span class="o">=</span> <span class="n">createOutputMessage</span><span class="o">(</span><span class="n">webRequest</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Try even with null return value. ResponseBodyAdvice could get involved.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// ä½¿ç”¨æ¶ˆæ¯è½¬æ¢å™¨è¿›è¡Œå†™å‡ºæ“ä½œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">writeWithMessageConverters</span><span class="o">(</span><span class="n">returnValue</span><span class="o">,</span> <span class="n">returnType</span><span class="o">,</span> <span class="n">inputMessage</span><span class="o">,</span> <span class="n">outputMessage</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2è¿”å›å€¼è§£æå™¨åŸç†">2ã€è¿”å›å€¼è§£æå™¨åŸç†</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/32.png" alt=""></p>
<ul>
<li>
<p>1ã€è¿”å›å€¼å¤„ç†å™¨åˆ¤æ–­æ˜¯å¦æ”¯æŒè¿™ç§ç±»å‹è¿”å›å€¼ supportsReturnType</p>
</li>
<li>
<p>2ã€è¿”å›å€¼å¤„ç†å™¨è°ƒç”¨ handleReturnValue è¿›è¡Œå¤„ç†</p>
</li>
<li>
<p>3ã€RequestResponseBodyMethodProcessor å¯ä»¥å¤„ç†è¿”å›å€¼æ ‡äº†@ResponseBody æ³¨è§£çš„ã€‚</p>
</li>
<li>
<ul>
<li>
<ol>
<li>åˆ©ç”¨ MessageConverters è¿›è¡Œå¤„ç† å°†æ•°æ®å†™ä¸ºjson</li>
</ol>
</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>1ã€å†…å®¹åå•†ï¼ˆæµè§ˆå™¨é»˜è®¤ä¼šä»¥è¯·æ±‚å¤´çš„æ–¹å¼å‘Šè¯‰æœåŠ¡å™¨ä»–èƒ½æ¥å—ä»€ä¹ˆæ ·çš„å†…å®¹ç±»å‹ï¼‰</li>
<li>2ã€æœåŠ¡å™¨æœ€ç»ˆæ ¹æ®è‡ªå·±è‡ªèº«çš„èƒ½åŠ›ï¼Œå†³å®šæœåŠ¡å™¨èƒ½ç”Ÿäº§å‡ºä»€ä¹ˆæ ·å†…å®¹ç±»å‹çš„æ•°æ®ï¼Œ</li>
<li>3ã€SpringMVCä¼šæŒ¨ä¸ªéå†æ‰€æœ‰å®¹å™¨åº•å±‚çš„ HttpMessageConverter ï¼Œçœ‹è°èƒ½å¤„ç†ï¼Ÿ</li>
</ul>
</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li>1ã€å¾—åˆ°MappingJackson2HttpMessageConverterå¯ä»¥å°†å¯¹è±¡å†™ä¸ºjson</li>
<li>2ã€åˆ©ç”¨MappingJackson2HttpMessageConverterå°†å¯¹è±¡è½¬ä¸ºjsonå†å†™å‡ºå»ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/33.png" alt=""></p>
<h3 id="12springmvcåˆ°åº•æ”¯æŒå“ªäº›è¿”å›å€¼">1.2ã€SpringMVCåˆ°åº•æ”¯æŒå“ªäº›è¿”å›å€¼</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ModelAndView</span>
</span></span><span class="line"><span class="cl"><span class="n">Model</span>
</span></span><span class="line"><span class="cl"><span class="n">View</span>
</span></span><span class="line"><span class="cl"><span class="n">ResponseEntity</span> 
</span></span><span class="line"><span class="cl"><span class="n">ResponseBodyEmitter</span>
</span></span><span class="line"><span class="cl"><span class="n">StreamingResponseBody</span>
</span></span><span class="line"><span class="cl"><span class="n">HttpEntity</span>
</span></span><span class="line"><span class="cl"><span class="n">HttpHeaders</span>
</span></span><span class="line"><span class="cl"><span class="n">Callable</span>
</span></span><span class="line"><span class="cl"><span class="n">DeferredResult</span>
</span></span><span class="line"><span class="cl"><span class="n">ListenableFuture</span>
</span></span><span class="line"><span class="cl"><span class="n">CompletionStage</span>
</span></span><span class="line"><span class="cl"><span class="n">WebAsyncTask</span>
</span></span><span class="line"><span class="cl"><span class="n">æœ‰</span> <span class="nd">@ModelAttribute</span> <span class="n">ä¸”ä¸ºå¯¹è±¡ç±»å‹çš„</span>
</span></span><span class="line"><span class="cl"><span class="nd">@ResponseBody</span> <span class="n">æ³¨è§£</span> <span class="o">---&gt;</span> <span class="n">RequestResponseBodyMethodProcessor</span><span class="err">ï¼›</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="13httpmessageconverteråŸç†">1.3ã€HTTPMessageConverteråŸç†</h3>
<h4 id="1messageconverterè§„èŒƒ">1ã€MessageConverterè§„èŒƒ</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/34.png" alt=""></p>
<p>HttpMessageConverter: çœ‹æ˜¯å¦æ”¯æŒå°† æ­¤ Classç±»å‹çš„å¯¹è±¡ï¼Œè½¬ä¸ºMediaTypeç±»å‹çš„æ•°æ®ã€‚</p>
<p>ä¾‹å­ï¼šPersonå¯¹è±¡è½¬ä¸ºJSONã€‚æˆ–è€… JSONè½¬ä¸ºPerson</p>
<h4 id="2é»˜è®¤çš„messageconverter">2ã€é»˜è®¤çš„MessageConverter</h4>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/35.png" alt=""></p>
<p>0 - åªæ”¯æŒByteç±»å‹çš„</p>
<p>1 - String</p>
<p>2 - String</p>
<p>3 - Resource</p>
<p>4 - ResourceRegion</p>
<p>5 - DOMSource.*<em>class *</em> SAXSource.<strong>class</strong>) \ StAXSource.**class **StreamSource.**class **Source.<strong>class</strong></p>
<p><strong>6 -</strong> MultiValueMap</p>
<p>7 - <strong>true</strong></p>
<p><strong>8 - true</strong></p>
<p><strong>9 - æ”¯æŒæ³¨è§£æ–¹å¼xmlå¤„ç†çš„ã€‚</strong></p>
<p>æœ€ç»ˆ MappingJackson2HttpMessageConverter  æŠŠå¯¹è±¡è½¬ä¸ºJSONï¼ˆåˆ©ç”¨åº•å±‚çš„jacksonçš„objectMapperè½¬æ¢çš„ï¼‰</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/36.png" alt=""></p>
<h2 id="2å†…å®¹åå•†">2ã€å†…å®¹åå•†</h2>
<p>æ ¹æ®å®¢æˆ·ç«¯æ¥æ”¶èƒ½åŠ›ä¸åŒï¼Œè¿”å›ä¸åŒåª’ä½“ç±»å‹çš„æ•°æ®ã€‚</p>
<h3 id="1å¼•å…¥xmlä¾èµ–">1ã€å¼•å…¥xmlä¾èµ–</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"> <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.dataformat<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jackson-dataformat-xml<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2postmanåˆ†åˆ«æµ‹è¯•è¿”å›jsonå’Œxml">2ã€postmanåˆ†åˆ«æµ‹è¯•è¿”å›jsonå’Œxml</h3>
<p>åªéœ€è¦æ”¹å˜è¯·æ±‚å¤´ä¸­Acceptå­—æ®µã€‚Httpåè®®ä¸­è§„å®šçš„ï¼Œå‘Šè¯‰æœåŠ¡å™¨æœ¬å®¢æˆ·ç«¯å¯ä»¥æ¥æ”¶çš„æ•°æ®ç±»å‹ã€‚</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/37.png" alt=""></p>
<h3 id="3å¼€å¯æµè§ˆå™¨å‚æ•°æ–¹å¼å†…å®¹åå•†åŠŸèƒ½">3ã€å¼€å¯æµè§ˆå™¨å‚æ•°æ–¹å¼å†…å®¹åå•†åŠŸèƒ½</h3>
<p>ä¸ºäº†æ–¹ä¾¿å†…å®¹åå•†ï¼Œå¼€å¯åŸºäºè¯·æ±‚å‚æ•°çš„å†…å®¹åå•†åŠŸèƒ½ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contentnegotiation</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">favor-parameter</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">  </span><span class="c">#å¼€å¯è¯·æ±‚å‚æ•°å†…å®¹åå•†æ¨¡å¼</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å‘è¯·æ±‚ï¼š http://localhost:8080/test/person?format=json</p>
<p><a href="http://localhost:8080/test/person?format=json">http://localhost:8080/test/person?format=</a>xml</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/38.png" alt=""></p>
<p>ç¡®å®šå®¢æˆ·ç«¯æ¥æ”¶ä»€ä¹ˆæ ·çš„å†…å®¹ç±»å‹ï¼›</p>
<p>1ã€Parameterç­–ç•¥ä¼˜å…ˆç¡®å®šæ˜¯è¦è¿”å›jsonæ•°æ®ï¼ˆè·å–è¯·æ±‚å¤´ä¸­çš„formatçš„å€¼ï¼‰</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/39.png" alt=""></p>
<p>2ã€æœ€ç»ˆè¿›è¡Œå†…å®¹åå•†è¿”å›ç»™å®¢æˆ·ç«¯jsonå³å¯ã€‚</p>
<h3 id="4å†…å®¹åå•†åŸç†">4ã€å†…å®¹åå•†åŸç†</h3>
<ul>
<li>
<p>1ã€åˆ¤æ–­å½“å‰å“åº”å¤´ä¸­æ˜¯å¦å·²ç»æœ‰ç¡®å®šçš„åª’ä½“ç±»å‹ã€‚MediaType</p>
</li>
<li>
<p><strong>2ã€è·å–å®¢æˆ·ç«¯ï¼ˆPostManã€æµè§ˆå™¨ï¼‰æ”¯æŒæ¥æ”¶çš„å†…å®¹ç±»å‹ã€‚ï¼ˆè·å–å®¢æˆ·ç«¯Acceptè¯·æ±‚å¤´å­—æ®µï¼‰ã€application/xmlã€‘</strong></p>
</li>
<li>
<ul>
<li><strong>contentNegotiationManager å†…å®¹åå•†ç®¡ç†å™¨ é»˜è®¤ä½¿ç”¨åŸºäºè¯·æ±‚å¤´çš„ç­–ç•¥</strong></li>
</ul>
</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/40.png" alt=""></p>
<ul>
<li></li>
<li><strong>HeaderContentNegotiationStrategy  ç¡®å®šå®¢æˆ·ç«¯å¯ä»¥æ¥æ”¶çš„å†…å®¹ç±»å‹</strong></li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/41.png" alt=""></p>
<p>3ã€éå†å¾ªç¯æ‰€æœ‰å½“å‰ç³»ç»Ÿçš„ <strong>MessageConverter</strong>ï¼Œçœ‹è°æ”¯æŒæ“ä½œè¿™ä¸ªå¯¹è±¡ï¼ˆPersonï¼‰</p>
<p>4ã€æ‰¾åˆ°æ”¯æŒæ“ä½œPersonçš„converterï¼ŒæŠŠconverteræ”¯æŒçš„åª’ä½“ç±»å‹ç»Ÿè®¡å‡ºæ¥ã€‚</p>
<p>5ã€å®¢æˆ·ç«¯éœ€è¦ã€application/xmlã€‘ã€‚æœåŠ¡ç«¯èƒ½åŠ›ã€10ç§ã€jsonã€xmlã€‘</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/42.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/43.png" alt=""></p>
<p>6ã€è¿›è¡Œå†…å®¹åå•†çš„æœ€ä½³åŒ¹é…åª’ä½“ç±»å‹</p>
<p>7ã€ç”¨ æ”¯æŒ å°†å¯¹è±¡è½¬ä¸º æœ€ä½³åŒ¹é…åª’ä½“ç±»å‹ çš„converterã€‚è°ƒç”¨å®ƒè¿›è¡Œè½¬åŒ– ã€‚</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/44.png" alt=""></p>
<p>å¯¼å…¥äº†jacksonå¤„ç†xmlçš„åŒ…ï¼Œxmlçš„converterå°±ä¼šè‡ªåŠ¨è¿›æ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">WebMvcConfigurationSupport</span>
</span></span><span class="line"><span class="cl"><span class="n">jackson2XmlPresent</span> <span class="o">=</span> <span class="n">ClassUtils</span><span class="o">.</span><span class="na">isPresent</span><span class="o">(</span><span class="s">&#34;com.fasterxml.jackson.dataformat.xml.XmlMapper&#34;</span><span class="o">,</span> <span class="n">classLoader</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">(</span><span class="n">jackson2XmlPresent</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Jackson2ObjectMapperBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">Jackson2ObjectMapperBuilder</span><span class="o">.</span><span class="na">xml</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">applicationContext</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">builder</span><span class="o">.</span><span class="na">applicationContext</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">applicationContext</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">messageConverters</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">MappingJackson2XmlHttpMessageConverter</span><span class="o">(</span><span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">()));</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="5è‡ªå®šä¹‰-messageconverter">5ã€è‡ªå®šä¹‰ MessageConverter</h3>
<p><strong>å®ç°å¤šåè®®æ•°æ®å…¼å®¹ã€‚jsonã€xmlã€x-guigu</strong></p>
<p><strong>0ã€</strong>@ResponseBody å“åº”æ•°æ®å‡ºå» è°ƒç”¨ <strong>RequestResponseBodyMethodProcessor</strong> å¤„ç†</p>
<p>1ã€Processor å¤„ç†æ–¹æ³•è¿”å›å€¼ã€‚é€šè¿‡ <strong>MessageConverter</strong> å¤„ç†</p>
<p>2ã€æ‰€æœ‰ <strong>MessageConverter</strong> åˆèµ·æ¥å¯ä»¥æ”¯æŒå„ç§åª’ä½“ç±»å‹æ•°æ®çš„æ“ä½œï¼ˆè¯»ã€å†™ï¼‰</p>
<p>3ã€å†…å®¹åå•†æ‰¾åˆ°æœ€ç»ˆçš„ <strong>messageConverter</strong>ï¼›</p>
<p>SpringMVCçš„ä»€ä¹ˆåŠŸèƒ½ã€‚ä¸€ä¸ªå…¥å£ç»™å®¹å™¨ä¸­æ·»åŠ ä¸€ä¸ª  WebMvcConfigurer</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"> <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">WebMvcConfigurer</span> <span class="nf">webMvcConfigurer</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">WebMvcConfigurer</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">extendMessageConverters</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">HttpMessageConverter</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">converters</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/45.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/46.png" alt=""></p>
<p><strong>æœ‰å¯èƒ½æˆ‘ä»¬æ·»åŠ çš„è‡ªå®šä¹‰çš„åŠŸèƒ½ä¼šè¦†ç›–é»˜è®¤å¾ˆå¤šåŠŸèƒ½ï¼Œå¯¼è‡´ä¸€äº›é»˜è®¤çš„åŠŸèƒ½å¤±æ•ˆã€‚</strong></p>
<p><strong>å¤§å®¶è€ƒè™‘ï¼Œä¸Šè¿°åŠŸèƒ½é™¤äº†æˆ‘ä»¬å®Œå…¨è‡ªå®šä¹‰å¤–ï¼ŸSpringBootæœ‰æ²¡æœ‰ä¸ºæˆ‘ä»¬æä¾›åŸºäºé…ç½®æ–‡ä»¶çš„å¿«é€Ÿä¿®æ”¹åª’ä½“ç±»å‹åŠŸèƒ½ï¼Ÿæ€ä¹ˆé…ç½®å‘¢ï¼Ÿã€æç¤ºï¼šå‚ç…§SpringBootå®˜æ–¹æ–‡æ¡£webå¼€å‘å†…å®¹åå•†ç« èŠ‚ã€‘</strong></p>
<h1 id="5è§†å›¾è§£æä¸æ¨¡æ¿å¼•æ“">5ã€è§†å›¾è§£æä¸æ¨¡æ¿å¼•æ“</h1>
<p>è§†å›¾è§£æï¼š<strong>SpringBooté»˜è®¤ä¸æ”¯æŒ JSPï¼Œéœ€è¦å¼•å…¥ç¬¬ä¸‰æ–¹æ¨¡æ¿å¼•æ“æŠ€æœ¯å®ç°é¡µé¢æ¸²æŸ“ã€‚</strong></p>
<h2 id="1è§†å›¾è§£æ">1ã€è§†å›¾è§£æ</h2>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/47.jpg" alt=""></p>
<h3 id="1è§†å›¾è§£æåŸç†æµç¨‹">1ã€è§†å›¾è§£æåŸç†æµç¨‹</h3>
<p>1ã€ç›®æ ‡æ–¹æ³•å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¼šè¢«æ”¾åœ¨ <strong>ModelAndViewContainer é‡Œé¢ã€‚åŒ…æ‹¬æ•°æ®å’Œè§†å›¾åœ°å€</strong></p>
<p><strong>2ã€æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹å¯¹è±¡ï¼ˆä»è¯·æ±‚å‚æ•°ä¸­ç¡®å®šçš„ï¼‰ï¼ŒæŠŠä»–é‡æ–°æ”¾åœ¨</strong> <strong>ModelAndViewContainer</strong></p>
<p><strong>3ã€ä»»ä½•ç›®æ ‡æ–¹æ³•æ‰§è¡Œå®Œæˆä»¥åéƒ½ä¼šè¿”å› ModelAndViewï¼ˆ<strong><strong>æ•°æ®å’Œè§†å›¾åœ°å€</strong></strong>ï¼‰ã€‚</strong></p>
<p>**4ã€**<strong>processDispatchResult  å¤„ç†æ´¾å‘ç»“æœï¼ˆé¡µé¢æ”¹å¦‚ä½•å“åº”ï¼‰</strong></p>
<ul>
<li>
<p>1ã€<strong>render</strong>(<strong>mv</strong>, request, response); è¿›è¡Œé¡µé¢æ¸²æŸ“é€»è¾‘</p>
</li>
<li>
<ul>
<li>1ã€æ ¹æ®æ–¹æ³•çš„Stringè¿”å›å€¼å¾—åˆ° <strong>View</strong> å¯¹è±¡ã€å®šä¹‰äº†é¡µé¢çš„æ¸²æŸ“é€»è¾‘ã€‘</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>1ã€æ‰€æœ‰çš„è§†å›¾è§£æå™¨å°è¯•æ˜¯å¦èƒ½æ ¹æ®å½“å‰è¿”å›å€¼å¾—åˆ°<strong>View</strong>å¯¹è±¡</li>
<li>2ã€å¾—åˆ°äº† <strong>redirect:/main.html</strong> &ndash;&gt; Thymeleaf new <strong>RedirectView</strong>()</li>
<li>3ã€ContentNegotiationViewResolver é‡Œé¢åŒ…å«äº†ä¸‹é¢æ‰€æœ‰çš„è§†å›¾è§£æå™¨ï¼Œå†…éƒ¨è¿˜æ˜¯åˆ©ç”¨ä¸‹é¢æ‰€æœ‰è§†å›¾è§£æå™¨å¾—åˆ°è§†å›¾å¯¹è±¡ã€‚</li>
<li>4ã€view.render(mv.getModelInternal(), request, response);  è§†å›¾å¯¹è±¡è°ƒç”¨è‡ªå®šä¹‰çš„renderè¿›è¡Œé¡µé¢æ¸²æŸ“å·¥ä½œ</li>
</ul>
</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><strong>RedirectView å¦‚ä½•æ¸²æŸ“ã€é‡å®šå‘åˆ°ä¸€ä¸ªé¡µé¢ã€‘</strong></li>
<li><strong>1ã€è·å–ç›®æ ‡urlåœ°å€</strong></li>
<li>**2ã€**<strong>response.sendRedirect(encodedURL);</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>è§†å›¾è§£æï¼š</strong></p>
<ul>
<li>
<ul>
<li><strong>è¿”å›å€¼ä»¥ forward: å¼€å§‹ï¼š new InternalResourceView(forwardUrl); &ndash;&gt;  è½¬å‘****request.getRequestDispatcher(path).forward(request, response);</strong></li>
<li><strong>è¿”å›å€¼ä»¥</strong> <strong>redirect: å¼€å§‹ï¼š</strong> <strong>new RedirectView() &ndash;ã€‹ renderå°±æ˜¯é‡å®šå‘</strong></li>
<li><strong>è¿”å›å€¼æ˜¯æ™®é€šå­—ç¬¦ä¸²ï¼š new ThymeleafViewï¼ˆï¼‰&mdash;&gt;</strong></li>
</ul>
</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/48.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/49.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/50.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/51.png" alt=""></p>
<h2 id="2æ¨¡æ¿å¼•æ“-thymeleaf">2ã€æ¨¡æ¿å¼•æ“-Thymeleaf</h2>
<h3 id="1thymeleafç®€ä»‹">1ã€thymeleafç®€ä»‹</h3>
<p>Thymeleaf is a modern server-side Java template engine for both web and standalone environments, capable of processing HTML, XML, JavaScript, CSS and even plain text.</p>
<p><strong>ç°ä»£åŒ–ã€æœåŠ¡ç«¯Javaæ¨¡æ¿å¼•æ“</strong></p>
<h3 id="2åŸºæœ¬è¯­æ³•">2ã€åŸºæœ¬è¯­æ³•</h3>
<h4 id="1è¡¨è¾¾å¼">1ã€è¡¨è¾¾å¼</h4>
<table>
<thead>
<tr>
<th>è¡¨è¾¾å¼åå­—</th>
<th>è¯­æ³•</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>å˜é‡å–å€¼</td>
<td>${&hellip;}</td>
<td>è·å–è¯·æ±‚åŸŸã€sessionåŸŸã€å¯¹è±¡ç­‰å€¼</td>
</tr>
<tr>
<td>é€‰æ‹©å˜é‡</td>
<td>*{&hellip;}</td>
<td>è·å–ä¸Šä¸‹æ–‡å¯¹è±¡å€¼</td>
</tr>
<tr>
<td>æ¶ˆæ¯</td>
<td>#{&hellip;}</td>
<td>è·å–å›½é™…åŒ–ç­‰å€¼</td>
</tr>
<tr>
<td>é“¾æ¥</td>
<td>@{&hellip;}</td>
<td>ç”Ÿæˆé“¾æ¥</td>
</tr>
<tr>
<td>ç‰‡æ®µè¡¨è¾¾å¼</td>
<td>~{&hellip;}</td>
<td>jsp:include ä½œç”¨ï¼Œå¼•å…¥å…¬å…±é¡µé¢ç‰‡æ®µ</td>
</tr>
</tbody>
</table>
<h4 id="2å­—é¢é‡">2ã€å­—é¢é‡</h4>
<p>æ–‡æœ¬å€¼: <strong>&lsquo;one text&rsquo;</strong> <strong>,</strong> <strong>&lsquo;Another one!&rsquo;</strong> **,â€¦**æ•°å­—: <strong>0</strong> <strong>,</strong> <strong>34</strong> <strong>,</strong> <strong>3.0</strong> <strong>,</strong> <strong>12.3</strong> **,â€¦**å¸ƒå°”å€¼: <strong>true</strong> <strong>,</strong> <strong>false</strong></p>
<p>ç©ºå€¼: <strong>null</strong></p>
<p>å˜é‡ï¼š oneï¼Œtwoï¼Œ&hellip;. å˜é‡ä¸èƒ½æœ‰ç©ºæ ¼</p>
<h4 id="3æ–‡æœ¬æ“ä½œ">3ã€æ–‡æœ¬æ“ä½œ</h4>
<p>å­—ç¬¦ä¸²æ‹¼æ¥: <strong>+</strong></p>
<p>å˜é‡æ›¿æ¢: <strong>|The name is ${name}|</strong></p>
<h4 id="4æ•°å­¦è¿ç®—">4ã€æ•°å­¦è¿ç®—</h4>
<p>è¿ç®—ç¬¦: + , - , * , / , %</p>
<h4 id="5å¸ƒå°”è¿ç®—">5ã€å¸ƒå°”è¿ç®—</h4>
<p>è¿ç®—ç¬¦:  <strong>and</strong> <strong>,</strong> <strong>or</strong></p>
<p>ä¸€å…ƒè¿ç®—: <strong>!</strong> <strong>,</strong> <strong>not</strong></p>
<p>**
**</p>
<h4 id="6æ¯”è¾ƒè¿ç®—">6ã€æ¯”è¾ƒè¿ç®—</h4>
<p>æ¯”è¾ƒ: <strong>&gt;</strong> <strong>,</strong> <strong>&lt;</strong> <strong>,</strong> <strong>&gt;=</strong> <strong>,</strong> <strong>&lt;=</strong> <strong>(</strong> <strong>gt</strong> <strong>,</strong> <strong>lt</strong> <strong>,</strong> <strong>ge</strong> <strong>,</strong> <strong>le</strong> **)**ç­‰å¼: <strong>==</strong> <strong>,</strong> <strong>!=</strong> <strong>(</strong> <strong>eq</strong> <strong>,</strong> <strong>ne</strong> <strong>)</strong></p>
<h4 id="7æ¡ä»¶è¿ç®—">7ã€æ¡ä»¶è¿ç®—</h4>
<p>If-then: <strong>(if) ? (then)</strong></p>
<p>If-then-else: <strong>(if) ? (then) : (else)</strong></p>
<p>Default: (value) <strong>?: (defaultvalue)</strong></p>
<h4 id="8ç‰¹æ®Šæ“ä½œ">8ã€ç‰¹æ®Šæ“ä½œ</h4>
<p>æ— æ“ä½œï¼š _</p>
<h3 id="3è®¾ç½®å±æ€§å€¼-thattr">3ã€è®¾ç½®å±æ€§å€¼-th:attr</h3>
<p>è®¾ç½®å•ä¸ªå€¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;subscribe.html&#34;</span> <span class="na">th:attr</span><span class="o">=</span><span class="s">&#34;action=@{/subscribe}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">fieldset</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;email&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Subscribe!&#34;</span> <span class="na">th:attr</span><span class="o">=</span><span class="s">&#34;value=#{subscribe.submit}&#34;</span><span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">fieldset</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è®¾ç½®å¤šä¸ªå€¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../../images/gtvglogo.png&#34;</span>  <span class="na">th:attr</span><span class="o">=</span><span class="s">&#34;src=@{/images/gtvglogo.png},title=#{logo},alt=#{logo}&#34;</span> <span class="p">/&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»¥ä¸Šä¸¤ä¸ªçš„ä»£æ›¿å†™æ³• th:xxxx</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Subscribe!&#34;</span> <span class="na">th:value</span><span class="o">=</span><span class="s">&#34;#{subscribe.submit}&#34;</span><span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;subscribe.html&#34;</span> <span class="na">th:action</span><span class="o">=</span><span class="s">&#34;@{/subscribe}&#34;</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€æœ‰h5å…¼å®¹çš„æ ‡ç­¾å†™æ³•</p>
<p><a href="https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#setting-value-to-specific-attributes">https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#setting-value-to-specific-attributes</a></p>
<h3 id="4è¿­ä»£">4ã€è¿­ä»£</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">tr</span> <span class="na">th:each</span><span class="o">=</span><span class="s">&#34;prod : ${prods}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${prod.name}&#34;</span><span class="p">&gt;</span>Onions<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${prod.price}&#34;</span><span class="p">&gt;</span>2.41<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${prod.inStock}? #{true} : #{false}&#34;</span><span class="p">&gt;</span>yes<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">tr</span> <span class="na">th:each</span><span class="o">=</span><span class="s">&#34;prod,iterStat : ${prods}&#34;</span> <span class="na">th:class</span><span class="o">=</span><span class="s">&#34;${iterStat.odd}? &#39;odd&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">td</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${prod.name}&#34;</span><span class="p">&gt;</span>Onions<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">td</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${prod.price}&#34;</span><span class="p">&gt;</span>2.41<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">td</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${prod.inStock}? #{true} : #{false}&#34;</span><span class="p">&gt;</span>yes<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="5æ¡ä»¶è¿ç®—">5ã€æ¡ä»¶è¿ç®—</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;comments.html&#34;</span>
</span></span><span class="line"><span class="cl"><span class="na">th:href</span><span class="o">=</span><span class="s">&#34;@{/product/comments(prodId=${prod.id})}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="na">th:if</span><span class="o">=</span><span class="s">&#34;${not #lists.isEmpty(prod.comments)}&#34;</span><span class="p">&gt;</span>view<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">th:switch</span><span class="o">=</span><span class="s">&#34;${user.role}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">p</span> <span class="na">th:case</span><span class="o">=</span><span class="s">&#34;&#39;admin&#39;&#34;</span><span class="p">&gt;</span>User is an administrator<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">p</span> <span class="na">th:case</span><span class="o">=</span><span class="s">&#34;#{roles.manager}&#34;</span><span class="p">&gt;</span>User is a manager<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">p</span> <span class="na">th:case</span><span class="o">=</span><span class="s">&#34;*&#34;</span><span class="p">&gt;</span>User is some other thing<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="heading-3"></h1>
<h3 id="6å±æ€§ä¼˜å…ˆçº§">6ã€å±æ€§ä¼˜å…ˆçº§</h3>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/52.png" alt=""></p>
<h2 id="3thymeleafä½¿ç”¨">3ã€thymeleafä½¿ç”¨</h2>
<h4 id="1å¼•å…¥starter">1ã€å¼•å…¥Starter</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-thymeleaf<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2è‡ªåŠ¨é…ç½®å¥½äº†thymeleaf">2ã€è‡ªåŠ¨é…ç½®å¥½äº†thymeleaf</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">@Configuration(proxyBeanMethods = false)
</span></span><span class="line"><span class="cl">@EnableConfigurationProperties(ThymeleafProperties.class)
</span></span><span class="line"><span class="cl">@ConditionalOnClass({ TemplateMode.class, SpringTemplateEngine.class })
</span></span><span class="line"><span class="cl">@AutoConfigureAfter({ WebMvcAutoConfiguration.class, WebFluxAutoConfiguration.class })
</span></span><span class="line"><span class="cl">public class ThymeleafAutoConfiguration { }
</span></span></code></pre></td></tr></table>
</div>
</div><p>è‡ªåŠ¨é…å¥½çš„ç­–ç•¥</p>
<ul>
<li>1ã€æ‰€æœ‰thymeleafçš„é…ç½®å€¼éƒ½åœ¨ ThymeleafProperties</li>
<li>2ã€é…ç½®å¥½äº† <strong>SpringTemplateEngine</strong></li>
<li><strong>3ã€é…å¥½äº†</strong> <strong>ThymeleafViewResolver</strong></li>
<li>4ã€æˆ‘ä»¬åªéœ€è¦ç›´æ¥å¼€å‘é¡µé¢</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">DEFAULT_PREFIX</span> <span class="o">=</span> <span class="s">&#34;classpath:/templates/&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">DEFAULT_SUFFIX</span> <span class="o">=</span> <span class="s">&#34;.html&#34;</span><span class="o">;</span>  <span class="c1">//xxx.html
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="3é¡µé¢å¼€å‘">3ã€é¡µé¢å¼€å‘</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span> <span class="na">xmlns:th</span><span class="o">=</span><span class="s">&#34;http://www.thymeleaf.org&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Title<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h1</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${msg}&#34;</span><span class="p">&gt;</span>å“ˆå“ˆ<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;www.atguigu.com&#34;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&#34;${link}&#34;</span><span class="p">&gt;</span>å»ç™¾åº¦<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>  <span class="p">&lt;</span><span class="nt">br</span><span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;www.atguigu.com&#34;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&#34;@{link}&#34;</span><span class="p">&gt;</span>å»ç™¾åº¦2<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="4æ„å»ºåå°ç®¡ç†ç³»ç»Ÿ">4ã€æ„å»ºåå°ç®¡ç†ç³»ç»Ÿ</h2>
<h3 id="1é¡¹ç›®åˆ›å»º">1ã€é¡¹ç›®åˆ›å»º</h3>
<p>thymeleafã€web-starterã€devtoolsã€lombok</p>
<h3 id="2é™æ€èµ„æºå¤„ç†">2ã€é™æ€èµ„æºå¤„ç†</h3>
<p>è‡ªåŠ¨é…ç½®å¥½ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæ‰€æœ‰é™æ€èµ„æºæ”¾åˆ° static æ–‡ä»¶å¤¹ä¸‹</p>
<h3 id="3è·¯å¾„æ„å»º">3ã€è·¯å¾„æ„å»º</h3>
<p>th:action=&quot;@{/login}&quot;</p>
<h3 id="4æ¨¡æ¿æŠ½å–">4ã€æ¨¡æ¿æŠ½å–</h3>
<p>th:insert/replace/include</p>
<h3 id="5é¡µé¢è·³è½¬">5ã€é¡µé¢è·³è½¬</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">&#34;/login&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">main</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">,</span> <span class="n">HttpSession</span> <span class="n">session</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">hasLength</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getUserName</span><span class="o">())</span> <span class="o">&amp;&amp;</span> <span class="s">&#34;123456&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getPassword</span><span class="o">())){</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//æŠŠç™»é™†æˆåŠŸçš„ç”¨æˆ·ä¿å­˜èµ·æ¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&#34;loginUser&#34;</span><span class="o">,</span><span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//ç™»å½•æˆåŠŸé‡å®šå‘åˆ°main.html;  é‡å®šå‘é˜²æ­¢è¡¨å•é‡å¤æäº¤
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">return</span> <span class="s">&#34;redirect:/main.html&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span><span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&#34;msg&#34;</span><span class="o">,</span><span class="s">&#34;è´¦å·å¯†ç é”™è¯¯&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//å›åˆ°ç™»å½•é¡µé¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">return</span> <span class="s">&#34;login&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="6æ•°æ®æ¸²æŸ“">6ã€æ•°æ®æ¸²æŸ“</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/dynamic_table&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">dynamic_table</span><span class="o">(</span><span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//è¡¨æ ¼å†…å®¹çš„éå†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">users</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">&#34;zhangsan&#34;</span><span class="o">,</span> <span class="s">&#34;123456&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">                <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">&#34;lisi&#34;</span><span class="o">,</span> <span class="s">&#34;123444&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">                <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">&#34;haha&#34;</span><span class="o">,</span> <span class="s">&#34;aaaaa&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">                <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">&#34;hehe &#34;</span><span class="o">,</span> <span class="s">&#34;aaddd&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&#34;users&#34;</span><span class="o">,</span><span class="n">users</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s">&#34;table/dynamic_table&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">table</span> <span class="n">class</span><span class="o">=</span><span class="s">&#34;display table table-bordered&#34;</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;hidden-table-info&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">thead</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="err">#</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="n">ç”¨æˆ·å</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="n">å¯†ç </span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">thead</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">tbody</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">tr</span> <span class="n">class</span><span class="o">=</span><span class="s">&#34;gradeX&#34;</span> <span class="n">th</span><span class="o">:</span><span class="n">each</span><span class="o">=</span><span class="s">&#34;user,stats:${users}&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">td</span> <span class="n">th</span><span class="o">:</span><span class="n">text</span><span class="o">=</span><span class="s">&#34;${stats.count}&#34;</span><span class="o">&gt;</span><span class="n">Trident</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">td</span> <span class="n">th</span><span class="o">:</span><span class="n">text</span><span class="o">=</span><span class="s">&#34;${user.userName}&#34;</span><span class="o">&gt;</span><span class="n">Internet</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">td</span> <span class="o">&gt;[[</span><span class="n">$</span><span class="o">{</span><span class="n">user</span><span class="o">.</span><span class="na">password</span><span class="o">}]]&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">tbody</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">table</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="6æ‹¦æˆªå™¨">6ã€æ‹¦æˆªå™¨</h1>
<h2 id="1handlerinterceptor-æ¥å£">1ã€HandlerInterceptor æ¥å£</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * ç™»å½•æ£€æŸ¥
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 1ã€é…ç½®å¥½æ‹¦æˆªå™¨è¦æ‹¦æˆªå“ªäº›è¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 2ã€æŠŠè¿™äº›é…ç½®æ”¾åœ¨å®¹å™¨ä¸­
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Slf4j</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginInterceptor</span> <span class="kd">implements</span> <span class="n">HandlerInterceptor</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param request
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param response
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param handler
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws Exception
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">preHandle</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">Object</span> <span class="n">handler</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;preHandleæ‹¦æˆªçš„è¯·æ±‚è·¯å¾„æ˜¯{}&#34;</span><span class="o">,</span><span class="n">requestURI</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//ç™»å½•æ£€æŸ¥é€»è¾‘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Object</span> <span class="n">loginUser</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&#34;loginUser&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="o">(</span><span class="n">loginUser</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//æ”¾è¡Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//æ‹¦æˆªä½ã€‚æœªç™»å½•ã€‚è·³è½¬åˆ°ç™»å½•é¡µ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&#34;msg&#34;</span><span class="o">,</span><span class="s">&#34;è¯·å…ˆç™»å½•&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//        re.sendRedirect(&#34;/&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">request</span><span class="o">.</span><span class="na">getRequestDispatcher</span><span class="o">(</span><span class="s">&#34;/&#34;</span><span class="o">).</span><span class="na">forward</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ç›®æ ‡æ–¹æ³•æ‰§è¡Œå®Œæˆä»¥å
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param request
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param response
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param handler
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param modelAndView
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws Exception
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postHandle</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">Object</span> <span class="n">handler</span><span class="o">,</span> <span class="n">ModelAndView</span> <span class="n">modelAndView</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;postHandleæ‰§è¡Œ{}&#34;</span><span class="o">,</span><span class="n">modelAndView</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * é¡µé¢æ¸²æŸ“ä»¥å
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param request
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param response
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param handler
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ex
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws Exception
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterCompletion</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">Object</span> <span class="n">handler</span><span class="o">,</span> <span class="n">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;afterCompletionæ‰§è¡Œå¼‚å¸¸{}&#34;</span><span class="o">,</span><span class="n">ex</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="2é…ç½®æ‹¦æˆªå™¨">2ã€é…ç½®æ‹¦æˆªå™¨</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 1ã€ç¼–å†™ä¸€ä¸ªæ‹¦æˆªå™¨å®ç°HandlerInterceptoræ¥å£
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 2ã€æ‹¦æˆªå™¨æ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼ˆå®ç°WebMvcConfigurerçš„addInterceptorsï¼‰
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 3ã€æŒ‡å®šæ‹¦æˆªè§„åˆ™ã€å¦‚æœæ˜¯æ‹¦æˆªæ‰€æœ‰ï¼Œé™æ€èµ„æºä¹Ÿä¼šè¢«æ‹¦æˆªã€‘
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AdminWebConfig</span> <span class="kd">implements</span> <span class="n">WebMvcConfigurer</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addInterceptors</span><span class="o">(</span><span class="n">InterceptorRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">registry</span><span class="o">.</span><span class="na">addInterceptor</span><span class="o">(</span><span class="k">new</span> <span class="n">LoginInterceptor</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">addPathPatterns</span><span class="o">(</span><span class="s">&#34;/**&#34;</span><span class="o">)</span>  <span class="c1">//æ‰€æœ‰è¯·æ±‚éƒ½è¢«æ‹¦æˆªåŒ…æ‹¬é™æ€èµ„æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">excludePathPatterns</span><span class="o">(</span><span class="s">&#34;/&#34;</span><span class="o">,</span><span class="s">&#34;/login&#34;</span><span class="o">,</span><span class="s">&#34;/css/**&#34;</span><span class="o">,</span><span class="s">&#34;/fonts/**&#34;</span><span class="o">,</span><span class="s">&#34;/images/**&#34;</span><span class="o">,</span><span class="s">&#34;/js/**&#34;</span><span class="o">);</span> <span class="c1">//æ”¾è¡Œçš„è¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="3æ‹¦æˆªå™¨åŸç†">3ã€æ‹¦æˆªå™¨åŸç†</h2>
<p>1ã€æ ¹æ®å½“å‰è¯·æ±‚ï¼Œæ‰¾åˆ°**HandlerExecutionChainã€**å¯ä»¥å¤„ç†è¯·æ±‚çš„handlerä»¥åŠhandlerçš„æ‰€æœ‰ æ‹¦æˆªå™¨ã€‘</p>
<p>2ã€å…ˆæ¥<strong>é¡ºåºæ‰§è¡Œ</strong> æ‰€æœ‰æ‹¦æˆªå™¨çš„ preHandleæ–¹æ³•</p>
<ul>
<li>1ã€å¦‚æœå½“å‰æ‹¦æˆªå™¨prehandlerè¿”å›ä¸ºtrueã€‚åˆ™æ‰§è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨çš„preHandle</li>
<li>2ã€å¦‚æœå½“å‰æ‹¦æˆªå™¨è¿”å›ä¸ºfalseã€‚ç›´æ¥   å€’åºæ‰§è¡Œæ‰€æœ‰å·²ç»æ‰§è¡Œäº†çš„æ‹¦æˆªå™¨çš„  afterCompletionï¼›</li>
</ul>
<p><strong>3ã€å¦‚æœä»»ä½•ä¸€ä¸ªæ‹¦æˆªå™¨è¿”å›falseã€‚ç›´æ¥è·³å‡ºä¸æ‰§è¡Œç›®æ ‡æ–¹æ³•</strong></p>
<p><strong>4ã€æ‰€æœ‰æ‹¦æˆªå™¨éƒ½è¿”å›Trueã€‚æ‰§è¡Œç›®æ ‡æ–¹æ³•</strong></p>
<p><strong>5ã€å€’åºæ‰§è¡Œæ‰€æœ‰æ‹¦æˆªå™¨çš„postHandleæ–¹æ³•ã€‚</strong></p>
<p><strong>6ã€å‰é¢çš„æ­¥éª¤æœ‰ä»»ä½•å¼‚å¸¸éƒ½ä¼šç›´æ¥å€’åºè§¦å‘</strong> afterCompletion</p>
<p>7ã€é¡µé¢æˆåŠŸæ¸²æŸ“å®Œæˆä»¥åï¼Œä¹Ÿä¼šå€’åºè§¦å‘ afterCompletion</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/53.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/54.png" alt=""></p>
<h1 id="7æ–‡ä»¶ä¸Šä¼ ">7ã€æ–‡ä»¶ä¸Šä¼ </h1>
<h2 id="1é¡µé¢è¡¨å•">1ã€é¡µé¢è¡¨å•</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;/upload&#34;</span> <span class="na">enctype</span><span class="o">=</span><span class="s">&#34;multipart/form-data&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;file&#34;</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;æäº¤&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="2æ–‡ä»¶ä¸Šä¼ ä»£ç ">2ã€æ–‡ä»¶ä¸Šä¼ ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * MultipartFile è‡ªåŠ¨å°è£…ä¸Šä¼ è¿‡æ¥çš„æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param email
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param username
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param headerImg
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param photos
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">&#34;/upload&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">upload</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&#34;email&#34;</span><span class="o">)</span> <span class="n">String</span> <span class="n">email</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                         <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">)</span> <span class="n">String</span> <span class="n">username</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                         <span class="nd">@RequestPart</span><span class="o">(</span><span class="s">&#34;headerImg&#34;</span><span class="o">)</span> <span class="n">MultipartFile</span> <span class="n">headerImg</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                         <span class="nd">@RequestPart</span><span class="o">(</span><span class="s">&#34;photos&#34;</span><span class="o">)</span> <span class="n">MultipartFile</span><span class="o">[]</span> <span class="n">photos</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;ä¸Šä¼ çš„ä¿¡æ¯ï¼šemail={}ï¼Œusername={}ï¼ŒheaderImg={}ï¼Œphotos={}&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">email</span><span class="o">,</span><span class="n">username</span><span class="o">,</span><span class="n">headerImg</span><span class="o">.</span><span class="na">getSize</span><span class="o">(),</span><span class="n">photos</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="o">(!</span><span class="n">headerImg</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()){</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//ä¿å­˜åˆ°æ–‡ä»¶æœåŠ¡å™¨ï¼ŒOSSæœåŠ¡å™¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">String</span> <span class="n">originalFilename</span> <span class="o">=</span> <span class="n">headerImg</span><span class="o">.</span><span class="na">getOriginalFilename</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">headerImg</span><span class="o">.</span><span class="na">transferTo</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&#34;H:\\cache\\&#34;</span><span class="o">+</span><span class="n">originalFilename</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="o">(</span><span class="n">photos</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="o">(</span><span class="n">MultipartFile</span> <span class="n">photo</span> <span class="o">:</span> <span class="n">photos</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span><span class="o">(!</span><span class="n">photo</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()){</span>
</span></span><span class="line"><span class="cl">                    <span class="n">String</span> <span class="n">originalFilename</span> <span class="o">=</span> <span class="n">photo</span><span class="o">.</span><span class="na">getOriginalFilename</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">photo</span><span class="o">.</span><span class="na">transferTo</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&#34;H:\\cache\\&#34;</span><span class="o">+</span><span class="n">originalFilename</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s">&#34;main&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="3è‡ªåŠ¨é…ç½®åŸç†">3ã€è‡ªåŠ¨é…ç½®åŸç†</h2>
<p>**æ–‡ä»¶ä¸Šä¼ è‡ªåŠ¨é…ç½®ç±»-MultipartAutoConfiguration-**<strong>MultipartProperties</strong></p>
<ul>
<li>
<p>è‡ªåŠ¨é…ç½®å¥½äº† <strong>StandardServletMultipartResolver  ã€æ–‡ä»¶ä¸Šä¼ è§£æå™¨ã€‘</strong></p>
</li>
<li>
<p><strong>åŸç†æ­¥éª¤</strong></p>
</li>
<li>
<ul>
<li><strong>1ã€è¯·æ±‚è¿›æ¥ä½¿ç”¨æ–‡ä»¶ä¸Šä¼ è§£æå™¨åˆ¤æ–­ï¼ˆ<strong>isMultipart</strong>ï¼‰å¹¶å°è£…ï¼ˆ<strong>resolveMultipartï¼Œ<strong>è¿”å›</strong>MultipartHttpServletRequest</strong>ï¼‰æ–‡ä»¶ä¸Šä¼ è¯·æ±‚</strong></li>
<li><strong>2ã€å‚æ•°è§£æå™¨æ¥è§£æè¯·æ±‚ä¸­çš„æ–‡ä»¶å†…å®¹å°è£…æˆMultipartFile</strong></li>
<li>**3ã€å°†requestä¸­æ–‡ä»¶ä¿¡æ¯å°è£…ä¸ºä¸€ä¸ªMapï¼›**MultiValueMap&lt;String, MultipartFile&gt;</li>
</ul>
</li>
</ul>
<p><strong>FileCopyUtils</strong>ã€‚å®ç°æ–‡ä»¶æµçš„æ‹·è´</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">&#34;/upload&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">upload</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&#34;email&#34;</span><span class="o">)</span> <span class="n">String</span> <span class="n">email</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                         <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">)</span> <span class="n">String</span> <span class="n">username</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                         <span class="nd">@RequestPart</span><span class="o">(</span><span class="s">&#34;headerImg&#34;</span><span class="o">)</span> <span class="n">MultipartFile</span> <span class="n">headerImg</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                         <span class="nd">@RequestPart</span><span class="o">(</span><span class="s">&#34;photos&#34;</span><span class="o">)</span> <span class="n">MultipartFile</span><span class="o">[]</span> <span class="n">photos</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/55.png" alt=""></p>
<h1 id="8å¼‚å¸¸å¤„ç†">8ã€å¼‚å¸¸å¤„ç†</h1>
<h2 id="1é”™è¯¯å¤„ç†">1ã€é”™è¯¯å¤„ç†</h2>
<h4 id="1é»˜è®¤è§„åˆ™">1ã€é»˜è®¤è§„åˆ™</h4>
<ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Bootæä¾›<code>/error</code>å¤„ç†æ‰€æœ‰é”™è¯¯çš„æ˜ å°„</li>
<li>å¯¹äºæœºå™¨å®¢æˆ·ç«¯ï¼Œå®ƒå°†ç”ŸæˆJSONå“åº”ï¼Œå…¶ä¸­åŒ…å«é”™è¯¯ï¼ŒHTTPçŠ¶æ€å’Œå¼‚å¸¸æ¶ˆæ¯çš„è¯¦ç»†ä¿¡æ¯ã€‚å¯¹äºæµè§ˆå™¨å®¢æˆ·ç«¯ï¼Œå“åº”ä¸€ä¸ªâ€œ whitelabelâ€é”™è¯¯è§†å›¾ï¼Œä»¥HTMLæ ¼å¼å‘ˆç°ç›¸åŒçš„æ•°æ®</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/56.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/57.png" alt=""></p>
<p><strong>è¦å¯¹å…¶è¿›è¡Œè‡ªå®šä¹‰ï¼Œæ·»åŠ </strong>**<code>View</code>**<strong>è§£æä¸º`error```</strong></p>
<p>è¦å®Œå…¨æ›¿æ¢é»˜è®¤è¡Œä¸ºï¼Œå¯ä»¥å®ç° <code>ErrorController </code>å¹¶æ³¨å†Œè¯¥ç±»å‹çš„Beanå®šä¹‰ï¼Œæˆ–æ·»åŠ <code>ErrorAttributesç±»å‹çš„ç»„ä»¶</code>ä»¥ä½¿ç”¨ç°æœ‰æœºåˆ¶ä½†æ›¿æ¢å…¶å†…å®¹ã€‚</p>
<p>error/ä¸‹çš„4xxï¼Œ5xxé¡µé¢ä¼šè¢«è‡ªåŠ¨è§£æï¼›</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/58.png" alt=""></p>
<h4 id="2å®šåˆ¶é”™è¯¯å¤„ç†é€»è¾‘">2ã€å®šåˆ¶é”™è¯¯å¤„ç†é€»è¾‘</h4>
<ul>
<li>
<p>è‡ªå®šä¹‰é”™è¯¯é¡µ</p>
</li>
<li>
<ul>
<li>error/404.html  error/5xx.htmlï¼›æœ‰ç²¾ç¡®çš„é”™è¯¯çŠ¶æ€ç é¡µé¢å°±åŒ¹é…ç²¾ç¡®ï¼Œæ²¡æœ‰å°±æ‰¾ 4xx.htmlï¼›å¦‚æœéƒ½æ²¡æœ‰å°±è§¦å‘ç™½é¡µ</li>
</ul>
</li>
<li>
<p>@ControllerAdvice+@ExceptionHandlerå¤„ç†å…¨å±€å¼‚å¸¸ï¼›åº•å±‚æ˜¯ <strong>ExceptionHandlerExceptionResolver æ”¯æŒçš„</strong></p>
</li>
<li>
<p>@ResponseStatus+è‡ªå®šä¹‰å¼‚å¸¸ ï¼›åº•å±‚æ˜¯ <strong>ResponseStatusExceptionResolver ï¼ŒæŠŠresponsestatusæ³¨è§£çš„ä¿¡æ¯åº•å±‚è°ƒç”¨</strong> <strong>response.sendError(statusCode, resolvedReason)ï¼›tomcatå‘é€çš„/error</strong></p>
</li>
<li>
<p>Springåº•å±‚çš„å¼‚å¸¸ï¼Œå¦‚ å‚æ•°ç±»å‹è½¬æ¢å¼‚å¸¸ï¼›<strong>DefaultHandlerExceptionResolver å¤„ç†æ¡†æ¶åº•å±‚çš„å¼‚å¸¸ã€‚</strong></p>
</li>
<li>
<ul>
<li>response.sendError(HttpServletResponse.<strong>SC_BAD_REQUEST</strong>, ex.getMessage());</li>
</ul>
</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/59.png" alt=""></p>
<ul>
<li>è‡ªå®šä¹‰å®ç° HandlerExceptionResolver å¤„ç†å¼‚å¸¸ï¼›å¯ä»¥ä½œä¸ºé»˜è®¤çš„å…¨å±€å¼‚å¸¸å¤„ç†è§„åˆ™</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/60.png" alt=""></p>
<ul>
<li>
<p><strong>ErrorViewResolver</strong> å®ç°è‡ªå®šä¹‰å¤„ç†å¼‚å¸¸ï¼›</p>
</li>
<li>
<ul>
<li>response.sendError ã€‚errorè¯·æ±‚å°±ä¼šè½¬ç»™controller</li>
<li>ä½ çš„å¼‚å¸¸æ²¡æœ‰ä»»ä½•äººèƒ½å¤„ç†ã€‚tomcatåº•å±‚ response.sendErrorã€‚errorè¯·æ±‚å°±ä¼šè½¬ç»™controller</li>
<li><strong>basicErrorController è¦å»çš„é¡µé¢åœ°å€æ˜¯</strong> <strong>ErrorViewResolver</strong> ï¼›</li>
</ul>
</li>
</ul>
<h4 id="3å¼‚å¸¸å¤„ç†è‡ªåŠ¨é…ç½®åŸç†">3ã€å¼‚å¸¸å¤„ç†è‡ªåŠ¨é…ç½®åŸç†</h4>
<ul>
<li>
<p><strong>ErrorMvcAutoConfiguration  è‡ªåŠ¨é…ç½®å¼‚å¸¸å¤„ç†è§„åˆ™</strong></p>
</li>
<li>
<ul>
<li><strong>å®¹å™¨ä¸­çš„ç»„ä»¶ï¼šç±»å‹ï¼šDefaultErrorAttributes -&gt;</strong> <strong>idï¼šerrorAttributes</strong></li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li><strong>public class</strong> <strong>DefaultErrorAttributes</strong> <strong>implements</strong> <strong>ErrorAttributes</strong>, <strong>HandlerExceptionResolver</strong></li>
<li><strong>DefaultErrorAttributes</strong>ï¼šå®šä¹‰é”™è¯¯é¡µé¢ä¸­å¯ä»¥åŒ…å«å“ªäº›æ•°æ®ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/61.png" alt=""></p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/62.png" alt=""></p>
<ul>
<li>
<ul>
<li>**å®¹å™¨ä¸­çš„ç»„ä»¶ï¼šç±»å‹ï¼š**<strong>BasicErrorController &ndash;&gt; idï¼šbasicErrorControllerï¼ˆjson+ç™½é¡µ é€‚é…å“åº”ï¼‰</strong></li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li><strong>å¤„ç†é»˜è®¤</strong> <strong>/error è·¯å¾„çš„è¯·æ±‚ï¼›é¡µé¢å“åº”</strong> <strong>new</strong> ModelAndView(<strong>&ldquo;error&rdquo;</strong>, model)ï¼›</li>
<li><strong>å®¹å™¨ä¸­æœ‰ç»„ä»¶ View</strong>-&gt;<strong>idæ˜¯error</strong>ï¼›ï¼ˆå“åº”é»˜è®¤é”™è¯¯é¡µï¼‰</li>
<li>å®¹å™¨ä¸­æ”¾ç»„ä»¶ <strong>BeanNameViewResolverï¼ˆè§†å›¾è§£æå™¨ï¼‰ï¼›æŒ‰ç…§è¿”å›çš„è§†å›¾åä½œä¸ºç»„ä»¶çš„idå»å®¹å™¨ä¸­æ‰¾Viewå¯¹è±¡ã€‚</strong></li>
</ul>
</li>
</ul>
</li>
<li>
<ul>
<li>**å®¹å™¨ä¸­çš„ç»„ä»¶ï¼š**ç±»å‹ï¼š**DefaultErrorViewResolver -&gt; idï¼š**conventionErrorViewResolver</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œä¼šä»¥HTTPçš„çŠ¶æ€ç  ä½œä¸ºè§†å›¾é¡µåœ°å€ï¼ˆviewNameï¼‰ï¼Œæ‰¾åˆ°çœŸæ­£çš„é¡µé¢</li>
<li>error/404ã€5xx.html</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>å¦‚æœæƒ³è¦è¿”å›é¡µé¢ï¼›å°±ä¼šæ‰¾errorè§†å›¾ã€<strong>StaticView</strong>ã€‘ã€‚(é»˜è®¤æ˜¯ä¸€ä¸ªç™½é¡µ)</p>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/63.png" alt=""></p>
<ul>
<li>
<h4 id="4å¼‚å¸¸å¤„ç†æ­¥éª¤æµç¨‹">4ã€å¼‚å¸¸å¤„ç†æ­¥éª¤æµç¨‹</h4>
</li>
<li>
<p>1ã€æ‰§è¡Œç›®æ ‡æ–¹æ³•ï¼Œç›®æ ‡æ–¹æ³•è¿è¡ŒæœŸé—´æœ‰ä»»ä½•å¼‚å¸¸éƒ½ä¼šè¢«catchã€è€Œä¸”æ ‡å¿—å½“å‰è¯·æ±‚ç»“æŸï¼›å¹¶ä¸”ç”¨ <strong>dispatchException</strong></p>
</li>
<li>
<p>2ã€è¿›å…¥è§†å›¾è§£ææµç¨‹ï¼ˆé¡µé¢æ¸²æŸ“ï¼Ÿï¼‰</p>
</li>
<li>
<p>processDispatchResult(processedRequest, response, mappedHandler, <strong>mv</strong>, <strong>dispatchException</strong>);</p>
</li>
<li>
<p>3ã€<strong>mv</strong> = <strong>processHandlerException</strong>ï¼›å¤„ç†handlerå‘ç”Ÿçš„å¼‚å¸¸ï¼Œå¤„ç†å®Œæˆè¿”å›ModelAndViewï¼›</p>
</li>
<li>
<ul>
<li>1ã€éå†æ‰€æœ‰çš„ <strong>handlerExceptionResolversï¼Œçœ‹è°èƒ½å¤„ç†å½“å‰å¼‚å¸¸ã€<strong><strong>HandlerExceptionResolverå¤„ç†å™¨å¼‚å¸¸è§£æå™¨</strong></strong>ã€‘</strong></li>
</ul>
</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/64.png" alt=""></p>
<ul>
<li><strong>2ã€ç³»ç»Ÿé»˜è®¤çš„  å¼‚å¸¸è§£æå™¨ï¼›</strong></li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/65.png" alt=""></p>
<ul>
<li>
<ul>
<li><strong>1ã€DefaultErrorAttributeså…ˆæ¥å¤„ç†å¼‚å¸¸ã€‚æŠŠå¼‚å¸¸ä¿¡æ¯ä¿å­˜åˆ°rrequeståŸŸï¼Œå¹¶ä¸”è¿”å›nullï¼›</strong></li>
<li><strong>2ã€é»˜è®¤æ²¡æœ‰ä»»ä½•äººèƒ½å¤„ç†å¼‚å¸¸ï¼Œæ‰€ä»¥å¼‚å¸¸ä¼šè¢«æŠ›å‡º</strong></li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li><strong>1ã€å¦‚æœæ²¡æœ‰ä»»ä½•äººèƒ½å¤„ç†æœ€ç»ˆåº•å±‚å°±ä¼šå‘é€ /error è¯·æ±‚ã€‚ä¼šè¢«åº•å±‚çš„BasicErrorControllerå¤„ç†</strong></li>
<li><strong>2ã€è§£æé”™è¯¯è§†å›¾ï¼›éå†æ‰€æœ‰çš„</strong>  <strong>ErrorViewResolver  çœ‹è°èƒ½è§£æã€‚</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/66.png" alt=""></p>
<p>â€‹			<strong>3ã€é»˜è®¤çš„</strong> <strong>DefaultErrorViewResolver ,ä½œç”¨æ˜¯æŠŠå“åº”çŠ¶æ€ç ä½œä¸ºé”™è¯¯é¡µçš„åœ°å€ï¼Œerror/500.html</strong></p>
<p>â€‹			<strong>4ã€æ¨¡æ¿å¼•æ“æœ€ç»ˆå“åº”è¿™ä¸ªé¡µé¢</strong> <strong>error/500.html</strong></p>
<h1 id="9webåŸç”Ÿç»„ä»¶æ³¨å…¥servletfilterlistener">9ã€WebåŸç”Ÿç»„ä»¶æ³¨å…¥ï¼ˆServletã€Filterã€Listenerï¼‰</h1>
<h2 id="1ä½¿ç”¨servlet-api">1ã€ä½¿ç”¨Servlet API</h2>
<p>@ServletComponentScan(basePackages = <strong>&ldquo;com.atguigu.admin&rdquo;</strong>) :æŒ‡å®šåŸç”ŸServletç»„ä»¶éƒ½æ”¾åœ¨é‚£é‡Œ</p>
<p>@WebServlet(urlPatterns = <strong>&quot;/my&quot;</strong>)ï¼šæ•ˆæœï¼šç›´æ¥å“åº”ï¼Œ<strong>æ²¡æœ‰ç»è¿‡Springçš„æ‹¦æˆªå™¨ï¼Ÿ</strong></p>
<p>@WebFilter(urlPatterns={<strong>&quot;/css/*&quot;</strong>,<strong>&quot;/images/*&quot;</strong>})</p>
<p>@WebListener</p>
<p>æ¨èå¯ä»¥è¿™ç§æ–¹å¼ï¼›</p>
<p>æ‰©å±•ï¼šDispatchServlet å¦‚ä½•æ³¨å†Œè¿›æ¥</p>
<ul>
<li>å®¹å™¨ä¸­è‡ªåŠ¨é…ç½®äº†  DispatcherServlet  å±æ€§ç»‘å®šåˆ° WebMvcPropertiesï¼›å¯¹åº”çš„é…ç½®æ–‡ä»¶é…ç½®é¡¹æ˜¯ <strong>spring.mvcã€‚</strong></li>
<li><strong>é€šè¿‡</strong> <strong>ServletRegistrationBean</strong><DispatcherServlet> æŠŠ DispatcherServlet  é…ç½®è¿›æ¥ã€‚</li>
<li>é»˜è®¤æ˜ å°„çš„æ˜¯ / è·¯å¾„ã€‚</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/67.png" alt=""></p>
<p>Tomcat-Servletï¼›</p>
<p>å¤šä¸ªServletéƒ½èƒ½å¤„ç†åˆ°åŒä¸€å±‚è·¯å¾„ï¼Œç²¾ç¡®ä¼˜é€‰åŸåˆ™</p>
<p>Aï¼š /my/</p>
<p>Bï¼š /my/1</p>
<h2 id="2ä½¿ç”¨registrationbean">2ã€ä½¿ç”¨RegistrationBean</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ServletRegistrationBean</span><span class="err">`</span><span class="o">,</span> <span class="err">`</span><span class="n">FilterRegistrationBean</span><span class="err">`</span><span class="o">,</span> <span class="n">and</span> <span class="err">`</span><span class="n">ServletListenerRegistrationBean</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyRegistConfig</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ServletRegistrationBean</span> <span class="nf">myServlet</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">MyServlet</span> <span class="n">myServlet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyServlet</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">ServletRegistrationBean</span><span class="o">(</span><span class="n">myServlet</span><span class="o">,</span><span class="s">&#34;/my&#34;</span><span class="o">,</span><span class="s">&#34;/my02&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">FilterRegistrationBean</span> <span class="nf">myFilter</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">MyFilter</span> <span class="n">myFilter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyFilter</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">//        return new FilterRegistrationBean(myFilter,myServlet());
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">FilterRegistrationBean</span> <span class="n">filterRegistrationBean</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FilterRegistrationBean</span><span class="o">(</span><span class="n">myFilter</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">filterRegistrationBean</span><span class="o">.</span><span class="na">setUrlPatterns</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&#34;/my&#34;</span><span class="o">,</span><span class="s">&#34;/css/*&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">filterRegistrationBean</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ServletListenerRegistrationBean</span> <span class="nf">myListener</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">MySwervletContextListener</span> <span class="n">mySwervletContextListener</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MySwervletContextListener</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">ServletListenerRegistrationBean</span><span class="o">(</span><span class="n">mySwervletContextListener</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="10åµŒå…¥å¼servletå®¹å™¨">10ã€åµŒå…¥å¼Servletå®¹å™¨</h1>
<h2 id="1åˆ‡æ¢åµŒå…¥å¼servletå®¹å™¨">1ã€åˆ‡æ¢åµŒå…¥å¼Servletå®¹å™¨</h2>
<ul>
<li>
<p>é»˜è®¤æ”¯æŒçš„webServer</p>
</li>
<li>
<ul>
<li><code>Tomcat</code>, <code>Jetty</code>, or <code>Undertow</code></li>
<li><code>ServletWebServerApplicationContext å®¹å™¨å¯åŠ¨å¯»æ‰¾ServletWebServerFactory å¹¶å¼•å¯¼åˆ›å»ºæœåŠ¡å™¨</code></li>
</ul>
</li>
<li>
<p>åˆ‡æ¢æœåŠ¡å™¨</p>
</li>
</ul>
<p><img src="https://hexobbblog.oss-cn-beijing.aliyuncs.com/images/springboot2.x/68.png" alt=""></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;exclusions&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;exclusion&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-tomcat<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/exclusion&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/exclusions&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>åŸç†</p>
</li>
<li>
<ul>
<li>SpringBootåº”ç”¨å¯åŠ¨å‘ç°å½“å‰æ˜¯Webåº”ç”¨ã€‚webåœºæ™¯åŒ…-å¯¼å…¥tomcat</li>
<li>webåº”ç”¨ä¼šåˆ›å»ºä¸€ä¸ªwebç‰ˆçš„iocå®¹å™¨ <code>ServletWebServerApplicationContext</code></li>
<li><code>ServletWebServerApplicationContext</code> å¯åŠ¨çš„æ—¶å€™å¯»æ‰¾ <strong><code>ServletWebServerFactory</code></strong><code>ï¼ˆServlet çš„webæœåŠ¡å™¨å·¥å‚---&gt; Servlet çš„webæœåŠ¡å™¨ï¼‰</code></li>
<li>SpringBootåº•å±‚é»˜è®¤æœ‰å¾ˆå¤šçš„WebServerå·¥å‚ï¼›<code>TomcatServletWebServerFactory</code>, <code>JettyServletWebServerFactory</code>, or <code>UndertowServletWebServerFactory</code></li>
<li><code>åº•å±‚ç›´æ¥ä¼šæœ‰ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»ã€‚ServletWebServerFactoryAutoConfiguration</code></li>
<li><code>ServletWebServerFactoryAutoConfigurationå¯¼å…¥äº†ServletWebServerFactoryConfigurationï¼ˆé…ç½®ç±»ï¼‰</code></li>
<li><code>ServletWebServerFactoryConfiguration é…ç½®ç±» æ ¹æ®åŠ¨æ€åˆ¤æ–­ç³»ç»Ÿä¸­åˆ°åº•å¯¼å…¥äº†é‚£ä¸ªWebæœåŠ¡å™¨çš„åŒ…ã€‚ï¼ˆé»˜è®¤æ˜¯web-starterå¯¼å…¥tomcatåŒ…ï¼‰ï¼Œå®¹å™¨ä¸­å°±æœ‰ TomcatServletWebServerFactory</code></li>
<li><code>TomcatServletWebServerFactory åˆ›å»ºå‡ºTomcatæœåŠ¡å™¨å¹¶å¯åŠ¨ï¼›TomcatWebServer çš„æ„é€ å™¨æ‹¥æœ‰åˆå§‹åŒ–æ–¹æ³•initialize---this.tomcat.start();</code></li>
<li><code>å†…åµŒæœåŠ¡å™¨ï¼Œå°±æ˜¯æ‰‹åŠ¨æŠŠå¯åŠ¨æœåŠ¡å™¨çš„ä»£ç è°ƒç”¨ï¼ˆtomcatæ ¸å¿ƒjaråŒ…å­˜åœ¨ï¼‰</code></li>
</ul>
</li>
<li>
<p>``</p>
</li>
</ul>
<h2 id="2å®šåˆ¶servletå®¹å™¨">2ã€å®šåˆ¶Servletå®¹å™¨</h2>
<ul>
<li>
<p>å®ç° <strong>WebServerFactoryCu</strong>stomizer<ConfigurableServletWebServerFactory></p>
</li>
<li>
<ul>
<li>æŠŠé…ç½®æ–‡ä»¶çš„å€¼å’Œ**<code>ServletWebServerFactory è¿›è¡Œç»‘å®š</code>**</li>
</ul>
</li>
<li>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶ <strong>server.xxx</strong></p>
</li>
<li>
<p>ç›´æ¥è‡ªå®šä¹‰ <strong>ConfigurableServletWebServerFactory</strong></p>
</li>
</ul>
<p><strong>xxxxx<strong><strong>Customizer</strong></strong>ï¼šå®šåˆ¶åŒ–å™¨ï¼Œå¯ä»¥æ”¹å˜xxxxçš„é»˜è®¤è§„åˆ™</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.boot.web.server.WebServerFactoryCustomizer</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.boot.web.servlet.server.ConfigurableServletWebServerFactory</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomizationBean</span> <span class="kd">implements</span> <span class="n">WebServerFactoryCustomizer</span><span class="o">&lt;</span><span class="n">ConfigurableServletWebServerFactory</span><span class="o">&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">customize</span><span class="o">(</span><span class="n">ConfigurableServletWebServerFactory</span> <span class="n">server</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">server</span><span class="o">.</span><span class="na">setPort</span><span class="o">(</span><span class="mi">9000</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="11å®šåˆ¶åŒ–åŸç†">11ã€å®šåˆ¶åŒ–åŸç†</h1>
<h2 id="1å®šåˆ¶åŒ–çš„å¸¸è§æ–¹å¼">1ã€å®šåˆ¶åŒ–çš„å¸¸è§æ–¹å¼</h2>
<ul>
<li>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼›</li>
<li><strong>xxxxxCustomizerï¼›</strong></li>
<li><strong>ç¼–å†™è‡ªå®šä¹‰çš„é…ç½®ç±»  xxxConfigurationï¼›+</strong> <strong>@Beanæ›¿æ¢ã€å¢åŠ å®¹å™¨ä¸­é»˜è®¤ç»„ä»¶ï¼›è§†å›¾è§£æå™¨</strong></li>
<li><strong>Webåº”ç”¨ ç¼–å†™ä¸€ä¸ªé…ç½®ç±»å®ç° WebMvcConfigurer å³å¯å®šåˆ¶åŒ–webåŠŸèƒ½ï¼›+ @Beanç»™å®¹å™¨ä¸­å†æ‰©å±•ä¸€äº›ç»„ä»¶</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AdminWebConfig</span> <span class="kd">implements</span> <span class="n">WebMvcConfigurer</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>@EnableWebMvc + WebMvcConfigurer â€”â€” @Bean å¯ä»¥å…¨é¢æ¥ç®¡SpringMVCï¼Œæ‰€æœ‰è§„åˆ™å…¨éƒ¨è‡ªå·±é‡æ–°é…ç½®ï¼› å®ç°å®šåˆ¶å’Œæ‰©å±•åŠŸèƒ½</p>
</li>
<li>
<ul>
<li>åŸç†</li>
<li>1ã€WebMvcAutoConfiguration  é»˜è®¤çš„SpringMVCçš„è‡ªåŠ¨é…ç½®åŠŸèƒ½ç±»ã€‚é™æ€èµ„æºã€æ¬¢è¿é¡µ&hellip;..</li>
<li>2ã€ä¸€æ—¦ä½¿ç”¨ @EnableWebMvc ã€ã€‚ä¼š @Import(DelegatingWebMvcConfiguration.<strong>class</strong>)</li>
<li>3ã€<strong>DelegatingWebMvcConfiguration</strong> çš„ ä½œç”¨ï¼Œåªä¿è¯SpringMVCæœ€åŸºæœ¬çš„ä½¿ç”¨</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>æŠŠæ‰€æœ‰ç³»ç»Ÿä¸­çš„ WebMvcConfigurer æ‹¿è¿‡æ¥ã€‚æ‰€æœ‰åŠŸèƒ½çš„å®šåˆ¶éƒ½æ˜¯è¿™äº› WebMvcConfigurer  åˆèµ·æ¥ä¸€èµ·ç”Ÿæ•ˆ</li>
<li>è‡ªåŠ¨é…ç½®äº†ä¸€äº›éå¸¸åº•å±‚çš„ç»„ä»¶ã€‚<strong>RequestMappingHandlerMapping</strong>ã€è¿™äº›ç»„ä»¶ä¾èµ–çš„ç»„ä»¶éƒ½æ˜¯ä»å®¹å™¨ä¸­è·å–</li>
<li><strong>public class</strong> DelegatingWebMvcConfiguration <strong>extends</strong> <strong>WebMvcConfigurationSupport</strong></li>
</ul>
</li>
</ul>
</li>
<li>
<ul>
<li>4ã€<strong>WebMvcAutoConfiguration</strong> é‡Œé¢çš„é…ç½®è¦èƒ½ç”Ÿæ•ˆ å¿…é¡»  @ConditionalOnMissingBean(<strong>WebMvcConfigurationSupport</strong>.<strong>class</strong>)</li>
<li>5ã€@EnableWebMvc  å¯¼è‡´äº† <strong>WebMvcAutoConfiguration  æ²¡æœ‰ç”Ÿæ•ˆã€‚</strong></li>
</ul>
</li>
<li>
<p>&hellip; &hellip;</p>
</li>
</ul>
<h2 id="2åŸç†åˆ†æå¥—è·¯">2ã€åŸç†åˆ†æå¥—è·¯</h2>
<p><strong>åœºæ™¯starter</strong> <strong>- xxxxAutoConfiguration - å¯¼å…¥xxxç»„ä»¶ - ç»‘å®šxxxProperties &ndash;</strong> <strong>ç»‘å®šé…ç½®æ–‡ä»¶é¡¹</strong></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">æ–‡ç« ä½œè€…</span>
    <span class="item-content">yuanshuai</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">ä¸Šæ¬¡æ›´æ–°</span>
    <span class="item-content">
        0001-01-01
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/yuanshuai1122.github.io/tags/java/">Java</a>
          <a href="/yuanshuai1122.github.io/tags/springboot/">SpringBoot</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="yuanshuai1122.github.io/post/spring5%E4%B9%8B%E6%96%B0%E5%8A%9F%E8%83%BDwebflux-spring5%E4%B9%8B%E6%96%B0%E5%8A%9F%E8%83%BDwebflux/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Spring5ä¹‹æ–°åŠŸèƒ½Webflux</span>
            <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
          </a>
        <a class="next" href="yuanshuai1122.github.io/post/springboot2%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-springboot2%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">
            <span class="next-text nav-default">SpringBoot2æ ¸å¿ƒæŠ€æœ¯-å•å…ƒæµ‹è¯•</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="http://localhost:1313" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="http://localhost:1313" class="iconfont icon-twitter" title="twitter"></a>
      <a href="http://localhost:1313" class="iconfont icon-facebook" title="facebook"></a>
      <a href="http://localhost:1313" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="http://localhost:1313" class="iconfont icon-google" title="google"></a>
      <a href="http://localhost:1313" class="iconfont icon-github" title="github"></a>
      <a href="http://localhost:1313" class="iconfont icon-weibo" title="weibo"></a>
      <a href="http://localhost:1313" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="http://localhost:1313" class="iconfont icon-douban" title="douban"></a>
      <a href="http://localhost:1313" class="iconfont icon-pocket" title="pocket"></a>
      <a href="http://localhost:1313" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="http://localhost:1313" class="iconfont icon-instagram" title="instagram"></a>
      <a href="http://localhost:1313" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="http://localhost:1313" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="yuanshuai1122.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://gohugo.io">Hugo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>yuanshuai</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js" integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js" integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin="anonymous"></script>
  <script>
    var languageCode = "zh-cn".replace(/-/g, '_').replace(/_(.*)/, function ($0, $1) {return $0.replace($1, $1.toUpperCase());});
    timeago().render(document.querySelectorAll('.timeago'), languageCode);
    timeago.cancel();  
  </script>



<script type="text/javascript" src="/yuanshuai1122.github.io/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
